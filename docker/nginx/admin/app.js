webpackJsonp(["app"],{"../../common/src/data/database.js":function(e,t,n){"use strict";function s(e,t,n){this.context=t||{},this.remoteDataSource=e,this.online=n}function r(e,t){return o.assign({},e,t)}var o=n("../node_modules/lodash/lodash.js");n("../node_modules/bluebird/js/browser/bluebird.js"),n("../../common/src/errors/http-error.js");e.exports=s,s.prototype.find=function(e){return e=r(this.context,e),this.remoteDataSource.find(e)},s.prototype.findOne=function(e){return e=o.extend({expected:1},e),this.find(e).then(function(e){return e[0]||null})},s.prototype.save=function(e,t,n){return e=r(this.context,e),this.remoteDataSource.save(e,t,n)},s.prototype.saveOne=function(e,t,n){return this.save(e,[t],n).then(function(e){return e.length>0?e[0]:null})},s.prototype.remove=function(e,t){return e=r(this.context,e),this.remoteDataSource.remove(e,t)},s.prototype.removeOne=function(e,t){return this.remove(e,[t]).then(function(e){return e.length>0?e[0]:null})},s.prototype.await=function(e,t,n){return e=r(this.context,e),this.remoteDataSource.await(e,t,n)},s.prototype.refresh=function(e,t){return e=r(this.context,e),this.remoteDataSource.refresh(e,t)},s.prototype.use=function(){var e={};o.assign(e,this.context);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return o.each(n,function(t){o.assign(e,t)}),new s(this.remoteDataSource,e)},s.prototype.start=function(e){return e=r(this.context,e),this.remoteDataSource.start(e)},s.prototype.beginSession=function(e){return this.remoteDataSource.beginSession(this.context,e)},s.prototype.checkSession=function(){return this.remoteDataSource.checkSession(this.context)},s.prototype.hasAuthorization=function(){return this.remoteDataSource.hasAuthorization(this.context)},s.prototype.restoreSession=function(e){this.remoteDataSource.restoreSession(e)},s.prototype.submitPassword=function(e,t){return this.remoteDataSource.submitPassword(this.context,e,t)},s.prototype.endSession=function(){return this.remoteDataSource.endSession(this.context)},s.prototype.beginMobileSession=function(e){return this.remoteDataSource.beginMobileSession(this.context,e)},s.prototype.acquireMobileSession=function(e){return this.remoteDataSource.acquireMobileSession(this.context,e)},s.prototype.releaseMobileSession=function(){return this.remoteDataSource.releaseMobileSession(this.context)},s.prototype.endMobileSession=function(e){return this.remoteDataSource.endMobileSession(this.context,e)},s.prototype.getOAuthURL=function(e,t){return this.remoteDataSource.getOAuthURL(this.context,e,t)},s.prototype.findTemporaryID=function(e,t){return e=r(this.context,e),this.remoteDataSource.findTemporaryID(e,t)}},"../../common/src/data/empty.js":function(e,t,n){"use strict";e.exports={array:[],object:{},string:"",func:function(){}}},"../../common/src/data/indexed-db-cache.jsx":function(e,t,n){"use strict";var s=function(){function e(e,t){var n=[],s=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(s=(i=a.next()).done)&&(n.push(i.value),!t||n.length!==t);s=!0);}catch(e){r=!0,o=e}finally{try{!s&&a.return&&a.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/bluebird/js/browser/bluebird.js"),i=n("../node_modules/react/react.js"),a=i.PropTypes,l=n("../../common/src/data/local-search.js"),c=n("../../common/src/mixins/update-check.js"),d=n("../../common/src/widgets/diagnostics.jsx"),u=n("../../common/src/widgets/diagnostics-section.jsx");e.exports=i.createClass({displayName:"IndexedDBCache",mixins:[c],propTypes:{databaseName:a.string.isRequired},statics:{isAvailable:function(){return!!window.indexedDB}},getInitialState:function(){return this.tables={},{database:null,recordCounts:{},writeCount:0,readCount:0,deleteCount:0}},find:function(e){var t=this,n=e.address||"",s=e.schema,o=e.table,i=e.criteria;return this.fetchTable(n,s,o).then(function(e){var n=t.getObjectKeyName(s),a=[];if(r.isEqual(r.keys(i),[n])){var c=i[n];return c=c instanceof Array?r.sortBy(r.slice(c)):[c],r.each(c,function(t){var s={};s[n]=t;var o=r.sortedIndexBy(e,s,n),i=e[o];i&&i[n]===t&&a.push(i)}),a}return r.each(e,function(e){l.match(o,e,i)&&a.push(e)}),a}).then(function(n){l.limit(o,n,e.criteria);var s=t.state.readCount;return s+=n.length,t.setState({readCount:s}),n})},save:function(e,t){var n=this,s=e.address||"",i=e.schema,a=e.table;return this.open().then(function(e){return new o(function(o,l){var c=n.getTablePath(s,i,a),d=n.getPrimaryKeyGenerator(s,i,a),u=n.getObjectStoreName(i),p=e.transaction(u,"readwrite"),m=p.objectStore(u);p.oncomplete=function(e){o(t)},p.onerror=function(e){l(new Error(e.message))},r.each(t,function(e){var t=d(e),n={address:s,location:c,data:e};m.put(n,t)})})}).then(function(e){var t=n.state.writeCount;return t+=e.length,n.setState({writeCount:t}),n.updateTableEntry(s,i,a,e,!1),n.updateRecordCount(i,500),e})},remove:function(e,t){var n=this,s=e.address||"",i=e.schema,a=e.table;return this.open().then(function(e){return new o(function(o,l){var c=n.getPrimaryKeyGenerator(s,i,a),d=(n.getTablePath(s,i,a),n.getObjectStoreName(i)),u=e.transaction(d,"readwrite"),p=u.objectStore(d);u.oncomplete=function(e){o(t)},u.onerror=function(e){l(new Error(e.message))},r.each(t,function(e){var t=c(e);p.delete(t)})})}).then(function(e){var t=n.state.deleteCount;return t+=e.length,n.setState({deleteCount:t}),n.updateTableEntry(s,i,a,e,!0),n.updateRecordCount(i,500),e})},clean:function(e){var t=this;return this.open().then(function(n){return new o(function(s,o){var i=t.getObjectStoreName("remote"),a=n.transaction(i,"readwrite"),l=a.objectStore(i);if(void 0!=e.address){var c=null;e.schema&&"*"!==e.schema&&(c=e.address+"/"+e.schema+"/");var d=l.index("address"),u=d.openCursor(e.address),p=[],m=[];u.onsuccess=function(e){var t=!0,n=e.target.result;if(n){var o=n.value,i=n.primaryKey;c&&!r.startsWith(o.location,c)||(p.push(o),m.push(i)),n.continue(),t=!1}t&&(r.each(m,function(e){l.delete(e)}),s(p))}}else if(void 0!=e.count){var d=l.index("rtime"),u=d.openCursor(),p=[],m=[];u.onsuccess=function(t){var n=!0,o=t.target.result;if(o){var i=o.value,a=o.primaryKey;p.push(i),m.push(a),p.length<e.count&&(o.continue(),n=!1)}n&&(r.each(m,function(e){l.delete(e)}),s(p))}}else{if(void 0==e.before)return[];var d=l.index("rtime"),u=d.openCursor(),p=[],m=[];u.onsuccess=function(t){var n=!0,o=t.target.result;if(o){var i=o.value,a=o.primaryKey;i.data.rtime<e.before&&(p.push(i),m.push(a),o.continue(),n=!1)}n&&(r.each(m,function(e){l.delete(e)}),s(p))}}})}).then(function(e){var n=e.length;if(n>0){var o=t.state.deleteCount;o+=e.length,t.setState({deleteCount:o}),t.updateRecordCount("remote",500);var i=[];r.each(e,function(e){var t=e.address||"",n=e.location.substr(t.length+1).split("/"),o=s(n,2),a=o[0],l=o[1],c=r.find(i,{address:t,schema:a,table:l});c||(c={address:t,schema:a,table:l,objects:[]},i.push(c)),c.objects.push(e.data)}),r.each(i,function(e){t.updateTableEntry(e.address,e.schema,e.table,e.objects,!0)})}return n}).catch(function(e){return t.destroy()})},open:function(){var e=this;return this.databasePromise||(this.databasePromise=new o(function(t,n){var s=window.indexedDB.open(e.props.databaseName,1);s.onsuccess=function(n){var s=n.target.result;t(s),e.setState({database:s})},s.onerror=function(e){n(new Error(e.message))},s.onupgradeneeded=function(e){var t=e.target.result;t.onerror=function(e){n(new Error(e.message))},t.createObjectStore("local-data").createIndex("location","location",{unique:!1});var s=t.createObjectStore("remote-data");s.createIndex("location","location",{unique:!1}),s.createIndex("address","address",{unique:!1}),s.createIndex("rtime","data.rtime",{unique:!1})}})),this.databasePromise},destroy:function(){var e=this;return new o(function(t,n){var s=window.indexedDB.deleteDatabase(e.props.databaseName);s.onsuccess=function(e){t(!0)},s.onerror=function(e){t(!1)}})},reset:function(e,t){var n="local"===t?["local"]:r.filter(["remote",e,t]);r.unset(this.tables,n)},getObjectStoreName:function(e){return"local"===e?"local-data":"remote-data"},getObjectKeyName:function(e){return"local"===e?"key":"id"},getTablePath:function(e,t,n){return"local"===t?n:e+"/"+t+"/"+n},getPrimaryKeyGenerator:function(e,t,n){var s=this.getTablePath(e,t,n);return"local"===t?function(e){return s+"/"+e.key}:function(e){var t=("0000000000"+e.id).slice(-10);return s+"/"+t}},getTableEntry:function(e,t,n){var s="local"===t?["local",n]:["remote",e,t,n],o=r.get(this.tables,s);return o||(o={promise:null,objects:null},r.set(this.tables,s,o)),o},updateTableEntry:function(e,t,n,s,o){var i=this.getTableEntry(e,t,n);if(i.objects){var a=this.getObjectKeyName(t);r.each(s,function(e){var t=r.sortedIndexBy(i.objects,e,a),n=i.objects[t];n&&n[a]===e[a]?o?i.objects.splice(t,1):i.objects[t]=e:o||i.objects.splice(t,0,e)})}},fetchTable:function(e,t,n){var s=this.getTableEntry(e,t,n);return s.promise||(s.promise=this.loadTable(e,t,n).then(function(e){return s.objects=e,s.objects})),s.promise},loadTable:function(e,t,n){var s=this;return this.open().then(function(i){return new o(function(o,a){var l=s.getObjectStoreName(t),c=s.getObjectKeyName(t),d=i.transaction(l,"readonly"),u=d.objectStore(l),p=u.index("location"),m=s.getTablePath(e,t,n),h=p.openCursor(m),f=[];h.onsuccess=function(e){var t=e.target.result;if(t){var n=t.value,s=n.data,i=r.sortedIndexBy(f,s,c);f.splice(i,0,s),t.continue()}else o(f)}})})},updateRecordCount:function(e,t){var n=this,s=this.getObjectStoreName(e),o="updateRecordCountTimeouts."+s,i=r.get(this,o);i&&clearTimeout(i),i=setTimeout(function(){n.open().then(function(e){e.transaction(s,"readonly").objectStore(s).count().onsuccess=function(e){var t=r.clone(n.state.recordCounts);t[s]=e.target.result,n.setState({recordCounts:t})}}).catch(function(e){}),r.set(n,o,0)},t||0),r.set(this,o,i)},componentDidMount:function(){this.updateRecordCount("remote"),this.updateRecordCount("local")},render:function(){var e=this.state.database,t=r.get(this.state.recordCounts,"local-data"),n=r.get(this.state.recordCounts,"remote-data");return i.createElement(d,{type:"indexed-db-cache"},i.createElement(u,{label:"Database details"},i.createElement("div",null,"Name: ",e?e.name:""),i.createElement("div",null,"Version: ",e?e.version:"")),i.createElement(u,{label:"Usage"},i.createElement("div",null,"Local objects: ",t),i.createElement("div",null,"Remote objects: ",n),i.createElement("div",null,"Objects read: ",this.state.readCount),i.createElement("div",null,"Objects written: ",this.state.writeCount),i.createElement("div",null,"Objects deleted: ",this.state.deleteCount)))}})},"../../common/src/data/local-search.js":function(e,t,n){"use strict";function s(e,t,n){var s=!0;for(var r in n){var a=n[r];if(void 0!==a){if(t.hasOwnProperty(r)){var l=t[r];if(a instanceof Array)if(l instanceof Array)0===i.intersection(a,l).length&&(s=!1);else{var c;c=l instanceof Object?i.some(a,function(e){return i.isEqual(e,l)}):i.includes(a,l),c||(s=!1)}else if(l!==a){"object"===(void 0===l?"undefined":o(l))&&"object"===(void 0===a?"undefined":o(a))?i.isEqual(l,a)||(s=!1):s=!1;break}}else switch(r){case"time_range":if(a){var d=a.substr(1,a.length-2).split(","),u=d[0],p=d[1];u<=t.ptime&&t.ptime<p||(s=!1)}break;case"exclude":a instanceof Array?i.includes(a,t.id)&&(s=!1):a===t.id&&(s=!1);break;case"newer_than":!t.ptime||t.ptime>a||(s=!1);break;case"older_than":!t.ptime||t.ptime<a||(s=!1);break;case"search":s=!1}if(!s)break}}return s}function r(e,t,n){if(n&&(n.limit&&t.length>n.limit&&t.splice(0,t.length-n.limit),n.per_user_limit)){var s=n.per_user_limit,r={},o=[];i.eachRight(t,function(e){var t=!1;if(e.hasOwnProperty("user_id")){var n=e.user_id,a=r[n]||0;a<s&&(r[n]=a+1,t=!0)}else e.hasOwnProperty("user_ids")&&i.each(e.user_ids,function(e){var n=r[e]||0;n<s&&(r[e]=n+1,t=!0)});t||o.push(e)}),i.pullAll(t,o)}}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n("../node_modules/lodash/lodash.js");e.exports={match:s,limit:r}},"../../common/src/data/local-storage-cache.jsx":function(e,t,n){"use strict";function s(e){try{return JSON.parse(e)}catch(e){return null}}function r(e,t){var n=a.sortedIndexBy(e,{id:t},"id"),s=e[n];if(s&&s.id===t)return s}function o(e,t){var n=a.sortedIndexBy(e,t,"id"),s=e[n];s&&s.id===t.id?e[n]=t:e.splice(n,0,t)}function i(e,t){var n=a.sortedIndexBy(e,t,"id"),s=e[n];s&&s.id===t.id&&e.splice(n,1)}var a=n("../node_modules/lodash/lodash.js"),l=n("../node_modules/bluebird/js/browser/bluebird.js"),c=n("../node_modules/react/react.js"),d=c.PropTypes,u=n("../../common/src/data/local-search.js");e.exports=c.createClass({displayName:"LocalStorageCache",propTypes:{databaseName:d.string.isRequired},statics:{isAvailable:function(){return!!window.localStorage}},getInitialState:function(){var e=localStorage.getItem(this.props.databaseName);return this.localData=s(e)||{},this.remoteData={},{}},getRows:function(e,t,n){var s="local"===t?this.localData:this.remoteData,r=[e,t,n],o=a.get(s,r);return o||(o=[],a.set(s,r,o)),o},saveRows:function(e,t,n){if("local"===t){var s=JSON.stringify(this.localData);localStorage.setItem(this.props.databaseName,s)}},find:function(e){var t,n=e.server||"",s=e.schema,o=e.table,i=e.criteria,c=this.getRows(n,s,o);if(i&&void 0!==i.id&&1===a.size(i)){var d=i.id;d instanceof Array||(d=[d]),t=a.filter(a.map(d,function(e){return r(c,e)}))}else t=a.filter(c,function(e){return u.match(o,e,i)});return u.limit(o,t,i),l.resolve(t)},save:function(e,t){var n=e.server||"",s=e.schema,r=e.table,i=this.getRows(n,s,r);return a.each(t,function(e){o(i,a.cloneDeep(e))}),this.saveRows(n,s,r),l.resolve(t)},remove:function(e,t){var n=e.server||"",s=e.schema,r=e.table,o=this.getRows(n,s,r);return a.each(t,function(e){i(o,e)}),this.saveRows(n,s,r),l.resolve(t)},clean:function(e){var t=this.remoteData,n=0;if(void 0!==e.server){var s=e.server,r=a.get(t,s);a.each(r,function(e){a.each(e,function(e){n+=e.length})}),a.set(t,s,void 0)}else if(void 0!==e.count){var o=[];a.each(t,function(e){a.each(e,function(e){a.each(e,function(e){for(var t=0;t<e.length;t++)o.push(e[t])})})}),o.sort(function(e,t){return e.rtime<t.rtime?-1:e.rtime>t.rtime?1:0}),o.splice(e.count),a.each(t,function(e){a.each(e,function(e){a.each(e,function(e){for(var t=e.length-1;t>=0;t--){var s=e[t];-1!==o.indexOf(s)&&(e.splice(t,1),n++)}})})})}else void 0!==e.before&&a.each(t,function(t){a.each(t,function(t){a.each(t,function(t){for(var s=t.length-1;s>=0;s--){t[s].rtime<e.before&&(t.splice(s,1),n++)}})})});return l.resolve(n)},render:function(){return c.createElement("div",null)}})},"../../common/src/data/remote-data-source/change.js":function(e,t,n){"use strict";function s(e,t,n){var s=this;this.location=e,this.objects=r.map(t,function(e){return e.uncommitted||(e=r.clone(e),e.id||(e.id=l.allocate()),e.uncommitted=!0),e}),this.removed=r.map(t,function(e){return!1}),this.dispatched=!1,this.delayed=!1,this.dispatching=!1,this.committed=!1,this.canceled=!1,this.timeout=0,this.promise=new o(function(e,t){s.resolvePromise=e,s.rejectPromise=t}),this.dependentPromises=[],this.delivered=null,this.received=null,this.error=null,this.time=null,n&&(n.delay&&(this.delayed=!0,this.timeout=setTimeout(function(){s.delayed=!1,s.dispatching&&(s.dispatching=!1,s.dispatch())},n.delay)),this.onConflict=n.onConflict),this.onDispatch=null,this.onCancel=null}var r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/bluebird/js/browser/bluebird.js"),i=n("../node_modules/async-do-while/index.js"),a=n("../../common/src/data/local-search.js"),l=n("../../common/src/data/remote-data-source/temporary-id.js");e.exports=s,s.prototype.dispatch=function(){var e=this;if(!this.dispatched&&!this.canceled)return this.delayed?void(this.dispatching=!0):void o.all(this.dependentPromises).then(function(){var t=1,n=1e3;return i.while(function(){return!e.committed&&!e.canceled&&!e.dispatched}),i.do(function(){return e.dispatched=!0,e.onDispatch(e).then(function(t){e.committed=!0,e.received=t,e.time=new Date,e.canceled?e.resolvePromise([]):e.resolvePromise(t)}).catch(function(s){return s.statusCode>=400&&s.statusCode<=499&&(e.error=s,e.rejectPromise(s)),e.dispatched=!1,n=Math.min(2*n,1e4),o.delay(n).then(function(){e.canceled?e.resolvePromise([]):t++})})}),i.end()})},s.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.dispatched||this.timeout&&clearTimeout(this.timeout))},s.prototype.merge=function(e){var t=this;if(r.isEqual(e.location,this.location)){var n=!1;if(r.each(this.objects,function(t,s){var o=r.findIndex(e.objects,{id:t.id});if(-1!==o&&!e.removed[o])if(!e.dispatched||t.id>=1){var i=e.objects[o];r.forIn(i,function(e,n){void 0===t[n]&&(t[n]=e)}),e.removed[o]=!0}else n=!0}),n){var s=e.promise.then(function(){r.each(t.objects,function(t){if(t.id<1){var n=e.findPermanentID(t.id);n&&(t.id=n)}})}).catch(function(e){});this.dependentPromises.push(s)}else r.every(e.removed)&&e.cancel()}},s.prototype.findPermanentID=function(e){var t=r.findIndex(this.delivered,{id:e});if(-1!==t&&this.received){var n=this.received[t];if(n)return n.id}},s.prototype.apply=function(e,t){var n=this;this.canceled||r.isMatch(e,this.location)&&r.each(this.objects,function(s,o){if(!n.removed[o]){var i=r.findIndex(e.results,{id:s.id});if(-1!==i)if(s.deleted&&!t)e.results.splice(i,1);else{var l=a.match(e.table,s,e.criteria);if(l){var c,d=e.results[i],u=r.some(d,function(e,t){if(!s.hasOwnProperty(t))return!0});c=u?r.extend({},d,s):s,e.results[i]=c}else e.results.splice(i,1)}else if(!s.deleted||t){var l=a.match(e.table,s,e.criteria);l&&e.results.push(s)}}})},s.prototype.deliverables=function(){var e=this;return this.delivered=r.filter(this.objects,function(t,n){return!e.removed[n]}),r.map(this.delivered,function(e){return e.id<1?r.omit(e,"id","uncommitted"):r.omit(e,"uncommitted")})},s.prototype.noop=function(){return this.objects=r.filter(this.objects,function(e){return!(e.deleted&&e.id<1)}),r.isEmpty(this.objects)},s.prototype.matchLocation=function(e){return this.location.address===e.address&&(this.location.schema===e.schema&&this.location.table===e.table)}},"../../common/src/data/remote-data-source/index.jsx":function(e,t,n){"use strict";function s(e,t){var n=[];return u.each(e,function(e,s){var r=u.sortedIndexBy(t,{id:e},"id"),o=t?t[r]:null;o&&o.id===e||n.push(e)}),n}function r(e,t,n){var s=[];return u.each(e,function(e,r){var o=t[r],i=u.sortedIndexBy(n,{id:e},"id"),a=n?n[i]:null;a&&a.id===e&&a.gn===o||s.push(e)}),s}function o(e,t,n){var s=[];return u.each(n,function(t){u.includes(e,t.id)||s.push(t.id)}),s}function i(e,t){return u.isEmpty(t)?e:(e=u.slice(e),u.each(t,function(t){var n=u.sortedIndexBy(e,{id:t},"id"),s=e?e[n]:null;s&&s.id===t&&e.splice(n,1)}),e)}function a(e,t){return e=u.slice(e),u.each(t,function(t){var n=u.sortedIndexBy(e,t,"id"),s=e[n];s&&s.id===t.id?e[n]=t:e.splice(n,0,t)}),e}function l(e,t){t||(t="primary");var n=u.find(R,{address:e,type:t});return n||(n={address:e,type:t},R.push(n)),n}function c(e){return u.filter(R,e)}function d(e){u.pull(R,e)}var u=n("../node_modules/lodash/lodash.js"),p=n("../node_modules/bluebird/js/browser/bluebird.js"),m=n("../node_modules/react/react.js"),h=m.PropTypes,f=n("../node_modules/moment/moment.js"),g=n("../../common/src/transport/http-request.js"),v=n("../../common/src/errors/http-error.js"),b=n("../../common/src/data/local-search.js"),y=n("../../common/src/data/remote-data-source/search.js"),j=n("../../common/src/data/remote-data-source/change.js"),x=n("../../common/src/data/remote-data-source/storage.js"),w=n("../../common/src/data/remote-data-source/removal.js"),_=n("../../common/src/mixins/update-check.js"),E=n("../../common/src/widgets/diagnostics.jsx"),k=n("../../common/src/widgets/diagnostics-section.jsx"),C=n("../../common/src/data/remote-data-source/recent-search-table.jsx"),S=n("../../common/src/data/remote-data-source/recent-storage-table.jsx");e.exports=m.createClass({displayName:"RemoteDataSource",mixins:[_],propTypes:{basePath:h.string,discoveryFlags:h.object,retrievalFlags:h.object,online:h.bool,connected:h.bool,inForeground:h.bool,prefetching:h.bool,cache:h.object,cacheValidation:h.bool,refreshInterval:h.number,sessionRetryInterval:h.number,onChange:h.func,onSearch:h.func,onAuthorization:h.func,onExpiration:h.func,onViolation:h.func,onStupefaction:h.func},getDefaultProps:function(){return{basePath:"/srv/data",discoveryFlags:{},retrievalFlags:{},online:!0,connected:!1,inForeground:!0,prefetching:!0,cacheValidation:!0,refreshInterval:900,sessionRetryInterval:5e3}},getInitialState:function(){this.searching=!1,this.disconnected=!1,this.idMappings={},this.cacheValidation={},this.cacheClearing={},this.changeMonitors=[];var e={recentSearchResults:[],recentStorageResults:[],recentRemovalResults:[],changeQueue:[]};return u.assign(this,e),e},updateList:function(e,t){var n=this[e],s=t(n);this[e]=s;var r={};r[e]=s,this.setState(r)},isOnline:function(){return this.props.online},isReceivingNotification:function(){return this.props.connected},beginSession:function(e,t){var n=this,s=e.address,r=l(s);if(!r.promise){var o=s+"/srv/session/",i={responseType:"json",contentType:"json"};r.promise=g.fetch("POST",o,{area:t},i).then(function(e){if(u.assign(r,e.session),r.handle)return{system:e.system,servers:e.servers};throw new v(r.error)}).catch(function(e){throw r.promise=null,setTimeout(n.triggerChangeEvent,n.props.sessionRetryInterval),e})}return r.promise},checkSession:function(e){var t=this,n=e.address,s=l(n),r=s.handle;if(!r)return p.resolve(!1);var o=n+"/srv/session/",i={responseType:"json"};return g.fetch("GET",o,{handle:r},i).then(function(e){if(e&&e.session&&u.assign(s,e.session),s.token)return t.triggerAuthorizationEvent(s),!0;if(s.error)throw new v(s.error);return!1}).catch(function(e){throw s.promise=null,t.triggerChangeEvent(),e})},submitPassword:function(e,t,n){var s=this,r=e.address,o=l(r),i=o.handle;if(!i)return p.resolve(!1);var a=r+"/srv/session/htpasswd/",c={handle:i,username:t,password:n},d={responseType:"json",contentType:"json"};return g.fetch("POST",a,c,d).then(function(e){return u.assign(o,e.session),s.triggerAuthorizationEvent(o),null}).catch(function(e){throw 401!==e.statusCode&&(o.promise=null,s.triggerChangeEvent()),e})},endSession:function(e){var t=this,n=e.address,s=l(n),r=s.handle;return r?p.resolve(s.promise).then(function(){var e=n+"/srv/session/",o={responseType:"json",contentType:"json"};return g.fetch("DELETE",e,{handle:r},o).catch(function(e){console.error(e)}).then(function(){return d(s),t.clearRecentOperations(n),t.clearCachedSchemas(n),t.triggerExpirationEvent(s),null})}):p.resolve(null)},beginMobileSession:function(e,t){var n=e.address,s=l(n,"mobile");if(!s.promise){var r=l(n),o=r.handle,i=n+"/srv/session/",a={responseType:"json",contentType:"json"};s.promise=g.fetch("POST",i,{area:t,handle:o},a).then(function(e){if(u.assign(s,e.session),s.handle)return s.handle;throw v(s.error)}).catch(function(e){throw s.promise=null,e})}return s.promise},acquireMobileSession:function(e,t){var n=this,s=e.address,r=l(s);if(r.handle!==t&&(r.promise=null,r.handle=t),!r.promise){var o=s+"/srv/session/",i={responseType:"json",contentType:"json"};r.promise=g.fetch("GET",o,{handle:t},i).then(function(e){if(u.assign(r,e.session),r.token)return n.triggerAuthorizationEvent(r),r.user_id;throw new v(r.error)}).catch(function(e){throw setTimeout(function(){r.promise=null,r.handle=null},5e3),e})}return r.promise},releaseMobileSession:function(e){var t=e.address,n=l(t,"mobile");return n.promise?n.promise.then(function(){d(n)}):p.resolve()},endMobileSession:function(e,t){var n=e.address,s=n+"/srv/session/",r={responseType:"json",contentType:"json"};return g.fetch("DELETE",s,{handle:t},r).then(function(){return null})},getOAuthURL:function(e,t,n){var s=e.address,r=l(s),o=r.handle;if(!o)return"";var i="sid="+t.id+"&handle="+o;return"activation"===n?i+="&activation=1":"test"===n&&(i+="&test=1"),s+"/srv/session/"+t.type+"/?"+i},hasAuthorization:function(e){return!!l(e.address).token},restoreSession:function(e){if(f(e.etime)>f()&&e.handle&&e.token){var t=l(e.address);u.assign(t,e)}},start:function(e){return p.resolve().then(function(){if("local"===e.schema)return 0;var t=e.address,n=l(t);if(n.token)return n.user_id;throw new v(401)})},find:function(e){var t=this,n=new y(e);if(n.isLocal())return this.searchLocalCache(n).then(function(){return n.results});var s,r=u.get(e,"by.constructor.displayName"),o=e.required,i=e.committed;s=!0===e.blocking?"insufficient":!1===e.blocking?"never":void 0==e.blocking?"insufficient":e.blocking,o&&"never"===s&&(s="incomplete");var a,l=this.findExistingSearch(n);if(l&&l.promise.isRejected()&&(l=null),l){r&&(u.includes(l.by,r)||l.by.push(r));if("expired"===(l.promise.isFulfilled()?l.isFresh(this.props.refreshInterval)?"complete":l.updating?"updating":"expired":"running")){var c=this.searchRemoteDatabase(l).then(function(e){return e&&t.triggerChangeEvent(),l.results}),d=!0;"expired"!==s&&(d=!1),d&&(l.promise=c)}a=l}else n=this.addSearch(n),n.promise=this.searchLocalCache(n).then(function(){var e;if("complete"===(e=n.isMeetingExpectation()?n.isSufficientlyRecent(t.props.refreshInterval)?"complete":"stale":n.isSufficientlyCached()?"incomplete":"insufficient"))return n.results;var r=t.searchRemoteDatabase(n).then(function(e){return e&&t.triggerChangeEvent(),a.results}),o=!0;return"stale"===e?"incomplete"!==s&&"insufficient"!==s||(o=!1):"incomplete"===e&&"insufficient"===s&&(o=!1),o?r:n.results}),a=n;return a.promise.then(function(s){if(u.get(t.props.discoveryFlags,"include_uncommitted")&&!0!==i&&(a=t.applyUncommittedChanges(a)),o&&!a.isMeetingExpectation())throw t.triggerStupefactionEvent(e,n.results),new v(404);return a.results})},save:function(e,t,n){var s=this,r=this.addStorage(new x(e,t,n));return r.isLocal()?this.updateLocalDatabase(r).then(function(){return s.triggerChangeEvent(),r.results}):this.updateRemoteDatabase(r).then(function(){return r.cancelled?[]:(s.updateLocalCache(r),s.updateRecentSearchResults(r),s.triggerChangeEvent(),r.results)})},remove:function(e,t){var n=this,s=this.addRemoval(new w(e,t));return s.isLocal()?this.updateLocalDatabase(s).then(function(){return n.triggerChangeEvent(),s.results}):this.updateRemoteDatabase(s).then(function(){return n.updateLocalCache(s),n.updateRecentSearchResults(s),n.triggerChangeEvent(),s.results})},await:function(e,t,n){var s=this,r={location:u.pick(e,"address","schema","table"),id:t.id,promise:null,resolve:null},o=new p(function(e){r.resolve=e});return r.promise=o.timeout(n).then(function(){return!0}).catch(function(e){return!1}).finally(function(){u.pull(s.changeMonitors,r)}),this.changeMonitors.push(r),r.promise},refresh:function(e,t){var n=this.getRelevantRecentSearches(e);u.each(n,function(e){var n=e.results,s=!1,r=u.sortedIndexBy(n,t,"id"),o=n[r];o&&o.id===t.id&&(s=!0),s&&(e.dirty=!0)})},abandon:function(e,t){this.updateList("recentSearchResults",function(n){var s=u.slice(n);return u.each(s,function(n){n.isLocal()||n.address===e&&(t&&n.schema!==t||(n.dirty=!0))}),s}),this.props.cache&&this.props.cache.reset(e,t)},invalidate:function(e){var t=this;if(!e||(e=this.omitOwnChanges(e),!u.isEmpty(e)))return this.reconcileChanges(e).then(function(){var n=[];return t.updateList("recentSearchResults",function(t){var s=u.slice(t);return u.each(s,function(t){if(!t.dirty){var s;s=!e||u.some(e,function(e){if(t.matchLocation(e)){if(!t.isMeetingExpectation())return!0;var n=u.sortedIndexBy(t.results,{id:e.id},"id"),s=t.results[n];if(s&&s.id===e.id)return!0}}),s&&(t.dirty=!0,n.push(t))}}),s}),e||(t.cacheValidation={}),!u.isEmpty(n)&&(t.props.online&&t.props.connected&&(t.triggerChangeEvent(),t.props.prefetching&&t.schedulePrefetch(n)),!0)})},triggerChangeMonitors:function(e,t){u.each(this.changeMonitors,function(n){u.isEqual(e,n.location)&&u.includes(t,n.id)&&n.resolve()})},omitOwnChanges:function(e){var t=this;return e?u.filter(e,function(e){var n=u.filter(t.changeQueue,function(t){if(t.dispatched&&!t.failed&&t.matchLocation(e))return!0});return!u.some(n,function(t){return t.committed?u.some(t.received,function(t){if(t.id===e.id&&t.gn>=e.gn)return!0}):u.some(t.delivered,function(t){if(t.id===e.id)return!0})})}):null},reconcileChanges:function(e){var t=this;return p.each(this.state.changeQueue,function(n){if(!1!==n.onConflict&&!n.dispatched){var s=u.filter(e,function(e){return n.matchLocation(e)}),r=u.filter(n.objects,function(t,r){if(!n.removed[r])return!e&&t.id>=1||u.some(s,function(e){if(e.id===t.id)return!0})});if(u.isEmpty(r))return null;var o=u.map(r,"id");return t.retrieveRemoteObjects(n.location,o,!0).then(function(e){return u.each(r,function(s){var r=u.find(e,{id:s.id});if(r&&r.gn>s.gn){var o=!1;if(n.onConflict&&n.onConflict({type:"conflict",target:t,local:s,remote:r,preventDefault:function(){o=!0}}),!o){var i=u.indexOf(n.objects,s);n.removed[i]=!0}}}),u.every(n.removed)&&n.cancel(),null})}})},triggerChangeEvent:function(){this.props.onChange&&this.props.onChange({type:"change",target:this})},triggerAuthorizationEvent:function(e){this.props.onAuthorization&&this.props.onAuthorization({type:"authorization",target:this,session:e})},triggerExpirationEvent:function(e){this.props.onExpiration&&this.props.onExpiration({type:"expiration",target:this,session:e})},triggerViolationEvent:function(e,t){this.props.onViolation&&this.props.onViolation({type:"violation",target:this,address:e,schema:t})},triggerStupefactionEvent:function(e,t){this.props.onStupefaction&&this.props.onStupefaction({type:"stupefaction",target:this,query:e,results:t})},triggerSearchEvent:function(e){this.props.onSearch&&this.props.onSearch({type:"search",target:this,searching:e})},findExistingSearch:function(e){var t=u.findIndex(this.recentSearchResults,function(t){return e.match(t)});if(-1!==t){var n=this.recentSearchResults[t];return n.prefetching=!0,this.updateList("recentSearchResults",function(e){var s=u.slice(e);return s.splice(t,1),s.unshift(n),s}),n}return null},addSearch:function(e){return this.updateList("recentSearchResults",function(t){var n=u.slice(t);for(n.unshift(e);n.length>1024;)n.pop();return n}),e},addStorage:function(e){return this.updateList("recentStorageResults",function(t){var n=u.slice(t);for(n.unshift(e),u.remove(n,{canceled:!0});n.length>32;)n.pop();return n}),e},addRemoval:function(e){return this.updateList("recentRemovalResults",function(t){var n=u.clone(t);for(n.unshift(e);n.length>32;)n.pop();return n}),e},searchRemoteDatabase:function(e){var t=this;if(e.isLocal())return p.resolve(!1);if(!this.props.online)return p.resolve(!1);if(e.updating)return p.resolve(!1);e.updating=!0,e.scheduled=!1,this.searching||(this.searching=!0,this.triggerSearchEvent(!0));var n=e.getLocation(),s=e.criteria;return e.start(),this.discoverRemoteObjects(n,s).then(function(n){return t.searchLocalCache(e,n).return(n)}).then(function(s){var l=s.ids,c=s.gns,d=r(l,c,e.results),m=o(l,c,e.results);if(u.isEmpty(d)){if(u.isEmpty(m))return null;return i(e.results,m)}return t.retrieveRemoteObjects(n,d).then(function(s){var r=s,o=a(e.results,r);if(o=i(o,m),u.get(t.props.discoveryFlags,"include_uncommitted")){var l=u.filter(t.changeQueue,function(e){if(e.dispatched&&!e.committed&&e.matchLocation(n))return!0});if(!u.isEmpty(l)){var c=u.map(l,"promise");return p.all(c).reflect().then(function(){return o})}}return o})}).then(function(n){return e.finish(n),t.updateList("recentSearchResults",function(e){return u.slice(e)}),t.updateLocalCache(e),!!n}).finally(function(){e.updating=!1,t.searchingEndTimeout&&clearTimeout(t.searchingEndTimeout),t.searchingEndTimeout=setTimeout(function(){var e=u.find(t.recentSearchResults,{scheduled:!0});e?t.searchRemoteDatabase(e):t.searching&&(t.searching=!1,t.triggerSearchEvent(!1)),t.searchingEndTimeout=0},250)})},discoverRemoteObjects:function(e,t){return this.performRemoteAction(e,"discovery",t)},retrieveRemoteObjects:function(e,t){return this.performRemoteAction(e,"retrieval",{ids:t})},updateRemoteDatabase:function(e){var t=this,n=new j(e.getLocation(),e.objects,e.options);return u.each(this.changeQueue,function(e){e.committed||e.canceled||n.merge(e)}),n.noop()?(e.finish(e.objects),p.resolve()):(n.onDispatch=function(n){var s=n.deliverables(),r=n.location;return e.start(),t.performRemoteAction(r,"storage",{objects:s}).then(function(e){return t.saveIDMapping(r,n.objects,e),e})},this.queueChange(n),this.props.online&&n.dispatch(),this.triggerChangeEvent(),n.promise.then(function(t){n.canceled?e.cancel():e.finish(t)}).catch(function(e){throw t.triggerChangeEvent(),e}))},queueChange:function(e){this.updateList("changeQueue",function(t){var n=f().subtract(1,"minute").toISOString(),s=u.reject(t,function(e){if(e.committed){if(e.time<n)return!0}else if(e.dispatched){if(e.error)return!0}else if(e.canceled)return!0});return s.push(e),s})},saveIDMapping:function(e,t,n){if(t.length===n.length){var s=[e.address,e.schema,e.table],r=u.get(this.idMappings,s);r||(r=[],u.set(this.idMappings,s,r)),u.each(t,function(e,t){if(e.id<1){var s=n[t];u.remove(r,{permanent:s.id}),r.push({temporary:e.id,permanent:s.id})}})}},findTemporaryID:function(e,t){var n=[e.address,e.schema,e.table],s=u.get(this.idMappings,n),r=u.find(s,{permanent:t});if(r)return r.temporary},applyUncommittedChanges:function(e){var t=u.filter(this.changeQueue,{committed:!1,canceled:!1,error:null});if(!u.isEmpty(t)){var n=u.get(this.props.discoveryFlags,"include_deleted");e=u.clone(e),e.results=u.slice(e.results),u.each(t,function(t){t.apply(e,n)})}return e},performRemoteAction:function(e,t,n){var s=this,r=e.address,o=this.props.basePath,i=e.schema,a=e.table;if(!i)return p.reject(new Error("No schema specified"));if(!a)return p.reject(new Error("No table specified"));var c;"retrieval"===t||"storage"===t?c=this.props.retrievalFlags:"discovery"===t&&(c=u.omit(this.props.discoveryFlags,"include_uncommitted"));var m=""+r+o+"/"+t+"/"+i+"/"+a+"/",h=l(r),f=u.assign({},n,c,{auth_token:h.token}),v={contentType:"json",responseType:"json"};return g.fetch("POST",m,f,v).then(function(e){return e}).catch(function(e){throw 401!==e.statusCode&&403!=e.statusCode||(s.clearRecentOperations(r),s.clearCachedSchemas(r),401===e.statusCode?(d(h),s.triggerExpirationEvent(h)):403==e.statusCode&&s.triggerViolationEvent(r,i),s.triggerChangeEvent()),e})},updateLocalDatabase:function(e){var t=this;return p.try(function(){var n=t.props.cache,s=e.getLocation();return e.start(),e.promise=e instanceof w?n.remove(s,e.objects):n.save(s,e.objects),e.promise.then(function(t){e.finish(t)})})},searchLocalCache:function(e,t){var n=this;return p.try(function(){var r=n.props.cache;if(t){if(!e.remote)return!1;var o=s(t.ids,e.results);if(u.isEmpty(o))return!1;var i=u.assign({criteria:{id:o}},e.getLocation());return n.validateCache(i.address,i.schema).then(function(){return r.find(i).then(function(t){return e.results=a(e.results,t),!0})})}if(e.remote)return!1;var i=e.getQuery();return n.validateCache(i.address,i.schema).then(function(){return r.find(i).then(function(t){return e.results=t,!0})})}).catch(function(e){return console.error(e),!1})},validateCache:function(e,t){var n=this;if("local"===t||!this.props.online||!this.props.cacheValidation)return p.resolve();var s=(this.props.cache,[e,t]),r=u.get(this.cacheValidation,s);return r||(r=this.getRemoteSignature(e,t).then(function(s){return n.getCacheSignature(e,t).then(function(r){return r?r!==s?n.clearCachedObjects(e,t).then(function(){return n.setCacheSignature(e,t,s),null}):void 0:n.waitForCacheClearing(e,t).then(function(){return n.setCacheSignature(e,t,s),null})})}).catch(function(e){console.error(e),u.unset(n.cacheValidation,s)}),u.set(this.cacheValidation,s,r)),r},clearCachedSchemas:function(e){var t=this;return u.unset(this.cacheValidation,[e]),this.clearCachedObjects(e,"*").then(function(){var n=t.props.cache,s={schema:"local",table:"remote_schema"},r=e+"/";return n.find(s).filter(function(e){return u.startsWith(e.key,r)}).then(function(e){return n.remove(s,e)})})},getRemoteSignature:function(e,t){var n=""+e+this.props.basePath+"/signature/"+t,s={responseType:"json"};return g.fetch("GET",n,null,s).then(function(e){return u.get(e,"signature")})},getCacheSignature:function(e,t){var n=this.props.cache,s={schema:"local",table:"remote_schema",criteria:{key:e+"/"+t}};return n.find(s).get(0).then(function(e){return u.get(e,"signature")})},setCacheSignature:function(e,t,n){var s=this.props.cache,r={schema:"local",table:"remote_schema"},o={key:e+"/"+t,signature:n};return s.save(r,[o])},updateLocalCache:function(e){var t=this;return p.try(function(){var n=t.props.cache,s=e.getLocation();return e instanceof y?n.save(s,e.results).then(function(){return n.remove(s,e.missingResults)}):e instanceof w?n.remove(s,e.results):e instanceof x?n.save(s,e.results):void 0}).then(function(){return!0}).catch(function(e){return console.error(e),!1})},clearCachedObjects:function(e,t){var n=this;return p.try(function(){var s=n.props.cache,r=u.get(n.cacheClearing,[e,"*"]);if(r)return r;var o=[e,t],i=u.get(n.cacheClearing,o);return i||(i=s.clean({address:e,schema:t}).then(function(e){return u.unset(n.cacheClearing,o),console.log("Cache entries removed: "+e),e}),u.set(n.cacheClearing,o,i)),i})},waitForCacheClearing:function(e,t){var n=u.get(this.cacheClearing,[e,"*"]);if(n)return n;var s=u.get(this.cacheClearing,[e,t]);return s||p.resolve(0)},updateRecentSearchResults:function(e){var t=this.getRelevantRecentSearches(e.getLocation());u.each(t,function(t){var n=t.results,s=n;u.each(e.results,function(r){var o=u.sortedIndexBy(s,r,"id"),i=s[o],a=i&&i.id===r.id;if(e instanceof w)a&&(s===n&&(s=u.slice(s)),s.splice(o,1));else if(e instanceof x){var l=b.match(t.table,r,t.criteria);(l||a)&&(s===n&&(s=u.slice(s)),l&&a?s[o]=r:l&&!a?(s.splice(o,0,r),b.limit(t.table,s,t.criteria)):!l&&a&&s.splice(o,1))}}),s!==n&&(t.results=s,t.promise=p.resolve(s))})},getRelevantRecentSearches:function(e){return u.filter(this.recentSearchResults,function(t){if(t.matchLocation(e))return!0})},clearRecentOperations:function(e){var t=this,n=["recentSearchResults","recentStorageResults","recentRemovalResults"];u.each(n,function(n){t.updateList(n,function(t){return u.filter(t,function(t){return t.address!==e})})})},componentWillMount:function(){var e=this;this.sessionCheckTimeout=setInterval(function(){var t=f().add(5,"minute").toISOString(),n=c(function(e){if(e.etime<t)return!0});u.isEmpty(n)||(u.each(n,function(e){e.token||d(e)}),e.triggerChangeEvent())},6e4)},componentDidMount:function(){this.triggerChangeEvent()},componentWillReceiveProps:function(e){var t=this,n=!this.props.online&&e.online,s=!this.props.connected&&e.connected;if(n||s)this.disconnected&&(this.invalidate().then(function(){u.each(t.changeQueue,function(e){e.dispatch()})}),this.disconnected=!1);else{var r=this.props.online&&!e.online,o=this.props.connected&&!e.connected;(r||o)&&(this.disconnected=!0)}},componentWillUnmount:function(){clearInterval(this.sessionExpirationCheckInterval)},schedulePrefetch:function(e){var t=this,n=[];u.each(e,function(e){if(!e.prefetching){var t=e.getCriteriaShape();return!(!u.some(n,function(n){if(u.includes(e.by,n.component)&&u.isEqual(t,n.shape))return!0})&&(n.push(e),e.updating||(e.scheduled=!0),n.length>16))&&void 0}}),setTimeout(function(){if(!t.searching){var e=u.find(t.recentSearchResults,{scheduled:!0,updating:!1});e&&t.searchRemoteDatabase(e)}},50)},render:function(){var e=this.state.recentSearchResults,t=this.state.recentStorageResults,n=this.state.recentRemovalResults;return m.createElement(E,{type:"remote-data-source"},m.createElement(k,{label:"Recent searches"},m.createElement(C,{searches:e})),m.createElement(k,{label:"Recent storage",hidden:u.isEmpty(t)},m.createElement(S,{stores:t})),m.createElement(k,{label:"Recent removal",hidden:u.isEmpty(n)},m.createElement(S,{stores:n})))}});var R=[]},"../../common/src/data/remote-data-source/operation.js":function(e,t,n){"use strict";function s(e){var t=r.get(e,"by.constructor.displayName");"local"!==e.schema&&(this.address=e.address),this.schema=e.schema,this.table=e.table,this.startTime=null,this.finishTime=null,this.results=[],this.promise=null,this.by=t?[t]:[]}var r=n("../node_modules/lodash/lodash.js");e.exports=s,s.prototype.getLocation=function(){return this.isLocal()?r.pick(this,"schema","table"):r.pick(this,"address","schema","table")},s.prototype.matchLocation=function(e){return this.address===e.address&&(this.schema===e.schema&&this.table===e.table)},s.prototype.isLocal=function(){return"local"===this.schema},s.prototype.start=function(){var e=new Date;this.startTime=e.toISOString()},s.prototype.finish=function(e){var t=new Date(this.startTime),n=new Date;e&&(this.results=e),this.finishTime=n.toISOString(),this.duration=n-t},s.prototype.cancel=function(){this.canceled=!0},s.prototype.getTimeElapsed=function(){var e=new Date(this.finishTime);return.001*(new Date-e)}},"../../common/src/data/remote-data-source/recent-search-table.jsx":function(e,t,n){"use strict";function s(e){var t=o.filter(e.searches,function(e){return"local"!==e.schema}),n=function(e,t){var n;e.updating?n="updating":e.dirty&&(n="dirty");var s=e.duration?e.duration+"ms":"",a=JSON.stringify(e.criteria,void 0,4),l=JSON.stringify(e.criteria);return i.createElement("tr",{key:t,className:n},i.createElement("td",{className:"time"},s),i.createElement("td",{className:"schema"},e.schema),i.createElement("td",{className:"table"},e.table),i.createElement("td",{className:"criteria",title:r(a)},l),i.createElement("td",{className:"objects"},o.size(e.results)," (",e.lastRetrieved,")"),i.createElement("td",{className:"by"},o.join(e.by,", ")))};return i.createElement("table",{className:"recent-search-table"},i.createElement("thead",null,i.createElement("tr",null,i.createElement("th",{className:"time"},"Time"),i.createElement("th",{className:"schema"},"Schema"),i.createElement("th",{className:"table"},"Table"),i.createElement("th",{className:"criteria"},"Criteria"),i.createElement("th",{className:"objects"},"Objects (fresh)"),i.createElement("th",{className:"by"},"By"))),i.createElement("tbody",null,o.map(t,n)))}function r(e){return e.replace(/\[([^\]]{1,50},\s*)[^\]]{50,}?(\s*)\]/g,"[$1...$2]")}var o=n("../node_modules/lodash/lodash.js"),i=n("../node_modules/react/react.js");i.PropTypes;e.exports=s},"../../common/src/data/remote-data-source/recent-storage-table.jsx":function(e,t,n){"use strict";function s(e){var t=r.filter(e.stores,function(e){return"local"!==e.schema}),n=function(e,t){var n=e.duration?e.duration+"ms":"",s=JSON.stringify(e.results,void 0,4),r=JSON.stringify(e.results);return o.createElement("tr",{key:t},o.createElement("td",{className:"time"},n),o.createElement("td",{className:"schema"},e.schema),o.createElement("td",{className:"table"},e.table),o.createElement("td",{className:"objects",title:s},r),o.createElement("td",{className:"by"},e.by))};return o.createElement("table",{className:"recent-storage-table"},o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",{className:"time"},"Time"),o.createElement("th",{className:"schema"},"Schema"),o.createElement("th",{className:"table"},"Table"),o.createElement("th",{className:"objects"},"Objects"),o.createElement("th",{className:"by"},"By"))),o.createElement("tbody",null,r.map(t,n)))}var r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/react/react.js");o.PropTypes;e.exports=s},"../../common/src/data/remote-data-source/removal.js":function(e,t,n){"use strict";function s(e,t){r.call(this,e,t,{onConflict:!1}),this.isLocal()||(this.objects=_.map(t,function(e){return{id:e.id,deleted:!0}}))}var r=n("../../common/src/data/remote-data-source/storage.js");e.exports=s,s.prototype=Object.create(r.prototype)},"../../common/src/data/remote-data-source/search.js":function(e,t,n){"use strict";function s(e){c.call(this,e),this.criteria=e.criteria||{},this.remote=e.remote||!1,this.dirty=!1,this.updating=!1,this.scheduled=!1,this.lastRetrieved=0,this.missingResults=[],this.minimum=e.minimum,this.expected=e.expected,this.prefetch=e.prefetch,"number"!=typeof this.expected&&(this.expected=r(this.criteria,"id")||r(this.criteria,"name")||r(this.criteria,"filters")||void 0),this.criteria=o(this.criteria),this.criteria=i(this.criteria)}function r(e,t){if(e){var n=e[t];if(void 0!=n)return n instanceof Array?n.length:n?1:0}}function o(e){if(e instanceof Array){for(var t=[],n=0;n<e.length;n++){var s=e[n];void 0!==s&&(s instanceof Object&&(s=o(s)),t.push(s))}return t}if(e instanceof Object){var t={};for(var r in e){var s=e[r];void 0!==s&&(s instanceof Object&&(s=o(s)),t[r]=s)}return t}return e}function i(e){return a.mapValues(e,function(e,t){return e instanceof Array&&/(^|_)ids?$/.test(t)&&(e=a.filter(e,function(e){return!("number"==typeof e&&e<1)})),e})}var a=n("../node_modules/lodash/lodash.js"),l=n("../node_modules/bluebird/js/browser/bluebird.js"),c=n("../../common/src/data/remote-data-source/operation.js"),d=n("../../common/src/data/session-start-time.js");e.exports=s,s.prototype=Object.create(c.prototype),s.prototype.getQuery=function(){return a.pick(this,"address","schema","table","criteria")},s.prototype.getCriteriaShape=function(){return a.mapValues(this.criteria,function(e){return null!=e?e.constructor:null})},s.prototype.match=function(e){return!!this.matchLocation(e)&&(!!this.matchCriteria(e)&&!!this.matchOptions(e))},s.prototype.matchCriteria=function(e){return a.isEqual(this.criteria,e.criteria)},s.prototype.matchOptions=function(e){return this.remote===e.remote},s.prototype.isSufficientlyRecent=function(e){if(this.isLocal())return!0;var t=a.map(this.results,"rtime"),n=a.min(t);if(n<d)return!1;var s=new Date(n);return!(.001*(new Date-s)>e)&&(this.finishTime=n,!0)},s.prototype.isFresh=function(e){return"local"===this.schema||!this.dirty&&!(this.getTimeElapsed()>e)},s.prototype.isSufficientlyCached=function(){var e=this.results.length;return void 0!=this.minimum&&!(e<this.minimum)},s.prototype.isMeetingExpectation=function(){return this.results.length===this.expected},s.prototype.finish=function(e){var t=this,n=this.results,s=[],r=0;c.prototype.finish.call(this,e),this.dirty=!1,e&&(this.promise=l.resolve(this.results),a.each(this.results,function(e){e.rtime||r++,e.rtime=t.finishTime}),a.each(n,function(t){var n=a.sortedIndexBy(e,t,"id"),r=e[n];r&&r.id===t.id||s.push(t)})),this.missingResults=s,this.lastRetrieved=r}},"../../common/src/data/remote-data-source/storage.js":function(e,t,n){"use strict";function s(e,t,n){o.call(this,e),this.objects=t,this.options=n||{},this.canceled=!1}var r=n("../node_modules/lodash/lodash.js"),o=n("../../common/src/data/remote-data-source/operation.js");e.exports=s,s.prototype=Object.create(o.prototype),s.prototype.finish=function(e){var t=this;o.prototype.finish.call(this,e),this.isLocal()||r.each(this.results,function(e){e.rtime=t.finishTime})}},"../../common/src/data/remote-data-source/temporary-id.js":function(e,t,n){"use strict";function s(){var e=r+1e-9;return r=e,e}t.allocate=s;var r=0},"../../common/src/data/session-manager.jsx":function(e,t,n){"use strict";var s=n("../node_modules/lodash/lodash.js"),r=n("../node_modules/bluebird/js/browser/bluebird.js"),o=n("../node_modules/react/react.js"),i=o.PropTypes,a=n("../../common/src/data/database.js"),l=n("../../common/src/mixins/update-check.js"),c=n("../../common/src/widgets/diagnostics.jsx"),d=n("../../common/src/widgets/diagnostics-section.jsx");e.exports=o.createClass({displayName:"SessionManager",mixins:[l],propTypes:{database:i.instanceOf(a)},getInitialState:function(){return this.removalQueue=[],{loaded:[],removed:[],saved:[]}},loadFromCache:function(e){var t=this;if(s.some(this.removalQueue,{address:e}))return r.resolve(null);var n=this.props.database.use({schema:"local",by:this}),o={key:e};return n.findOne({table:"session",criteria:o}).then(function(n){return n?(t.setState({loaded:s.union(t.state.loaded,[e])}),{address:n.key,handle:n.handle,token:n.token,user_id:n.user_id,etime:n.etime}):null})},saveToCache:function(e){var t=this,n=this.props.database.use({schema:"local",by:this}),r={key:e.address,handle:e.handle,token:e.token,user_id:e.user_id,etime:e.etime};return n.saveOne({table:"session"},r).then(function(n){return t.setState({saved:s.union(t.state.loaded,[e.address])}),n})},removeFromCache:function(e){var t=this;this.removalQueue.push(e);var n=this.props.database.use({schema:"local",by:this}),r={key:e.address};return n.removeOne({table:"session"},r).then(function(n){s.pull(t.removalQueue,e),t.setState({removed:s.union(t.state.loaded,[e.address])})})},render:function(){return o.createElement(c,{type:"session-manager"},o.createElement(d,{label:"Session Handling"},o.createElement("div",null,"Loaded from cache: ",s.join(this.state.loaded," ")),o.createElement("div",null,"Saved to cache: ",s.join(this.state.saved," ")),o.createElement("div",null,"Removed from cache: ",s.join(this.state.removed," "))))}})},"../../common/src/data/session-start-time.js":function(e,t,n){"use strict";e.exports=(new Date).toISOString()},"../../common/src/data/subscription-manager.jsx":function(e,t,n){"use strict";var s=n("../node_modules/lodash/lodash.js"),r=(n("../node_modules/bluebird/js/browser/bluebird.js"),n("../node_modules/react/react.js")),o=r.PropTypes,i=n("../../common/src/data/database.js"),a=n("../../common/src/locale/locale.js"),l=n("../../common/src/mixins/update-check.js"),c=n("../../common/src/widgets/diagnostics.jsx"),d=n("../../common/src/widgets/diagnostics-section.jsx");e.exports=r.createClass({displayName:"SubscriptionManager",mixins:[l],propTypes:{area:o.oneOf(["client","admin"]).isRequired,connection:o.object,schema:o.string,database:o.instanceOf(i),locale:o.instanceOf(a)},getInitialState:function(){return{subscription:null,serverAddress:null}},componentWillReceiveProps:function(e){this.props.connection&&e.connection&&this.props.connection.address!==e.connection.address&&this.setState({subscription:null})},componentDidUpdate:function(e,t){var n=this;if(this.props.connection&&this.props.database&&this.props.locale){var r=this.props.database.use({schema:"global",by:this});r.start().then(function(e){var t=n.state.subscription,o=r.context.address,i={user_id:e,schema:n.props.schema,area:n.props.area,locale:n.props.locale.localeCode,method:n.props.connection.method,token:n.props.connection.token,relay:n.props.connection.relay,details:n.props.connection.details};if(t&&n.state.serverAddress===o){if(s.isMatch(t,i))return;s.assign(t,i),i=t}else n.setState({subscription:i,serverAddress:o});return r.saveOne({table:"subscription"},i).then(function(e){return n.setState({subscription:e}),null}).catch(function(e){if(404===e.statusCode&&i.id)return i.id=void 0,r.saveOne({table:"subscription"},i).then(function(e){return n.setState({subscription:e}),null})})}).catch(function(e){if(401!==e.statusCode)throw e})}},render:function(){var e=this.state.subscription||{};return r.createElement(c,{type:"subscription-manager"},r.createElement(d,{label:"Current subscription"},r.createElement("div",null,"ID: ",e.id),r.createElement("div",null,"Token: ",e.token),r.createElement("div",null,"Method: ",e.method),r.createElement("div",null,"Schema: ",e.schema),r.createElement("div",null,"Locale: ",e.locale),r.createElement("div",null,"Relay: ",e.relay)))}})},"../../common/src/errors/file-error.js":function(e,t,n){"use strict";function s(e){e instanceof Object&&(e=e.code),this.code=e,this.message=r[e]}e.exports=s;var r={1:"A required file or directory could not be found at the time an operation was processed",2:"Access to the file was denied",3:"Operation was aborted",4:"The file or directory cannot be read",5:"The URL is malformed",6:"The state of the underlying file system prevents any writing to a file or a directory",7:"The operation cannot be performed on the current state of the interface object",8:"Synax error",9:"The modification requested is not allowed",10:"Not enough remaining storage space or the storage quota was reached",11:"The app looked up an entry, but the entry found is of the wrong type",12:"The file or directory with the same path already exists"};s.prototype=Object.create(Error.prototype)},"../../common/src/errors/http-error.js":function(e,t,n){"use strict";function s(){for(var e=0;e<arguments.length;e++){var t=arguments[e];if("number"==typeof t)this.statusCode=t;else if("string"==typeof t)this.message=t;else if("object"===(void 0===t?"undefined":r(t)))for(var n in t)this[n]=t[n]}this.statusCode||(this.statusCode=500),this.hasOwnProperty("name")||(this.name=o[this.statusCode]),this.hasOwnProperty("message")||(this.message=this.name)}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=s;var o={400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout"};s.prototype=Object.create(Error.prototype)},"../../common/src/languages.js":function(e,t,n){"use strict";e.exports=[{name:"etina",code:"cz",script:"latin",countries:{cz:"esko",pl:"Polsko",sk:"Slovensko"},defaultCountry:"cz"},{name:"Dansk",code:"da",script:"latin",countries:{dk:"Danmark",fo:"Frerne",gl:"Grnland",de:"Tyskland"},defaultCountry:"dk"},{name:"Deutsch",code:"de",script:"latin",countries:{at:"sterreich",be:"Belgien",de:"Deutschland",lu:"Luxemburg",ch:"Schweiz"},defaultCountry:"de"},{name:"",code:"el",script:"greek",countries:{gr:"",cy:""},defaultCountry:"gr"},{name:"English",code:"en",script:"latin",countries:{au:"Australia",ca:"Canada",hk:"Hong Kong",ie:"Ireland",sg:"Singapore",gb:"United Kingdom",us:"United States"},defaultCountry:"us",module:function(){return n.e("locale-en").then(n.bind(null,"./locales/en.js"))}},{name:"Espaol",code:"es",script:"latin",countries:{ar:"Argentina",bo:"Bolivia",cl:"Chile",co:"Colombia",cr:"Costa Rica",cu:"Cuba",es:"Espaa",ec:"Ecuador",sv:"El Salvador",gq:"Guinea Ecuatorial",gt:"Guatemala",hn:"Honduras",mx:"Mxico",ni:"Nicaragua",pa:"Panam",py:"Paraguay",pe:"Per",pr:"Puerto Rico",do:"Repblica Dominicana",uy:"Uruguay",ve:"Venezuela"},defaultCountry:"es"},{name:"Franais",code:"fr",script:"latin",countries:{be:"Belgique",bj:"Bnin",bf:"Burkina Faso",bi:"Burundi",cm:"Cameroun",ca:"Canada",cg:"Congo",ci:"Cte d'Ivoire",dj:"Djibouti",gq:"Guine quatoriale",fr:"France",ga:"Gabon",gn:"Guine",ht:"Hati",lu:"Luxembourg",mg:"Madagascar",ml:"Mali",ne:"Niger",rw:"Rwanda",cf:"Rpublique centrafricaine",cd:"Rpublique dmocratique du Congo",sn:"Sngal",sc:"Seychelles",ch:"Suisse",td:"Tchad",tg:"Togo"},defaultCountry:"fr"},{name:"",code:"ko",script:"hangul",countries:{kr:"",cn:""},defaultCountry:"kr"},{name:"Hrvatski",code:"hr",script:"latin",countries:{ba:"Bosna i Hercegovina",hr:"Hrvatska",rs:"Srbija"},defaultCountry:"hr"},{name:"Italiano",code:"it",script:"latin",countries:{it:"Italia",ch:"Svizzera",hr:"Croazia",si:"Slovenia"},defaultCountry:"it",module:function(){return n.e("locale-it").then(n.bind(null,"./locales/it.js"))}},{name:"Magyar",code:"hu",script:"latin",countries:{hr:"Magyarorszg",ro:"Romnia"},defaultCountry:"hu"},{name:"Nederlands",code:"nl",script:"latin",countries:{be:"Belgi",nl:"Nederland",sr:"Suriname"},defaultCountry:"nl"},{name:"",code:"jp",script:"hiragana",countries:{jp:""},defaultCountry:"jp"},{name:"Norsk",code:"nb",script:"latin",countries:{no:"Norge"},defaultCountry:"no",module:function(){return n.e("locale-nb").then(n.bind(null,"./locales/nb.js"))}},{name:"Polski",code:"pl",script:"latin",countries:{by:"Biaoru",lt:"Litwa",pl:"Polska",ua:"Ukraina"},defaultCountry:"pl",module:function(){return n.e("locale-pl").then(n.bind(null,"./locales/pl.js"))}},{name:"Portugus",code:"pt",script:"latin",countries:{ao:"Angola",br:"Brasil",tl:"Timor Leste",gq:"Guin Equatorial",gw:"Guin-Bissau",mz:"Moambique",mo:"Macao",pt:"Portugal"},defaultCountry:"pt"},{name:"",code:"ru",script:"cyrillic",countries:{am:"",by:"",ge:"",lv:"",kz:"",kg:"",lt:"",ru:"",tj:"",ua:"",uz:"",es:""},defaultCountry:"ru",module:function(){return n.e("locale-ru").then(n.bind(null,"./locales/ru.js"))}},{name:"Srpski",code:"sr",script:"latin",countries:{rs:"Srbija",hr:"Hrvatska",ba:"Bosna i Hercegovina"},defaultCountry:"sr"},{name:"Suomi",code:"fi",script:"latin",countries:{fi:"Suomi",se:"Ruotsi"},defaultCountry:"fi",module:function(){return n.e("locale-fi").then(n.bind(null,"./locales/fi.js"))}},{name:"Slovenina",code:"sk",script:"latin",countries:{cz:"esko",sk:"Slovensko"},defaultCountry:"sk"},{name:"Svenska",code:"sv",script:"latin",countries:{fi:"Finland",se:"Sverige"},defaultCountry:"se"},{name:"Ting Vit",code:"vi",script:"latin",countries:{vn:"Vit Nam"},defaultCountry:"vn"},{name:"Trke",code:"tr",script:"latin",countries:{cy:"Kbrs",tr:"Trkiye"},defaultCountry:"tr"},{name:"",code:"zh",script:"hanzi",countries:{cn:"",hk:"",mo:"",sg:"",tw:""},defaultCountry:"cn",module:function(){return n.e("locale-zh").then(n.bind(null,"./locales/zh.js"))}}]},"../../common/src/locale/locale-manager.jsx":function(e,t,n){"use strict";function s(){function e(e){void 0===n&&e&&e.length>=2&&(n=r.toLower(e))}r.each(navigator.languages,e);var t=["language","browserLanguage","systemLanguage","userLanguage"];r.each(t,function(t){e(navigator[t])});var n;return n}var r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/react/react.js"),i=o.PropTypes,a=n("../../common/src/data/database.js"),l=n("../../common/src/widgets/diagnostics.jsx"),c=n("../../common/src/widgets/diagnostics-section.jsx");e.exports=o.createClass({displayName:"LocaleManager",propTypes:{defaultLanguageCode:i.string,database:i.instanceOf(a),directory:i.arrayOf(i.object).isRequired,onChange:i.func},getDefaultProps:function(){return{defaultLanguageCode:"en"}},getInitialState:function(){return{localeCode:"",localeCodeSaved:"",phraseTable:{},missingPhrases:[]}},getLocaleCode:function(){return this.state.localeCode},getDirectory:function(){return this.props.directory},translate:function(e){var t=this,n=this.state.phraseTable[e];if(null==n)return setTimeout(function(){var n=r.union(t.state.missingPhrases,[e]);t.setState({missingPhrases:n})},10),e;if("function"!=typeof n)return n;try{for(var s=arguments.length,o=Array(s>1?s-1:0),i=1;i<s;i++)o[i-1]=arguments[i];return n.apply(this,o)}catch(t){return console.error(t),"["+e+": "+t.message+"]"}},pick:function(e,t){if("string"==typeof e)return e;var n=this.state.localeCode.substr(0,2);t&&(n=t.substr(0,2));var s="",o="",i=this.props.defaultLanguageCode.substr(0,2),a="";for(var l in e){var c=e[l],d=r.toLower(l);d===n&&(s=c),o||(o=c),d===i&&(a=c)}return s||(a||o)},change:function(e){var t=this;return e=r.toLower(e),e===this.state.localeCode?Promise.resolve(!0):this.load(e).then(function(n){var s;s="function"==typeof n?n(e):n;var r={localeCode:e,phraseTable:s};return t.setState(r,function(){t.triggerChangeEvent()}),!0})},load:function(e){var t=e.substr(0,2),n=r.find(this.props.directory,{code:t});return n&&n.module?Promise.resolve(n.module()):Promise.reject(new Error("No module for language: "+t))},triggerChangeEvent:function(){this.props.onChange&&this.props.onChange({type:"change",target:this})},componentDidMount:function(){var e=this,t=s()||this.props.defaultLanguageCode;this.change(t).catch(function(t){e.change(e.props.defaultLanguageCode)})},componentDidUpdate:function(e,t){var n=this;if(!e.database&&this.props.database){var o=this.props.database.use({by:this,schema:"local"});o.start().then(function(){var e={key:"language"};return o.findOne({table:"settings",criteria:e})}).then(function(e){var t=r.get(e,"selectedLanguageCode");t&&(n.change(t),n.setState({localeCodeSaved:t}))})}if(t.localeCode!==this.state.localeCode&&this.props.database){var o=this.props.database.use({by:this,schema:"local"});o.start().then(function(){var e={key:"language",selectedLanguageCode:n.state.localeCode};return e.selectedLanguageCode!==s()?o.saveOne({table:"settings"},e):t.localeCode?o.removeOne({table:"settings"},e):void 0})}},render:function(){var e=s(),t=this.state.missingPhrases;return o.createElement(l,{type:"locale-manager"},o.createElement(c,{label:"Locale code"},o.createElement("div",null,"Current: ",this.state.localeCode),o.createElement("div",null,"Browser: ",e),o.createElement("div",null,"Previously saved: ",this.state.localeCodeSaved)),o.createElement(c,{label:"Missing phrases",hidden:r.isEmpty(t)},r.map(t,function(e,t){return o.createElement("div",{key:t},e)})))}})},"../../common/src/locale/locale.js":function(e,t,n){"use strict";function s(e){this.localeManager=e,this.directory=this.localeManager.getDirectory(),this.localeCode=this.localeManager.getLocaleCode();var t=_.split(this.localeCode,"-");this.languageCode=t[0],this.countryCode=t[1],this.translate=this.translate.bind(this),this.pick=this.pick.bind(this),this.name=this.name.bind(this),this.change=this.change.bind(this)}e.exports=s,s.prototype.translate=function(e){return e instanceof Object?this.localeManager.pick(e):this.localeManager.translate.apply(this.localeManager,arguments)},s.prototype.pick=function(e,t){return this.localeManager.pick(e,t)},s.prototype.name=function(e,t,n){var s=this.localeManager.pick(e,n),r=new String(s||"");return r.gender=t,r},s.prototype.change=function(e){return this.localeManager.change(e)}},"../../common/src/media/bitmap-view.jsx":function(e,t,n){"use strict";function s(e){var t=i(e,6),n=t[0],s=t[1],r=t[2],o=t[3],a=t[4],l=t[5],c=n*o-s*r;return[o/c,-s/c,-r/c,n/c,(r*l-o*a)/c,-(n*l-s*a)/c]}function r(e,t){var n=i(e,6),s=n[0],r=n[1],o=n[2],a=n[3],l=n[4],c=n[5],d=i(t,2),u=d[0],p=d[1];return[s*u+o*p+l,r*u+a*p+c]}function o(e,t){var n=[t.left,t.top],s=[t.left+t.width,t.top+t.height];return n=r(e,n),s=r(e,s),{width:Math.abs(s[0]-n[0]),height:Math.abs(s[1]-n[1]),left:Math.min(s[0],n[0]),top:Math.min(s[1],n[1])}}var i=function(){function e(e,t){var n=[],s=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(s=(i=a.next()).done)&&(n.push(i.value),!t||n.length!==t);s=!0);}catch(e){r=!0,o=e}finally{try{!s&&a.return&&a.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},l=n("../node_modules/lodash/lodash.js"),c=n("../node_modules/bluebird/js/browser/bluebird.js"),d=n("../node_modules/react/react.js"),u=d.PropTypes,p=n("../../common/src/transport/blob-manager.js"),m=n("../../common/src/transport/blob-reader.js"),h=n("../../common/src/media/media-loader.js"),f=n("../../common/src/media/jpeg-analyser.js"),g=n("../../common/src/utils/component-refs.js");e.exports=d.createClass({displayName:"BitmapView",propTypes:{url:u.string,clippingRect:u.object,onLoad:u.func,onError:u.func},getInitialState:function(){return this.components=g({canvas:HTMLCanvasElement}),{}},componentWillMount:function(){this.load(this.props.url)},componentWillReceiveProps:function(e){this.props.url!==e.url&&this.load(e.url),this.clippingRect!==e.clippingRect&&this.image&&this.drawImage(e.clippingRect)},render:function(){var e=this.components.setters,t=l.omit(this.props,"onLoad","url","clippingRect");return t.width=4,t.height=4,d.createElement("canvas",a({ref:e.canvas},t))},componentDidMount:function(){this.image&&this.redrawNeeded&&this.drawImage(this.props.clippingRect)},triggerLoadEvent:function(){this.props.onLoad&&this.props.onLoad({type:"load",target:this})},triggerErrorEvent:function(e){this.props.onError&&this.props.onError({type:"error",target:this,error:e})},load:function(e){var t=this;return e?p.fetch(e).then(function(e){var n=h.loadImage(e),s=m.loadUint8Array(e);return c.join(n,s,function(e,n){var s=f.getOrientation(n)||1;t.image=e,t.orientation=s,s<5?(t.naturalWidth=e.naturalWidth,t.naturalHeight=e.naturalHeight):(t.naturalWidth=e.naturalHeight,t.naturalHeight=e.naturalWidth),t.drawImage(t.props.clippingRect),t.triggerLoadEvent()})}).catch(function(e){console.error(e),t.triggerErrorEvent(e)}):(this.clearCanvas(),c.resolve())},drawImage:function(e){var t=this.image;if(t){var n=this.components.canvas;if(!n)return void(this.redrawNeeded=!0);var r,i=this.orientation,a=t.naturalWidth,l=t.naturalHeight;switch(i){case 1:r=[1,0,0,1,0,0];break;case 2:r=[-1,0,0,1,a,0];break;case 3:r=[-1,0,0,-1,a,l];break;case 4:r=[1,0,0,-1,0,l];break;case 5:r=[0,1,1,0,0,0];break;case 6:r=[0,1,-1,0,l,0];break;case 7:r=[0,-1,-1,0,l,a];break;case 8:r=[0,-1,1,0,0,a]}e||(e={left:0,top:0,width:this.naturalWidth,height:this.naturalHeight}),this.width=e.width,this.height=e.height;var c=s(r),d=o(c,e),u=o(c,{left:0,top:0,width:e.width,height:e.height});n.width=u.width,n.height=u.height;var p=n.getContext("2d");p.transform.apply(p,r),p.drawImage(t,d.left,d.top,d.width,d.height,u.left,u.top,u.width,u.height)}},clearCanvas:function(){var e=this.components.canvas;e&&(e.width=0,e.height=0),this.width=0,this.height=0,this.orientation=void 0}})},"../../common/src/media/frame-grabber.js":function(e,t,n){"use strict";function s(e,t){return new i(function(n,s){function i(t){if(g)l(t);else if(t){var n=u*p*3,s=t.size,r=s/n;r>.02?l(t):((!f||f.size<t.size)&&(f=t),h>10?l(f):(e.currentTime+=1e3,h++))}else c(new Error("Unable to obtain a frame"))}function a(t){try{m.getContext("2d").drawImage(e,0,0,u,p),r(m,"image/jpeg",.75,i)}catch(e){c(e)}}function l(e){d(),n(e)}function c(e){d(),f?n(f):s(e)}function d(){g&&(e.removeEventListener("seeked",a),clearTimeout(y))}var u=e.videoWidth,p=e.videoHeight,m=document.createElement("CANVAS");m.width=u,m.height=p;var h=1,f=null,g=e.duration===1/0,v=o.get(t,"start",0),b=o.get(t,"timeout",1e3);if(g)a();else{e.addEventListener("seeked",a),e.addEventListener("ended",function(){c(new Error("Unable to obtain an image before video ended"))}),e.currentTime=v;var y=setTimeout(function(){c(new Error("Unable to obtain an image within time limit"))},b)}})}function r(e,t,s,r){if("function"==typeof e.toBlob)e.toBlob(r,t,90);else{r(n("../node_modules/b64-to-blob/b64toBlob.js")(e.toDataURL(t,s).replace("data:image/jpeg;base64,",""),"image/jpeg"))}}var o=n("../node_modules/lodash/lodash.js"),i=n("../node_modules/bluebird/js/browser/bluebird.js");e.exports={capture:s}},"../../common/src/media/image-cropping.js":function(e,t,n){"use strict";function s(e,t){var n=0,s=0,r=Math.min(e,t);return e>r?n=Math.floor((e-r)/2):t>r&&(s=Math.floor((t-r)/2)),{left:n,top:s,width:r,height:r}}e.exports={centerSquare:s,default:s}},"../../common/src/media/jpeg-analyser.js":function(e,t,n){"use strict";function s(e){var t=d(e,function(e,t,n){if(65472===e||65474===e)return t});if(t>0){var n=(e[t++],o(e[t++],e[t++]));return{width:o(e[t++],e[t++]),height:n}}}function r(e){var t=o,n=a,s=d(e,function(s,r,o){if(65505===s){var a=r,c=r+o;if(69==e[a++]&&120==e[a++]&&105==e[a++]&&102==e[a++]&&0==e[a++]&&0==e[a++]){var d=a;"II"===String.fromCharCode(e[a++])+String.fromCharCode(e[a++])&&(t=i,n=l);if(42!==t(e[a++],e[a++]))return;do{var u=n(e[a++],e[a++],e[a++],e[a++]);if(0===u)break;a=d+u;for(var p=t(e[a++],e[a++]),m=0;m<p;m++){var h=t(e[a++],e[a++]),f=t(e[a++],e[a++]),g=n(e[a++],e[a++],e[a++],e[a++]);if(274===h&&3===f&&1===g)return a;a+=4}}while(a<c)}}});if(s>0){return t(e[s++],e[s++])}}function o(e,t){return e<<8|t}function i(e,t){return t<<8|e}function a(e,t,n,s){return e<<24|t<<16|n<<8|s}function l(e,t,n,s){return s<<24|n<<16|t<<8|e}function c(e){var t=u(e);return-1!==t?p(e,t):null}function d(e,t){var n=e.length,s=0;if(65496==o(e[s++],e[s++]))for(;s<n;){var r=o(e[s++],e[s++]),i=o(e[s++],e[s++]);if(65498==r)break;var a=t(r,s,i);if(void 0!==a&&!1!==a)return a;s+=i-2}return-1}function u(e){return d(e,function(t,n){if(65517==t&&80==e[n++]&&104==e[n++]&&111==e[n++]&&116==e[n++]&&111==e[n++]&&115==e[n++]&&104==e[n++]&&111==e[n++]&&112==e[n++]&&32==e[n++]&&51==e[n++]&&46==e[n++]&&48==e[n++])return n})}function p(e,t){for(var n=e.length,s=null,r=t;r+4<n;)if(56==e[r+0]&&66==e[r+1]&&73==e[r+2]&&77==e[r+3]){r+=4;for(var i=o(e[r++],e[r++]),a=e[r++],l="",c=0;c<a;c++)l+=String.fromCharCode(e[r++]);r++;var d=(o(e[r++],e[r++]),o(e[r++],e[r++]));i>=1999&&i<=2998&&(s||(s={}),s[l]=m(e,r,d)),r+=d}else r++;return s}function m(e,t,n){for(var s=n/26,r=0,i=[],l=[],c=t,d=0;d<s;d++){switch(o(e[c++],e[c++])){case 0:case 3:r=o(e[c++],e[c++]),c+=22;break;case 1:case 2:case 4:case 5:for(var u=0;u<3;u++){var p=a(e[c++],e[c++],e[c++],e[c++]),m=a(e[c++],e[c++],e[c++],e[c++]);p>=2147483648?p=(2147483647-p)/16777216:p/=16777216,m>=2147483648?m=(2147483647-m)/16777216:m/=16777216,l.push({x:m,y:p})}r--,0==r&&(l.push(l.shift()),l.push(l[0]),i.push(l),l=[]);break;default:c+=24}}return i}e.exports={getDimensions:s,getOrientation:r,extractPaths:c}},"../../common/src/media/media-loader.js":function(e,t,n){"use strict";function s(e){var t;return t="string"==typeof e?e:h.manage(e),new m(function(e,n){var s=document.createElement("IMG");s.src=t,s.onload=function(t){e(s)},s.onerror=function(e){console.log("load image error",e.message),n(new Error("Unable to load "+t))}})}function r(e){if(/iPhone/i.test(navigator.userAgent))return m.reject("Cannot load video on iPhone");var t;return t="string"==typeof e?e:h.manage(e),new m(function(e,n){var s=document.createElement("VIDEO");s.src=t,s.preload=!0,s.onloadeddata=function(t){e(s)},s.onerror=function(e){n(new Error("Unable to load "+t))}})}function o(e){var t;return t="string"==typeof e?e:h.manage(e),new m(function(e,n){var s=document.createElement("AUDIO");s.src=t,s.preload=!0,s.onloadeddata=function(t){e(s)},s.onerror=function(e){n(new Error("Unable to load "+t))}})}function i(e){return f.loadText(e).then(function(e){var t=new DOMParser,n=t.parseFromString(e,"text/xml"),s=n.getElementsByTagName("svg")[0];if(!s)throw new Error("Invalid SVG document");return s})}function a(e){if("string"==typeof e){var t=e;return h.fetch(t).then(function(e){return a(e)}).catch(function(e){return s(t).then(function(e){return{width:e.naturalWidth,height:e.naturalHeight,format:d(t,"image")}})})}var n=p(e.type);return"svg"===n?i(e).then(function(e){var t=e.width.baseVal.value,s=e.height.baseVal.value,r=e.viewBox.baseVal;return t||(t=r.width),s||(s=r.height),t||(t=1e3),s||(s=1e3),{width:t,height:s,format:n}}):"jpeg"===n?f.loadUint8Array(e).then(function(e){var t=g.getDimensions(e),s=g.getOrientation(e);if(!t)throw new Error("Invalid JPEG file");var r,o;return s>=5?(r=t.height,o=t.width):(r=t.width,o=t.height),{width:r,height:o,format:n}}):s(e).then(function(e){return{width:e.naturalWidth,height:e.naturalHeight,format:n}})}function l(e){if("string"==typeof e){var t=e;return h.fetch(t).then(function(e){return l(e)}).catch(function(e){return r(t).then(function(e){return v.capture(e).then(function(n){return{width:e.videoWidth,height:e.videoHeight,duration:Math.round(1e3*e.duration),format:d(t,"video"),poster:n}})})})}return r(e).then(function(t){return v.capture(t).then(function(n){return{width:t.videoWidth,height:t.videoHeight,duration:Math.round(1e3*t.duration),format:p(e.type),poster:n}})})}function c(e){if("string"==typeof e){var t=e;return h.fetch(t).then(function(e){return c(e)}).catch(function(e){return o(t).then(function(e){return{duration:Math.round(1e3*e.duration),format:d(t,"image")}})})}return o(e).then(function(t){return{duration:Math.round(1e3*t.duration),format:p(e.type)}})}function d(e,t){var n,s=/\.(\w+)$/.execute(e.replace(/#.*/,"").replace(/\?.*/,""));if(s)switch(n=_.toLower(s[1])){case"jpg":return"jpeg";default:return n}else switch(t){case"image":return"jpeg";case"video":return"mp4";case"audio":return"mp3";default:return""}}function u(e){var t=_.split(e,"/");return _.toLower(t[0])}function p(e){var t=_.split(e,"/"),n=_.toLower(t[1]);switch(n){case"svg+xml":return"svg";default:return n}}var m=n("../node_modules/bluebird/js/browser/bluebird.js"),h=n("../../common/src/transport/blob-manager.js"),f=n("../../common/src/transport/blob-reader.js"),g=n("../../common/src/media/jpeg-analyser.js"),v=n("../../common/src/media/frame-grabber.js");e.exports={loadImage:s,loadVideo:r,loadAudio:o,loadSVG:i,getImageMetadata:a,getVideoMetadata:l,getAudioMetadata:c,extractFileCategory:u,extractFileFormat:p}},"../../common/src/media/vector-view.jsx":function(e,t,n){"use strict";var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/bluebird/js/browser/bluebird.js"),i=n("../node_modules/react/react.js"),a=i.PropTypes,l=n("../../common/src/media/media-loader.js"),c=n("../../common/src/utils/component-refs.js");e.exports=i.createClass({displayName:"VectorView",propTypes:{url:a.string,clippingRect:a.object,title:a.string,onLoad:a.func,onError:a.func},getInitialState:function(){return this.components=c({svg:SVGGraphicsElement}),{}},componentWillMount:function(){this.load(this.props.url)},componentWillReceiveProps:function(e){this.props.url!==e.url&&this.load(e.url),this.props.clippingRect!==e.clippingRect&&this.setViewBox(e.clippingRect),this.props.title!==e.title&&this.setTitle(e.title)},render:function(){var e=this.components.setters,t=r.omit(this.props,"onLoad","url","clippingRect","title");return i.createElement("svg",s({ref:e.svg,viewBox:"0 0 4 4",width:4,height:4},t))},triggerLoadEvent:function(){this.props.onLoad&&this.props.onLoad({type:"load",target:this})},triggerErrorEvent:function(e){this.props.onError&&this.props.onError({type:"error",target:this,error:e})},load:function(e){var t=this;return e?l.loadSVG(e).then(function(e){var n=t.components.svg;if(!n)throw new Error("Invalid missing container");t.clear(),t.addTitle(t.props.title);for(var s;s=e.firstChild;)e.removeChild(s),n.appendChild(s);var r=e.width.baseVal.value,o=e.height.baseVal.value,i=e.viewBox.baseVal;r||(r=i.width),o||(o=i.height),r||(r=1e3),o||(o=1e3),t.originX=i.x,t.originY=i.y,t.zoomX=i.width?i.width/r:1,t.zoomY=i.height?i.height/o:1,t.naturalWidth=r,t.naturalHeight=o,t.setViewBox(t.props.clippingRect),t.triggerLoadEvent()}).catch(function(e){t.triggerErrorEvent(e)}):(this.clear(),this.originX=0,this.originY=0,this.zoomX=1,this.zoomY=1,this.naturalWidth=4,this.naturalHeight=4,this.setViewBox(),o.resolve())},clear:function(){for(var e=this.components.svg;e.firstChild;)e.removeChild(e.firstChild)},addTitle:function(e){var t=this.components.svg;if(e&&t){var n=document.createElementNS("http://www.w3.org/2000/svg","title");n.textContent=e,t.appendChild(n)}},setTitle:function(e){var t=svg.getElementByTagName("title");t?e?t.textContent=e:svg.removeChild(t):this.addTitle(e)},setViewBox:function(e){e||(e={left:0,top:0,width:this.naturalWidth,height:this.naturalHeight});var t=this.components.svg,n=t.viewBox.baseVal,s=t.width.baseVal,r=t.height.baseVal;n.x=e.left*this.zoomX+this.originX,n.y=e.top*this.zoomX+this.originY,n.width=e.width*this.zoomX,n.height=e.height*this.zoomY,s.value=e.width,r.value=e.height}})},"../../common/src/mixins/update-check.js":function(e,t,n){"use strict";function s(e,t){if(e===t)return!0;if(!e||!t)return!1;for(var n in t){var s=e[n];if(t[n]!==s)return!1}return!0}e.exports={shouldComponentUpdate:function(e,t){return!s(this.props,e)||!s(this.state,t)}}},"../../common/src/objects/finders/picture-finder.js":function(e,t,n){"use strict";function s(e,t,n){return e.find({table:"picture",criteria:{purpose:t,deleted:!1},minimum:n})}e.exports={findPictures:s}},"../../common/src/objects/finders/project-finder.js":function(e,t,n){"use strict";function s(e,t){return e.findOne({schema:"global",table:"project",criteria:{id:t},required:!0})}function r(e,t){return e.find({table:"project",criteria:{},minimum:t})}function o(e){return e.findOne({schema:"global",table:"project",criteria:{name:e.context.schema+""},required:!0})}function i(e,t){return e.find({schema:"global",table:"project",criteria:{achived:!1,deleted:!1},minimum:t})}function a(e,t,n){var s=c.map(t,"id");return c.isEmpty(s)?d.resolve(u.array):(s=c.sortBy(c.uniq(s)),e.find({schema:"global",table:"project",criteria:{user_ids:s},minimum:n}))}function l(e){return e.find({schema:"local",table:"project_link",criteria:{}}).filter(function(t){return e.findOne({schema:"local",table:"session",criteria:{key:t.address}}).then(function(e){if(e){if((new Date).toISOString()<e.etime)return!0}})})}var c=n("../node_modules/lodash/lodash.js"),d=n("../node_modules/bluebird/js/browser/bluebird.js"),u=n("../../common/src/data/empty.js");e.exports={findProject:s,findAllProjects:r,findCurrentProject:o,findActiveProjects:i,findProjectsWithMembers:a,findProjectLinks:l}},"../../common/src/objects/finders/repo-finder.js":function(e,t,n){"use strict";function s(e,t){return e.findOne({schema:"global",table:"repo",criteria:{id:t},required:!0})}function r(e,t){return e.find({schema:"global",table:"repo",criteria:{},minimum:t})}function o(e,t){return e.find({schema:"global",table:"repo",criteria:{deleted:!1},minimum:t})}function i(e,t){if(t instanceof Array){var n=a.flatten(a.map(t,"repo_ids"));return a.isEmpty(n)?l.resolve(c.array):(n=a.sortBy(a.uniq(n)),e.find({schema:"global",table:"repo",criteria:{id:n,deleted:!1}}))}var s=t;return s?e.find({schema:"global",table:"repo",criteria:{id:s.repo_ids,deleted:!1}}):l.resolve(c.array)}var a=n("../node_modules/lodash/lodash.js"),l=n("../node_modules/bluebird/js/browser/bluebird.js"),c=n("../../common/src/data/empty.js");e.exports={findRepo:s,findAllRepos:r,findExistingRepos:o,findProjectRepos:i}},"../../common/src/objects/finders/role-finder.js":function(e,t,n){"use strict";function s(e,t){return e.findOne({schema:"global",table:"role",criteria:{id:t},required:!0})}function r(e,t){return e.find({schema:"global",table:"role",criteria:{},minimum:t})}function o(e,t){return e.find({schema:"global",table:"role",criteria:{deleted:!1,disabled:!1},minimum:t})}function i(e,t){var n=a.flatten(a.map(t,"role_ids"));return a.isEmpty(n)?l.resolve(c.array):(n=a.sortBy(a.uniq(n)),e.find({schema:"global",table:"role",criteria:{id:n}}))}var a=n("../node_modules/lodash/lodash.js"),l=n("../node_modules/bluebird/js/browser/bluebird.js"),c=n("../../common/src/data/empty.js");e.exports={findRole:s,findAllRoles:r,findActiveRoles:o,findRolesOfUsers:i}},"../../common/src/objects/finders/server-finder.js":function(e,t,n){"use strict";function s(e,t){return e.findOne({schema:"global",table:"server",criteria:{id:t},required:!0})}function r(e,t){return e.find({schema:"global",table:"server",criteria:{},minimum:t})}function o(e,t){var n=i.filter(i.map(t,function(e){var t=c.findLinkByServerType(e,e.type);if(t)return t.server_id}));return i.isEmpty(n)?a.resolve(l.array):(n=i.sortBy(i.uniq(n)),e.find({schema:"global",table:"server",criteria:{id:n}}))}var i=n("../node_modules/lodash/lodash.js"),a=n("../node_modules/bluebird/js/browser/bluebird.js"),l=n("../../common/src/data/empty.js"),c=n("../../common/src/objects/utils/external-data-utils.js");e.exports={findServer:s,findAllServers:r,findServersOfRepos:o}},"../../common/src/objects/finders/statistics-finder.js":function(e,t,n){"use strict";function s(e,t){var n,s,o,a=!1;if(t&&(n=t.type,t.user?s=t.user:t.user_id&&(s={id:t.user_id}),t.project?o=t.project:t.schema?o={name:t.schema}:t.project_name&&(o={name:t.project_name}),a=t.public),"daily-activities"===n){if(s&&o)return i(e,o,s,a);if(o)return r(e,o,s,a)}else if("daily-notifications"===n&&s&&o)return l(e,o,s);return g.resolve(null)}function r(e,t,n){if(!t||t.deleted)return null;var s=t.name,r={type:"story-date-range",filters:{public:n||void 0}};return e.findOne({schema:s,table:"statistics",criteria:r,minimum:0}).then(function(t){if(p(t)){var r=y.getMonthRanges(t.details.start_time,t.details.end_time),o=y.getTimeZoneOffset(),i=f.map(r,function(e){return{time_range:e,tz_offset:o,public:n||void 0}}),a={type:"daily-activities",filters:i};return e.find({schema:s,table:"statistics",criteria:a,minimum:0}).then(function(e){return j(e,t)})}})}function o(e,t){return g.mapSeries(t,function(t){return r(e,t)}).then(function(e){var n=f.map(t,"id");return f.zipObject(n,e)})}function i(e,t,n,s){return n?a(e,t,[n],s).then(function(e){return f.get(e,n.id,null)}):null}function a(e,t,n,s){if(!t)return g.resolve(null);var r=t.name,o=f.filter(n,function(e){return!e.deleted}),i={type:"story-date-range",filters:f.map(o,function(e){return{user_ids:[e.id],public:s||void 0}})};return e.find({schema:r,table:"statistics",criteria:i}).then(function(t){t=f.filter(t,p);var n=f.map(t,function(e){var t=y.getMonthRanges(e.details.start_time,e.details.end_time),n=y.getTimeZoneOffset();return f.map(t,function(t){return{user_ids:e.filters.user_ids,time_range:t,tz_offset:n,public:s||void 0}})}),o=f.flatten(n);if(f.isEmpty(o))return{};var i={type:"daily-activities",filters:o};return e.find({schema:r,table:"statistics",criteria:i}).then(function(e){return f.transform(t,function(t,n){var s=n.filters.user_ids[0],r=f.filter(e,function(e){return e.filters.user_ids[0]===s});t[s]=j(r,n)},{})})})}function l(e,t,n){return n?c(e,t,[n]).then(function(e){return f.get(e,n.id,null)}):null}function c(e,t,n){if(!t)return g.resolve(null);var s=t.name,r=f.filter(n,function(e){return!e.deleted}),o={type:"notification-date-range",filters:f.map(r,function(e){return{target_user_id:e.id}})};return e.find({schema:s,table:"statistics",criteria:o}).then(function(t){t=f.filter(t,p);var n=f.map(t,function(e){var t=y.getMonthRanges(e.details.start_time,e.details.end_time),n=y.getTimeZoneOffset();return f.map(t,function(t){return{target_user_id:e.filters.target_user_id,time_range:t,tz_offset:n}})}),r=f.flatten(n);if(f.isEmpty(r))return{};var o={type:"daily-notifications",filters:r};return e.find({schema:s,table:"statistics",criteria:o}).then(function(e){return f.transform(t,function(t,n){var s=n.filters.target_user_id,r=f.filter(e,function(e){return e.filters.target_user_id===s});t[s]=j(r,n)},{})})})}function d(e,t,n){return n?u(e,t,[n]).then(function(e){return f.get(e,n.id,null)}):null}function u(e,t,n){if(!t)return g.resolve(null);var s=t.name,r=f.filter(n,function(e){return!e.deleted}),o={type:"story-date-range",filters:f.map(r,function(e){return{external_object:f.find(e.external,{type:e.type})}})};return e.find({schema:s,table:"statistics",criteria:o}).then(function(t){t=f.filter(t,p);var r=f.map(t,function(e){var t=y.getMonthRanges(e.details.start_time,e.details.end_time),n=y.getTimeZoneOffset();return f.map(t,function(t){return{external_object:e.filters.external_object,time_range:t,tz_offset:n}})}),o=f.flatten(r);if(f.isEmpty(o))return{};var i={type:"daily-activities",filters:o};return e.find({schema:s,table:"statistics",criteria:i}).then(function(e){return f.transform(t,function(t,s){var r=s.filters.external_object,o=f.filter(e,function(e){return f.isEqual(e.filters.external_object,r)});t[f.find(n,function(e){return f.some(e.external,r)}).id]=j(o,s)},{})})})}function p(e){return e&&!!e.details.start_time&&!!e.details.end_time}function m(e,t){var n={total:0};return f.each(e,function(e){f.each(e.details,function(e,s){t&&s.substr(0,7)!==t||f.each(e,function(e,t){"#"!==t.charAt(0)&&(n.total+=e),n[t]?n[t]+=e:n[t]=e})})}),n}function h(e){var t={};return f.each(e,function(e){f.assign(t,e.details)}),t}var f=n("../node_modules/lodash/lodash.js"),g=n("../node_modules/bluebird/js/browser/bluebird.js"),v=n("../node_modules/moment/moment.js"),b=n("../../common/src/utils/memoize.js"),y=n("../../common/src/utils/date-utils.js");e.exports={find:s,findDailyActivitiesOfProject:r,findDailyActivitiesOfProjects:o,findDailyActivitiesOfUser:i,findDailyActivitiesOfUsers:a,findDailyNotificationsOfUser:l,findDailyNotificationsOfUsers:c,findDailyActivitiesOfRepo:d,findDailyActivitiesOfRepos:u};var j=b(function(e,t,n){var s=v().subtract(1,"month").format("YYYY-MM"),r=v().format("YYYY-MM"),o=h(e),i=m(e,s),a=m(e,r),l=m(e),c=t.details.start_time,d=t.details.end_time;if(0===i.total){c.substr(0,7)<=s||(i.total=void 0)}return{range:{start:c,end:d},last_month:i,this_month:a,to_date:l,daily:o}})},"../../common/src/objects/finders/system-finder.js":function(e,t,n){"use strict";function s(e){return e.findOne({schema:"global",table:"system",criteria:{}}).then(function(e){return e||{}})}n("../node_modules/lodash/lodash.js"),n("../node_modules/bluebird/js/browser/bluebird.js"),n("../../common/src/data/empty.js");e.exports={findSystem:s}},"../../common/src/objects/finders/task-finder.js":function(e,t,n){"use strict";function s(e,t,n){return e.find({schema:"global",table:"task",criteria:{etime:null,deleted:!1,newer_than:t,limit:10,user_id:null},minimum:n})}function r(e,t,n){return t?e.find({schema:"global",table:"task",criteria:{options:{server_id:t.id},deleted:!1,limit:1e3},prefetch:!1,minimum:n}):o.resolve(i.array)}var o=(n("../node_modules/lodash/lodash.js"),n("../node_modules/bluebird/js/browser/bluebird.js")),i=n("../../common/src/data/empty.js");e.exports={findActiveTasks:s,findServerTasks:r}},"../../common/src/objects/finders/user-finder.js":function(e,t,n){"use strict";function s(e,t){return e.findOne({schema:"global",table:"user",criteria:{id:t},required:!0})}function r(e,t){return f.isEmpty(t)?g.resolve(v.array):(t=f.sortBy(f.uniq(t)),e.find({schema:"global",table:"user",criteria:{id:t}}))}function o(e,t){return e.find({schema:"global",table:"user",criteria:{},minimum:t})}function i(e,t){var n;if(t instanceof Array)n=f.flatten(f.map(t,"user_ids"));else{var s=t;n=f.get(s,"user_ids")}return r(e,n)}function a(e,t){return e.find({schema:"global",table:"user",criteria:{deleted:!1},minimum:t})}function l(e,t){return e.find({schema:"global",table:"user",criteria:{deleted:!1,disabled:!1},minimum:t})}function c(e,t,n){var s=f.map(t,"id");return s=f.sortBy(f.uniq(s)),e.find({schema:"global",table:"user",criteria:{role_ids:s},minimum:n})}function d(e,t){return r(e,f.flatten(f.map(t,"user_ids")))}function u(e,t){return r(e,f.map(t,"user_id"))}function p(e,t){return r(e,f.map(t,"target_user_id"))}function m(e,t){return r(e,f.flatten(f.map(t,"user_ids")))}function h(e,t){return r(e,f.map(t,"user_id"))}var f=n("../node_modules/lodash/lodash.js"),g=n("../node_modules/bluebird/js/browser/bluebird.js"),v=n("../../common/src/data/empty.js");e.exports={findUser:s,findUsers:r,findAllUsers:o,findUsersWithRoles:c,findProjectMembers:i,findExistingUsers:a,findActiveUsers:l,findStoryAuthors:d,findReactionAuthors:u,findBookmarkRecipients:p,findBookmarkSenders:m,findNotificationTriggerers:h}},"../../common/src/objects/settings/project-settings.js":function(e,t,n){"use strict";function s(e,t){if(e&&t&&!t.disabled){if("admin"===t.type||o.includes(e.user_ids,t.id))return e.archived?"read-only":"read-write";if(o.get(e,"settings.access_control.grant_view_access"))return e.archived?"read-only":o.get(e,"settings.access_control.grant_comment_access")?"read-comment":"read-only"}return null}function r(e,t){if(s(e,t))return!0;if("guest"===t.type){if(o.get(e,"settings.membership.allow_guest_request"))return!0}else if(o.get(e,"settings.membership.allow_user_request"))return!0;return!1}var o=n("../node_modules/lodash/lodash.js");e.exports={default:{},isVisibleToUser:r,getUserAccessLevel:s}},"../../common/src/objects/settings/server-settings.js":function(e,t,n){"use strict";e.exports={default:{}}},"../../common/src/objects/settings/system-settings.js":function(e,t,n){"use strict";e.exports={default:{}}},"../../common/src/objects/settings/user-settings.js":function(e,t,n){"use strict";e.exports={default:{notification:{like:!0,comment:!0,task_completion:!0,vote:!0,bookmark:!0,mention:!0,coauthor:!0},web_alert:{like:!0,comment:!0,task_completion:!0,vote:!0,bookmark:!0,mention:!0,coauthor:!0},mobile_alert:{like:!0,comment:!0,task_completion:!0,vote:!0,bookmark:!0,mention:!0,coauthor:!0}}}},"../../common/src/objects/types/server-types.js":function(e,t,n){"use strict";e.exports=t=["dropbox","facebook","github","gitlab","google","windows"],t.integrated=["gitlab"]},"../../common/src/objects/types/story-types.js":function(e,t,n){"use strict";(function(s){e.exports=t=["push","merge","branch","issue","milestone","merge-request","wiki","member","repo","post","survey","task-list"],t.editable=["post","task-list","survey"],t.trackable=["post"],t.git=["push","merge","branch","issue","milestone","merge-request","wiki","member","repo"],"[object process]"===Object.prototype.toString.call(void 0!==s?s:0)||(t.icons={push:n("../node_modules/octicons/build/svg/repo-push.svg"),merge:n("../node_modules/octicons/build/svg/git-merge.svg"),branch:n("../node_modules/octicons/build/svg/git-branch.svg"),issue:n("../node_modules/octicons/build/svg/issue-opened.svg"),"issue.opened":n("../node_modules/octicons/build/svg/issue-opened.svg"),"issue.closed":n("../node_modules/octicons/build/svg/issue-closed.svg"),"issue.reopened":n("../node_modules/octicons/build/svg/issue-reopened.svg"),milestone:n("../node_modules/octicons/build/svg/milestone.svg"),"merge-request":n("../node_modules/octicons/build/svg/git-pull-request.svg"),wiki:n("../node_modules/octicons/build/svg/file-text.svg"),member:n("../node_modules/octicons/build/svg/person.svg"),repo:n("../node_modules/octicons/build/svg/repo.svg"),post:n("../node_modules/octicons/build/svg/note.svg"),survey:n("../node_modules/octicons/build/svg/list-unordered.svg"),"task-list":n("../node_modules/octicons/build/svg/list-ordered.svg")})}).call(t,n("../node_modules/process/browser.js"))},"../../common/src/objects/types/user-types.js":function(e,t,n){"use strict";e.exports=["guest","regular","moderator","admin"]},"../../common/src/objects/utils/external-data-utils.js":function(e,t,n){"use strict";function s(e,t){return y.assign({type:e.type,server_id:e.id},t)}function r(e,t,n){var s=l(t,e);if(!s)throw new Error("Parent object is not linked to server");return s=y.pickBy(s,function(e,t){return"_"!==t.charAt(0)}),y.assign(s,n)}function o(e,t,n){return a(e,s(t,n))}function i(e,t,n,s){return a(e,r(t,n,s))}function a(e,t){return e.external?y.remove(e.external,{server_id:t.server_id}):e.external=[],e.external.push(t),t}function l(e,t,n){var s=y.find(e.external,{server_id:t.id});return!s||n&&!y.isMatch(s,n)?null:s}function c(e,t,n){var s=y.find(e.external,{type:t});return!s||n&&!y.isMatch(s,n)?null:s}function d(e){for(var t=arguments.length,n=Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return y.find(e.external,function(e){if(y.every(y.pick(e,n)))return!0})||null}function u(e,t){for(var n=arguments.length,s=Array(n>2?n-2:0),r=2;r<n;r++)s[r-2]=arguments[r];return y.find(e.external,function(e){return y.find(t.external,function(t){if(e.type===t.type&&e.server_id===t.server_id){if(y.isEmpty(s))return!0;if(y.isEqual(y.pick(e,s),y.pick(t,s)))return!0}})})||null}function p(e,t,n){y.remove(e.external,function(e){if(e.server_id===t.id&&(!n||y.isMatch(e,n)))return!0})}function m(e){return y.size(e.external)}function h(e,t,n,s){if(!s.ignore){var r,o=y.get(e,n),i=s.overwrite,a=y.indexOf(i,":");if(-1!==a&&(r=i.substr(a+1),i=i.substr(0,a)),"always"===i)void 0!==s.value?y.set(e,n,s.value):y.unset(e,n);else if("never"===i)void 0===o&&void 0!==s.value&&y.set(e,n,s.value);else{if("match-previous"!==i)throw new Error("Unknown option: "+i);var l=v(e,t),c=y.get(l,r);y.isEqual(o,c)&&(void 0!==s.value?(y.set(e,n,s.value),y.set(l,r,s.value)):(y.unset(e,n),y.unset(l,r)))}}}function f(e,t,n){if(!n.ignore){var s="details.resources",r=y.get(e,s,[]),o=y.findIndex(r,{type:n.type}),i=r[o],a=n.replace;if("always"===a)void 0===i?n.value&&r.push(n.value):n.value?r[o]=n.value:r.splice(o,1);else if("never"===a)void 0===i&&n.value&&r.push(n.value);else{if("match-previous"!==a)throw new Error("Unknown option: "+a);var l=v(e,t),c=y.get(l,"resources",[]),d=y.findIndex(c,{type:n.type}),u=c[d];y.isEqual(i,u)&&(void 0===i?n.value&&(r.push(n.value),c.push(n.value)):n.value?(r[o]=n.value,c[d]=n.value):(r.splice(o,1),c.splice(d,1))),y.isEmpty(c)?y.unset(l,"resources"):y.set(l,"resources",c)}y.isEmpty(r)?y.unset(e,s):y.set(e,s,r)}}function g(e,t,n,s,r){if(!r.ignore){var o,i=y.get(s,n),a=r.overwrite,l=y.indexOf(a,":");if(-1!==l&&(o=a.substr(l+1),a=a.substr(0,l)),"always"===a)y.set(s,n,r.value);else if("never"===a)void 0===i&&y.set(s,n,r.value);else{if("match-previous"!==a)throw new Error("Unknown option: "+a);var c=v(e,t),d=y.get(c,o);y.isEqual(i,d)&&(y.set(s,n,r.value),y.set(c,o,r.value))}}}function v(e,t){var n=y.find(e.exchange,{server_id:t.id});return n||(n={type:t.type,server_id:t.id,previous:{}},e.exchange||(e.exchange=[]),e.exchange.push(n)),n.previous}function b(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var s=y.first(t),r=y.slice(t,1),o=y.find(s.external,function(e){var t=y.pick(e,"server_id","type");return y.every(r,function(e){return y.some(e.external,t)})});return o?{id:o.server_id,type:o.type}:null}var y=n("../node_modules/lodash/lodash.js");e.exports={createLink:s,extendLink:r,addLink:o,inheritLink:i,attachLink:a,findLink:l,findLinkByServerType:c,findLinkByRelations:d,findLinkByRelative:u,removeLink:p,countLinks:m,importProperty:h,importResource:f,exportProperty:g,findCommonServer:b}},"../../common/src/routing/cors-rewriter.js":function(e,t,n){"use strict";function s(e,t){var n,s,r=new RegExp("^/(https?)/([^/]*)"),o=r.exec(e.path);o?(s=o[1]+":",n=o[2],e.path=e.path.substr(o[0].length),t.cors=!0):(n=window.location.host,s=window.location.protocol,t.cors=!1),s&&n&&(t.address=s+"//"+n)}function r(e,t){if(t.cors){var n=t.address;if(n){var s=n.indexOf("://"),r=n.substr(0,s),o=n.substr(s+3);e.path="/"+r+"/"+o+e.path}}}e.exports={extract:s,insert:r}},"../../common/src/routing/route-manager.jsx":function(e,t,n){"use strict";function s(e){var t=e,n="",s=t.indexOf("#");-1!==s&&(n=t.substr(s+1),t=t.substr(0,s));var o={},i=t.indexOf("?");return-1!==i&&(o=r(t.substr(i+1)),t=t.substr(0,i)),{path:t,query:o,hash:n}}function r(e){var t={},n=i.split(e,"&");return i.each(n,function(e){var n=i.split(e,"="),s=decodeURIComponent(n[0]),r=decodeURIComponent(n[1]||"");r=i.replace(r,/\+/g," "),t[s]=r}),t}function o(e){return e.pathname+e.search+e.hash}var i=n("../node_modules/lodash/lodash.js"),a=n("../node_modules/bluebird/js/browser/bluebird.js"),l=n("../node_modules/react/react.js"),c=l.PropTypes,d=n("../../common/src/data/database.js");e.exports=l.createClass({displayName:"RouteManager",propTypes:{pages:c.array.isRequired,database:c.instanceOf(d),rewrite:c.func,onChange:c.func,onRedirectionRequest:c.func},getInitialState:function(){return{basePath:this.getBasePath(),url:null,component:null,parameters:null,query:null,hash:""}},getBasePath:function(){var e=document.getElementsByTagName("BASE")[0];if(e){var t=e.getAttribute("href");return i.replace(t,/\/+$/,"")}return""},getURL:function(){return this.state.url},getComponent:function(){return this.state.component},getParameters:function(){return this.state.parameters},getQuery:function(){return this.state.query},getHash:function(){return this.state.hash},goTo:function(e,t){var n=o(e);return this.change(n,t)},find:function(e,t){var n,s;e instanceof Array?(n=e[0],s=i.slice(e,1)):n=e,t=i.clone(t)||{};var r=n.getURL(t),o=this.state.basePath;o&&(r.path=o+r.path),this.props.rewrite&&this.props.rewrite(r,t,"find");var a=r.path;if(!i.isEmpty(r.query)){var l="";i.forIn(r.query,function(e,t){l+=l?"&":"?",l+=t+"="+encodeURIComponent(e).replace(/%20/g,"+")}),a+=l}var c=i.map(s,function(e){return e.getHash(t)}),d=i.join(c,"");return d&&(a+="#"+d),a},parse:function(e){var t=this,n=s(e),r={};this.props.rewrite&&this.props.rewrite(n,r,"parse");var o=this.state.basePath;if(o){if(!i.startsWith(n.path,o))return null;n.path=n.path.substr(o.length)}var a,l=0;try{i.each(this.props.pages,function(e){if("function"!=typeof e.parseURL){var s=i.get(e,"displayName","Page");throw new Error(s+" does not implement the static function parseURL()")}var o=e.parseURL(n.path,n.query);if(o&&o.match.length>l){var c=i.assign(i.omit(o,"match"),r),d=t.find(e,c);n.hash&&(d+="#"+n.hash),a={url:d,component:e,parameters:c,query:n.query,hash:n.hash},l=o.match.length}})}catch(e){return console.error(e),null}return a},change:function(e,t,n){var s=this;if(this.state.url===e)return a.resolve(!1);var r=this.parse(e);return r?(this.setState(r,function(){n||(n=r.url);var e=window.location.protocol,o=window.location.host,i=e+"//"+o+n;window.location.href!==i&&(t?window.history.replaceState({},"",i):window.history.pushState({},"",i)),s.triggerChangeEvent()}),a.resolve(!0)):this.triggerRedirectionRequest(e,t)},reanchor:function(e){var t=window.location.href,n=t.indexOf("#"),s=-1!==n?t.substr(0,n):t;e&&(s+="#"+e),t!==s&&window.history.replaceState({},"",s),this.state.hash!==e&&this.setState({hash:e})},triggerChangeEvent:function(){this.props.onChange&&this.props.onChange({type:"change",target:this})},triggerRedirectionRequest:function(e,t){var n=this;if(this.props.onRedirectionRequest&&!this.redirecting){var s=this.state.basePath;return s&&i.startsWith(e,s)&&(e=e.substr(s.length),i.startsWith(e,"/")||(e="/"+e)),this.redirecting=!0,a.try(function(){return n.props.onRedirectionRequest({type:"redirection",target:n,url:e,replacing:t})}).finally(function(){n.redirecting=!1})}return a.reject(new Error("Unable to route URL to a page: "+e))},render:function(){return null},componentDidMount:function(){this.componentDidUpdate({},{}),window.addEventListener("popstate",this.handlePopState)},componentDidUpdate:function(e,t){!e.database&&this.props.database&&this.goTo(window.location,!0).catch(function(e){console.error(e)})},componentWillUnmount:function(){window.removeEventListener("popstate",this.handlePopState)},handlePopState:function(e){var t=this;e.preventDefault();var n=o(window.location),s=this.parse(n);s&&this.setState(s,function(){t.triggerChangeEvent()})}})},"../../common/src/routing/route.js":function(e,t,n){"use strict";function s(e){this.routeManager=e,this.url=this.routeManager.getURL(),this.path=o.replace(this.url,/[?#].*/,""),this.component=this.routeManager.getComponent(),this.parameters=this.routeManager.getParameters(),this.query=this.routeManager.getQuery(),this.hash=this.routeManager.getHash(),this.callbacks=[]}function r(e){var t=l[e];if(!t){var n=[],s=e.replace(/(:\w+)/g,function(e){return n.push(e),"([^\\/]+)"});t=l[e]=new RegExp("^"+s),t.names=n}return t}var o=("function"==typeof Symbol&&Symbol.iterator,n("../node_modules/lodash/lodash.js")),i=n("../node_modules/bluebird/js/browser/bluebird.js");e.exports=s,s.prototype.change=function(e,t,n){var s=this;if("string"!=typeof e)throw new Error("Invalid argument");return this.ask(e,!0).then(function(r){return!!r&&s.routeManager.change(e,t,n)})},s.prototype.find=function(e,t){return this.routeManager.find(e,t)},s.prototype.push=function(e,t){var n=this.routeManager.find(e,t);return this.change(n,!1)},s.prototype.replace=function(e,t){var n=this.routeManager.find(e,t);return this.change(n,!0)},s.prototype.reanchor=function(e){this.routeManager.reanchor(e),this.hash=e||""},s.prototype.ask=function(e,t){return t?i.reduce(this.callbacks,function(t,n){try{if(!t)return!1;var s=n(e,!0);return i.resolve(s)}catch(e){return console.error(e),!0}},!0).then(function(e){return e}):o.reduce(this.callbacks,function(e,t){try{if(!e)return!1;var n=t(!1);if("boolean"!=typeof n)throw new Error("Callback passed to keep() should return a boolean when interactive (2nd argument) is true");return n}catch(e){return console.error(e),!0}},!0)},s.prototype.keep=function(e){this.callbacks.push(e)},s.prototype.free=function(e){o.pull(this.callbacks,e)},s.prototype.toString=function(){return this.url},s.compare=function(e,t){if(e&&t){if(e.component!==t.component)return!1;var n=e.parameters,s=t.parameters,r=o.union(o.keys(n),o.keys(s));return o.every(r,function(e){var t=n[e],r=s[e];return!(!o.isEqual(t,r)&&(t instanceof Array&&0===t.length&&(t=null),r instanceof Array&&0===r.length&&(r=null),t||r))})}return!1},s.match=function(e,t,n){for(var s=0;s<t.length;s++){var i=r(t[s]),a=i.exec(e);if(a){var l={};return o.each(i.names,function(e,t){l[e.substr(1)]=a[t+1]}),n&&(l=n(l)),l&&(l.match=a[0]),l}}},s.parseIdList=function(e){if(void 0!=e){if(e){var t=o.split(e,"+");return o.map(t,o.strictParseInt)}return a}};var a=[];s.parseId=function(e,t){if(void 0!=e){if(t instanceof RegExp){var n=t.exec(e);if(!n)return;e=n[1]}return o.strictParseInt(e)}},s.parseDate=function(e){if(void 0!=e)return/\d{4}-\d{2}-\d{2}/.test(e)?e:""};var l={}},"../../common/src/theme/theme-manager.jsx":function(e,t,n){"use strict";function s(e){var t;if("number"==typeof e)return e;if(t=/^(\d+)\s*vw/.exec(e)){var n=parseInt(t[1]);return Math.round(n*document.body.offsetWidth/100)}if(t=/^(\d+)\s*vh/.exec(e)){var n=parseInt(t[1]);return Math.round(n*document.body.offsetHeight/100)}}function r(e){switch(e){case"cellular":case"2g":return"50kbps";case"3g":return"400kbps";case"4g":return"5000kbps";case"ethernet":case"wifi":default:return"10000kpbs"}}function o(e,t){if(t.original)return null;var n=e.clip;return t.hasOwnProperty("clip")?n=t.clip:n||(n=m.default(e.width,e.height)),n}function i(){var e=document.createElement("CANVAS");if(e.width=e.height=1,e.toDataURL){if(5===e.toDataURL("image/webp").indexOf("image/webp"))return!0}return!1}function a(){var e=navigator.userAgent;return!(!/Android/.test(e)||/Edge/.test(e))}function l(){if(!a())return!1;var e=window.innerHeight;return screen.height-e>200}function c(){var e=navigator.userAgent;return!!/iPhone|iPad|iPod/.test(e)||(!!/Android/.test(e)||!!/Windows Phone/.test(e))}var d=n("../node_modules/lodash/lodash.js"),u=n("../node_modules/react/react.js"),p=u.PropTypes,m=n("../../common/src/media/image-cropping.js"),h=n("../../common/src/transport/blob-manager.js"),f=n("../../common/src/data/database.js");e.exports=u.createClass({displayName:"ThemeManager",propTypes:{modes:p.object,serverAddress:p.string,networkType:p.string,database:p.instanceOf(f),useWebP:p.bool,onChange:p.func},getInitialState:function(){return{mode:this.selectMode(),onscreenKeyboard:l(),touchInterface:c(),devicePixelRatio:window.devicePixelRatio,webpSupport:i(),details:null}},getMode:function(){return this.state.mode},getModes:function(){var e=d.sortBy(d.toPairs(this.props.modes),1);d.map(e,0);return d.keys(this.props.modes)},getBandwidth:function(){return 1e3*parseInt(r(this.props.networkType))},getDetails:function(){return this.state.details},hasKeyboard:function(){return this.state.onscreenKeyboard},hasTouchInterface:function(){return this.state.touchInterface},getImageURL:function(e,t){if(!e)return null;t||(t={});var n=this.getRemoteImageURL(e,t);return n||t.remote||(n=this.getLocalImageURL(e,t)),n},getLocalImageURL:function(e,t){if(e.payload_token){var n;switch(e.type){case"video":case"audio":case"website":n="poster";break;default:n="main"}var s="payload:"+e.payload_token+"/"+n,r=h.find(s);if(!r)return null;var i={url:h.url(r),clip:o(e,t),format:e.format};return"json:"+JSON.stringify(i)}},getRemoteImageURL:function(e,t){var n;switch(e.type){case"video":case"audio":case"website":n=e.poster_url;break;default:n=e.url}if(n){var r="";if(!t.original){var i=[],a=o(e,t);if(a){var l=d.map([a.left,a.top,a.width,a.height],Math.round);i.push("cr"+l.join("-"))}var c=s(t.width),u=s(t.height);1!==this.state.devicePixelRatio&&(c*=this.state.devicePixelRatio,u*=this.state.devicePixelRatio),c=Math.round(c),u=Math.round(u);var p=c||u;p&&(c&&u?i.push("re"+c+"-"+u):!c&&u?i.push("h"+u):!u&&c&&i.push("w"+c),"png"!==e.format&&"gif"!==e.format||i.push("sh")),void 0!==t.quality&&i.push("q"+t.quality);var m;"svg"===e.format?m="svg":this.state.webpSupport&&!1!==this.props.useWebP||!0===this.props.useWebP?(m="webp","png"!==e.format&&"gif"!==e.format||p||i.push("l")):m="png"===e.format||"gif"===e.format?"png":"jpg",r="/"+i.join("+")+"."+m}return""+this.props.serverAddress+n+r}},getVideoURL:function(e,t){if(!e.url)return null;t||(t={});var n=""+this.props.serverAddress+e.url;if(!t||!t.original){var s=this.pickVideoVersion(e,t);s&&(n+="."+s.name+"."+s.format)}return n},getAudioURL:function(e,t){if(!e.url)return null;t||(t={});var n=""+this.props.serverAddress+e.url;if(!t||!t.original){var s=this.pickAudioVersion(e,t);s&&(n+="."+s.name+"."+s.format)}return n},getImageDimensions:function(e,t){t||(t={});var n=o(e,t);return n&&!t.original?{width:n.width,height:n.height}:{width:e.width,height:e.height}},getDimensions:function(e,t){if("video"===e.type){if(!t.original){var n=this.pickVideoVersion(e,t);if(n&&n.width&&n.height)return{width:n.width,height:n.height}}return{width:e.width,height:e.height}}return this.getImageDimensions(e,t)},pickVideoVersion:function(e,t){if(t.hasOwnProperty("bitrate"))return d.find(e.resources,{bitrates:{video:t.bitrate}})||null;var n=this.getBandwidth(),s=function(e){return parseInt(d.get(e,"bitrates.video"))},r=function(e){var t=s(e);return t<=n?n-t:1/0},o=function(e){var t=s(e);return t>n?t-n:0},i=d.sortBy(e.versions,[r,o]);return d.first(i)||null},pickAudioVersion:function(e,t){if(t.hasOwnProperty("bitrate"))return d.find(e.resources,{bitrates:{audio:t.bitrate}})||null;var n=this.getBandwidth(),s=function(e){return parseInt(d.get(e,"bitrates.audio"))},r=function(e){var t=s(e);return t<=n?n-t:1/0},o=function(e){var t=s(e);return t>n?t-n:0},i=d.sortBy(e.versions,[r,o]);return d.first(i)||null},getURL:function(e,t){switch(e.type){case"image":return this.getImageURL(e,t);case"video":return this.getVideoURL(e,t);case"website":return e.url;case"audio":return this.getAudioURL(e,t)}},selectMode:function(){var e=document.body.parentNode.offsetWidth,t="";for(var n in this.props.modes){e>=this.props.modes[n]&&(t=n)}return t},change:function(e){var t=this;return d.isEqual(this.state.details,e)?Promise.resolve(!0):(this.setState({details:e},function(){t.triggerChangeEvent()}),Promise.resolve(!0))},componentWillMount:function(){window.addEventListener("resize",this.handleWindowResize)},render:function(){return null},componentDidMount:function(){this.change(g)},componentDidUpdate:function(e,t){var n=this;if(!e.database&&this.props.database){var s=this.props.database.use({schema:"local",by:this});s.start().then(function(){return s.findOne({table:"settings",key:"theme"})}).then(function(e){e&&e.theme&&n.change(e.theme)})}},componentWillUnmount:function(){window.removeEventListener("resize",this.handleWindowResize)},triggerChangeEvent:function(){this.props.onChange&&this.props.onChange({type:"change",target:this})},handleWindowResize:function(e){var t=this,n={},s=this.selectMode();this.state.mode!==s&&(n.mode=s);var r=l();if(this.state.onscreenKeyboard!==r&&(n.onscreenKeyboard=r,r&&a())){var o=document.activeElement;o&&setTimeout(function(){o.scrollIntoViewIfNeeded({behavior:"smooth",block:"center"})},100)}this.state.devicePixelRatio!==window.devicePixelRatio&&(n.devicePixelRatio=window.devicePixelRatio),d.isEmpty(n)||this.setState(n,function(){t.triggerChangeEvent()})}});var g={}},"../../common/src/theme/theme.js":function(e,t,n){"use strict";function s(e){this.themeManager=e,this.mode=this.themeManager.getMode(),this.modes=this.themeManager.getModes(),this.keyboard=this.themeManager.hasKeyboard(),this.touch=this.themeManager.hasTouchInterface(),this.details=this.themeManager.getDetails()}var r=n("../node_modules/lodash/lodash.js");e.exports=s,s.prototype.change=function(e){return this.themeManager.change(e)},s.prototype.isAboveMode=function(e){var t=r.indexOf(this.modes,e);return r.indexOf(this.modes,this.mode)>=t},s.prototype.isBelowMode=function(e){return!this.isAboveMode(e)},s.prototype.getImageURL=function(e,t){return this.themeManager.getImageURL(e,t)},s.prototype.getVideoURL=function(e,t){return this.themeManager.getVideoURL(e,t)},s.prototype.getAudioURL=function(e,t){return this.themeManager.getAudioURL(e,t)},s.prototype.getURL=function(e,t){return this.themeManager.getURL(e,t)},s.prototype.getImageDimensions=function(e,t){return this.themeManager.getImageDimensions(e,t)},s.prototype.getDimensions=function(e,t){return this.themeManager.getDimensions(e,t)}},"../../common/src/transport/background-file-transfer.js":function(e,t,n){"use strict";function s(){try{a=i.init(),a.on("success",function(e){var t=o.find(l,{id:e.id});t&&t.onSuccess&&t.onSuccess(e),o.pull(l,t)}),a.on("progress",function(e){var t=o.find(l,{id:e.id});t&&t.onProgress&&t.onProgress(e)}),a.on("error",function(e){var t=o.find(l,{id:e.id});t&&t.onError&&t.onError(new Error(e.error))})}catch(e){a=null}}function r(e,t,n,s){var r={id:e,filePath:t,serverUrl:n,fileKey:"file",headers:o.get(s,"headers",{}),parameters:o.get(s,"parameters",{})};a.startUpload(r);var i={id:e,onSuccess:o.get(s,"onSuccess"),onError:o.get(s,"onError"),onProgress:o.get(s,"onProgress")};l.push(i)}var o=n("../node_modules/lodash/lodash.js"),i=window.FileTransferManager;e.exports={initialize:s,send:r};var a,l=[]},"../../common/src/transport/blob-manager.js":function(e,t,n){"use strict";function s(e){var t=new Date,n=d.find(m,{blob:e});if(n)return n.atime=t,n.localURL;var s;e instanceof Blob&&(s=URL.createObjectURL(e));var r=[s];return m.push({blob:e,localURL:s,urls:r,atime:t}),s}function r(e){if(!e)return null;var t=d.find(m,function(t){return d.includes(t.urls,e)});return t?(t.atime=new Date,t.blob):null}function o(e,t){if(e&&t){var n=d.find(m,{blob:e});n||(s(e),n=d.find(m,{blob:e})),n.urls.push(t)}}function i(e){if(!e)throw u.reject(new Error("Invalid argument"));var t=r(e);if(t)return u.resolve(t);var n={responseType:"blob"};return p.fetch("GET",e,null,n).then(function(t){s(t);return o(t,e),t})}function a(e){var t=d.findIndex(m,{blob:e});if(-1!==t){var n=m[t];m.splice(t,1),l(n)}}function l(e){e.blob instanceof Blob&&URL.revokeObjectURL(e.localURL)}function c(){var e=new Date,t=d.remove(m,function(t){if(d.some(t.urls,function(e){return/https?:/.test(e)})&&e-t.atime>18e4)return!0});d.each(t,function(e){l(e)})}var d=n("../node_modules/lodash/lodash.js"),u=n("../node_modules/bluebird/js/browser/bluebird.js"),p=(n("../node_modules/moment/moment.js"),n("../../common/src/transport/http-request.js"));e.exports={manage:s,find:r,associate:o,fetch:i,release:a,url:s};var m=[];setInterval(c,6e4)},"../../common/src/transport/blob-reader.js":function(e,t,n){"use strict";function s(e){return r(e).then(function(e){return new Uint8Array(e)})}function r(e){if("string"==typeof e){var t=e;return a.fetch(t).then(function(e){return r(e)})}return new i(function(t,n){var s=new FileReader;s.onload=function(e){t(s.result)},s.onerror=function(e){n(new Error("Unable to load blob"))},s.readAsArrayBuffer(e)})}function o(e){if("string"==typeof e){var t=e;return a.fetch(t).then(function(e){return o(e)})}return new i(function(t,n){var s=new FileReader;s.onload=function(e){t(s.result)},s.onerror=function(e){n(new Error("Unable to load text"))},s.readAsText(e)})}var i=n("../node_modules/bluebird/js/browser/bluebird.js"),a=n("../../common/src/transport/blob-manager.js");e.exports={loadUint8Array:s,loadArrayBuffer:r,loadText:o}},"../../common/src/transport/blob-stream.js":function(e,t,n){"use strict";function s(e,t){this.id=l.generate(),this.address=e,this.options=t,this.parts=[],this.closed=!1,this.error=null,this.pullResult=null,this.waitResult=null,this.size=0,this.started=!1,this.online=!0,this.transferred=0,this.promise=null,this.onProgress=null,this.onComplete=null}function r(){var e={};return e.promise=new i(function(t,n){e.resolve=t,e.reject=n}),e}var o=n("../node_modules/lodash/lodash.js"),i=n("../node_modules/bluebird/js/browser/bluebird.js"),a=n("../../common/src/transport/http-request.js"),l=n("../../common/src/utils/random-token.js"),c=n("../node_modules/async-do-while/index.js");e.exports=s,s.prototype.toBlob=function(){var e=o.map(this.parts,"blob");if(e.length>1){var t=e[0].type;return new Blob(e,{type:t})}return 1===e.length?e[0]:new Blob},s.prototype.setOptions=function(e){if(this.started)throw new Error("Cannot set options once a stream has started");this.options=o.assign({},this.options,e)},s.prototype.push=function(e){this.parts.push({blob:e,sent:!1}),this.size+=e.size,this.pullResult&&(this.pullResult.resolve(e),this.pullResult=null)},s.prototype.close=function(){this.closed=!0,o.find(this.parts,{sent:!1})||(this.pullResult&&(this.pullResult.resolve(null),this.pullResult=null),this.waitResult&&(this.waitResult.resolve(),this.waitResult=null))},s.prototype.pull=function(){var e=o.find(this.parts,{sent:!1});return e?i.resolve(e.blob):this.closed?i.resolve(null):(this.pullResult||(this.pullResult=r()),this.pullResult.promise)},s.prototype.finalize=function(e){var t=o.find(this.parts,{blob:e});if(t&&(t.sent=!0),this.waitResult){!o.find(this.parts,{sent:!1})&&this.closed&&this.waitResult.resolve()}},s.prototype.abandon=function(e){this.error=e,this.waitResult&&this.waitResult.reject(e)},s.prototype.wait=function(){if(this.closed){if(this.error)return i.reject(this.error);if(!o.find(this.parts,{sent:!1}))return i.resolve()}return this.waitResult||(this.waitResult=r()),this.waitResult.promise},s.prototype.pipe=function(e,t){t||(t=1048576);for(var n=e.size,s=e.type,r=0;r<n;r+=t){var o=Math.min(t,n-r),i=e.slice(r,r+o,s);this.push(i)}return this.close(),this},s.prototype.suspend=function(e){this.online&&(this.online=!1)},s.prototype.resume=function(){if(!this.online&&(this.online=!0,this.onConnectivity)){var e=this.onConnectivity;this.onConnectivity=null,this.connectivityPromise=null,e()}},s.prototype.waitForConnectivity=function(){var e=this;return this.online?i.resolve():(this.connectivityPromise||(this.connectivityPromise=new i(function(t,n){e.onConnectivity=t})),this.connectivityPromise)},s.prototype.start=function(){var e=this;return this.promise||(this.promise=this.waitForConnectivity().then(function(){return e.started=!0,new i(function(t,n){var s=0,r=!1,l=0,d=0,u=1e3;c.do(function(){return e.waitForConnectivity().then(function(){return e.pull().then(function(n){var s=e.address+"/srv/media/stream/?id="+e.id,i=new FormData;n?(i.append("file",n),i.append("chunk",d),0===d&&o.each(e.options,function(e,t){i.append(t,e)})):r=!0;var c={responseType:"json",onUploadProgress:function(t){if(n){var s=Math.round(n.size*(t.loaded/t.total));s&&e.updateProgress(l+s)}}};return a.fetch("POST",s,i,c).then(function(s){n&&(e.finalize(n),l+=n.size),0===d&&t(),d++})}).catch(function(e){if(!(e.statusCode>=400&&e.statusCode<=499&&429!==e.statusCode)&&++s<10)return u=Math.min(2*u,3e4),i.delay(u);throw e})})}),c.while(function(){return!r}),c.end().then(function(){e.onComplete&&e.onComplete({type:"complete",target:e})}).catch(function(t){e.abandon(t),0===d&&n(t)})})})),this.promise},s.prototype.updateProgress=function(e){this.transferred=e,this.onProgress&&this.onProgress({type:"progress",target:this,loaded:e,total:this.size,lengthComputable:this.closed})}},"../../common/src/transport/http-request.js":function(e,t,n){"use strict";function s(e,t,n,s){var l=new XMLHttpRequest,c=new i(function(i,c){var d=o.get(s,"username",null),u=o.get(s,"password",null),p=o.get(s,"contentType",null);if("GET"===(e=o.toUpper(e))&&!o.isEmpty(n)){var m=[];o.forIn(n,function(e,t){t=encodeURIComponent(t),void 0!==(e=encodeURIComponent(e))&&m.push(t+"="+e)}),-1===o.indexOf(t,"?")?t+="?":t+="&",t+=o.join(m,"&"),n=null}"json"===p&&(p="application/json"),"application/json"===p&&o.isObject(n)&&(n=JSON.stringify(n,r)),l.timeout=o.get(s,"timeout"),l.withCredentials=o.get(s,"crossSite",!1),l.responseType=o.get(s,"responseType",""),l.attributes=o.get(s,"attributes"),l.attributes&&l.upload&&(l.upload.attributes=l.attributes),l.open(e,t,!0,d,u),p&&l.setRequestHeader("Content-Type",p),l.onload=function(e){if(l.status>=400){var t=new a(l.status,l.response);c(t)}else{var n=l.response;i(n)}},l.ontimeout=function(e){c(new Error("Request timed out"))},l.onerror=function(e){c(new Error(e.message))},l.onabort=function(e){c(new Error("Transfer aborted: "+t))};var h=o.get(s,"onDownloadProgress"),f=o.get(s,"onUploadProgress");l.onprogress=function(e){h&&h(e)},l.upload.onprogress=function(e){f&&f(e)},l.send(n)});return c.cancel=function(){l.abort()},c}function r(e,t){if(!(t instanceof Blob))return t}var o=n("../node_modules/lodash/lodash.js"),i=n("../node_modules/bluebird/js/browser/bluebird.js"),a=n("../../common/src/errors/http-error.js");e.exports={fetch:s}},"../../common/src/transport/notification-unpacker.js":function(e,t,n){"use strict";function s(e){return e.changes?{type:"change",changes:r(e)}:e.alert?{type:"alert",alert:o(e)}:e.socket?{type:"connection",connection:i(e)}:e.address&&e.schema&&e.notification_id?{type:"alert",alert:a(e)}:null}function r(e){var t=[],n=e.address;return l.each(e.changes,function(e,s){var r=l.split(s,"."),o=r[0],i=r[1];l.each(e.ids,function(s,r){var a=e.gns[r];t.push({address:n,schema:o,table:i,id:s,gn:a})})}),t}function o(e){var t=e.address;return alert=l.clone(e.alert),alert.address=t,alert.profile_image&&(alert.profile_image=t+alert.profile_image),alert.attached_image&&(alert.attached_image=t+alert.attached_image),alert}function i(e){return{method:"websocket",relay:null,token:e.socket,address:e.address,details:{user_agent:navigator.userAgent}}}function a(e){return{title:"",message:"",type:e.type,address:e.address,schema:e.schema,notification_id:parseInt(e.notification_id),reaction_id:parseInt(e.reaction_id),story_id:parseInt(e.story_id),user_id:parseInt(e.user_id),foreground:!!e.foreground}}var l=n("../node_modules/lodash/lodash.js");e.exports={unpack:s}},"../../common/src/transport/payload-manager.jsx":function(e,t,n){"use strict";(function(t){function s(e){return e>=1073741824?r.round(e/1073741824)+" GB":e>=1048576?r.round(e/1048576)+" MB":e>=1024?r.round(e/1024)+" KB":e>0?e+" bytes":"0"}var r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/bluebird/js/browser/bluebird.js"),i=n("../node_modules/react/react.js"),a=i.PropTypes,l=n("../node_modules/moment/moment.js"),c=n("../../common/src/transport/blob-stream.js"),d=n("../../common/src/transport/payload.js"),u=n("../../common/src/data/database.js"),p=n("../../common/src/routing/route.js"),m=n("../../common/src/widgets/diagnostics.jsx"),h=n("../../common/src/widgets/diagnostics-section.jsx");e.exports=i.createClass({displayName:"PayloadManager",propTypes:{online:a.bool,database:a.instanceOf(u),route:a.instanceOf(p),onChange:a.func},getDefaultProps:function(){return{online:!0}},getInitialState:function(){var e={payloads:[],streams:[]};return r.assign(this,e),e},updateList:function(e,t){var n=this[e],s=t(n);this[e]=s;var r={};r[e]=s,this.setState(r)},add:function(e,t){t||(t={});var n=this.props.route.parameters,s=t.address||n.address,o=t.schema||n.schema||"global",i=new d(s,o,e);return i.onUploadProgress=this.handleUploadProgress,i.onUploadComplete=this.handleUploadComplete,this.updateList("payloads",function(e){return r.concat(e,i)}),i},stream:function(){var e=this.props.route.parameters,t=new c(e.address);return this.props.online||t.suspend(),this.updateList("streams",function(e){return r.concat(e,t)}),t},dispatch:function(e){var t=this,n=r.filter(this.payloads,function(t){return r.includes(e,t.token)});r.isEmpty(n)||this.acquirePermission(n).then(function(){return r.each(n,function(e){e.send()}),null}).then(function(){t.triggerChangeEvent()})},inquire:function(e){var n=this;if(r.isEmpty(e))return null;var s=r.filter(this.payloads,function(t){return r.includes(e,t.token)});if(s.length<e)return t(function(){var t=n.props.route.parameters,s=[];r.each(e,function(e){r.find(n.payloads,{token:e})||s.push(new d(t.address,t.schema,"unknown",e))}),n.updateList("payloads",function(e){return r.concat(e,s)})}),{action:"unknown",progress:void 0};var o=0,i=0;if(r.each(s,function(e){o+=e.getSize(),i+=e.getUploaded()}),(i=o>0?Math.round(i/o*100):100)<100)return{action:"uploading",progress:i};if(r.some(s,{failed:!0}))return{action:"failed"};var a=r.filter(s,function(e){return"web-site"===e.type});if(r.some(a,{completed:!1})){var l=0;return r.each(c,function(e){l+=e.processed}),l=Math.round(l/r.size(a)),{action:"rendering",progress:l}}var c=r.filter(s,function(e){return"video"===e.type||"audio"===e.type});if(r.some(c,{completed:!1})){var u=0;return r.each(c,function(e){u+=e.processed}),u=Math.round(u/r.size(c)),{action:"transcoding",progress:u}}return null},getUploadProgress:function(){var e=0,t=0;return r.each(this.payloads,function(n){n.started&&(n.failed||n.sent||(t+=n.getRemainingFiles(),e+=n.getRemainingBytes()))}),t>0?{files:t,bytes:e}:null},acquirePermission:function(e){var t=r.filter(e,{approved:!1});if(r.isEmpty(t))return o.resolve();var n=this.props.database.use({by:this});return n.start().then(function(s){var o,i=r.map(t,function(e){o=e.schema;var t={};return r.each(e.parts,function(e){t[e.name]=!1}),{token:e.token,action:e.action,options:t,user_id:s}});return n.save({schema:o,table:"task"},i).then(function(t){r.each(e,function(e){e.approved=!0})}).catch(function(t){r.each(e,function(e){e.failed=!0})})})},componentDidMount:function(){},componentDidUpdate:function(e,t){var n=this;!e.database&&this.props.database&&this.triggerChangeEvent(),e.database===this.props.database&&t.payloads===this.state.payloads||this.props.route&&this.updateBackendProgress(),e.online!==this.props.online&&r.each(this.streams,function(e){n.props.online?e.resume():e.suspend()})},updateBackendProgress:function(){var e=this,t=this.props.route.parameters,n=t.schema||"global",s=r.filter(this.payloads,{sent:!0,completed:!1,address:t.address,schema:n});if(!r.isEmpty(s)){var o=this.props.database.use({schema:n,by:this});o.start().then(function(t){var n={token:r.map(s,"token"),user_id:t};return o.find({table:"task",criteria:n}).then(function(t){var n=!1;r.each(t,function(e){var t=r.find(s,{token:e.token});t&&t.updateBackendStatus(e)&&(n=!0)}),n&&e.triggerChangeEvent()})})}},triggerChangeEvent:function(){this.props.onChange&&this.props.onChange({type:"change",target:this})},handleUploadProgress:function(e){this.triggerChangeEvent()},handleUploadComplete:function(e){this.triggerChangeEvent()},render:function(){var e=this.state.payloads;if(r.isEmpty(e))return null;var t=r.filter(e,{started:!1}),n=r.filter(e,{started:!0,sent:!1,failed:!1}),s=r.filter(e,{sent:!0,completed:!1}),o=r.filter(e,{failed:!0}),a=r.filter(e,{completed:!0});return i.createElement(m,{type:"payload-manager"},i.createElement(h,{label:"Pending payloads",hidden:r.isEmpty(t)},r.map(t,this.renderPayload)),i.createElement(h,{label:"Payloads in transit",hidden:r.isEmpty(n)},r.map(n,this.renderPayload)),i.createElement(h,{label:"Payloads in backend process",hidden:r.isEmpty(s)},r.map(s,this.renderPayload)),i.createElement(h,{label:"Failed payloads",hidden:r.isEmpty(o)},r.map(o,this.renderPayload)),i.createElement(h,{label:"Completed payloads",hidden:r.isEmpty(a)},r.map(a,this.renderPayload)))},renderPayload:function(e,t){return i.createElement("div",{key:t},i.createElement("div",null,"Payload token: ",e.token),i.createElement("div",null,"Resource type: ",e.type),this.renderTransferStatus(e),this.renderBackendStatus(e),i.createElement("ol",null,r.map(e.parts,this.renderPayloadPart)))},renderTransferStatus:function(e){if(!e.started)return null;if(e.sent){var t,n=.001*(l(e.uploadEndTime)-l(e.uploadStartTime)),o=e.getSize();o>0&&(t="("+s(o/n)+" per sec)");var a=r.round(n,n<1?2:0)+"s";return i.createElement("div",null,"Upload duration: ",a," ",t)}var o=e.getSize(),c=e.getUploaded(),d=Math.round(c/o*100||0)+"%";return i.createElement("div",null,"Upload progress: ",d)},renderBackendStatus:function(e){if(!e.sent)return null;if(e.completed){var t=.001*(l(e.processEndTime)-l(e.uploadEndTime)),n=r.round(t,t<1?2:0)+"s";return i.createElement("div",null,"Backend duration: ",n)}var s=e.processed+"%";return i.createElement("div",null,"Backend progress: ",s)},renderPayloadPart:function(e,t){var n,r=e.name;e.blob||e.cordovaFile?n="File":e.stream?n="Stream":e.url&&(n="URL");var o;return e.size>0&&(o=i.createElement("span",{className:"file-size"},s(e.size))),i.createElement("li",{key:t},n," - ",r," ",o)}})}).call(t,n("../node_modules/timers-browserify/main.js").setImmediate)},"../../common/src/transport/payload.js":function(e,t,n){"use strict";function s(e,t,n,s){this.address=e,this.schema=t,this.type=n,this.action="add-"+n,this.token=s||d.generate(),this.recreated=!!s,this.options={},this.url="payload:"+this.token,this.processed=0,this.promise=null,this.parts=[],this.approved=!1,this.started=!!s,this.sent=!1,this.failed=!1,this.canceled=!1,this.completed=!1,this.uploadStartTime=null,this.uploadEndTime=null,this.processEndTime=null,this.onUploadProgress=null,this.onUploadComplete=null}var r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/bluebird/js/browser/bluebird.js"),i=n("../node_modules/moment/moment.js"),a=(n("../../common/src/transport/blob-stream.js"),n("../../common/src/transport/blob-manager.js")),l=n("../../common/src/transport/http-request.js"),c=(n("../../common/src/transport/background-file-transfer.js"),n("../../common/src/errors/http-error.js")),d=(n("../../common/src/errors/file-error.js"),n("../../common/src/utils/random-token.js")),u=n("../node_modules/async-do-while/index.js");e.exports=s,s.getImageURL=function(e){if(e.payload_token){var t;switch(e.type){case"image":t="main";break;default:t="poster"}var n="payload:"+e.payload_token+"/"+t;return a.find(n)}},s.prototype.attachFile=function(e,t){t||(t="main");var n="payload:"+this.token+"/"+t;return a.associate(e,n),e instanceof Blob&&this.parts.push({blob:e,size:e.size,uploaded:0,name:t}),this},s.prototype.attachStream=function(e,t){return t||(t="main"),this.parts.push({stream:e,size:e.size,uploaded:e.transferred,name:t}),this},s.prototype.attachURL=function(e,t){return t||(t="main"),this.parts.push({url:e,name:t}),this},s.prototype.attachStep=function(e,t){var n;switch(t){case"poster":n={generate_poster:!0}}return this.setPartOptions(n,e),this.parts.push({name:t}),this},s.prototype.setPartOptions=function(e,t){t||(t="main");var n=r.find(this.parts,{name:t});if(!n)throw new Error("Unable to find part: "+t);n.stream?n.stream.setOptions(e):n.options=r.assign({},n.options,e)},s.prototype.send=function(){var e=this;if(!this.started){if(!this.approved)throw new c(403);this.started=!0,this.uploadStartTime=i().toISOString(),o.each(this.parts,function(t){var n=!1,s=1,r=1e3;return u.do(function(){return e.sendPart(t).then(function(){n=!0}).catch(function(t){if(t.statusCode>=400&&t.statusCode<=499)throw t;return r=Math.min(2*r,1e4),o.delay(r).then(function(){e.canceled||s++})})}),u.while(function(){return!n&&!e.canceled}),u.end()}).then(function(){e.sent=!0,e.uploadEndTime=i().toISOString(),e.onUploadComplete&&e.onUploadComplete({type:"uploadcomplete",target:e})})}},s.prototype.sendPart=function(e){return e.stream?this.sendStream(e):e.blob?this.sendBlob(e):(e.cordovaFile,e.url?this.sendURL(e):o.resolve())},s.prototype.sendBlob=function(e){var t=this,n=this.getDestinationURL(e.name),s=e.blob,o=new FormData;o.append("file",s),r.each(e.options,function(e,t){o.append(t,e)});var i={responseType:"json",onUploadProgress:function(n){t.updateProgress(e,n.loaded/n.total)}};return e.uploaded=0,l.fetch("POST",n,o,i).then(function(e){return t.associateRemoteURL(e.url,s),e})},s.prototype.sendCordovaFile=function(e){return},s.prototype.sendStream=function(e){var t=this,n=this.getDestinationURL(e.name),s=e.stream;return s.onProgress=function(n){t.updateProgress(e,n.loaded/n.total)},s.start().then(function(){var e={responseType:"json",contentType:"json"};return l.fetch("POST",n,{stream:s.id},e)})},s.prototype.sendURL=function(e){var t=this.getDestinationURL(e.name),n={responseType:"json",contentType:"json"},s=r.extend({url:e.url},e.options);return l.fetch("POST",t,s,n)},s.prototype.getSize=function(){var e=r.map(this.parts,function(e){return e.size||0});return r.sum(e)},s.prototype.getUploaded=function(){var e=r.map(this.parts,function(e){return e.uploaded||0});return r.sum(e)},s.prototype.getRemainingFiles=function(){return r.filter(this.parts,function(e){if(e.size>0&&e.uploaded<e.size)return!0}).length},s.prototype.getRemainingBytes=function(){var e=r.map(this.parts,function(e){return e.size>0?e.size-e.uploaded:0});return r.sum(e)},s.prototype.getDestinationURL=function(e){var t;switch(this.type){case"image":"main"===e&&(t="/srv/media/images/upload/"+this.schema+"/");break;case"video":"main"===e?t="/srv/media/videos/upload/"+this.schema+"/":"poster"===e&&(t="/srv/media/videos/poster/"+this.schema+"/");break;case"audio":"main"===e?t="/srv/media/audios/upload/"+this.schema+"/":"poster"===e&&(t="/srv/media/audios/poster/"+this.schema+"/");break;case"website":"poster"===e&&(t="/srv/media/html/poster/"+this.schema+"/")}return t?""+this.address+t+"?token="+this.token:null},s.prototype.updateProgress=function(e,t){t&&(e.uploaded=Math.round(e.size*t),this.onUploadProgress&&this.onUploadProgress({type:"uploadprogress",target:this}))},s.prototype.updateBackendStatus=function(e){var t=!1;return"unknown"===this.type&&(this.action=e.action,this.type=r.replace(this.action,/^add\-/,""),this.sent=e.completion>0,t=!0),this.processed!==e.completion&&(this.processed=e.completion,t=!0),this.processEndTime!==e.etime&&(this.processEndTime=e.etime,e.etime&&!e.failed&&(this.completed=!0),t=!0),e.failed&&!this.failed&&(this.failed=!0,t=!0),t},s.prototype.associateRemoteURL=function(e,t){e&&a.associate(t,this.address+e)}},"../../common/src/transport/payloads.js":function(e,t,n){"use strict";function s(e,t){this.payloadManager=e,this.destination=t,this.uploading=this.payloadManager.getUploadProgress()}function r(e){var t=[];if(e){var n=e.details;n&&(n.resources?o.each(n.resources,function(e){e.payload_token&&t.push(e.payload_token)}):n.payload_token&&t.push(n.payload_token))}return t}var o=n("../node_modules/lodash/lodash.js");n("../node_modules/bluebird/js/browser/bluebird.js");e.exports=s,s.prototype.add=function(e){return this.payloadManager.add(e,this.destination)},s.prototype.override=function(e){return new s(this.payloadManager,e)},s.prototype.stream=function(){return this.payloadManager.stream()},s.prototype.dispatch=function(e){var t=r(e);return this.payloadManager.dispatch(t)},s.prototype.inquire=function(e){var t=r(e);return this.payloadManager.inquire(t)}},"../../common/src/transport/websocket-notifier.jsx":function(e,t,n){"use strict";function s(){return new a(function(e,t){Notification.requestPermission(function(n){"granted"===n?e():t(new Error("Unable to gain permission"))})})}function r(e,t){return l.createElement("pre",{key:t},JSON.stringify(e,void 0,4))}function o(e){try{return JSON.parse(e)}catch(e){return{}}}var i=n("../node_modules/lodash/lodash.js"),a=n("../node_modules/bluebird/js/browser/bluebird.js"),l=n("../node_modules/react/react.js"),c=l.PropTypes,d=n("../node_modules/sockjs-client/lib/entry.js"),u=n("../node_modules/async-do-while/index.js"),p=n("../../common/src/transport/notification-unpacker.js"),m=n("../../common/src/locale/locale.js"),h=n("../../common/src/widgets/diagnostics.jsx"),f=n("../../common/src/widgets/diagnostics-section.jsx");e.exports=l.createClass({displayName:"WebsocketNotifier",propTypes:{serverAddress:c.string,basePath:c.string,initialReconnectionDelay:c.number,maximumReconnectionDelay:c.number,defaultProfileImage:c.string,online:c.bool,locale:c.instanceOf(m),onConnect:c.func,onDisconnect:c.func,onNotify:c.func,onAlertClick:c.func},statics:{isAvailable:function(){return!0}},getDefaultProps:function(){return{basePath:"/srv/socket",online:!0,initialReconnectionDelay:500,maximumReconnectionDelay:3e4}},getInitialState:function(){return{socket:null,notificationPermitted:!1,reconnectionCount:0,recentMessages:[]}},componentWillMount:function(){var e=this;s().then(function(){e.setState({notificationPermitted:!0})}).catch(function(e){}),this.updateConnection(this.props)},componentWillReceiveProps:function(e){this.props.serverAddress!==e.serverAddress&&this.updateConnection(e),!this.props.online&&e.online?this.onConnectivity&&this.onConnectivity():this.props.online&&!e.online&&this.state.socket&&this.state.socket.close()},updateConnection:function(e){this.disconnect(),e.serverAddress&&this.connect(e.serverAddress)},waitForConnectivity:function(){var e=this;return this.props.online?a.resolve():(this.connectivityPromise||(this.connectivityPromise=new a(function(t,n){e.onConnectivity=function(){e.connectivityPromise=null,e.onConnectivity=null,t()}})),this.connectivityPromise)},connect:function(e){var t=this,n=this.connectionAttempt;if(n&&n.serverAddress===e)return n.promise;n=this.connectionAttempt={serverAddress:e};var s=!1,r=this.props.initialReconnectionDelay,l=this.props.maximumReconnectionDelay;return u.do(function(){return t.createSocket(e).then(function(r){n===t.connectionAttempt&&(r.onmessage=function(n){if(t.state.socket===r){var s=o(n.data),a=i.assign({address:e},s),l=p.unpack(a);"change"===l.type?t.triggerNotifyEvent(l.changes):"alert"===l.type?t.showAlert(l.alert):"connection"===l.type&&(r.id=l.connection.token,t.triggerConnectEvent(l.connection));var c=i.slice(t.state.recentMessages);c.unshift(s),c.length>10&&c.splice(10),t.setState({recentMessages:c})}},r.onclose=function(){t.state.socket===r&&(t.setState({socket:null},function(){t.connect(e).then(function(e){if(e){var n=t.state.reconnectionCount+1;t.setState({reconnectionCount:n}),console.log("Connection reestablished")}})}),t.props.serverAddress===e&&(console.log("Disconnect"),t.triggerDisconnectEvent()))},t.setState({socket:r})),s=!0}).catch(function(t){return r*=2,r>l&&(r=l),console.log("Connection attempt in "+r+"ms: "+e),a.delay(r)})}),u.while(function(){return n===t.connectionAttempt&&!s}),u.return(function(){return t.connectionAttempt=null,s}),n.promise=u.end(),n.promise},disconnect:function(){var e=this.state.socket;e&&this.setState({socket:null,reconnectionCount:0},function(){e.close()})},createSocket:function(e){var t=this.props.basePath;return this.waitForConnectivity().then(function(){return new a(function(n,s){var r=""+e+t,o=new d(r),i=!1;o.onopen=function(e){i||(i=!0,n(o))},o.onclose=function(){i||s(new Error("Unable to establish a connection"))},o.onerror=function(e){i||(i=!0,s(new Error(e.message)))}})})},triggerNotifyEvent:function(e){this.props.onNotify&&this.props.onNotify({type:"notify",target:this,changes:e})},triggerConnectEvent:function(e){this.props.onConnect&&this.props.onConnect({type:"connect",target:this,connection:e})},triggerDisconnectEvent:function(){this.props.onDisconnect&&this.props.onDisconnect({type:"disconnect",target:this})},triggerAlertClickEvent:function(e){this.props.onAlertClick&&this.props.onAlertClick({type:"alertclick",target:this,alert:e})},showAlert:function(e){var t=this;if(this.state.notificationPermitted){var n={};e.profile_image?n.icon=e.profile_image:n.icon=this.props.defaultProfileImage,e.message?n.body=e.message:e.attached_image&&(n.image=e.attached_image),n.lang=i.get(this.props.locale,"languageCode");var s=new Notification(e.title,n);s.addEventListener("click",function(){t.triggerAlertClickEvent(e),s.close()})}},render:function(){var e=i.get(this.state.socket,"id");return l.createElement(h,{type:"websocket-notifier"},l.createElement(f,{label:"Connection"},l.createElement("div",null,"ID: ",e),l.createElement("div",null,"Socket: ",this.state.socket?"established":"none"),l.createElement("div",null,"Reconnection count: ",this.state.reconnectionCount),l.createElement("div",null,"Notification: ",this.state.notificationPermitted?"permitted":"denied")),l.createElement(f,{label:"Recent messages"},i.map(this.state.recentMessages,r)))}})},"../../common/src/utils/component-refs.js":function(e,t,n){"use strict";function s(e){if(!this)return new s(e);var t=this,n={};r.forIn(e,function(e,s){var r=function(e){if(!(arguments.length>0))return t[s];t[s]=e};n[s]=r}),this.setters=n,r.forIn(e,function(e,n){t[n]=null})}var r=n("../node_modules/lodash/lodash.js");e.exports=s},"../../common/src/utils/date-tracker.js":function(e,t,n){"use strict";function s(e,t){"change"===e&&t&&m.push(t)}function r(e,t){"change"===e&&t&&d.pull(m,t)}function o(e){h=e,a(u())&&c()}function i(e){return e.format("YYYY-MM-DD")}function a(e){var n=!1;return d.each(p,function(s,r){var o=s(e.clone()),a=t[r];if(o){var l=i(o);a!==l&&(t[r]=l,t[r+"ISO"]=o.toISOString(),n=!0)}}),n}function l(){var e=u();i(e)!==t.today&&(a(e),c())}function c(){var e={type:"change",target:t};d.each(m,function(t){t(e)})}var d=n("../node_modules/lodash/lodash.js"),u=n("../node_modules/moment/moment.js");e.exports=t={addEventListener:s,removeEventListener:r,setLocale:o,today:void 0};var p={today:function(e){return e.startOf("day")},yesterday:function(e){return e.subtract(1,"day").startOf("day")},oneWeekAgo:function(e){return e.subtract(7,"day").startOf("day")},twoWeeksAgo:function(e){return e.subtract(14,"day").startOf("day")},oneMonthAgo:function(e){return e.subtract(1,"month").startOf("day")},twoMonthsAgo:function(e){return e.subtract(2,"month").startOf("day")},startOfWeek:function(e){if(h)return e.locale(h).startOf("week")},endOfWeek:function(e){if(h)return e.locale(h).endOf("week")},startOfMonth:function(e){return e.startOf("month")},endOfMonth:function(e){return e.endOf("month")},startOfLastMonth:function(e){return e.subtract(1,"month").startOf("month")},endOfLastMonth:function(e){return e.subtract(1,"month").endOf("month")},startOfYear:function(e){return e.startOf("year")},endOfYear:function(e){return e.endOf("year")}},m=[],h="";setInterval(l,1e3),l()},"../../common/src/utils/date-utils.js":function(e,t,n){"use strict";function s(e){var t=e instanceof a?e:a(e),n=t.clone().endOf("day");return"["+t.toISOString()+","+n.toISOString()+"]"}function r(e,t){for(var n=e instanceof a?e:a(e),s=t instanceof a?t:a(t),r=n.startOf("month"),o=s.endOf("month"),i=[],l=r.clone();l<=o;l.add(1,"month")){var c=l.toISOString(),d=l.clone().endOf("month").toISOString(),u="["+c+","+d+"]";i.push(u)}return i}function o(e,t){for(var n=startTime instanceof a?startTime:a(startTime),s=t instanceof a?t:a(t),r=n.startOf("day"),o=s.endOf("day"),i=[],l=r.clone();l<=o;l.add(1,"day")){var c=l.format("YYYY-MM-DD");i.push(c)}return i}function i(){return a().utcOffset()}var a=n("../node_modules/moment/moment.js");n("../../common/src/utils/date-tracker.js");e.exports={getDayRange:s,getMonthRanges:r,getTimeZoneOffset:i,getDates:o}},"../../common/src/utils/lodash-extra.js":function(e,t,n){"use strict";function s(e){switch(void 0===e?"undefined":r(e)){case"number":return 0;case"string":return o.repeat("x",e.length);case"boolean":return!1;case"object":return e instanceof Array?o.map(e,s):o.mapValues(e,s)}}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n("../node_modules/lodash/lodash.js"),i={};o.mixin({decouple:function(e,t,n){"string"==typeof t?t=o.split(t,"."):t instanceof Array||(t=[t]),n||(n=i);var s=o.clone(e);s instanceof Object||(s={});for(var r=s,a=e,l=0;l<t.length;l++){var c=t[l],d=a?a[c]:void 0,u=o.clone(d);l===t.length-1?u instanceof n.constructor||(u=n):u instanceof Object||(u={}),r[c]=u,r=u,a=d}return s},decoupleSet:function(e,t,n){if("string"==typeof t?t=o.split(t,"."):t instanceof Array||(t=[t]),t.length<0)throw new Error("Empty path");var s=o.slice(t,0,-1),r=o.decouple(e,s,{});return o.set(r,t,n),r},decoupleUnset:function(e,t){if("string"==typeof t?t=o.split(t,"."):t instanceof Array||(t=[t]),t.length<0)throw new Error("Empty path");var n=o.slice(t,0,-1),s=o.decouple(e,n,{});return o.unset(s,t),s},decouplePush:function(e,t){for(var n=o.decouple(e,t,[]),s=o.get(n,t),r=arguments.length,i=Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];return Array.prototype.push.apply(s,i),n},shallowDiff:function(e,t){return o.pickBy(e,function(e,n){return t[n]!==e})},obscure:function(e,t){var n=o.cloneDeep(e);return o.each(t,function(e){var t=o.get(n,e);o.set(n,e,s(t))}),n},strictParseInt:function(e){var t=o.parseInt(e);if(t.toString()!==e)throw new Error("Not an integer: "+e);return t},fileSize:function(e){if(e<1024)return e+"B";var t=e/1024;if(t<1024)return o.round(t)+"KB";var n=t/1024;if(n<1024)return o.round(n,1)+"MB";var s=n/1024;return o.round(s,2)+"GB"}})},"../../common/src/utils/memoize.js":function(e,t,n){"use strict";function s(e,t,n){void 0===t&&(t=null);var s=!1!==n?o(e):r(e);return function(){return null!=arguments[0]?s.apply(null,arguments):t}}var r=n("../node_modules/memoizee/index.js"),o=n("../node_modules/memoizee/weak.js");e.exports=s},"../../common/src/utils/random-token.js":function(e,t,n){"use strict";function s(){var e=new Uint32Array(4);window.crypto.getRandomValues(e);var t=[];return e.forEach(function(e){for(var n=e.toString(16);n.length<8;)n="0"+n;t.push(n)}),t.join("")}e.exports={generate:s}},"../../common/src/utils/slug-generator.js":function(e,t,n){"use strict";function s(e){"string"==typeof e&&(e={en:e});var t,n="";for(var t in e)if(n=String(e[t]),n=o(n).toLowerCase(),n=n.replace(/\s+/g,"-"),n=n.replace(/[^0-9a-z\-]/g,""),/^\-+$/.test(n)&&(n=""),n)break;return n.length>32&&(n=n.substr(0,32)),n}function r(e){"string"==typeof e&&(e={en:e});var t,n="";for(var t in e){var s=String(e[t]).split(/\s+/).map(function(e){return o(e).toLowerCase().replace(/[^a-z]/g,"")}).filter(Boolean);if(s.length>0){for(var r=s[s.length-1],i="",a=0;a<s.length-1;a++)i+=s[a].charAt(0);if(n=i+r)break}}return n}function o(e){return String(e).normalize("NFD").replace(/[\u0300-\u036f]/g,"")}e.exports={fromTitle:s,fromPersonalName:r}},"../../common/src/widgets/autosize-text-area.jsx":function(e,t,n){"use strict";var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/react/react.js"),i=(o.PropTypes,n("../../common/src/utils/component-refs.js")),a=n("../../common/src/mixins/update-check.js");n("../../common/src/widgets/autosize-text-area.scss"),e.exports=o.createClass({displayName:"AutosizeTextArea",mixins:[a],getInitialState:function(){return this.components=i({actual:HTMLTextAreaElement,shadow:HTMLTextAreaElement}),{requiredHeight:void 0}},getElement:function(){return this.components.actual},componentWillReceiveProps:function(e){if(this.props.value!==e.value){var t=this.components.actual;t&&t===document.activeElement&&t.value!==e.value&&(this.caretPosition={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd,text:t.value})}},render:function(){var e=this.components.setters,t=r.extend({height:this.state.requiredHeight},this.props.style),n=r.omit(this.props,"style");return o.createElement("div",{className:"autosize-text-area"},o.createElement("textarea",{ref:e.shadow,style:t,className:"shadow",value:n.value,readOnly:!0}),o.createElement("textarea",s({ref:e.actual,style:t},n)))},componentDidMount:function(){window.removeEventListener("resize",this.handleDocumentResize),this.updateSize()},componentDidUpdate:function(e,t){if(this.caretPosition){var n,s,o=this.components.actual,i=this.caretPosition.selectionStart,a=this.caretPosition.selectionEnd,l=this.caretPosition.text,c=this.props.value,d=l.substring(0,i),u=l.substring(a),p=l.substring(i,a);r.startsWith(c,d)&&(n=i),r.endsWith(c,u)&&(s=c.length-u.length),void 0!==n&&void 0===s?(s=n+p.length)>c.length&&(s=c.length):void 0===n&&void 0!==s&&(n=s-p.length)<0&&(n=0),void 0!==n&&void 0!==s&&(p||(n=s),o.selectionStart=n,o.selectionEnd=s),this.caretPosition=null}e.value!==this.props.value&&this.updateSize()},componentWillUnmount:function(){window.removeEventListener("resize",this.handleDocumentResize)},focus:function(){this.components.actual.focus()},updateSize:function(){var e=this.components.shadow,t=this.components.actual;if(e&&t){var n=e.offsetHeight,s=e.scrollHeight,r=e.clientHeight,o=t.offsetHeight,i=s+(n-r)+1;if(this.state.height!==i){if(o>i&&o>this.state.requiredHeight)return;this.setState({requiredHeight:i})}}},handleResize:function(e){},handleDocumentResize:function(e){this.updateSize()}})},"../../common/src/widgets/autosize-text-area.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!../../common/src/widgets/autosize-text-area.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"../../common/src/widgets/chartist.jsx":function(e,t,n){"use strict";var s=n("../node_modules/lodash/lodash.js"),r=n("../node_modules/react/react.js"),o=r.PropTypes,i=(n("../node_modules/react-dom/index.js"),n("../node_modules/chartist/dist/chartist.js")),a=n("../../common/src/utils/component-refs.js");n("./widgets/chartist.scss"),e.exports=r.createClass({displayName:"Chartist",propTypes:{type:o.oneOf(["line","bar","pie"]).isRequired,data:o.object.isRequired,className:o.string,options:o.object,responsiveOptions:o.array,style:o.object,onDraw:o.func,onClick:o.func},getInitialState:function(){return this.components=a({container:HTMLDivElement}),{}},componentWillReceiveProps:function(e){this.props.onDraw!==e.onDraw&&(this.chartist?this.chartist.off("draw",this.props.onDraw):this.chartist.on("draw",e.onDraw))},render:function(){var e=["ct-chart"];this.props.className&&e.push(this.props.className);var t={ref:this.components.setters.container,className:e.join(" "),style:this.props.style,onClick:this.props.onClick};return r.createElement("div",t)},componentDidUpdate:function(e,t){e.type!==this.props.type?(this.destroyChart(),this.createChart()):e.data===this.props.data&&e.options===this.props.options&&e.responsiveOptions===this.props.responsiveOptions||this.updateChart()},componentDidMount:function(){this.createChart()},createChart:function(){var e=i[s.upperFirst(this.props.type)],t=this.components.container;this.chartist=new e(t,this.props.data,this.props.options,this.props.responsiveOptions),this.props.onDraw&&this.chartist.on("draw",this.props.onDraw)},updateChart:function(){this.chartist.update(this.props.data,this.props.options,this.props.responsiveOptions)},destroyChart:function(){this.chartist&&this.chartist.detach();var e=this.components.container;if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}}),e.exports.Interpolation=i.Interpolation,e.exports.Svg=i.Svg},"../../common/src/widgets/collapsible-container.jsx":function(e,t,n){"use strict";function s(e){var t=e.offsetHeight,n=e.getElementsByClassName("collapsible-container");return _.each(n,function(e){if(t-=e.offsetHeight,parseInt(e.style.height)>0){var n=e.children[0];t+=n.offsetHeight}}),t}var r=n("../node_modules/react/react.js"),o=(r.PropTypes,n("../../common/src/utils/component-refs.js"));n("../../common/src/widgets/collapsible-container.scss"),e.exports=r.createClass({displayName:"CollapsibleContainer",propTypes:{open:r.PropTypes.bool},getInitialState:function(){return this.components=o({container:HTMLDivElement,contents:HTMLDivElement}),{contentHeight:void 0,collapsing:!1,expanding:!1}},componentWillReceiveProps:function(e){this.props.open!==e.open&&(e.open?this.setState({collapsing:!1,expanding:!0}):this.setState({collapsing:!0,expanding:!1}))},render:function(){var e=this.components.setters,t={};this.props.open?t.height=this.state.contentHeight:t.height=0;var n="collapsible-container";return this.state.expanding?n+=" expanding":this.state.collapsing&&(n+=" collapsing"),r.createElement("div",{ref:e.container,className:n,style:t},r.createElement("div",{ref:e.contents,className:"collapsible-contents"},this.props.children))},componentDidMount:function(){this.props.open&&(this.updateHeight(),this.updateTimeout=setTimeout(this.updateHeight,10))},componentDidUpdate:function(e,t){this.updateHeight(),this.updateTimeout=setTimeout(this.updateHeight,10)},componentWillUnmount:function(){this.updateTimeout&&clearTimeout(this.updateTimeout)},updateHeight:function(){if(this.components.contents){var e=s(this.components.contents);this.state.contentHeight!==e&&this.setState({contentHeight:e})}}})},"../../common/src/widgets/collapsible-container.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!../../common/src/widgets/collapsible-container.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"../../common/src/widgets/diagnostics-section.jsx":function(e,t,n){"use strict";var s=n("../node_modules/react/react.js"),r=s.PropTypes,o=n("../../common/src/widgets/collapsible-container.jsx");e.exports=s.createClass({displayName:"DiagnosticsSection",propTypes:{label:r.string,hidden:r.bool},getInitialState:function(){return{open:!1}},render:function(){if(this.props.hidden)return null;var e="diagnostics-section";return this.state.open&&(e+=" open"),s.createElement("div",{className:e},s.createElement("div",{className:"title",onClick:this.handleLabelClick},this.props.label),s.createElement(o,{open:this.state.open},this.props.children))},handleLabelClick:function(e){var t=!this.state.open;this.setState({open:t})}})},"../../common/src/widgets/diagnostics.jsx":function(e,t,n){"use strict";(function(t){function s(n){var s=n.type,r=n.children;return i[s]=r,l||(l=t(function(){l=0,_.each(a,function(t){t({type:"change",target:e.exports})})})),null}var r=n("../node_modules/react/react.js"),o=r.PropTypes,i={},a=[],l=0;e.exports=s,s.propTypes={type:o.string.isRequired},s.get=function(e){return i[e]},s.addListener=function(e){e&&a.push(e)},s.removeListener=function(e){_.pull(a,e)}}).call(t,n("../node_modules/timers-browserify/main.js").setImmediate)},"../../common/src/widgets/image-cropper.jsx":function(e,t,n){"use strict";function s(e,t,n){e.left<0?e.left=0:e.left+e.width>t&&(e.left=t-e.width),e.top<0?e.top=0:e.top+e.height>n&&(e.top=n-e.height)}var r=n("../node_modules/lodash/lodash.js"),o=(n("../node_modules/bluebird/js/browser/bluebird.js"),n("../node_modules/react/react.js")),i=o.PropTypes,a=(n("../node_modules/react-dom/index.js"),n("../node_modules/hammerjs/hammer.js")),l=n("../../common/src/utils/component-refs.js"),c=n("../../common/src/media/bitmap-view.jsx"),d=n("../../common/src/media/vector-view.jsx");n("../../common/src/widgets/image-cropper.scss"),e.exports=o.createClass({displayName:"ImageCropper",propTypes:{url:i.string.isRequired,clippingRect:i.object,vector:i.bool,disabled:i.bool,onChange:i.func,onLoad:i.func},getDefaultProps:function(){return{vector:!1}},getInitialState:function(){return this.components=l({container:HTMLElement,image:c}),{clippingRect:this.props.clippingRect,hasFocus:!1}},componentWillReceiveProps:function(e){this.props.clippingRect!==e.clippingRect&&(this.zoomChangeTimeout?console.log("Ignoring incoming clipping rect"):this.setState({clippingRect:e.clippingRect})),this.props.url!==e.url&&this.zoomChangeTimeout&&(clearTimeout(this.zoomChangeTimeout),this.triggerChangeEvent(this.state.clippingRect),this.zoomChangeTimeout=0)},render:function(){var e=this.components.setters,t={ref:e.container,className:"image-cropper"};this.props.disabled||(r.assign(t,{tabIndex:0,onMouseDown:this.handleMouseDown,onFocus:this.handleFocus,onBlur:this.handleBlur}),this.state.hasFocus&&r.assign(t,{onWheel:this.handleMouseWheel,onKeyDown:this.handleKeyDown}));var n={ref:e.image,url:this.props.url,clippingRect:this.state.clippingRect,onLoad:this.props.onLoad},s=c;return this.props.vector&&(s=d),o.createElement("div",t,o.createElement(s,n))},focus:function(){this.components.container.focus()},activateTouchHandling:function(){var e=this.components.container;if(e&&!this.hammer){this.hammer=new a(e);var t=this.hammer.get("pan").set({direction:a.DIRECTION_ALL,threshold:5});this.hammer.get("pinch").set({enable:!0}).recognizeWith(t),this.hammer.on("panstart",this.handlePanStart),this.hammer.on("panmove",this.handlePanMove),this.hammer.on("panend",this.handlePanEnd),this.hammer.on("pinchstart",this.handlePinchStart),this.hammer.on("pinchmove",this.handlePinchMove),this.hammer.on("pinchend",this.handlePinchEnd)}},deactivateTouchHandling:function(){this.hammer&&(this.hammer.off("panstart",this.handlePanStart),this.hammer.off("panmove",this.handlePanMove),this.hammer.off("panend",this.handlePanEnd),this.hammer.off("pinchstart",this.handlePinchStart),this.hammer.off("pinchmove",this.handlePinchMove),this.hammer.off("pinchend",this.handlePinchEnd),this.hammer.stop(!0),this.hammer.element.style.touchAction="",this.hammer.destroy(),this.hammer=null)},componentDidUpdate:function(e,t){!t.hasFocus&&this.state.hasFocus?this.activateTouchHandling():t.hasFocus&&!this.state.hasFocus&&this.deactivateTouchHandling()},componentWillUnmount:function(){this.dragStart&&this.handleMouseUp(),this.zoomChangeTimeout&&(clearTimeout(this.zoomChangeTimeout),this.triggerChangeEvent(this.state.clippingRect)),this.deactivateTouchHandling()},triggerChangeEvent:function(e){r.isEqual(this.props.clippingRect,e)||this.props.onChange&&this.props.onChange({type:"change",target:this,rect:e})},handleFocus:function(e){this.setState({hasFocus:!0})},handleBlur:function(e){this.setState({hasFocus:!1})},handleMouseDown:function(e){if(0===e.button){var t=this.components.image,n=this.components.container;if(t&&n&&this.state.clippingRect){var s=n.getBoundingClientRect(),r=this.state.clippingRect;this.dragStart={clippingRect:r,boundingRect:s,pageX:e.pageX,pageY:e.pageY,naturalWidth:t.naturalWidth,naturalHeight:t.naturalHeight},document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}}},handleMouseMove:function(e){if(e.preventDefault(),this.dragStart){var t={x:this.dragStart.pageX-e.pageX,y:this.dragStart.pageY-e.pageY},n=this.dragStart.boundingRect,o=r.clone(this.dragStart.clippingRect),i=t.x*o.width/n.width,a=t.y*o.height/n.height;o.left+=Math.round(i),o.top+=Math.round(a),s(o,this.dragStart.naturalWidth,this.dragStart.naturalHeight),this.setState({clippingRect:o})}},handleMouseUp:function(e){this.dragStart&&(document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.triggerChangeEvent(this.state.clippingRect),this.dragStart=null)},handleMouseWheel:function(e){var t=this;e.preventDefault();var n=this.components.image,o=this.components.container;if(n&&o&&this.state.clippingRect){var i=4;e.shiftKey&&(i=1);var a,l=o.getBoundingClientRect(),c=r.clone(this.state.clippingRect);switch(e.deltaMode){case 0:a=e.deltaY;break;case 1:a=18*e.deltaY;break;case 2:a=480*e.deltaY}var d=Math.round(a*c.height/l.height/i),u=c.width+d;u>n.naturalWidth&&(u=n.naturalWidth,d=u-c.width);var p=c.height+d;p>n.naturalHeight&&(p=n.naturalHeight,d=p-c.height,u=c.width+d);var m={x:e.pageX-l.left,y:e.pageY-l.top},h=-m.x*d/l.width,f=-m.y*d/l.height;c.left+=Math.round(h),c.top+=Math.round(f),c.width=u,c.height=p,s(c,n.naturalWidth,n.naturalHeight),this.setState({clippingRect:c},function(){t.zoomChangeTimeout&&clearTimeout(t.zoomChangeTimeout),t.zoomChangeTimeout=setTimeout(function(){t.triggerChangeEvent(c),t.zoomChangeTimeout=0},1e3)}),this.dragStart&&(this.dragStart={clippingRect:c,boundingRect:l,pageX:e.pageX,pageY:e.pageY,naturalWidth:n.naturalWidth,naturalHeight:n.naturalHeight})}},handlePanStart:function(e){if("mouse"!==e.pointerType){var t=this.components.image,n=this.components.container;if(t&&n&&this.state.clippingRect){var s=n.getBoundingClientRect(),r=this.state.clippingRect;this.panStart={clippingRect:r,boundingRect:s,naturalWidth:t.naturalWidth,naturalHeight:t.naturalHeight},this.handlePanMove(e)}}},handlePanMove:function(e){if(this.panStart){var t=this.panStart.boundingRect,n=r.clone(this.panStart.clippingRect),o=-e.deltaX*n.width/t.width,i=-e.deltaY*n.height/t.height;n.left+=Math.round(o),n.top+=Math.round(i),s(n,this.panStart.naturalWidth,this.panStart.naturalHeight),this.setState({clippingRect:n})}},handlePanEnd:function(e){this.panStart&&(this.triggerChangeEvent(this.state.clippingRect),this.panStart=null)},handlePinchStart:function(e){if("mouse"!==e.pointerType){var t=this.components.image,n=this.components.container;if(t&&n&&this.state.clippingRect){var s=n.getBoundingClientRect(),o=this.state.clippingRect;this.pinchStart={clippingRect:o,boundingRect:s,pointers:r.map(e.pointers,function(e){return{pageX:e.pageX,pageY:e.pageY}})},this.handlePinchMove(e)}}},handlePinchMove:function(e){if(this.pinchStart){var t=this.components.image,n=r.clone(this.pinchStart.clippingRect),o=this.pinchStart.boundingRect,i=1/e.scale,a=Math.round(n.width*i);a>t.naturalWidth&&(a=t.naturalWidth,i=a/n.width);var l=Math.round(n.height*i);l>t.naturalHeight&&(l=t.naturalHeight,i=l/n.height,a=Math.round(n.width*i));var c={x:this.pinchStart.pointers[0].pageX-o.left,y:this.pinchStart.pointers[0].pageY-o.top},d={x:this.pinchStart.pointers[1].pageX-o.left,y:this.pinchStart.pointers[1].pageY-o.top},u={x:e.pointers[0].pageX-o.left,y:e.pointers[0].pageY-o.top},p={x:e.pointers[1].pageX-o.left,y:e.pointers[1].pageY-o.top},m=(c.x*n.width-u.x*a)/o.width,h=(d.x*n.width-p.x*a)/o.width,f=(c.y*n.height-u.y*l)/o.height,g=(d.y*n.height-p.y*l)/o.height;n.left+=Math.round((m+h)/2),n.top+=Math.round((f+g)/2),n.width=a,n.height=l,s(n,t.naturalWidth,t.naturalHeight),this.setState({clippingRect:n})}},handlePinchEnd:function(e){this.pinchStart&&(this.triggerChangeEvent(this.state.clippingRect),this.pinchStart=null)},handleKeyDown:function(e){if(27===e.keyCode){this.components.container.blur()}}})},"../../common/src/widgets/image-cropper.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!../../common/src/widgets/image-cropper.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"../../common/src/widgets/overlay.jsx":function(e,t,n){"use strict";function s(e){var t=_.omit(e,"className","children","show");return t.className="overlay",e.show?t.className+=" show":t.className+=" hide",e.className&&(t.className+=" "+e.className),r.createElement("div",t,r.createElement("div",{className:"background"}),r.createElement("div",{className:"foreground"},e.children))}var r=n("../node_modules/react/react.js"),o=r.PropTypes,i=n("../node_modules/react-dom/index.js");n("../../common/src/theme/theme.js");n("../../common/src/widgets/overlay.scss"),e.exports=r.createClass({displayName:"OverlayProxy",propTypes:{className:o.string,show:o.bool,onBackgroundClick:o.func},statics:{active:!1},getDefaultProps:function(){return{show:!1}},render:function(){return null},componentDidMount:function(){this.props.show&&this.show()},componentDidUpdate:function(e){e.show!==this.props.show?this.props.show?this.show():this.hide():e.children!==this.props.children&&this.props.show&&this.redraw(this.shown)},componentWillUnmount:function(){this.hide()},show:function(){var e=this;if(this.containerNode)this.containerRemovalTimeout&&(clearTimeout(this.containerRemovalTimeout),this.containerRemovalTimeout=0);else{var t=document.getElementById("application");this.containerNode=document.createElement("DIV"),t.appendChild(this.containerNode),t.addEventListener("keydown",this.handleKeyDown);var n=document.activeElement;n&&n!==document.body?(this.originalFocusElement=n,n.blur()):this.originalFocusElement=null}this.redraw(!1),this.shown=!1,setTimeout(function(){e.shown=!0,e.redraw(e.shown)},10),this.constructor.active=!0},redraw:function(e){var t={show:e,onClick:this.handleClick,onTouchMove:this.handleTouchMove,children:this.props.children};i.render(r.createElement(s,t),this.containerNode)},hide:function(){var e=this;this.containerNode&&(this.containerRemovalTimeout||(this.containerRemovalTimeout=setTimeout(function(){var t=document.getElementById("application");i.unmountComponentAtNode(e.containerNode),t.removeChild(e.containerNode),t.removeEventListener("keydown",e.handleKeyDown),e.containerNode=null,e.containerRemovalTimeout=0},500),this.originalFocusElement&&(this.originalFocusElement.focus(),this.originalFocusElement=null)),this.shown=!1,this.redraw(this.shown),this.constructor.active=!1)},handleClick:function(e){if(0===e.button){var t=e.target.className;"foreground"!==t&&"background"!==t||this.props.onBackgroundClick&&this.props.onBackgroundClick(e)}},handleTouchMove:function(e){for(var t=e.target,n=null,s=t;s&&s!==this.containerNode;s=s.parentNode){var r=getComputedStyle(s);if("auto"===r.overflowY||"scroll"===r.overflowY){s.scrollHeight>s.clientHeight&&(n=s);break}}n||e.preventDefault()},handleKeyDown:function(e){27===e.keyCode&&this.props.onBackgroundClick&&this.props.onBackgroundClick(e)}})},"../../common/src/widgets/overlay.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!../../common/src/widgets/overlay.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"../../common/src/widgets/resource-view.jsx":function(e,t,n){"use strict";function s(e){return o.startsWith(e,"json:")}function r(e){var t=e.substr(5);return JSON.parse(t)}var o=n("../node_modules/lodash/lodash.js"),i=n("../node_modules/react/react.js"),a=i.PropTypes,l=n("../../common/src/media/media-loader.js"),c=(n("../../common/src/media/image-cropping.js"),n("../../common/src/transport/payload.js"),n("../../common/src/theme/theme.js")),d=n("../../common/src/media/bitmap-view.jsx"),u=n("../../common/src/media/vector-view.jsx");e.exports=i.createClass({displayName:"ResourceView",propTypes:{clip:a.bool,animation:a.bool,resource:a.object,url:a.string,width:a.number,height:a.number,theme:a.instanceOf(c)},getDefaultProps:function(){return{clip:!0}},getInitialState:function(){return{isWaitingForImage:!1}},getURL:function(e){if(e=e||this.props,e.resource){var t={};return e.animation&&"gif"===e.resource.format?t.original=!0:(e.clip||(t.clip=null),e.width&&(t.width=e.width),e.height&&(t.height=e.height)),e.theme.getImageURL(e.resource,t)}return e.url},getDimensions:function(e){e=e||this.props;var t=e.width,n=e.height;if(e.resource){var s=e.theme.getImageDimensions(e.resource,{original:!this.props.clip});t?n=Math.round(t*s.height/s.width):n?t=Math.round(n*s.width/s.height):(t=s.width,n=s.height)}return{width:t,height:n}},componentWillReceiveProps:function(e){var t=this;if(this.props.resource!==e.resource){var n=this.getURL(),r=this.getURL(e);s(n)&&!s(r)&&(this.setState({isWaitingForImage:!0}),l.loadImage(r).catch(function(e){}).then(function(){t.setState({isWaitingForImage:!1})}))}},shouldComponentUpdate:function(e,t){return!t.isWaitingForImage},render:function(){var e=this.getURL();if(!e)return this.props.children||null;var t=o.omit(this.props,"clip","animation","resource","url","width","height","theme");if(s(e)){var n=r(e);return t.url=n.url,t.clippingRect=n.clip,"svg"===n.format?i.createElement(u,t):i.createElement(d,t)}var a=this.getDimensions();return t.src=e,t.width=a.width,t.height=a.height,i.createElement("img",t)}})},"../../common/src/widgets/smart-list.jsx":function(e,t,n){"use strict";function s(e){this.node=e}var r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/react/react.js"),i=o.PropTypes,a=n("../node_modules/react-dom/index.js");n("../../common/src/widgets/smart-list.scss"),e.exports=o.createClass({displayName:"SmartList",propTypes:{items:i.arrayOf(i.object),behind:i.number,ahead:i.number,anchor:i.string,offset:i.number,inverted:i.bool,transitioning:i.number,onIdentity:i.func.isRequired,onTransition:i.func,onRender:i.func.isRequired,onAnchorChange:i.func,onBeforeAnchor:i.func},getDefaultProps:function(){return{behind:5,ahead:10,offset:0,inverted:!1,transitioning:5}},getInitialState:function(){var e={};return this.updateAnchor(this.props,e),this.updateSlots(this.props,e),e},releaseAnchor:function(){this.setState({currentAnchor:null})},componentWillReceiveProps:function(e){var t=r.clone(this.state);this.props.anchor!==e.anchor&&this.updateAnchor(e,t),this.props.items!==e.items&&this.updateSlots(e,t);var n=r.shallowDiff(t,this.state);r.isEmpty(n)||this.setState(n)},updateAnchor:function(e,t){t.currentAnchor!==e.anchor&&(t.currentAnchor=e.anchor,this.anchorOffset=e.offset)},updateSlots:function(e,t){var n=this,s=e.items,o=function(t,s,r){return e.onIdentity({type:"identity",target:n,item:t,currentIndex:s,alternative:r||!1})},i=function(t,s){return!e.onTransition||e.onTransition({type:"transition",target:n,item:t,currentIndex:s})},a=r.slice(t.slots),l=r.transform(a,function(e,t){e[t.id]=t},{}),c=!r.isEmpty(a),d={};r.each(s,function(e,t){var s=o(e,t),r=l[s];if(!r){var u=o(e,t,!0);u&&(r=l[u])&&(r.id=s)}if(r)r.item=e,r.index=t,"disappearing"===r.state&&(r.state="present");else{var p="present";c&&i(e,t)&&(p="appearing"),r=n.createSlot(s,e,t,p),a.push(r)}d[s]=!0}),r.each(a,function(e){d[e.id]||(c&&n.isSlotVisible(e)?e.state="disappearing":e.state="gone")});var u=0,p=0,m=this.props.transitioning;r.each(a,function(e){"appearing"===e.state?u<m?u++:e.state="present":"disappearing"===e.state&&(p<m?p++:e.state="gone")});var h=r.remove(a,{state:"gone"});if(r.some(h,{unseen:!0})){var f=r.filter(a,{unseen:!0});this.triggerBeforeAnchorEvent(f)}t.slots=r.sortBy(a,"index")},createSlot:function(e,t,n,r){var o={id:e,key:e,index:n,state:r,item:t,transition:!1,rendering:void 0,contents:null,unseen:!1,height:void 0,node:null,setter:null};return o.setter=s.bind(o),o},render:function(){var e=this,t=this.state.slots,n=0;this.state.currentAnchor&&(n=r.findIndex(t,{id:this.state.currentAnchor}));var s=Math.max(0,n-this.props.behind),i=Math.min(r.size(t),n+this.props.ahead+1),a=this.props.onRender,l=r.map(t,function(t,n){var r,l=s<=n&&n<i;if("disappearing"!==t.state){var c={type:"render",target:e,item:t.item,needed:l,startIndex:s,currentIndex:n,endIndex:i,previousHeight:t.height,estimatedHeight:e.state.estimatedHeight};r=t.contents=a(c)}else r=t.contents;l&&(t.rendering=!0);var d,u="slot";return"appearing"===t.state?(u+=" transition in",t.transition?d={height:t.height}:u+=" hidden"):"disappearing"===t.state&&(u+=" transition out",t.transition?u+=" hidden":d={height:t.height}),o.createElement("div",{key:t.key,ref:t.setter,className:u,style:d},r)});return this.startIndex=s,this.endIndex=i,this.props.inverted&&r.reverse(l),o.createElement("div",{className:"smart-list",onTransitionEnd:this.handleTransitionEnd},l)},componentDidMount:function(){this.container=a.findDOMNode(this);for(var e=this.container.parentNode;e;e=e.parentNode){var t=getComputedStyle(e);if("auto"===t.overflowY||"scroll"===t.overflowY){this.scrollContainer=e;break}}this.scrollContainerWidth=this.scrollContainer.clientWidth,this.scrollContainer.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleWindowResize),this.maintainScrollPosition(),this.setSlotHeights()},componentDidUpdate:function(e,t){this.scrolling||this.maintainScrollPosition(),this.setSlotHeights(),this.markUnseenSlots(),this.setTransitionState()},maintainScrollPosition:function(){var e,t;if(this.state.currentAnchor?(e=r.find(this.state.slots,{id:this.state.currentAnchor}),t=this.anchorOffset):this.props.inverted&&(e=r.first(this.state.slots),t=1/0),e&&e.node&&void 0!==t){var n=this.scrollContainer.offsetTop,s=this.scrollContainer.scrollTop,o=e.node.offsetTop-n;if(this.props.inverted){var i=this.scrollContainer.scrollHeight,a=this.scrollContainer.offsetHeight,l=i-s-a,c=e.node.offsetHeight,d=i-o-c,u=d-l;if(u!==t){var p=Math.max(0,d-t),m=i-p-a;this.scrollContainer.scrollTop=m}}else{var u=o-s;if(u!==t){var m=Math.max(0,o-t);this.scrollContainer.scrollTop=m}}}},isSlotVisible:function(e){if(!e.rendering||!e.node)return!1;if(e.transition)return!0;if(this.scrollContainer){var t=this.scrollContainer.offsetHeight,n=this.scrollContainer.offsetTop,s=this.scrollContainer.scrollTop,r=s+t,o=e.node.offsetTop-n;if(s<o&&o<=r)return!0;var i=o+e.height;if(s<i&&i<=r)return!0}return!1},setSlotHeights:function(){var e=[];if(r.each(this.state.slots,function(t){if(t.rendering){var n=t.node.firstChild,s=n?n.offsetHeight:0;t.height=s,e.push(s)}}),void 0===this.state.estimatedHeight&&!r.isEmpty(e)){var t=r.sum(e)/e.length,n=Math.round(t);0!==n&&this.setState({estimatedHeight:n})}},markUnseenSlots:function(){var e=this,t=this.state.slots,n=r.findIndex(t,{id:this.state.currentAnchor}),s=!1;if(r.each(t,function(t,r){"appearing"===t.state?r<n&&(e.isSlotVisible(t)||(t.unseen=!0,s=!0)):t.unseen&&r>=n&&(t.unseen=!1,s=!0)}),s){var o=r.filter(t,{unseen:!0});this.triggerBeforeAnchorEvent(o)}},setTransitionState:function(){var e=this,t=r.clone(this.state.slots),n=!1;r.each(t,function(t){if(("appearing"===t.state||"disappearing"===t.state)&&!t.transition){var s=e.isSlotVisible(t);e.props.inverted&&("appearing"!==t.state||e.state.currentAnchor||(e.scrollPositionInterval||(e.scrollPositionInterval=setInterval(e.maintainScrollPosition,10)),e.scrollToAnchorNode=t.node,s=!0)),s?t.transition=!0:t.state="present",n=!0}}),n&&this.setState({slots:t})},componentWillUnmount:function(){this.scrollContainer.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleWindowResize)},triggerAnchorChangeEvent:function(e){this.props.onAnchorChange&&this.props.onAnchorChange({type:"anchorchange",target:this,anchor:e?e.id:null,item:e?e.item:null})},triggerBeforeAnchorEvent:function(e){this.props.onBeforeAnchor&&this.props.onBeforeAnchor({type:"beforeanchor",target:this,items:r.map(e,"item")})},findAnchorSlot:function(e){var t,n=this.scrollContainer.scrollTop,s=this.scrollContainer.offsetTop;if(this.props.inverted){var r,o=this.scrollContainer.scrollHeight,i=this.scrollContainer.offsetHeight,a=o-n-i;if(a>0)for(var l=0;l<e.length;l++){var c=e[l];t=c;var d=t.node.offsetTop-s,u=t.node.offsetHeight,r=o-d-u;if(r>a)break}this.anchorOffset=t?r-a:void 0}else{var d;if(n>0)for(var l=0;l<e.length;l++){var c=e[l];if(t=c,(d=t.node.offsetTop-s)>n)break}this.anchorOffset=t?d-n:void 0}return t},handleScroll:function(e){var t=this;if(!this.scrollPositionInterval){if(this.resizing)return void this.maintainScrollPosition();var n=this.findAnchorSlot(this.state.slots),s=n?n.id:void 0;this.state.currentAnchor!==s&&(this.setState({currentAnchor:s}),this.triggerAnchorChangeEvent(n)),this.scrolling=!0,this.scrollingEndTimeout&&clearTimeout(this.scrollingEndTimeout),this.scrollingEndTimeout=setTimeout(function(){t.scrolling=!1,t.scrollingEndTimeout=0},500)}},handleWindowResize:function(){var e=this;if(this.scrollContainerWidth!==this.scrollContainer.clientWidth){this.scrollContainerWidth=this.scrollContainer.clientWidth;var t=r.slice(this.state.slots);r.each(t,function(e){e.height=void 0}),this.setState({slots:t,estimatedHeight:void 0}),this.resizing=!0,this.resizingEndTimeout&&clearTimeout(this.resizingEndTimeout),this.resizingEndTimeout=setTimeout(function(){e.resizing=!1,e.resizingEndTimeout=0},50)}},handleTransitionEnd:function(e){var t=r.slice(this.state.slots);if("opacity"===e.propertyName){var n=r.find(t,{node:e.target});n&&"appearing"===n.state&&(n.state="present",n.transition=!1,this.setState({slots:t}),this.scrollToAnchorNode===e.target&&(this.maintainScrollPosition(),clearInterval(this.scrollPositionInterval),this.scrollPositionInterval=null,this.scrollToAnchorNode=null))}else if("height"===e.propertyName){var n=r.find(t,{node:e.target});if(n&&"disappearing"===n.state){var s=r.indexOf(t,n);t.splice(s,1);var o=this.findAnchorSlot(t),i=o?o.id:void 0;i!==this.state.currentAnchor&&this.triggerAnchorChangeEvent(o),this.setState({slots:t,currentAnchor:i})}}}})},"../../common/src/widgets/smart-list.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!../../common/src/widgets/smart-list.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"../../common/src/widgets/upload-progress.jsx":function(e,t,n){"use strict";var s=n("../node_modules/lodash/lodash.js"),r=n("../node_modules/react/react.js"),o=r.PropTypes,i=n("../../common/src/locale/locale.js"),a=n("../../common/src/transport/payloads.js");n("../../common/src/widgets/upload-progress.scss"),e.exports=r.createClass({displayName:"UploadProgress",propTypes:{payloads:o.instanceOf(a).isRequired,locale:o.instanceOf(i).isRequired},render:function(){var e=this.props.locale.translate,t=this.props.payloads.uploading;if(!t)return null;var n=s.fileSize(t.bytes),o=t.files;return r.createElement("div",{className:"upload-progress"},e("upload-progress-uploading-$count-files-$size-remaining",o,n))}})},"../../common/src/widgets/upload-progress.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!../../common/src/widgets/upload-progress.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"../assets/unicorn.svg":function(e,t,n){function s(e){return r.createElement("svg",e,[r.createElement("polygon",{points:"280,653 373,679 255,840",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:0}),r.createElement("polygon",{points:"102,634 298,439 373,430 297,540 447,585 387,674 281,646 285,575",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:1}),r.createElement("polygon",{points:"312,528 386,425 431,428",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:2}),r.createElement("polygon",{points:"332,520 485,397 513,414 496,435",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:3}),r.createElement("polygon",{points:"316,534 492,443 467,467 521,509 515,543 565,587 560,592 498,549",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:4}),r.createElement("polygon",{points:"318,542 496,557 555,595 548,605",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:5}),r.createElement("polygon",{points:"550,611 574,592 599,618",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:6}),r.createElement("polygon",{points:"476,466 543,399 521,500",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:7}),r.createElement("polygon",{points:"525,524 555,392 600,427",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:8}),r.createElement("polygon",{points:"522,542 605,435 597,604",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:9}),r.createElement("polygon",{points:"613,444 743,521 685,543 775,833 554,617 605,625",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:10}),r.createElement("polygon",{points:"565,318 620,318 655,457 613,434",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:11}),r.createElement("polygon",{points:"629,310 695,204 751,184 733,267 740,508 661,462",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:12}),r.createElement("polygon",{points:"757,183 869,81 776,196",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:13}),r.createElement("polygon",{points:"743,273 755,194 848,270 853,338",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:14})])}var r=n("../node_modules/react/react.js");s.displayName="Unicorn",s.defaultProps={version:"1.1",viewBox:"0 0 1000 1000"},e.exports=s,s.default=s},"../node_modules/asap/browser-asap.js":function(e,t,n){"use strict";function s(){if(l.length)throw l.shift()}function r(e){var t;t=a.length?a.pop():new o,t.task=e,i(t)}function o(){this.task=null}var i=n("../node_modules/asap/browser-raw.js"),a=[],l=[],c=i.makeRequestCallFromTimer(s);e.exports=r,o.prototype.call=function(){try{this.task.call()}catch(e){r.onerror?r.onerror(e):(l.push(e),c())}finally{this.task=null,a[a.length]=this}}},"../node_modules/asap/browser-raw.js":function(e,t,n){"use strict";(function(t){function n(e){i.length||(o(),a=!0),i[i.length]=e}function s(){for(;l<i.length;){var e=l;if(l+=1,i[e].call(),l>c){for(var t=0,n=i.length-l;t<n;t++)i[t]=i[t+l];i.length-=l,l=0}}i.length=0,l=0,a=!1}function r(e){return function(){function t(){clearTimeout(n),clearInterval(s),e()}var n=setTimeout(t,0),s=setInterval(t,50)}}e.exports=n;var o,i=[],a=!1,l=0,c=1024,d=void 0!==t?t:self,u=d.MutationObserver||d.WebKitMutationObserver;o="function"==typeof u?function(e){var t=1,n=new u(e),s=document.createTextNode("");return n.observe(s,{characterData:!0}),function(){t=-t,s.data=t}}(s):r(s),n.requestFlush=o,n.makeRequestCallFromTimer=r}).call(t,n("../node_modules/webpack/buildin/global.js"))},"../node_modules/async-do-while/index.js":function(e,t,n){function s(){var e=this;return o.resolve().then(function(){return e.begin()}).then(function(){return e.loop()}).catch(function(e){if(e!==u)throw e}).then(function(){return e.return()})}function r(){}var o=n("../node_modules/bluebird/js/browser/bluebird.js"),i=null,a=null,l=null,c=null,d="";t.begin=function(e){if(a||l)throw new Error("Cannot call begin() after while() or do()");if(!(e instanceof Function))throw new Error("Argument must be a function");i=e},t.while=function(e){if(l)throw new Error("Cannot call while() consecutively");if(!(e instanceof Function))throw new Error("Argument must be a function");a&&(d="do-while"),l=e},t.do=function(e){if(a)throw new Error("Cannot call do() consecutively");if(!(e instanceof Function))throw new Error("Argument must be a function");l&&(d="while-do"),a=e},t.return=function(e){if(!a||!l)throw new Error("Cannot call return() without calling while() and do() beforehand");if(!(e instanceof Function))throw new Error("Argument must be a function");c=e},t.end=function(){if(!a||!l)throw new Error("Cannot call end() without calling while() and do() beforehand");var e;"while-do"===d?e=function(){var e=this;return o.resolve(e.while()).then(function(t){if(t)return o.resolve(e.do()).then(function(){return e.loop()})})}:"do-while"===d&&(e=function(){var e=this;return o.resolve(e.do()).then(function(){return o.resolve(e.while()).then(function(t){if(t)return e.loop()})})});var t={begin:i||r,do:a,while:l,return:c||r,loop:e};return i=null,a=null,l=null,c=null,d="",s.call(t)};var u=new Error;t.break=function(){throw u}},"../node_modules/b64-to-blob/b64toBlob.js":function(e,t,n){var s,r,o;!function(n,i,a){r=[],s=a,void 0!==(o="function"==typeof s?s.apply(t,r):s)&&(e.exports=o)}(0,0,function(){"use strict";return function(e,t,n){t=t||"",n=n||512;for(var s=atob(e),r=[],o=0;o<s.length;o+=n){for(var i=s.slice(o,o+n),a=new Array(i.length),l=0;l<i.length;l++)a[l]=i.charCodeAt(l);var c=new Uint8Array(a);r.push(c)}return new Blob(r,{type:t})}})},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!../../common/src/widgets/autosize-text-area.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".autosize-text-area {\n  position: relative; }\n  .autosize-text-area TEXTAREA {\n    width: 100%;\n    resize: vertical; }\n  .autosize-text-area .shadow {\n    position: absolute;\n    top: 0;\n    left: 0;\n    min-height: 1em !important;\n    max-height: 1em !important;\n    visibility: hidden; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!../../common/src/widgets/collapsible-container.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".collapsible-container {\n  transition: height .25s;\n  overflow: hidden; }\n  .collapsible-container .collapsible-contents {\n    overflow: hidden; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!../../common/src/widgets/image-cropper.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".image-cropper {\n  overflow: hidden; }\n  .image-cropper CANVAS, .image-cropper svg {\n    width: 100%;\n    height: auto;\n    display: block; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!../../common/src/widgets/overlay.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".overlay {\n  position: fixed;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  overflow: hidden;\n  z-index: 5000;\n  overscroll-behavior: contain;\n  -ms-scroll-chaining: none; }\n  .overlay .background {\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    background-color: #000;\n    transition: opacity 0.5s; }\n  .overlay .foreground {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 90%;\n    transition: opacity 0.25s, top 0.25s; }\n  .overlay.show .background {\n    opacity: 0.75; }\n  .overlay.show .foreground {\n    opacity: 1; }\n  .overlay.hide .background {\n    opacity: 0; }\n  .overlay.hide .foreground {\n    top: -30px;\n    opacity: 0; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!../../common/src/widgets/smart-list.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".smart-list .slot.transition {\n  overflow: hidden;\n  opacity: 1; }\n  .smart-list .slot.transition.in {\n    transition: height 0.5s ease-out 0.0s, margin-top 0.5s ease-out 0.0s, margin-bottom 0.5s ease-out 0.0s, opacity 0.5s linear 0.2s; }\n  .smart-list .slot.transition.out {\n    transition: height 0.5s ease-in 0.2s, margin-top 0.5s ease-in 0.2s, margin-bottom 0.5s ease-in 0.2s, opacity 0.5s linear 0.0s; }\n  .smart-list .slot.transition.hidden {\n    pointer-events: none;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    opacity: 0;\n    height: 0;\n    margin-top: 0;\n    margin-bottom: 0; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!../../common/src/widgets/upload-progress.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".upload-progress {\n  position: fixed;\n  right: 1em;\n  bottom: 3em;\n  font-size: 1.2em;\n  font-weight: bold;\n  color: #eeeeee;\n  background-color: #aa0000;\n  padding: 0.5em 0.5em 0.5em 0.5em; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./application.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,"* {\n  box-sizing: border-box;\n  font-family: sans-serif; }\n  *:focus {\n    outline-color: #fca326; }\n\nbody {\n  overflow: hidden; }\n\n.application {\n  position: absolute;\n  display: flex;\n  flex-direction: row;\n  top: 0px;\n  left: 0px;\n  right: 0px;\n  bottom: 0px;\n  height: 100%;\n  width: 100%; }\n\n.page-view-port {\n  flex: 3 1 800px;\n  position: relative;\n  background-color: #ffffff; }\n  .page-view-port .scroll-box {\n    position: absolute;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    overflow-y: auto;\n    overflow-y: overlay;\n    overflow-x: hidden;\n    padding: 0 2em 1.5em 2em; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./dialogs/confirmation-dialog-box.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".confirmation-dialog-box {\n  background-color: #006699;\n  color: #ffffff;\n  max-width: 50vw;\n  padding: 1em 1em 1em 1em;\n  box-shadow: 5px 5px 4px #000000; }\n  .confirmation-dialog-box .message {\n    font-size: 1.6em;\n    margin-bottom: 0.5em; }\n  .confirmation-dialog-box .buttons {\n    border-top: 1px solid #ffffff;\n    text-align: right;\n    padding-top: 1em; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./dialogs/image-album-dialog-box.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,'.image-album-dialog-box {\n  display: flex;\n  position: relative;\n  flex-direction: column;\n  background-color: #006699;\n  color: #ffffff;\n  width: 80vw;\n  max-height: 60vh;\n  padding: 1em 1em 1em 1em;\n  box-shadow: 5px 5px 4px #000000; }\n  .image-album-dialog-box .scrollable {\n    flex: 1 1 auto;\n    margin-bottom: 0.5em;\n    min-height: 30vh;\n    text-align: center;\n    overflow: auto; }\n    .image-album-dialog-box .scrollable .picture {\n      display: inline-block;\n      border: 5px solid #ffffff;\n      margin: 0.3em 0.4em 0.3em 0.4em;\n      cursor: pointer; }\n      .image-album-dialog-box .scrollable .picture IMG, .image-album-dialog-box .scrollable .picture CANVAS, .image-album-dialog-box .scrollable .picture svg {\n        display: block; }\n      .image-album-dialog-box .scrollable .picture.selected {\n        border-color: #99ddff; }\n      .image-album-dialog-box .scrollable .picture.deleting {\n        border-color: #ff9999; }\n      .image-album-dialog-box .scrollable .picture.disabled {\n        cursor: wait; }\n  .image-album-dialog-box .buttons {\n    flex: 0 0 auto;\n    border-top: 1px solid #ffffff;\n    padding-top: 0.8em; }\n    .image-album-dialog-box .buttons .left {\n      float: left; }\n    .image-album-dialog-box .buttons .right {\n      float: right; }\n    .image-album-dialog-box .buttons label.push-button {\n      display: inline-block;\n      vertical-align: top;\n      -webkit-user-select: none;\n         -moz-user-select: none;\n          -ms-user-select: none;\n              user-select: none; }\n      .image-album-dialog-box .buttons label.push-button INPUT[type="file"] {\n        position: absolute;\n        z-index: -50000;\n        width: 1px;\n        height: 1px; }\n  .image-album-dialog-box .drop-target {\n    position: absolute;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    border: 4px solid #ffff66;\n    background-color: rgba(255, 255, 102, 0.2); }\n',""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./dialogs/image-cropping-dialog-box.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".image-cropping-dialog-box {\n  display: flex;\n  position: relative;\n  flex-direction: column;\n  background-color: #006699;\n  color: #ffffff;\n  padding: 1em 1em 1em 1em;\n  box-shadow: 5px 5px 4px #000000; }\n  .image-cropping-dialog-box .image {\n    max-width: 80vw;\n    max-height: 80vh;\n    margin-bottom: 0.8em; }\n  .image-cropping-dialog-box .buttons {\n    flex: 0 0 auto;\n    border-top: 1px solid #ffffff;\n    padding-top: 0.8em; }\n    .image-cropping-dialog-box .buttons .left {\n      float: left; }\n    .image-cropping-dialog-box .buttons .right {\n      float: right; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/error-page.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".error-page {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-top: 20vh; }\n  .error-page .text {\n    max-width: 20em;\n    line-height: 135%;\n    margin-left: 1em;\n    margin-right: 1em; }\n    .error-page .text h1 {\n      text-align: center; }\n  .error-page .graphic {\n    margin-left: 1em;\n    margin-right: 1em; }\n    .error-page .graphic svg {\n      width: 100%;\n      max-width: 20em; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/member-list-page.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".member-list-page .buttons {\n  float: right;\n  margin-left: 0.4em; }\n\n.member-list-page .sortable-table #type {\n  width: 10em; }\n\n.member-list-page .sortable-table #roles {\n  width: 10em; }\n\n.member-list-page .sortable-table #range {\n  width: 15em; }\n\n.member-list-page .sortable-table #to_date, .member-list-page .sortable-table #last_month, .member-list-page .sortable-table #this_month {\n  width: 12em; }\n\n.member-list-page .sortable-table #mtime {\n  width: 10em; }\n\n.member-list-page .sortable-table .action-badge {\n  margin-top: 0.35em; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/project-list-page.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".project-list-page .buttons {\n  float: right; }\n\n.project-list-page .sortable-table #users {\n  width: 10em; }\n\n.project-list-page .sortable-table #repos {\n  width: 10em; }\n\n.project-list-page .sortable-table #range {\n  width: 15em; }\n\n.project-list-page .sortable-table #to_date, .project-list-page .sortable-table #last_month, .project-list-page .sortable-table #this_month {\n  width: 10em; }\n\n.project-list-page .sortable-table #mtime {\n  width: 10em; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/project-summary-page.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".project-summary-page .buttons {\n  float: right; }\n\n.project-summary-page .form {\n  float: left;\n  max-width: 40em;\n  min-width: 20em;\n  width: 50%;\n  padding-left: 0.5em;\n  margin-right: 2em; }\n\n.project-summary-page .instructions {\n  padding-top: 1.2em; }\n\n.project-summary-page .statistics {\n  clear: both; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/repo-list-page.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".repo-list-page .buttons {\n  float: right; }\n\n.repo-list-page .sortable-table #type {\n  width: 12em; }\n\n.repo-list-page .sortable-table #server {\n  width: 12em; }\n\n.repo-list-page .sortable-table #issue_tracker {\n  width: 14em; }\n\n.repo-list-page .sortable-table #range {\n  width: 15em; }\n\n.repo-list-page .sortable-table #to_date, .repo-list-page .sortable-table #last_month, .repo-list-page .sortable-table #this_month {\n  width: 12em; }\n\n.repo-list-page .sortable-table #mtime {\n  width: 10em; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/repo-summary-page.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".repo-summary-page .buttons {\n  float: right; }\n\n.repo-summary-page .form {\n  float: left;\n  max-width: 40em;\n  min-width: 20em;\n  width: 50%;\n  padding-left: 0.5em;\n  margin-right: 2em; }\n\n.repo-summary-page .instructions {\n  padding-top: 1.2em; }\n\n.repo-summary-page .statistics {\n  clear: both; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/role-list-page.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".role-list-page .buttons {\n  float: right; }\n\n.role-list-page .sortable-table #mtime {\n  width: 12em; }\n\n.role-list-page .sortable-table #users {\n  width: 10em; }\n\n.role-list-page .sortable-table #mtime {\n  width: 12em; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/role-summary-page.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".role-summary-page .buttons {\n  float: right; }\n\n.role-summary-page .form {\n  float: left;\n  max-width: 40em;\n  min-width: 20em;\n  width: 50%;\n  padding-left: 0.5em;\n  margin-right: 2em; }\n\n.role-summary-page .instructions {\n  padding-top: 1.2em; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/server-list-page.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".server-list-page .buttons {\n  float: right; }\n\n.server-list-page .sortable-table #type {\n  width: 10em; }\n\n.server-list-page .sortable-table #oauth {\n  width: 14em; }\n\n.server-list-page .sortable-table #api {\n  width: 12em; }\n\n.server-list-page .sortable-table #users {\n  width: 10em; }\n\n.server-list-page .sortable-table #mtime {\n  width: 10em; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/server-summary-page.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".server-summary-page .buttons {\n  float: right; }\n\n.server-summary-page .form {\n  float: left;\n  max-width: 40em;\n  min-width: 20em;\n  width: 50%;\n  padding-left: 0.5em;\n  margin-right: 2em; }\n\n.server-summary-page .instructions {\n  padding-top: 1.2em; }\n\n.server-summary-page .task-history {\n  clear: both; }\n\n.server-summary-page .fa-arrow-right {\n  margin-left: 0.3em;\n  margin-right: 0.15em; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/settings-page.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".settings-page .buttons {\n  float: right; }\n\n.settings-page .form {\n  float: left;\n  max-width: 40em;\n  min-width: 20em;\n  width: 50%;\n  padding-left: 0.5em;\n  margin-right: 2em; }\n\n.settings-page .instructions {\n  padding-top: 1.2em; }\n\n.settings-page .option-list .pos {\n  background-color: #000000;\n  color: #eeeeee;\n  display: inline-block;\n  font-size: 0.7em;\n  padding: 0.1em 0.4em 0.1em 0.4em;\n  border-radius: 1em;\n  vertical-align: 0.07em; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/sign-in-page.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".sign-in-page FORM {\n  max-width: 20em; }\n  .sign-in-page FORM .button-row {\n    margin-top: -0.5em;\n    text-align: right; }\n  .sign-in-page FORM .error {\n    color: #cc0000;\n    margin-bottom: 1em; }\n\n.sign-in-page .oauth-button {\n  display: table;\n  border: 1px solid #000000;\n  width: 100%;\n  max-width: 20em;\n  margin-top: 0.5em; }\n  .sign-in-page .oauth-button .icon {\n    width: 2em;\n    display: table-cell;\n    font-size: 2em;\n    padding: 0.26em 0 0.24em 0.25em;\n    text-align: center;\n    vertical-align: middle; }\n  .sign-in-page .oauth-button .label {\n    display: table-cell;\n    font-size: 1.25em;\n    padding-right: 2.5em;\n    text-align: center;\n    vertical-align: middle; }\n  .sign-in-page .oauth-button .error {\n    display: table-cell;\n    padding-left: 1.25em;\n    padding-right: 1.5em;\n    vertical-align: middle; }\n  .sign-in-page .oauth-button:link, .sign-in-page .oauth-button:visited {\n    text-decoration: none;\n    color: #000000; }\n  .sign-in-page .oauth-button.error {\n    border-color: #990000;\n    color: #990000; }\n  .sign-in-page .oauth-button:hover, .sign-in-page .oauth-button:active {\n    background-color: #99ddff;\n    color: #000000; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/start-page.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".start-page {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  -webkit-animation-name: fade-in-out;\n          animation-name: fade-in-out;\n  -webkit-animation-delay: 0.5s;\n          animation-delay: 0.5s;\n  -webkit-animation-duration: 2s;\n          animation-duration: 2s;\n  opacity: 0; }\n\n@-webkit-keyframes fade-in-out {\n  0% {\n    opacity: 0; }\n  75% {\n    opacity: 1; }\n  100% {\n    opacity: 0; } }\n\n@keyframes fade-in-out {\n  0% {\n    opacity: 0; }\n  75% {\n    opacity: 1; }\n  100% {\n    opacity: 0; } }\n  .start-page h2 {\n    font-size: 3em;\n    text-transform: uppercase; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/user-list-page.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".user-list-page .buttons {\n  float: right; }\n\n.user-list-page .sortable-table #username {\n  width: 12em; }\n\n.user-list-page .sortable-table #type {\n  width: 10em; }\n\n.user-list-page .sortable-table #roles {\n  width: 10em; }\n\n.user-list-page .sortable-table #projects {\n  width: 12em; }\n\n.user-list-page .sortable-table #email {\n  width: 12em; }\n\n.user-list-page .sortable-table #mtime {\n  width: 10em; }\n\n.user-list-page .sortable-table .action-badge {\n  margin-top: 0.35em; }\n\n.user-list-page .sortable-table .email {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/user-summary-page.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".user-summary-page .buttons {\n  float: right; }\n\n.user-summary-page .form {\n  float: left;\n  max-width: 40em;\n  min-width: 20em;\n  width: 50%;\n  padding-left: 0.5em;\n  margin-right: 2em; }\n  .user-summary-page .form.social {\n    clear: left; }\n\n.user-summary-page .social-toggle {\n  float: left;\n  clear: left;\n  margin-top: 0;\n  cursor: pointer; }\n  .user-summary-page .social-toggle:hover {\n    color: #004466; }\n\n.user-summary-page .instructions {\n  padding-top: 1.2em; }\n\n.user-summary-page .statistics {\n  clear: both; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./tooltips/activity-tooltip.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".tooltip.activity .window {\n  padding-bottom: 0.2em; }\n\n.tooltip.activity .item {\n  margin-bottom: 2px; }\n\n.tooltip.activity .icon {\n  height: 1.1em;\n  vertical-align: middle;\n  margin-bottom: 0.2em;\n  margin-right: 0.2em; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./tooltips/project-tooltip.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".tooltip.project .item {\n  margin-bottom: 0.2em; }\n\n.tooltip.project .bottom {\n  font-size: 0.9em;\n  text-align: center;\n  border-top: 1px solid #999999;\n  padding-top: 0.2em; }\n  .tooltip.project .bottom A {\n    display: block; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./tooltips/repository-tooltip.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".tooltip.repository .item {\n  margin-bottom: 0.2em; }\n\n.tooltip.repository .bottom {\n  font-size: 0.9em;\n  text-align: center;\n  border-top: 1px solid #999999;\n  padding-top: 0.2em; }\n  .tooltip.repository .bottom A {\n    display: block; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./tooltips/role-tooltip.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".tooltip.role .item {\n  margin-bottom: 0.2em; }\n\n.tooltip.role .bottom {\n  font-size: 0.9em;\n  text-align: center;\n  border-top: 1px solid #999999;\n  padding-top: 0.2em; }\n  .tooltip.role .bottom A {\n    display: block; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./tooltips/user-tooltip.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".tooltip.user .item {\n  margin-bottom: 2px;\n  vertical-align: middle; }\n\n.tooltip.user .ellipsis {\n  text-align: center;\n  color: #999999;\n  padding-bottom: 0.2em; }\n\n.tooltip.user .profile-image {\n  width: 1.5em;\n  height: 1.5em;\n  vertical-align: middle; }\n\n.tooltip.user .bottom {\n  font-size: 0.9em;\n  text-align: center;\n  border-top: 1px solid #999999;\n  padding-top: 0.2em; }\n  .tooltip.user .bottom A {\n    display: block; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/action-badge.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".action-badge {\n  font-size: 0.7em;\n  color: #ffffff;\n  padding: 2px 4px 2px 4px;\n  float: right;\n  text-transform: uppercase;\n  margin-left: 0.1em; }\n  .action-badge .fa {\n    margin-right: 2px; }\n  .action-badge.add {\n    background-color: #009900; }\n  .action-badge.remove {\n    background-color: #cc0000; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/activity-chart.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".activity-chart {\n  margin-bottom: 1em; }\n  .activity-chart h2 {\n    float: left;\n    margin: 0; }\n  .activity-chart .legend {\n    text-align: right;\n    font-size: 0.8em;\n    margin-bottom: 1em;\n    padding-top: 0.25em; }\n    .activity-chart .legend .item {\n      display: inline-block;\n      white-space: nowrap;\n      margin-left: 0.6em;\n      margin-top: 0.25em; }\n      .activity-chart .legend .item .ct-chart-bar {\n        width: 0.8em;\n        height: 0.8em;\n        vertical-align: middle;\n        margin-right: 0.3em; }\n      .activity-chart .legend .item .label {\n        vertical-align: middle; }\n  .activity-chart .scroll-container {\n    width: 100%;\n    display: flex;\n    flex-direction: row-reverse;\n    overflow-y: hidden;\n    overflow-x: auto;\n    clear: both; }\n    .activity-chart .scroll-container .contents {\n      flex: 0 0 auto; }\n  .activity-chart .ct-label.ct-horizontal.ct-end {\n    min-width: 10em;\n    justify-content: flex-start;\n    text-align: left; }\n  .activity-chart .ct-label.ct-vertical.ct-start {\n    justify-content: flex-start;\n    text-align: left; }\n  .activity-chart .ct-line {\n    stroke-linecap: round;\n    stroke-width: 2px; }\n  .activity-chart .ct-grid.ct-horizontal.month-start {\n    stroke: #000000;\n    stroke-width: 1px;\n    stroke-dasharray: none; }\n  .activity-chart .ct-grid.ct-horizontal.today {\n    stroke-width: 1px;\n    stroke-dasharray: none; }\n  .activity-chart .ct-chart svg {\n    margin-bottom: -0.75em; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/chartist.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,'.ct-label {\n  fill: rgba(0, 0, 0, 0.4);\n  color: rgba(0, 0, 0, 0.4);\n  font-size: 0.75rem;\n  line-height: 1; }\n\n.ct-chart-line .ct-label,\n.ct-chart-bar .ct-label {\n  display: block;\n  display: flex; }\n\n.ct-chart-pie .ct-label,\n.ct-chart-donut .ct-label {\n  dominant-baseline: central; }\n\n.ct-label.ct-horizontal.ct-start {\n  align-items: flex-end;\n  justify-content: flex-start;\n  text-align: left;\n  text-anchor: start; }\n\n.ct-label.ct-horizontal.ct-end {\n  align-items: flex-start;\n  justify-content: flex-start;\n  text-align: left;\n  text-anchor: start; }\n\n.ct-label.ct-vertical.ct-start {\n  align-items: flex-end;\n  justify-content: flex-end;\n  text-align: right;\n  text-anchor: end; }\n\n.ct-label.ct-vertical.ct-end {\n  align-items: flex-end;\n  justify-content: flex-start;\n  text-align: left;\n  text-anchor: start; }\n\n.ct-chart-bar .ct-label.ct-horizontal.ct-start {\n  align-items: flex-end;\n  justify-content: center;\n  text-align: center;\n  text-anchor: start; }\n\n.ct-chart-bar .ct-label.ct-horizontal.ct-end {\n  align-items: flex-start;\n  justify-content: center;\n  text-align: center;\n  text-anchor: start; }\n\n.ct-chart-bar.ct-horizontal-bars .ct-label.ct-horizontal.ct-start {\n  align-items: flex-end;\n  justify-content: flex-start;\n  text-align: left;\n  text-anchor: start; }\n\n.ct-chart-bar.ct-horizontal-bars .ct-label.ct-horizontal.ct-end {\n  align-items: flex-start;\n  justify-content: flex-start;\n  text-align: left;\n  text-anchor: start; }\n\n.ct-chart-bar.ct-horizontal-bars .ct-label.ct-vertical.ct-start {\n  align-items: center;\n  justify-content: flex-end;\n  text-align: right;\n  text-anchor: end; }\n\n.ct-chart-bar.ct-horizontal-bars .ct-label.ct-vertical.ct-end {\n  align-items: center;\n  justify-content: flex-start;\n  text-align: left;\n  text-anchor: end; }\n\n.ct-grid {\n  stroke: rgba(0, 0, 0, 0.2);\n  stroke-width: 1px;\n  stroke-dasharray: 2px; }\n\n.ct-grid-background {\n  fill: none; }\n\n.ct-point {\n  stroke-width: 10px;\n  stroke-linecap: round; }\n\n.ct-line {\n  fill: none;\n  stroke-width: 4px; }\n\n.ct-area {\n  stroke: none;\n  fill-opacity: 0.1; }\n\n.ct-bar {\n  fill: none;\n  stroke-width: 10px; }\n\n.ct-slice-donut {\n  fill: none;\n  stroke-width: 60px; }\n\n.ct-series-a .ct-point, .ct-series-a .ct-line, .ct-series-a .ct-bar, .ct-series-a .ct-slice-donut {\n  stroke: #e67300; }\n\n.ct-series-a .ct-slice-pie, .ct-series-a .ct-slice-donut-solid, .ct-series-a .ct-area {\n  fill: #e67300; }\n\n.ct-series-b .ct-point, .ct-series-b .ct-line, .ct-series-b .ct-bar, .ct-series-b .ct-slice-donut {\n  stroke: #a1a112; }\n\n.ct-series-b .ct-slice-pie, .ct-series-b .ct-slice-donut-solid, .ct-series-b .ct-area {\n  fill: #a1a112; }\n\n.ct-series-c .ct-point, .ct-series-c .ct-line, .ct-series-c .ct-bar, .ct-series-c .ct-slice-donut {\n  stroke: #73e600; }\n\n.ct-series-c .ct-slice-pie, .ct-series-c .ct-slice-donut-solid, .ct-series-c .ct-area {\n  fill: #73e600; }\n\n.ct-series-d .ct-point, .ct-series-d .ct-line, .ct-series-d .ct-bar, .ct-series-d .ct-slice-donut {\n  stroke: #0d730d; }\n\n.ct-series-d .ct-slice-pie, .ct-series-d .ct-slice-donut-solid, .ct-series-d .ct-area {\n  fill: #0d730d; }\n\n.ct-series-e .ct-point, .ct-series-e .ct-line, .ct-series-e .ct-bar, .ct-series-e .ct-slice-donut {\n  stroke: #00e673; }\n\n.ct-series-e .ct-slice-pie, .ct-series-e .ct-slice-donut-solid, .ct-series-e .ct-area {\n  fill: #00e673; }\n\n.ct-series-f .ct-point, .ct-series-f .ct-line, .ct-series-f .ct-bar, .ct-series-f .ct-slice-donut {\n  stroke: #12a1a1; }\n\n.ct-series-f .ct-slice-pie, .ct-series-f .ct-slice-donut-solid, .ct-series-f .ct-area {\n  fill: #12a1a1; }\n\n.ct-series-g .ct-point, .ct-series-g .ct-line, .ct-series-g .ct-bar, .ct-series-g .ct-slice-donut {\n  stroke: #0073e6; }\n\n.ct-series-g .ct-slice-pie, .ct-series-g .ct-slice-donut-solid, .ct-series-g .ct-area {\n  fill: #0073e6; }\n\n.ct-series-h .ct-point, .ct-series-h .ct-line, .ct-series-h .ct-bar, .ct-series-h .ct-slice-donut {\n  stroke: #0d0d73; }\n\n.ct-series-h .ct-slice-pie, .ct-series-h .ct-slice-donut-solid, .ct-series-h .ct-area {\n  fill: #0d0d73; }\n\n.ct-series-i .ct-point, .ct-series-i .ct-line, .ct-series-i .ct-bar, .ct-series-i .ct-slice-donut {\n  stroke: #7300e6; }\n\n.ct-series-i .ct-slice-pie, .ct-series-i .ct-slice-donut-solid, .ct-series-i .ct-area {\n  fill: #7300e6; }\n\n.ct-series-j .ct-point, .ct-series-j .ct-line, .ct-series-j .ct-bar, .ct-series-j .ct-slice-donut {\n  stroke: #a112a1; }\n\n.ct-series-j .ct-slice-pie, .ct-series-j .ct-slice-donut-solid, .ct-series-j .ct-area {\n  fill: #a112a1; }\n\n.ct-series-k .ct-point, .ct-series-k .ct-line, .ct-series-k .ct-bar, .ct-series-k .ct-slice-donut {\n  stroke: #e60073; }\n\n.ct-series-k .ct-slice-pie, .ct-series-k .ct-slice-donut-solid, .ct-series-k .ct-area {\n  fill: #e60073; }\n\n.ct-series-l .ct-point, .ct-series-l .ct-line, .ct-series-l .ct-bar, .ct-series-l .ct-slice-donut {\n  stroke: #730d0d; }\n\n.ct-series-l .ct-slice-pie, .ct-series-l .ct-slice-donut-solid, .ct-series-l .ct-area {\n  fill: #730d0d; }\n\n.ct-square {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-square:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 100%; }\n  .ct-square:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-square > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-minor-second {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-minor-second:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 93.75%; }\n  .ct-minor-second:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-minor-second > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-major-second {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-major-second:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 88.88889%; }\n  .ct-major-second:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-major-second > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-minor-third {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-minor-third:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 83.33333%; }\n  .ct-minor-third:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-minor-third > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-major-third {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-major-third:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 80%; }\n  .ct-major-third:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-major-third > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-perfect-fourth {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-perfect-fourth:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 75%; }\n  .ct-perfect-fourth:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-perfect-fourth > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-perfect-fifth {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-perfect-fifth:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 66.66667%; }\n  .ct-perfect-fifth:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-perfect-fifth > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-minor-sixth {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-minor-sixth:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 62.5%; }\n  .ct-minor-sixth:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-minor-sixth > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-golden-section {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-golden-section:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 61.8047%; }\n  .ct-golden-section:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-golden-section > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-major-sixth {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-major-sixth:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 60%; }\n  .ct-major-sixth:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-major-sixth > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-minor-seventh {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-minor-seventh:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 56.25%; }\n  .ct-minor-seventh:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-minor-seventh > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-major-seventh {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-major-seventh:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 53.33333%; }\n  .ct-major-seventh:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-major-seventh > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-octave {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-octave:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 50%; }\n  .ct-octave:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-octave > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-major-tenth {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-major-tenth:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 40%; }\n  .ct-major-tenth:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-major-tenth > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-major-eleventh {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-major-eleventh:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 37.5%; }\n  .ct-major-eleventh:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-major-eleventh > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-major-twelfth {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-major-twelfth:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 33.33333%; }\n  .ct-major-twelfth:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-major-twelfth > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n\n.ct-double-octave {\n  display: block;\n  position: relative;\n  width: 100%; }\n  .ct-double-octave:before {\n    display: block;\n    float: left;\n    content: "";\n    width: 0;\n    height: 0;\n    padding-bottom: 25%; }\n  .ct-double-octave:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .ct-double-octave > svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n',""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/combo-button.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".combo-button {\n  display: inline-block;\n  position: relative; }\n  .combo-button BUTTON {\n    font-size: 1.2em;\n    background-color: #cccccc;\n    border: 2px outset #dddddd;\n    color: #000000; }\n    .combo-button BUTTON.main {\n      padding: 0.14em 0.5em 0.14em 0.5em;\n      border-right: 0; }\n      .combo-button BUTTON.main:active {\n        border-style: inset; }\n    .combo-button BUTTON.side {\n      padding: 0.14em 5px 0.14em 5px;\n      border-left: 1px inset #dddddd; }\n      .combo-button BUTTON.side:active {\n        border-left-width: 2px;\n        padding-left: 4px;\n        border-style: inset; }\n    .combo-button BUTTON.alert {\n      -webkit-animation: blink normal 2.5s infinite ease-in-out;\n              animation: blink normal 2.5s infinite ease-in-out; }\n\n@-webkit-keyframes blink {\n  50% {\n    background-color: #e0e0e0;\n    border-color: #e0e0e0;\n    color: #101010; } }\n\n@keyframes blink {\n  50% {\n    background-color: #e0e0e0;\n    border-color: #e0e0e0;\n    color: #101010; } }\n  .combo-button .container {\n    position: absolute;\n    width: 50vw;\n    right: 0;\n    z-index: 1000;\n    text-align: right; }\n    .combo-button .container .menu {\n      display: inline-block;\n      border: 2px outset #dddddd;\n      padding: 0.5em 0.5em 0.5em 0.5em;\n      background-color: #cccccc;\n      text-align: left; }\n      .combo-button .container .menu .option {\n        cursor: pointer;\n        margin-bottom: 0.5em; }\n        .combo-button .container .menu .option.disabled {\n          color: #aaaaaa;\n          cursor: default; }\n        .combo-button .container .menu .option.separator {\n          border-top: 1px solid #999999;\n          padding-top: 0.5em; }\n        .combo-button .container .menu .option:last-child {\n          margin-bottom: 0; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/image-selector.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,'.image-selector {\n  margin-bottom: 1em;\n  overflow: hidden; }\n  .image-selector label {\n    display: block;\n    font-weight: 600; }\n  .image-selector .contents {\n    margin-top: 4px; }\n    .image-selector .contents .image {\n      float: left;\n      z-index: 1; }\n      .image-selector .contents .image A {\n        display: block; }\n      .image-selector .contents .image IMG, .image-selector .contents .image CANVAS, .image-selector .contents .image svg {\n        height: 120px;\n        width: auto; }\n      .image-selector .contents .image .placeholder {\n        display: block;\n        position: relative;\n        background-color: #eeeeee; }\n        .image-selector .contents .image .placeholder .fa {\n          display: block;\n          position: absolute;\n          font-size: 2em;\n          top: 0;\n          bottom: 0;\n          left: 0;\n          right: 0;\n          margin: auto;\n          height: 1em;\n          width: 1em; }\n    .image-selector .contents .options {\n      margin-left: 0.35em;\n      transition: opacity 1s;\n      z-index: 0;\n      overflow: hidden;\n      display: inline-block; }\n      .image-selector .contents .options .option {\n        display: block;\n        font-weight: normal;\n        padding: 0.25em 0.4em 0.15em 0.4em;\n        cursor: pointer; }\n        .image-selector .contents .options .option INPUT[type="file"] {\n          position: absolute;\n          z-index: -50000;\n          width: 1px;\n          height: 1px; }\n        .image-selector .contents .options .option:hover {\n          background-color: #99ddff; }\n        .image-selector .contents .options .option.disabled {\n          cursor: default;\n          color: #999999; }\n          .image-selector .contents .options .option.disabled:hover {\n            background-color: transparent; }\n  .image-selector.readonly .options {\n    opacity: 0; }\n    .image-selector.readonly .options .option {\n      cursor: default; }\n',""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/input-error.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".input-error {\n  font-weight: normal;\n  float: right;\n  color: #cc0000; }\n  .input-error.warning {\n    color: #cc6600; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/instruction-block.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".instruction-block {\n  transition: opacity 0.5s linear 0.5s;\n  opacity: 1; }\n  .instruction-block .contents {\n    overflow: hidden;\n    padding: 0 1em 0 1em;\n    min-width: 15em;\n    margin-bottom: 1em;\n    background: #99ddff;\n    background: linear-gradient(135deg, transparent 0.6em, #99ddff 0) top left, linear-gradient(225deg, transparent 0.6em, #99ddff 0) top right, linear-gradient(315deg, transparent 0.6em, #99ddff 0) bottom right, linear-gradient(45deg, transparent 0.6em, #99ddff 0) bottom left;\n    background-size: 51% 51%;\n    background-repeat: no-repeat; }\n  .instruction-block .collapsible-container {\n    transition: height 1s;\n    overflow: visible; }\n    .instruction-block .collapsible-container.collapsing {\n      transition: height 1s linear 0.5s;\n      pointer-events: none; }\n  .instruction-block.hidden {\n    opacity: 0;\n    pointer-events: none; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/multilingual-text-field.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".multilingual-text-field {\n  margin-bottom: 1em; }\n  .multilingual-text-field label {\n    display: block;\n    font-weight: 600; }\n  .multilingual-text-field input[type=text],\n  .multilingual-text-field textarea {\n    display: block;\n    width: 100%;\n    transition: border-color 1s ease-out;\n    border: 1px solid #000000;\n    font-size: 1em;\n    margin-top: 2px;\n    margin-bottom: 0;\n    padding: 2px 2px 1px 4px; }\n  .multilingual-text-field textarea {\n    resize: none; }\n  .multilingual-text-field.multiple-languages input[type=text],\n  .multilingual-text-field.multiple-languages textarea {\n    border-bottom: 0;\n    padding-bottom: 2px; }\n  .multilingual-text-field .tabs {\n    display: flex;\n    flex-direction: row;\n    position: relative;\n    background-color: #000000;\n    border: 1px solid #000000;\n    border-top: 0;\n    transition: border-color 1s ease-out; }\n  .multilingual-text-field .tab {\n    flex: 1 1 auto;\n    text-align: center;\n    font-variant: small-caps;\n    color: #ffffff;\n    font-size: 0.8em;\n    padding: 0.25em 0 0.25em 0;\n    transition: font-size 0.25s;\n    cursor: pointer; }\n    .multilingual-text-field .tab.selected {\n      color: #000000;\n      background-size: 100% 100%;\n      background-repeat: no-repeat;\n      background: linear-gradient(45deg, transparent 1.2em, #fff 0) bottom left;\n      cursor: default; }\n      .multilingual-text-field .tab.selected:first-child {\n        background: linear-gradient(315deg, transparent 1.2em, #fff 0) bottom right; }\n  .multilingual-text-field .bubble {\n    position: absolute;\n    left: 0;\n    right: 0;\n    bottom: -3em;\n    z-index: 100; }\n    .multilingual-text-field .bubble .arrow {\n      position: absolute;\n      top: 0;\n      left: 8px;\n      width: 0;\n      height: 0;\n      border: 8px solid transparent;\n      border-bottom-color: #e0e0e0;\n      border-top: 0;\n      margin-left: -8px;\n      margin-top: -8px; }\n    .multilingual-text-field .bubble .box {\n      background: #e0e0e0;\n      box-shadow: 3px 3px 3px 0px rgba(0, 0, 0, 0.5);\n      padding: 6px 4px 4px 4px;\n      margin-left: 1em;\n      margin-right: 1em; }\n  .multilingual-text-field.readonly input[type=text],\n  .multilingual-text-field.readonly textarea {\n    border-color: #ffffff;\n    cursor: text;\n    outline: none; }\n  .multilingual-text-field.readonly .tabs {\n    background-color: #ffffff;\n    border-color: #ffffff; }\n  .multilingual-text-field.readonly .tab {\n    color: #999999; }\n    .multilingual-text-field.readonly .tab .selected {\n      color: #000000; }\n  .multilingual-text-field.collapsed .tab {\n    font-size: 0; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/navigation-tree.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".navigation-tree {\n  position: relative; }\n  .navigation-tree .level1 {\n    font-size: 1.4em;\n    padding-left: 2em;\n    margin-bottom: 0.5em; }\n  .navigation-tree .level2 {\n    font-size: 0.8em;\n    padding-left: 0.5em;\n    margin-top: 0.2em;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap; }\n  .navigation-tree .level3 {\n    font-size: 0.95em;\n    padding-left: 0.6em;\n    margin-top: 0.2em; }\n  .navigation-tree .level4 {\n    font-size: 0.95em;\n    padding-left: 0.5em;\n    margin-top: 0.2em;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap; }\n  .navigation-tree A {\n    cursor: default; }\n    .navigation-tree A:link, .navigation-tree A:visited {\n      color: #ffffff;\n      text-decoration: none;\n      cursor: pointer; }\n      .navigation-tree A:link:hover, .navigation-tree A:visited:hover {\n        color: #99ddff; }\n  .navigation-tree .collapsible-container {\n    transition: height .25s; }\n  .navigation-tree .arrow {\n    position: absolute;\n    font-size: 1.2em;\n    left: 16px;\n    opacity: 1;\n    transition: top 0.5s, opacity 0.8s; }\n    .navigation-tree .arrow .second, .navigation-tree .arrow .third, .navigation-tree .arrow .fourth {\n      position: absolute;\n      transition: left 0.3s; }\n    .navigation-tree .arrow.extending .second, .navigation-tree .arrow.extending .third, .navigation-tree .arrow.extending .fourth {\n      transition: left 0.3s linear 0.3s; }\n    .navigation-tree .arrow.retracting {\n      transition: top 0.5s linear 0.2s, opacity 0.8s linear 0.2s; }\n    .navigation-tree .arrow.zero {\n      visibility: hidden;\n      opacity: 0; }\n    .navigation-tree .arrow.one .second, .navigation-tree .arrow.one .third, .navigation-tree .arrow.one .fourth {\n      left: 0px; }\n    .navigation-tree .arrow.two .second, .navigation-tree .arrow.two .third, .navigation-tree .arrow.two .fourth {\n      left: 0.5em; }\n    .navigation-tree .arrow.three .second {\n      left: 0.5em; }\n    .navigation-tree .arrow.three .third, .navigation-tree .arrow.three .fourth {\n      left: 1em; }\n    .navigation-tree .arrow.four .second {\n      left: 0.5em; }\n    .navigation-tree .arrow.four .third {\n      left: 1em; }\n    .navigation-tree .arrow.four .fourth {\n      left: 1.5em; }\n  .navigation-tree.disabled A {\n    color: #2483b3; }\n  .navigation-tree.disabled .arrow {\n    opacity: 0; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/option-list.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".option-list {\n  margin-bottom: 1em; }\n  .option-list label {\n    display: block;\n    font-weight: 600; }\n  .option-list .container {\n    margin-top: 3px;\n    border: 1px solid #000000;\n    transition: border-color 1s ease-out;\n    max-height: 30em;\n    min-height: 1em;\n    overflow: auto;\n    clear: both; }\n  .option-list .sortable-table TD {\n    padding-left: 4px; }\n  .option-list .badge {\n    float: right;\n    margin-top: 0.1em; }\n    .option-list .badge.add {\n      color: #009900; }\n    .option-list .badge.remove {\n      color: #cc0000; }\n  .option-list.readonly .container {\n    border-color: #ffffff; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/profile-image.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".profile-image.small {\n  width: 1.5em;\n  height: 1.5em;\n  vertical-align: middle; }\n\n.profile-image.large {\n  width: 6em;\n  height: 6em;\n  vertical-align: middle; }\n\nsvg.profile-image {\n  background-color: #999999; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/push-button.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".push-button {\n  font-size: 1.2em;\n  padding: 0.14em 0.5em 0.14em 0.5em;\n  background-color: #cccccc;\n  border: 2px outset #dddddd;\n  color: #000000; }\n  .push-button:disabled {\n    color: #999999; }\n  .push-button.emphasis {\n    color: #ffffff;\n    background-color: #006699;\n    border: 2px outset #0088cc; }\n    .push-button.emphasis:disabled {\n      color: #5c8599; }\n  .push-button.danger {\n    color: #ffffff;\n    background-color: #cc2929;\n    border: 2px outset #ff3333; }\n    .push-button.danger:disabled {\n      color: #cc7a7a; }\n  .push-button:active {\n    border-style: inset; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/side-navigation.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".side-navigation {\n  flex: 1 1 auto;\n  position: relative;\n  color: #fff;\n  background-color: #006699;\n  min-width: 15em;\n  max-width: 20em; }\n  .side-navigation HEADER {\n    cursor: pointer;\n    overflow: hidden;\n    margin-bottom: 1em; }\n  .side-navigation .logo {\n    float: left;\n    margin: 10px 16px 8px 16px;\n    width: 32px;\n    height: 40px; }\n  .side-navigation .app-name {\n    text-transform: uppercase;\n    opacity: 1;\n    transition: opacity 1s ease-out 0.6s; }\n  .side-navigation .navigation-tree {\n    opacity: 1;\n    transition: opacity 1s ease-out 1s; }\n  .side-navigation .bottom-buttons {\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    left: 0;\n    background-color: #005580;\n    transition: bottom 1s linear 1s; }\n    .side-navigation .bottom-buttons .button {\n      position: relative;\n      float: left; }\n      .side-navigation .bottom-buttons .button.country .label {\n        border-left: 1px solid #006699; }\n      .side-navigation .bottom-buttons .button.user {\n        float: right; }\n        .side-navigation .bottom-buttons .button.user .label {\n          border-left: 1px solid #006699; }\n        .side-navigation .bottom-buttons .button.user .window-container {\n          left: auto;\n          right: 0.1em; }\n      .side-navigation .bottom-buttons .button .tooltip .label {\n        display: inline-block;\n        color: #0077b3;\n        padding: 0.4em 0.5em 0.3em 0.5em; }\n      .side-navigation .bottom-buttons .button .tooltip.live .label {\n        cursor: pointer; }\n        .side-navigation .bottom-buttons .button .tooltip.live .label:hover {\n          color: #99ddff; }\n      .side-navigation .bottom-buttons .button .tooltip .item {\n        color: #777777;\n        margin-top: 0.25em;\n        margin-right: 0.25em;\n        cursor: pointer; }\n        .side-navigation .bottom-buttons .button .tooltip .item .fa {\n          visibility: hidden; }\n        .side-navigation .bottom-buttons .button .tooltip .item.selected {\n          cursor: default;\n          color: #0077b3; }\n          .side-navigation .bottom-buttons .button .tooltip .item.selected .fa {\n            visibility: visible; }\n  .side-navigation.hidden .app-name, .side-navigation.hidden .navigation-tree {\n    opacity: 0; }\n  .side-navigation.hidden .bottom-buttons {\n    bottom: -2em; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/sign-off-menu.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".sign-off-menu {\n  text-align: center;\n  padding-top: 0.25em;\n  min-width: 5em; }\n  .sign-off-menu A {\n    display: block;\n    cursor: pointer; }\n    .sign-off-menu A:link, .sign-off-menu A:visited {\n      color: #777777;\n      text-decoration: none; }\n    .sign-off-menu A:hover {\n      color: #004466; }\n  .sign-off-menu .name {\n    padding: 0.5em 0.25em 0.25em 0.25em;\n    text-align: center; }\n  .sign-off-menu .sign-off {\n    text-align: center;\n    padding: 0.5em 0.25em 0 0.25em;\n    border-top: 1px solid #dddddd;\n    color: #777777;\n    cursor: pointer; }\n    .sign-off-menu .sign-off:hover {\n      color: #004466; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/sortable-table.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".sortable-table {\n  width: 100%;\n  border-collapse: collapse;\n  table-layout: fixed; }\n  .sortable-table TH {\n    text-align: left;\n    cursor: pointer;\n    border-bottom: 1px solid #000000;\n    border-top: 1px solid #000000;\n    padding: 0.2em 0.4em 0.1em 0.4em; }\n    .sortable-table TH .arrow {\n      display: none;\n      margin-left: 0.5em; }\n  .sortable-table TH.asc .arrow.down {\n    display: inline; }\n  .sortable-table TH.desc .arrow.up {\n    display: inline; }\n  .sortable-table TBODY TD {\n    padding: 0.3em 0.4em 0.2em 0.4em;\n    word-wrap: break-word;\n    transition: padding-top 0.5s, padding-bottom 0.5s; }\n  .sortable-table TBODY TR {\n    background-color: #ffffff;\n    transition: background-color 0.5s, opacity 0.5s; }\n    .sortable-table TBODY TR.pending {\n      opacity: 0.5 !important; }\n    .sortable-table TBODY TR.disabled {\n      opacity: 0.3 !important; }\n    .sortable-table TBODY TR.deleted {\n      opacity: 0.15 !important; }\n  .sortable-table TBODY TR:nth-child(even) {\n    background-color: #eeeeee; }\n  .sortable-table .collapsible-container {\n    transition: height 0.5s; }\n  .sortable-table A:link, .sortable-table A:visited {\n    color: #000000;\n    text-decoration: none; }\n    .sortable-table A:link:hover, .sortable-table A:visited:hover {\n      color: #004466; }\n  .sortable-table.expandable TBODY TR {\n    background-color: #ffffff; }\n    .sortable-table.expandable TBODY TR.collapsed {\n      opacity: 0; }\n      .sortable-table.expandable TBODY TR.collapsed TD {\n        padding-top: 0;\n        padding-bottom: 0; }\n    .sortable-table.expandable TBODY TR.expanded {\n      opacity: 1; }\n      .sortable-table.expandable TBODY TR.expanded TD {\n        padding-top: 0.3em;\n        padding-bottom: 0.2em; }\n  .sortable-table.selectable TBODY TR {\n    cursor: pointer; }\n    .sortable-table.selectable TBODY TR.selected {\n      background-color: #99ddff;\n      opacity: 1 !important; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/task-alert-bar.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".task-alert-bar {\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: #005580;\n  padding: 0.4em 0.5em 0.3em 0.5em;\n  border-left: 1px solid #006699;\n  text-align: right;\n  transition: bottom 0.4s; }\n  .task-alert-bar .progress-bar-frame {\n    display: inline-block;\n    width: 10em;\n    border: 1px solid #0077b3;\n    margin-left: 0.5em; }\n    .task-alert-bar .progress-bar-frame .bar {\n      background-color: #0077b3;\n      height: 0.6em; }\n  .task-alert-bar.hidden {\n    bottom: -1.8em; }\n  .task-alert-bar A {\n    color: #0077b3; }\n    .task-alert-bar A:link, .task-alert-bar A:visited {\n      text-decoration: none; }\n    .task-alert-bar A:hover {\n      color: #99ddff; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/task-list.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".task-list {\n  max-height: 25em;\n  overflow-y: auto;\n  padding: 0 0.5em 0 0.5em;\n  margin-bottom: 1em; }\n  .task-list .task {\n    clear: both;\n    padding: 0.25em 0.25em 0.2em 0.25em;\n    overflow: hidden; }\n    .task-list .task .summary {\n      cursor: pointer; }\n    .task-list .task .start-time {\n      float: left;\n      margin-right: 1em; }\n    .task-list .task .message {\n      float: left;\n      margin-right: 1em; }\n      .task-list .task .message .fa {\n        margin-left: 0.5em; }\n    .task-list .task .duration {\n      display: inline-block;\n      float: right;\n      margin-left: 1em; }\n    .task-list .task .progress-bar-frame {\n      display: inline-block;\n      float: right;\n      width: 7em;\n      border: 1px solid #000000;\n      margin-top: 0.2em;\n      margin-left: 0.5em; }\n      .task-list .task .progress-bar-frame .bar {\n        background-color: #0077b3;\n        height: 0.6em; }\n    .task-list .task.expanded {\n      background: #99ddff; }\n    .task-list .task .details {\n      clear: both;\n      margin-top: 0.25em;\n      padding-top: 0.25em; }\n      .task-list .task .details .item {\n        display: inline-block;\n        color: #000000;\n        max-width: 8em;\n        padding: 0.15em 0.5em 0.15em 0.5em;\n        margin-right: 0.3em;\n        text-align: center;\n        text-overflow: ellipsis;\n        border: 1px solid black;\n        overflow: hidden;\n        white-space: nowrap; }\n        .task-list .task .details .item.added {\n          background-color: #99ee66; }\n        .task-list .task .details .item.deleted {\n          background-color: #ee3333; }\n        .task-list .task .details .item.modified {\n          background-color: #66aaff; }\n    .task-list .task .error {\n      font-size: 0.8em;\n      clear: both;\n      white-space: pre-wrap;\n      padding-top: 0.35em;\n      padding-bottom: 0.35em;\n      border-top: 1px solid #551111; }\n    .task-list .task.failure {\n      color: #551111; }\n      .task-list .task.failure .progress-bar-frame {\n        border-color: #551111; }\n        .task-list .task.failure .progress-bar-frame .bar {\n          background-color: #ff6666; }\n      .task-list .task.failure .details {\n        border-top-color: #551111; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/text-field.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".text-field {\n  margin-bottom: 1em; }\n  .text-field label {\n    display: block;\n    font-weight: 600; }\n  .text-field input[type=text],\n  .text-field input[type=password],\n  .text-field input[type=email],\n  .text-field textarea {\n    display: block;\n    width: 100%;\n    transition: border-color 1s ease-out;\n    border: 1px solid #000000;\n    font-size: 1em;\n    margin-top: 2px;\n    padding: 2px 2px 1px 4px; }\n  .text-field textarea {\n    resize: none; }\n  .text-field.readonly input[type=text],\n  .text-field.readonly input[type=password],\n  .text-field.readonly input[type=email],\n  .text-field.readonly textarea {\n    border-color: #ffffff;\n    cursor: text;\n    outline: none; }\n",""])},'../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/tooltip.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!1),t.push([e.i,".tooltip {\n  position: relative;\n  display: inline-block; }\n  .tooltip.live .label {\n    cursor: pointer; }\n  .tooltip .window-container {\n    position: absolute;\n    top: 100%;\n    left: 0.5em;\n    width: 50vw;\n    z-index: 100;\n    margin-top: 0.2em; }\n  .tooltip.upward .window-container {\n    top: auto;\n    bottom: 100%;\n    margin-bottom: 0.2em; }\n  .tooltip.leftward .window-container {\n    left: auto;\n    right: 0.3em; }\n    .tooltip.leftward .window-container .window {\n      float: right; }\n  .tooltip .window {\n    display: inline-block;\n    padding: 0.4em 0.5em 0.4em 0.5em;\n    border: 1px solid black;\n    background-color: #ffffff;\n    box-shadow: 1px 1px 3px 0px rgba(0, 0, 0, 0.75); }\n",""])},"../node_modules/d/auto-bind.js":function(e,t,n){"use strict";var s,r=n("../node_modules/es5-ext/object/copy.js"),o=n("../node_modules/es5-ext/object/normalize-options.js"),i=n("../node_modules/es5-ext/object/valid-callable.js"),a=n("../node_modules/es5-ext/object/map.js"),l=n("../node_modules/es5-ext/object/valid-callable.js"),c=n("../node_modules/es5-ext/object/valid-value.js"),d=Function.prototype.bind,u=Object.defineProperty,p=Object.prototype.hasOwnProperty;s=function(e,t,n){var s,o=c(t)&&l(t.value);return s=r(t),delete s.writable,delete s.value,s.get=function(){return!n.overwriteDefinition&&p.call(this,e)?o:(t.value=d.call(o,n.resolveContext?n.resolveContext(this):this),u(this,e,t),this[e])},s},e.exports=function(e){var t=o(arguments[1]);return null!=t.resolveContext&&i(t.resolveContext),a(e,function(e,n){return s(n,e,t)})}},"../node_modules/d/index.js":function(e,t,n){"use strict";var s,r=n("../node_modules/es5-ext/object/assign/index.js"),o=n("../node_modules/es5-ext/object/normalize-options.js"),i=n("../node_modules/es5-ext/object/is-callable.js"),a=n("../node_modules/es5-ext/string/#/contains/index.js");s=e.exports=function(e,t){var n,s,i,l,c;return arguments.length<2||"string"!=typeof e?(l=t,t=e,e=null):l=arguments[2],null==e?(n=i=!0,s=!1):(n=a.call(e,"c"),s=a.call(e,"e"),i=a.call(e,"w")),c={value:t,configurable:n,enumerable:s,writable:i},l?r(o(l),c):c},s.gs=function(e,t,n){var s,l,c,d;return"string"!=typeof e?(c=n,n=t,t=e,e=null):c=arguments[3],null==t?t=void 0:i(t)?null==n?n=void 0:i(n)||(c=n,n=void 0):(c=t,t=n=void 0),null==e?(s=!0,l=!1):(s=a.call(e,"c"),l=a.call(e,"e")),d={get:t,set:n,configurable:s,enumerable:l},c?r(o(c),d):d}},"../node_modules/es5-ext/array/#/clear.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/valid-value.js");e.exports=function(){return s(this).length=0,this}},"../node_modules/es5-ext/array/#/e-index-of.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/number/is-nan/index.js"),r=n("../node_modules/es5-ext/number/to-pos-integer.js"),o=n("../node_modules/es5-ext/object/valid-value.js"),i=Array.prototype.indexOf,a=Object.prototype.hasOwnProperty,l=Math.abs,c=Math.floor;e.exports=function(e){var t,n,d,u;if(!s(e))return i.apply(this,arguments);for(n=r(o(this).length),d=arguments[1],d=isNaN(d)?0:d>=0?c(d):r(this.length)-c(l(d)),t=d;t<n;++t)if(a.call(this,t)&&(u=this[t],s(u)))return t;return-1}},"../node_modules/es5-ext/array/from/index.js":function(e,t,n){"use strict";e.exports=n("../node_modules/es5-ext/array/from/is-implemented.js")()?Array.from:n("../node_modules/es5-ext/array/from/shim.js")},"../node_modules/es5-ext/array/from/is-implemented.js":function(e,t,n){"use strict";e.exports=function(){var e,t,n=Array.from;return"function"==typeof n&&(e=["raz","dwa"],t=n(e),Boolean(t&&t!==e&&"dwa"===t[1]))}},"../node_modules/es5-ext/array/from/shim.js":function(e,t,n){"use strict";var s=n("../node_modules/es6-symbol/index.js").iterator,r=n("../node_modules/es5-ext/function/is-arguments.js"),o=n("../node_modules/es5-ext/function/is-function.js"),i=n("../node_modules/es5-ext/number/to-pos-integer.js"),a=n("../node_modules/es5-ext/object/valid-callable.js"),l=n("../node_modules/es5-ext/object/valid-value.js"),c=n("../node_modules/es5-ext/object/is-value.js"),d=n("../node_modules/es5-ext/string/is-string.js"),u=Array.isArray,p=Function.prototype.call,m={configurable:!0,enumerable:!0,writable:!0,value:null},h=Object.defineProperty;e.exports=function(e){var t,n,f,g,v,b,y,j,x,w,_=arguments[1],E=arguments[2];if(e=Object(l(e)),c(_)&&a(_),this&&this!==Array&&o(this))t=this;else{if(!_){if(r(e))return 1!==(v=e.length)?Array.apply(null,e):(g=new Array(1),g[0]=e[0],g);if(u(e)){for(g=new Array(v=e.length),n=0;n<v;++n)g[n]=e[n];return g}}g=[]}if(!u(e))if(void 0!==(x=e[s])){for(y=a(x).call(e),t&&(g=new t),j=y.next(),n=0;!j.done;)w=_?p.call(_,E,j.value,n):j.value,t?(m.value=w,h(g,n,m)):g[n]=w,j=y.next(),++n;v=n}else if(d(e)){for(v=e.length,t&&(g=new t),n=0,f=0;n<v;++n)w=e[n],n+1<v&&(b=w.charCodeAt(0))>=55296&&b<=56319&&(w+=e[++n]),w=_?p.call(_,E,w,f):w,t?(m.value=w,h(g,f,m)):g[f]=w,++f;v=f}if(void 0===v)for(v=i(e.length),t&&(g=new t(v)),n=0;n<v;++n)w=_?p.call(_,E,e[n],n):e[n],t?(m.value=w,h(g,n,m)):g[n]=w;return t&&(m.value=null,g.length=v),g}},"../node_modules/es5-ext/array/to-array.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/array/from/index.js"),r=Array.isArray;e.exports=function(e){return r(e)?e:s(e)}},"../node_modules/es5-ext/error/custom.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/assign/index.js"),r=n("../node_modules/es5-ext/object/is-object.js"),o=n("../node_modules/es5-ext/object/is-value.js"),i=Error.captureStackTrace;t=e.exports=function(e){var n=new Error(e),a=arguments[1],l=arguments[2];return o(l)||r(a)&&(l=a,a=null),o(l)&&s(n,l),o(a)&&(n.code=a),i&&i(n,t),n}},"../node_modules/es5-ext/function/#/partial.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/valid-callable.js"),r=n("../node_modules/es5-ext/array/from/index.js"),o=n("../node_modules/es5-ext/function/_define-length.js"),i=Function.prototype.apply;e.exports=function(){var e=s(this),t=r(arguments);return o(function(){return i.call(e,this,t.concat(r(arguments)))},e.length-t.length)}},"../node_modules/es5-ext/function/_define-length.js":function(e,t,n){"use strict";var s,r,o,i,a=n("../node_modules/es5-ext/number/to-pos-integer.js"),l=function(e,t){return t};try{Object.defineProperty(l,"length",{configurable:!0,writable:!1,enumerable:!1,value:1})}catch(e){}1===l.length?(s={configurable:!0,writable:!1,enumerable:!1},r=Object.defineProperty,e.exports=function(e,t){return t=a(t),e.length===t?e:(s.value=t,r(e,"length",s))}):(i=n("../node_modules/es5-ext/object/mixin.js"),o=function(){var e=[];return function(t){var n,s=0;if(e[t])return e[t];for(n=[];t--;)n.push("a"+(++s).toString(36));return new Function("fn","return function ("+n.join(", ")+") { return fn.apply(this, arguments); };")}}(),e.exports=function(e,t){var n;if(t=a(t),e.length===t)return e;n=o(t)(e);try{i(n,e)}catch(e){}return n})},"../node_modules/es5-ext/function/is-arguments.js":function(e,t,n){"use strict";var s=Object.prototype.toString,r=s.call(function(){return arguments}());e.exports=function(e){return s.call(e)===r}},"../node_modules/es5-ext/function/is-function.js":function(e,t,n){"use strict";var s=Object.prototype.toString,r=s.call(n("../node_modules/es5-ext/function/noop.js"));e.exports=function(e){return"function"==typeof e&&s.call(e)===r}},"../node_modules/es5-ext/function/noop.js":function(e,t,n){"use strict";e.exports=function(){}},"../node_modules/es5-ext/math/sign/index.js":function(e,t,n){"use strict";e.exports=n("../node_modules/es5-ext/math/sign/is-implemented.js")()?Math.sign:n("../node_modules/es5-ext/math/sign/shim.js")},"../node_modules/es5-ext/math/sign/is-implemented.js":function(e,t,n){"use strict";e.exports=function(){var e=Math.sign;return"function"==typeof e&&(1===e(10)&&-1===e(-20))}},"../node_modules/es5-ext/math/sign/shim.js":function(e,t,n){"use strict";e.exports=function(e){return e=Number(e),isNaN(e)||0===e?e:e>0?1:-1}},"../node_modules/es5-ext/number/is-nan/index.js":function(e,t,n){"use strict";e.exports=n("../node_modules/es5-ext/number/is-nan/is-implemented.js")()?Number.isNaN:n("../node_modules/es5-ext/number/is-nan/shim.js")},"../node_modules/es5-ext/number/is-nan/is-implemented.js":function(e,t,n){"use strict";e.exports=function(){var e=Number.isNaN;return"function"==typeof e&&(!e({})&&e(NaN)&&!e(34))}},"../node_modules/es5-ext/number/is-nan/shim.js":function(e,t,n){"use strict";e.exports=function(e){return e!==e}},"../node_modules/es5-ext/number/to-integer.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/math/sign/index.js"),r=Math.abs,o=Math.floor;e.exports=function(e){return isNaN(e)?0:(e=Number(e),0!==e&&isFinite(e)?s(e)*o(r(e)):e)}},"../node_modules/es5-ext/number/to-pos-integer.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/number/to-integer.js"),r=Math.max;e.exports=function(e){return r(0,s(e))}},"../node_modules/es5-ext/object/_iterate.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/valid-callable.js"),r=n("../node_modules/es5-ext/object/valid-value.js"),o=Function.prototype.bind,i=Function.prototype.call,a=Object.keys,l=Object.prototype.propertyIsEnumerable;e.exports=function(e,t){return function(n,c){var d,u=arguments[2],p=arguments[3];return n=Object(r(n)),s(c),d=a(n),p&&d.sort("function"==typeof p?o.call(p,n):void 0),"function"!=typeof e&&(e=d[e]),i.call(e,d,function(e,s){return l.call(n,e)?i.call(c,u,n[e],e,n,s):t})}}},"../node_modules/es5-ext/object/assign/index.js":function(e,t,n){"use strict";e.exports=n("../node_modules/es5-ext/object/assign/is-implemented.js")()?Object.assign:n("../node_modules/es5-ext/object/assign/shim.js")},"../node_modules/es5-ext/object/assign/is-implemented.js":function(e,t,n){"use strict";e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(e={foo:"raz"},t(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},"../node_modules/es5-ext/object/assign/shim.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/keys/index.js"),r=n("../node_modules/es5-ext/object/valid-value.js"),o=Math.max;e.exports=function(e,t){var n,i,a,l=o(arguments.length,2);for(e=Object(r(e)),a=function(s){try{e[s]=t[s]}catch(e){n||(n=e)}},i=1;i<l;++i)t=arguments[i],s(t).forEach(a);if(void 0!==n)throw n;return e}},"../node_modules/es5-ext/object/copy.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/array/from/index.js"),r=n("../node_modules/es5-ext/object/assign/index.js"),o=n("../node_modules/es5-ext/object/valid-value.js");e.exports=function(e){var t=Object(o(e)),n=arguments[1],i=Object(arguments[2]);if(t!==e&&!n)return t;var a={};return n?s(n,function(t){(i.ensure||t in e)&&(a[t]=e[t])}):r(a,e),a}},"../node_modules/es5-ext/object/create.js":function(e,t,n){"use strict";var s,r=Object.create;n("../node_modules/es5-ext/object/set-prototype-of/is-implemented.js")()||(s=n("../node_modules/es5-ext/object/set-prototype-of/shim.js")),e.exports=function(){var e,t,n;return s?1!==s.level?r:(e={},t={},n={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(e){if("__proto__"===e)return void(t[e]={configurable:!0,enumerable:!1,writable:!0,value:void 0});t[e]=n}),Object.defineProperties(e,t),Object.defineProperty(s,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:e}),function(t,n){return r(null===t?e:t,n)}):r}()},"../node_modules/es5-ext/object/for-each.js":function(e,t,n){"use strict";e.exports=n("../node_modules/es5-ext/object/_iterate.js")("forEach")},"../node_modules/es5-ext/object/is-callable.js":function(e,t,n){"use strict";e.exports=function(e){return"function"==typeof e}},"../node_modules/es5-ext/object/is-object.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/is-value.js"),r={function:!0,object:!0};e.exports=function(e){return s(e)&&r[typeof e]||!1}},"../node_modules/es5-ext/object/is-value.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/function/noop.js")();e.exports=function(e){return e!==s&&null!==e}},"../node_modules/es5-ext/object/keys/index.js":function(e,t,n){"use strict";e.exports=n("../node_modules/es5-ext/object/keys/is-implemented.js")()?Object.keys:n("../node_modules/es5-ext/object/keys/shim.js")},"../node_modules/es5-ext/object/keys/is-implemented.js":function(e,t,n){"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},"../node_modules/es5-ext/object/keys/shim.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/is-value.js"),r=Object.keys;e.exports=function(e){return r(s(e)?Object(e):e)}},"../node_modules/es5-ext/object/map.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/valid-callable.js"),r=n("../node_modules/es5-ext/object/for-each.js"),o=Function.prototype.call;e.exports=function(e,t){var n={},i=arguments[2];return s(t),r(e,function(e,s,r,a){n[s]=o.call(t,i,e,s,r,a)}),n}},"../node_modules/es5-ext/object/mixin.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/valid-value.js"),r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,a=Object.getOwnPropertySymbols;e.exports=function(e,t){var n,l=Object(s(t));if(e=Object(s(e)),i(l).forEach(function(s){try{r(e,s,o(t,s))}catch(e){n=e}}),"function"==typeof a&&a(l).forEach(function(s){try{r(e,s,o(t,s))}catch(e){n=e}}),void 0!==n)throw n;return e}},"../node_modules/es5-ext/object/normalize-options.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/is-value.js"),r=Array.prototype.forEach,o=Object.create,i=function(e,t){var n;for(n in e)t[n]=e[n]};e.exports=function(e){var t=o(null);return r.call(arguments,function(e){s(e)&&i(Object(e),t)}),t}},"../node_modules/es5-ext/object/primitive-set.js":function(e,t,n){"use strict";var s=Array.prototype.forEach,r=Object.create;e.exports=function(e){var t=r(null);return s.call(arguments,function(e){t[e]=!0}),t}},"../node_modules/es5-ext/object/set-prototype-of/index.js":function(e,t,n){"use strict";e.exports=n("../node_modules/es5-ext/object/set-prototype-of/is-implemented.js")()?Object.setPrototypeOf:n("../node_modules/es5-ext/object/set-prototype-of/shim.js")},"../node_modules/es5-ext/object/set-prototype-of/is-implemented.js":function(e,t,n){"use strict";var s=Object.create,r=Object.getPrototypeOf,o={};e.exports=function(){var e=Object.setPrototypeOf,t=arguments[0]||s;return"function"==typeof e&&r(e(t(null),o))===o}},"../node_modules/es5-ext/object/set-prototype-of/shim.js":function(e,t,n){"use strict";var s,r=n("../node_modules/es5-ext/object/is-object.js"),o=n("../node_modules/es5-ext/object/valid-value.js"),i=Object.prototype.isPrototypeOf,a=Object.defineProperty,l={configurable:!0,enumerable:!1,writable:!0,value:void 0};s=function(e,t){if(o(e),null===t||r(t))return e;throw new TypeError("Prototype must be null or an object")},e.exports=function(e){var t,n;return e?(2===e.level?e.set?(n=e.set,t=function(e,t){return n.call(s(e,t),t),e}):t=function(e,t){return s(e,t).__proto__=t,e}:t=function e(t,n){var r;return s(t,n),r=i.call(e.nullPolyfill,t),r&&delete e.nullPolyfill.__proto__,null===n&&(n=e.nullPolyfill),t.__proto__=n,r&&a(e.nullPolyfill,"__proto__",l),t},Object.defineProperty(t,"level",{configurable:!1,enumerable:!1,writable:!1,value:e.level})):null}(function(){var e,t=Object.create(null),n={},s=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(s){try{e=s.set,e.call(t,n)}catch(e){}if(Object.getPrototypeOf(t)===n)return{set:e,level:2}}return t.__proto__=n,Object.getPrototypeOf(t)===n?{level:2}:(t={},t.__proto__=n,Object.getPrototypeOf(t)===n&&{level:1})}()),n("../node_modules/es5-ext/object/create.js")},"../node_modules/es5-ext/object/valid-callable.js":function(e,t,n){"use strict";e.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},"../node_modules/es5-ext/object/valid-object.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/is-object.js");e.exports=function(e){if(!s(e))throw new TypeError(e+" is not an Object");return e}},"../node_modules/es5-ext/object/valid-value.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/is-value.js");e.exports=function(e){if(!s(e))throw new TypeError("Cannot use null or undefined");return e}},"../node_modules/es5-ext/object/validate-stringifiable-value.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/valid-value.js"),r=n("../node_modules/es5-ext/object/validate-stringifiable.js");e.exports=function(e){return r(s(e))}},"../node_modules/es5-ext/object/validate-stringifiable.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/is-callable.js");e.exports=function(e){try{return e&&s(e.toString)?e.toString():String(e)}catch(e){throw new TypeError("Passed argument cannot be stringifed")}}},"../node_modules/es5-ext/safe-to-string.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/is-callable.js");e.exports=function(e){try{return e&&s(e.toString)?e.toString():String(e)}catch(e){return"[Non-coercible (to string) value]"}}},"../node_modules/es5-ext/string/#/contains/index.js":function(e,t,n){"use strict";e.exports=n("../node_modules/es5-ext/string/#/contains/is-implemented.js")()?String.prototype.contains:n("../node_modules/es5-ext/string/#/contains/shim.js")},"../node_modules/es5-ext/string/#/contains/is-implemented.js":function(e,t,n){"use strict";var s="razdwatrzy";e.exports=function(){return"function"==typeof s.contains&&(!0===s.contains("dwa")&&!1===s.contains("foo"))}},"../node_modules/es5-ext/string/#/contains/shim.js":function(e,t,n){"use strict";var s=String.prototype.indexOf;e.exports=function(e){return s.call(this,e,arguments[1])>-1}},"../node_modules/es5-ext/string/is-string.js":function(e,t,n){"use strict";var s=Object.prototype.toString,r=s.call("");e.exports=function(e){return"string"==typeof e||e&&"object"==typeof e&&(e instanceof String||s.call(e)===r)||!1}},"../node_modules/es5-ext/string/random-uniq.js":function(e,t,n){"use strict";var s=Object.create(null),r=Math.random;e.exports=function(){var e;do{e=r().toString(36).slice(2)}while(s[e]);return e}},"../node_modules/es5-ext/to-short-string-representation.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/safe-to-string.js"),r=/[\n\r\u2028\u2029]/g;e.exports=function(e){var t=s(e);return t.length>100&&(t=t.slice(0,99)+""),t=t.replace(r,function(e){return JSON.stringify(e).slice(1,-1)})}},"../node_modules/es6-iterator/array.js":function(e,t,n){"use strict";var s,r=n("../node_modules/es5-ext/object/set-prototype-of/index.js"),o=n("../node_modules/es5-ext/string/#/contains/index.js"),i=n("../node_modules/d/index.js"),a=n("../node_modules/es6-symbol/index.js"),l=n("../node_modules/es6-iterator/index.js"),c=Object.defineProperty;s=e.exports=function(e,t){if(!(this instanceof s))throw new TypeError("Constructor requires 'new'");l.call(this,e),t=t?o.call(t,"key+value")?"key+value":o.call(t,"key")?"key":"value":"value",c(this,"__kind__",i("",t))},r&&r(s,l),delete s.prototype.constructor,s.prototype=Object.create(l.prototype,{_resolve:i(function(e){return"value"===this.__kind__?this.__list__[e]:"key+value"===this.__kind__?[e,this.__list__[e]]:e})}),c(s.prototype,a.toStringTag,i("c","Array Iterator"))},"../node_modules/es6-iterator/for-of.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/function/is-arguments.js"),r=n("../node_modules/es5-ext/object/valid-callable.js"),o=n("../node_modules/es5-ext/string/is-string.js"),i=n("../node_modules/es6-iterator/get.js"),a=Array.isArray,l=Function.prototype.call,c=Array.prototype.some;e.exports=function(e,t){var n,d,u,p,m,h,f,g,v=arguments[2];if(a(e)||s(e)?n="array":o(e)?n="string":e=i(e),r(t),u=function(){p=!0},"array"===n)return void c.call(e,function(e){return l.call(t,v,e,u),p});if("string"!==n)for(d=e.next();!d.done;){if(l.call(t,v,d.value,u),p)return;d=e.next()}else for(h=e.length,m=0;m<h&&(f=e[m],m+1<h&&(g=f.charCodeAt(0))>=55296&&g<=56319&&(f+=e[++m]),l.call(t,v,f,u),!p);++m);}},"../node_modules/es6-iterator/get.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/function/is-arguments.js"),r=n("../node_modules/es5-ext/string/is-string.js"),o=n("../node_modules/es6-iterator/array.js"),i=n("../node_modules/es6-iterator/string.js"),a=n("../node_modules/es6-iterator/valid-iterable.js"),l=n("../node_modules/es6-symbol/index.js").iterator;e.exports=function(e){return"function"==typeof a(e)[l]?e[l]():s(e)?new o(e):r(e)?new i(e):new o(e)}},"../node_modules/es6-iterator/index.js":function(e,t,n){"use strict";var s,r=n("../node_modules/es5-ext/array/#/clear.js"),o=n("../node_modules/es5-ext/object/assign/index.js"),i=n("../node_modules/es5-ext/object/valid-callable.js"),a=n("../node_modules/es5-ext/object/valid-value.js"),l=n("../node_modules/d/index.js"),c=n("../node_modules/d/auto-bind.js"),d=n("../node_modules/es6-symbol/index.js"),u=Object.defineProperty,p=Object.defineProperties;e.exports=s=function(e,t){if(!(this instanceof s))throw new TypeError("Constructor requires 'new'");p(this,{__list__:l("w",a(e)),__context__:l("w",t),__nextIndex__:l("w",0)}),t&&(i(t.on),t.on("_add",this._onAdd),t.on("_delete",this._onDelete),t.on("_clear",this._onClear))},delete s.prototype.constructor,p(s.prototype,o({_next:l(function(){var e;if(this.__list__)return this.__redo__&&void 0!==(e=this.__redo__.shift())?e:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:l(function(){return this._createResult(this._next())}),_createResult:l(function(e){return void 0===e?{done:!0,value:void 0}:{done:!1,value:this._resolve(e)}}),_resolve:l(function(e){return this.__list__[e]}),_unBind:l(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:l(function(){return"[object "+(this[d.toStringTag]||"Object")+"]"})},c({_onAdd:l(function(e){if(!(e>=this.__nextIndex__)){if(++this.__nextIndex__,!this.__redo__)return void u(this,"__redo__",l("c",[e]));this.__redo__.forEach(function(t,n){t>=e&&(this.__redo__[n]=++t)},this),this.__redo__.push(e)}}),_onDelete:l(function(e){var t;e>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(t=this.__redo__.indexOf(e),-1!==t&&this.__redo__.splice(t,1),this.__redo__.forEach(function(t,n){t>e&&(this.__redo__[n]=--t)},this)))}),_onClear:l(function(){this.__redo__&&r.call(this.__redo__),this.__nextIndex__=0})}))),u(s.prototype,d.iterator,l(function(){return this}))},"../node_modules/es6-iterator/is-iterable.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/function/is-arguments.js"),r=n("../node_modules/es5-ext/object/is-value.js"),o=n("../node_modules/es5-ext/string/is-string.js"),i=n("../node_modules/es6-symbol/index.js").iterator,a=Array.isArray;e.exports=function(e){return!!r(e)&&(!!a(e)||(!!o(e)||(!!s(e)||"function"==typeof e[i])))}},"../node_modules/es6-iterator/string.js":function(e,t,n){"use strict";var s,r=n("../node_modules/es5-ext/object/set-prototype-of/index.js"),o=n("../node_modules/d/index.js"),i=n("../node_modules/es6-symbol/index.js"),a=n("../node_modules/es6-iterator/index.js"),l=Object.defineProperty;s=e.exports=function(e){if(!(this instanceof s))throw new TypeError("Constructor requires 'new'");e=String(e),a.call(this,e),l(this,"__length__",o("",e.length))},r&&r(s,a),delete s.prototype.constructor,s.prototype=Object.create(a.prototype,{_next:o(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:o(function(e){var t,n=this.__list__[e];return this.__nextIndex__===this.__length__?n:(t=n.charCodeAt(0),t>=55296&&t<=56319?n+this.__list__[this.__nextIndex__++]:n)})}),l(s.prototype,i.toStringTag,o("c","String Iterator"))},"../node_modules/es6-iterator/valid-iterable.js":function(e,t,n){"use strict";var s=n("../node_modules/es6-iterator/is-iterable.js");e.exports=function(e){if(!s(e))throw new TypeError(e+" is not iterable");return e}},"../node_modules/es6-symbol/index.js":function(e,t,n){"use strict";e.exports=n("../node_modules/es6-symbol/is-implemented.js")()?Symbol:n("../node_modules/es6-symbol/polyfill.js")},"../node_modules/es6-symbol/is-implemented.js":function(e,t,n){"use strict";var s={object:!0,symbol:!0};e.exports=function(){var e;if("function"!=typeof Symbol)return!1;e=Symbol("test symbol");try{String(e)}catch(e){return!1}return!!s[typeof Symbol.iterator]&&(!!s[typeof Symbol.toPrimitive]&&!!s[typeof Symbol.toStringTag])}},"../node_modules/es6-symbol/is-symbol.js":function(e,t,n){"use strict";e.exports=function(e){return!!e&&("symbol"==typeof e||!!e.constructor&&("Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag]))}},"../node_modules/es6-symbol/polyfill.js":function(e,t,n){"use strict";var s,r,o,i,a=n("../node_modules/d/index.js"),l=n("../node_modules/es6-symbol/validate-symbol.js"),c=Object.create,d=Object.defineProperties,u=Object.defineProperty,p=Object.prototype,m=c(null);if("function"==typeof Symbol){s=Symbol;try{String(s()),i=!0}catch(e){}}var h=function(){var e=c(null);return function(t){for(var n,s,r=0;e[t+(r||"")];)++r;return t+=r||"",e[t]=!0,n="@@"+t,u(p,n,a.gs(null,function(e){s||(s=!0,u(this,n,a(e)),s=!1)})),n}}();o=function(e){if(this instanceof o)throw new TypeError("Symbol is not a constructor");return r(e)},e.exports=r=function e(t){var n;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return i?s(t):(n=c(o.prototype),t=void 0===t?"":String(t),d(n,{__description__:a("",t),__name__:a("",h(t))}))},d(r,{for:a(function(e){return m[e]?m[e]:m[e]=r(String(e))}),keyFor:a(function(e){var t;l(e);for(t in m)if(m[t]===e)return t}),hasInstance:a("",s&&s.hasInstance||r("hasInstance")),isConcatSpreadable:a("",s&&s.isConcatSpreadable||r("isConcatSpreadable")),iterator:a("",s&&s.iterator||r("iterator")),match:a("",s&&s.match||r("match")),replace:a("",s&&s.replace||r("replace")),search:a("",s&&s.search||r("search")),species:a("",s&&s.species||r("species")),split:a("",s&&s.split||r("split")),toPrimitive:a("",s&&s.toPrimitive||r("toPrimitive")),toStringTag:a("",s&&s.toStringTag||r("toStringTag")),unscopables:a("",s&&s.unscopables||r("unscopables"))}),d(o.prototype,{constructor:a(r),toString:a("",function(){return this.__name__})}),d(r.prototype,{toString:a(function(){return"Symbol ("+l(this).__description__+")"}),valueOf:a(function(){return l(this)})}),u(r.prototype,r.toPrimitive,a("",function(){var e=l(this);return"symbol"==typeof e?e:e.toString()})),u(r.prototype,r.toStringTag,a("c","Symbol")),u(o.prototype,r.toStringTag,a("c",r.prototype[r.toStringTag])),u(o.prototype,r.toPrimitive,a("c",r.prototype[r.toPrimitive]))},"../node_modules/es6-symbol/validate-symbol.js":function(e,t,n){"use strict";var s=n("../node_modules/es6-symbol/is-symbol.js");e.exports=function(e){if(!s(e))throw new TypeError(e+" is not a symbol");return e}},"../node_modules/es6-weak-map/index.js":function(e,t,n){"use strict";e.exports=n("../node_modules/es6-weak-map/is-implemented.js")()?WeakMap:n("../node_modules/es6-weak-map/polyfill.js")},"../node_modules/es6-weak-map/is-implemented.js":function(e,t,n){"use strict";e.exports=function(){var e,t;if("function"!=typeof WeakMap)return!1;try{e=new WeakMap([[t={},"one"],[{},"two"],[{},"three"]])}catch(e){return!1}return"[object WeakMap]"===String(e)&&("function"==typeof e.set&&(e.set({},1)===e&&("function"==typeof e.delete&&("function"==typeof e.has&&"one"===e.get(t)))))}},"../node_modules/es6-weak-map/is-native-implemented.js":function(e,t,n){"use strict";e.exports=function(){return"function"==typeof WeakMap&&"[object WeakMap]"===Object.prototype.toString.call(new WeakMap)}()},"../node_modules/es6-weak-map/polyfill.js":function(e,t,n){"use strict";var s,r=n("../node_modules/es5-ext/object/set-prototype-of/index.js"),o=n("../node_modules/es5-ext/object/valid-object.js"),i=n("../node_modules/es5-ext/object/valid-value.js"),a=n("../node_modules/es5-ext/string/random-uniq.js"),l=n("../node_modules/d/index.js"),c=n("../node_modules/es6-iterator/get.js"),d=n("../node_modules/es6-iterator/for-of.js"),u=n("../node_modules/es6-symbol/index.js").toStringTag,p=n("../node_modules/es6-weak-map/is-native-implemented.js"),m=Array.isArray,h=Object.defineProperty,f=Object.prototype.hasOwnProperty,g=Object.getPrototypeOf;e.exports=s=function(){var e,t=arguments[0];if(!(this instanceof s))throw new TypeError("Constructor requires 'new'");return e=p&&r&&WeakMap!==s?r(new WeakMap,g(this)):this,null!=t&&(m(t)||(t=c(t))),h(e,"__weakMapData__",l("c","$weakMap$"+a())),t?(d(t,function(t){i(t),e.set(t[0],t[1])}),e):e},p&&(r&&r(s,WeakMap),s.prototype=Object.create(WeakMap.prototype,{constructor:l(s)})),Object.defineProperties(s.prototype,{delete:l(function(e){return!!f.call(o(e),this.__weakMapData__)&&(delete e[this.__weakMapData__],!0)}),get:l(function(e){if(f.call(o(e),this.__weakMapData__))return e[this.__weakMapData__]}),has:l(function(e){return f.call(o(e),this.__weakMapData__)}),set:l(function(e,t){return h(o(e),this.__weakMapData__,l("c",t)),this}),toString:l(function(){return"[object WeakMap]"})}),h(s.prototype,u,l("c","WeakMap"))},"../node_modules/event-emitter/index.js":function(e,t,n){"use strict";var s,r,o,i,a,l,c,d=n("../node_modules/d/index.js"),u=n("../node_modules/es5-ext/object/valid-callable.js"),p=Function.prototype.apply,m=Function.prototype.call,h=Object.create,f=Object.defineProperty,g=Object.defineProperties,v=Object.prototype.hasOwnProperty,b={configurable:!0,enumerable:!1,writable:!0};s=function(e,t){var n;return u(t),v.call(this,"__ee__")?n=this.__ee__:(n=b.value=h(null),f(this,"__ee__",b),b.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},r=function(e,t){var n,r;return u(t),r=this,s.call(this,e,n=function(){o.call(r,e,n),p.call(t,this,arguments)}),n.__eeOnceListener__=t,this},o=function(e,t){var n,s,r,o;if(u(t),!v.call(this,"__ee__"))return this;if(n=this.__ee__,!n[e])return this;if("object"==typeof(s=n[e]))for(o=0;r=s[o];++o)r!==t&&r.__eeOnceListener__!==t||(2===s.length?n[e]=s[o?0:1]:s.splice(o,1));else s!==t&&s.__eeOnceListener__!==t||delete n[e];return this},i=function(e){var t,n,s,r,o;if(v.call(this,"__ee__")&&(r=this.__ee__[e]))if("object"==typeof r){for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];for(r=r.slice(),t=0;s=r[t];++t)p.call(s,this,o)}else switch(arguments.length){case 1:m.call(r,this);break;case 2:m.call(r,this,arguments[1]);break;case 3:m.call(r,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];p.call(r,this,o)}},a={on:s,once:r,off:o,emit:i},l={on:d(s),once:d(r),off:d(o),emit:d(i)},c=g({},l),e.exports=t=function(e){return null==e?h(c):g(Object(e),l)},t.methods=a},"../node_modules/is-promise/index.js":function(e,t){function n(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then}e.exports=n},"../node_modules/lru-queue/index.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/number/to-pos-integer.js"),r=Object.create,o=Object.prototype.hasOwnProperty;e.exports=function(e){var t,n=0,i=1,a=r(null),l=r(null),c=0;return e=s(e),{hit:function(s){var r=l[s],d=++c;if(a[d]=s,l[s]=d,!r){if(++n<=e)return;return s=a[i],t(s),s}if(delete a[r],i===r)for(;!o.call(a,++i);)continue},delete:t=function(e){var t=l[e];if(t&&(delete a[t],delete l[e],--n,i===t)){if(!n)return c=0,void(i=1);for(;!o.call(a,++i);)continue}},clear:function(){n=0,i=1,a=r(null),l=r(null),c=0}}}},"../node_modules/mark-gor/lib/react-renderer.js":function(e,t,n){function s(){for(var e=0;e<arguments.length;e++)for(var t=arguments[e],n=Object.keys(t),r=0;r<n.length;r++){var o=n[r];this[o]=t[o]}this.options||(this.options=s.defaults)}var r=n("../node_modules/react/react.js");s.defaults={sanitize:!1,langPrefix:"lang-",headerPrefix:""},s.prototype.render=function(e){return this.renderTokens(e)},s.prototype.renderChildren=function(e){return e.children?this.renderTokens(e.children):null},s.prototype.renderTokens=function(e,t){for(var n=[],s=0;s<e.length;s++){var r=this.renderToken(e[s],s);if(r instanceof Array)for(var o=0,i=r;o<i.length;o++)n.push(i[o]);else r&&n.push(r)}return n},s.prototype.renderToken=function(e,t){switch(e.type){case"code":return this.renderCode(e,t);case"blockquote":return this.renderBlockquote(e,t);case"html":return this.renderHtml(e,t);case"heading":return this.renderHeading(e,t);case"hr":return this.renderHorizontalLine(e,t);case"list":return this.renderList(e,t);case"list_item":return this.renderListItem(e,t);case"loose_item":return this.renderLooseItem(e,t);case"paragraph":return this.renderParagraph(e,t);case"table":return this.renderTable(e,t);case"table_header":return this.renderTableHeader(e,t);case"table_row":return this.renderTableRow(e,t);case"table_header_cell":return this.renderTableHeaderCell(e,t);case"table_row_cell":return this.renderTableRowCell(e,t);case"strong":return this.renderStrong(e,t);case"em":return this.renderEmphasized(e,t);case"codespan":return this.renderCodeSpan(e,t);case"del":return this.renderDeleted(e,t);case"br":return this.renderLineBreak(e,t);case"link":return this.renderLink(e,t);case"autolink":return this.renderAutolink(e,t);case"url":return this.renderUrl(e,t);case"image":return this.renderImage(e,t);case"text":return this.renderText(e,t);case"text_block":return this.renderTextBlock(e,t);case"html_block":return this.renderHtmlBlock(e,t);case"space":return this.renderSpace(e,t);case"def":return this.renderRefDefinition(e,t);default:throw new Error("Unrecognized token: "+e.type)}},s.prototype.renderCode=function(e,t){var n,s=e.text,o=e.lang;return o&&(n=this.options.langPrefix+o),r.createElement("pre",{key:t},r.createElement("code",{className:n},s,"\n"))},s.prototype.renderBlockquote=function(e,t){return r.createElement("blockquote",{key:t},this.renderChildren(e))},s.prototype.renderHtml=function(e,t){return null},s.prototype.renderHeading=function(e,t){var n=this.options.headerPrefix+e.name;return r.createElement("h"+e.depth,{id:n,key:t},this.renderChildren(e))},s.prototype.renderHorizontalLine=function(e,t){return r.createElement("hr",{key:t})},s.prototype.renderList=function(e,t){return e.ordered?r.createElement("ol",{key:t},this.renderChildren(e)):r.createElement("ul",{key:t},this.renderChildren(e))},s.prototype.renderLooseItem=s.prototype.renderListItem=function(e,t){return r.createElement("li",{key:t},this.renderChildren(e))},s.prototype.renderParagraph=function(e,t){return r.createElement("p",{key:t},this.renderChildren(e))},s.prototype.renderTable=function(e,t){var n=e.children,s=r.createElement("thead",null,this.renderTableHeader(n[0])),o=r.createElement("tbody",null,this.renderTokens(n.slice(1)));return r.createElement("table",{key:t},s,o)},s.prototype.renderTableHeader=s.prototype.renderTableRow=function(e,t){return r.createElement("tr",{key:t},this.renderChildren(e))},s.prototype.renderTableHeaderCell=function(e,t){return r.createElement("th",{key:t,style:{textALign:e.align}},this.renderChildren(e))},s.prototype.renderTableRowCell=function(e,t){return r.createElement("td",{key:t,style:{textALign:e.align}},this.renderChildren(e))},s.prototype.renderStrong=function(e,t){return r.createElement("strong",{key:t},this.renderChildren(e))},s.prototype.renderEmphasized=function(e,t){return r.createElement("em",{key:t},this.renderChildren(e))},s.prototype.renderCodeSpan=function(e,t){var n=e.text;return r.createElement("code",{key:t},n)},s.prototype.renderLineBreak=function(e,t){return r.createElement("br",{key:t})},s.prototype.renderDeleted=function(e,t){return r.createElement("del",{key:t},this.renderChildren(e))},s.prototype.renderUrl=s.prototype.renderAutolink=function(e,t){if(!this.sanitizeUrl(e.href))return"";var n=e.href,s=e.text;return r.createElement("a",{key:t,href:n},s)},s.prototype.renderLink=function(e,t){if(!this.sanitizeUrl(e.href))return null;var n=e.href,s=e.title;return r.createElement("a",{key:t,href:n,title:s},this.renderChildren(e))},s.prototype.sanitizeUrl=function(e){if(this.options.sanitize){try{var t=decodeURIComponent(e).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return!1}if(0===t.indexOf("javascript:")||0===t.indexOf("vbscript:")||0===t.indexOf("data:"))return!1}return!0},s.prototype.renderImage=function(e,t){var n=e.href,s=e.title,o=e.text;return r.createElement("img",{key:t,src:n,alt:o,title:s})},s.prototype.renderText=function(e,t){return e.text},s.prototype.renderHtmlBlock=s.prototype.renderTextBlock=function(e,t){return e.paragraph?this.renderParagraph(e,t):this.renderChildren(e)},s.prototype.renderRefDefinition=s.prototype.renderSpace=function(e,t){return null},e.exports=s},"../node_modules/mark-gor/react.js":function(e,t,n){function s(e,t){var n=new r({options:d(t,r.defaults)}),s=new a({options:d(t,a.defaults)}),o=n.parse(e);return s.render(o)}var r=n("../node_modules/mark-gor/lib/parser.js"),o=n("../node_modules/mark-gor/lib/block-lexer.js"),i=n("../node_modules/mark-gor/lib/inline-lexer.js"),a=n("../node_modules/mark-gor/lib/react-renderer.js"),l=n("../node_modules/mark-gor/lib/helpers.js"),c=l.merge,d=l.pick;t.parse=s,t.defaults=c({},r.defaults,a.defaults),t.BlockLexer=o,t.InlineLexer=i,t.Parser=r,t.Renderer=a},"../node_modules/memoizee/ext/async.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/array/from/index.js"),r=n("../node_modules/es5-ext/object/map.js"),o=n("../node_modules/es5-ext/object/mixin.js"),i=n("../node_modules/es5-ext/function/_define-length.js"),a=n("../node_modules/next-tick/index.js"),l=Array.prototype.slice,c=Function.prototype.apply,d=Object.create;n("../node_modules/memoizee/lib/registered-extensions.js").async=function(e,t){var n,u,p,m=d(null),h=d(null),f=t.memoized,g=t.original;t.memoized=i(function(e){var t=arguments,s=t[t.length-1];return"function"==typeof s&&(n=s,t=l.call(t,0,-1)),f.apply(u=this,p=t)},f);try{o(t.memoized,f)}catch(e){}t.on("get",function(e){var s,r,o;if(n){if(m[e])return"function"==typeof m[e]?m[e]=[m[e],n]:m[e].push(n),void(n=null);s=n,r=u,o=p,n=u=p=null,a(function(){var i;hasOwnProperty.call(h,e)?(i=h[e],t.emit("getasync",e,o,r),c.call(s,i.context,i.args)):(n=s,u=r,p=o,f.apply(r,o))})}}),t.original=function(){var e,r,o,i;return n?(e=s(arguments),r=function e(n){var r,o,l=e.id;return null==l?void a(c.bind(e,this,arguments)):(delete e.id,r=m[l],delete m[l],r?(o=s(arguments),t.has(l)&&(n?t.delete(l):(h[l]={context:this,args:o},t.emit("setasync",l,"function"==typeof r?1:r.length))),"function"==typeof r?i=c.call(r,this,o):r.forEach(function(e){i=c.call(e,this,o)},this),i):void 0)},o=n,n=u=p=null,e.push(r),i=c.call(g,this,e),r.cb=o,n=r,i):c.call(g,this,arguments)},t.on("set",function(e){if(!n)return void t.delete(e);m[e]?"function"==typeof m[e]?m[e]=[m[e],n.cb]:m[e].push(n.cb):m[e]=n.cb,delete n.cb,n.id=e,n=null}),t.on("delete",function(e){var n;hasOwnProperty.call(m,e)||h[e]&&(n=h[e],delete h[e],t.emit("deleteasync",e,l.call(n.args,1)))}),t.on("clear",function(){var e=h;h=d(null),t.emit("clearasync",r(e,function(e){return l.call(e.args,1)}))})}},"../node_modules/memoizee/ext/dispose.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/valid-callable.js"),r=n("../node_modules/es5-ext/object/for-each.js"),o=n("../node_modules/memoizee/lib/registered-extensions.js"),i=Function.prototype.apply;o.dispose=function(e,t,n){var a;if(s(e),n.async&&o.async||n.promise&&o.promise)return t.on("deleteasync",a=function(t,n){i.call(e,null,n)}),void t.on("clearasync",function(e){r(e,function(e,t){a(t,e)})});t.on("delete",a=function(t,n){e(n)}),t.on("clear",function(e){r(e,function(e,t){a(t,e)})})}},"../node_modules/memoizee/ext/max-age.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/array/from/index.js"),r=n("../node_modules/es5-ext/object/for-each.js"),o=n("../node_modules/next-tick/index.js"),i=n("../node_modules/is-promise/index.js"),a=n("../node_modules/timers-ext/valid-timeout.js"),l=n("../node_modules/memoizee/lib/registered-extensions.js"),c=Function.prototype,d=Math.max,u=Math.min,p=Object.create;l.maxAge=function(e,t,n){var m,h,f,g;(e=a(e))&&(m=p(null),h=n.async&&l.async||n.promise&&l.promise?"async":"",t.on("set"+h,function(n){m[n]=setTimeout(function(){t.delete(n)},e),"function"==typeof m[n].unref&&m[n].unref(),g&&(g[n]&&"nextTick"!==g[n]&&clearTimeout(g[n]),g[n]=setTimeout(function(){delete g[n]},f),"function"==typeof g[n].unref&&g[n].unref())}),t.on("delete"+h,function(e){clearTimeout(m[e]),delete m[e],g&&("nextTick"!==g[e]&&clearTimeout(g[e]),delete g[e])}),n.preFetch&&(f=!0===n.preFetch||isNaN(n.preFetch)?.333:d(u(Number(n.preFetch),1),0))&&(g={},f=(1-f)*e,t.on("get"+h,function(e,r,a){g[e]||(g[e]="nextTick",o(function(){var o;"nextTick"===g[e]&&(delete g[e],t.delete(e),n.async&&(r=s(r),r.push(c)),o=t.memoized.apply(a,r),n.promise&&i(o)&&("function"==typeof o.done?o.done(c,c):o.then(c,c)))}))})),t.on("clear"+h,function(){r(m,function(e){clearTimeout(e)}),m={},g&&(r(g,function(e){"nextTick"!==e&&clearTimeout(e)}),g={})}))}},"../node_modules/memoizee/ext/max.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/number/to-pos-integer.js"),r=n("../node_modules/lru-queue/index.js"),o=n("../node_modules/memoizee/lib/registered-extensions.js");o.max=function(e,t,n){var i,a,l;(e=s(e))&&(a=r(e),i=n.async&&o.async||n.promise&&o.promise?"async":"",t.on("set"+i,l=function(e){void 0!==(e=a.hit(e))&&t.delete(e)}),t.on("get"+i,l),t.on("delete"+i,a.delete),t.on("clear"+i,a.clear))}},"../node_modules/memoizee/ext/promise.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/map.js"),r=n("../node_modules/es5-ext/object/primitive-set.js"),o=n("../node_modules/es5-ext/object/validate-stringifiable-value.js"),i=n("../node_modules/es5-ext/to-short-string-representation.js"),a=n("../node_modules/is-promise/index.js"),l=n("../node_modules/next-tick/index.js"),c=Object.create,d=r("then","then:finally","done","done:finally");n("../node_modules/memoizee/lib/registered-extensions.js").promise=function(e,t){var n=c(null),r=c(null),u=c(null);if(!0===e)e=null;else if(e=o(e),!d[e])throw new TypeError("'"+i(e)+"' is not valid promise mode");t.on("set",function(s,o,i){var c=!1;if(!a(i))return r[s]=i,void t.emit("setasync",s,1);n[s]=1,u[s]=i;var d=function(e){var o=n[s];if(c)throw new Error("Memoizee error: Detected unordered then|done & finally resolution, which in turn makes proper detection of success/failure impossible (when in 'done:finally' mode)\nConsider to rely on 'then' or 'done' mode instead.");o&&(delete n[s],r[s]=e,t.emit("setasync",s,o))},p=function(){c=!0,n[s]&&(delete n[s],delete u[s],t.delete(s))},m=e;if(m||(m="then"),"then"===m)i.then(function(e){l(d.bind(this,e))},function(){l(p)});else if("done"===m){if("function"!=typeof i.done)throw new Error("Memoizee error: Retrieved promise does not implement 'done' in 'done' mode");i.done(d,p)}else if("done:finally"===m){if("function"!=typeof i.done)throw new Error("Memoizee error: Retrieved promise does not implement 'done' in 'done:finally' mode");if("function"!=typeof i.finally)throw new Error("Memoizee error: Retrieved promise does not implement 'finally' in 'done:finally' mode");i.done(d),i.finally(p)}}),t.on("get",function(e,s,r){var o;if(n[e])return void++n[e];o=u[e];var i=function(){t.emit("getasync",e,s,r)};a(o)?"function"==typeof o.done?o.done(i):o.then(function(){l(i)}):i()}),t.on("delete",function(e){if(delete u[e],n[e])return void delete n[e];if(hasOwnProperty.call(r,e)){var s=r[e];delete r[e],t.emit("deleteasync",e,[s])}}),t.on("clear",function(){var e=r;r=c(null),n=c(null),u=c(null),t.emit("clearasync",s(e,function(e){return[e]}))})}},"../node_modules/memoizee/ext/ref-counter.js":function(e,t,n){"use strict";var s=n("../node_modules/d/index.js"),r=n("../node_modules/memoizee/lib/registered-extensions.js"),o=Object.create,i=Object.defineProperties;r.refCounter=function(e,t,n){var a,l;a=o(null),l=n.async&&r.async||n.promise&&r.promise?"async":"",t.on("set"+l,function(e,t){a[e]=t||1}),t.on("get"+l,function(e){++a[e]}),t.on("delete"+l,function(e){delete a[e]}),t.on("clear"+l,function(){a={}}),i(t.memoized,{deleteRef:s(function(){var e=t.get(arguments);return null===e?null:a[e]?!--a[e]&&(t.delete(e),!0):null}),getRefCount:s(function(){var e=t.get(arguments);return null===e?0:a[e]?a[e]:0})})}},"../node_modules/memoizee/index.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/normalize-options.js"),r=n("../node_modules/memoizee/lib/resolve-length.js"),o=n("../node_modules/memoizee/plain.js");e.exports=function(e){var t,i=s(arguments[1]);return i.normalizer||0!==(t=i.length=r(i.length,e.length,i.async))&&(i.primitive?!1===t?i.normalizer=n("../node_modules/memoizee/normalizers/primitive.js"):t>1&&(i.normalizer=n("../node_modules/memoizee/normalizers/get-primitive-fixed.js")(t)):i.normalizer=!1===t?n("../node_modules/memoizee/normalizers/get.js")():1===t?n("../node_modules/memoizee/normalizers/get-1.js")():n("../node_modules/memoizee/normalizers/get-fixed.js")(t)),i.async&&n("../node_modules/memoizee/ext/async.js"),i.promise&&n("../node_modules/memoizee/ext/promise.js"),i.dispose&&n("../node_modules/memoizee/ext/dispose.js"),i.maxAge&&n("../node_modules/memoizee/ext/max-age.js"),i.max&&n("../node_modules/memoizee/ext/max.js"),i.refCounter&&n("../node_modules/memoizee/ext/ref-counter.js"),o(e,i)}},"../node_modules/memoizee/lib/configure-map.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/error/custom.js"),r=n("../node_modules/es5-ext/function/_define-length.js"),o=n("../node_modules/d/index.js"),i=n("../node_modules/event-emitter/index.js").methods,a=n("../node_modules/memoizee/lib/resolve-resolve.js"),l=n("../node_modules/memoizee/lib/resolve-normalize.js"),c=Function.prototype.apply,d=Function.prototype.call,u=Object.create,p=Object.defineProperties,m=i.on,h=i.emit;e.exports=function(e,t,n){var i,f,g,v,b,y,j,x,w,_,E,k,C,S,R,O=u(null);return f=!1!==t?t:isNaN(e.length)?1:e.length,n.normalizer&&(_=l(n.normalizer),g=_.get,v=_.set,b=_.delete,y=_.clear),null!=n.resolvers&&(R=a(n.resolvers)),S=g?r(function(t){var n,r,o=arguments;if(R&&(o=R(o)),null!==(n=g(o))&&hasOwnProperty.call(O,n))return E&&i.emit("get",n,o,this),O[n];if(r=1===o.length?d.call(e,this,o[0]):c.call(e,this,o),null===n){if(null!==(n=g(o)))throw s("Circular invocation","CIRCULAR_INVOCATION");n=v(o)}else if(hasOwnProperty.call(O,n))throw s("Circular invocation","CIRCULAR_INVOCATION");return O[n]=r,k&&i.emit("set",n,null,r),r},f):0===t?function(){var t;if(hasOwnProperty.call(O,"data"))return E&&i.emit("get","data",arguments,this),O.data;if(t=arguments.length?c.call(e,this,arguments):d.call(e,this),hasOwnProperty.call(O,"data"))throw s("Circular invocation","CIRCULAR_INVOCATION");return O.data=t,k&&i.emit("set","data",null,t),t}:function(t){var n,r,o=arguments;if(R&&(o=R(arguments)),r=String(o[0]),hasOwnProperty.call(O,r))return E&&i.emit("get",r,o,this),O[r];if(n=1===o.length?d.call(e,this,o[0]):c.call(e,this,o),hasOwnProperty.call(O,r))throw s("Circular invocation","CIRCULAR_INVOCATION");return O[r]=n,k&&i.emit("set",r,null,n),n},i={original:e,memoized:S,profileName:n.profileName,get:function(e){return R&&(e=R(e)),g?g(e):String(e[0])},has:function(e){return hasOwnProperty.call(O,e)},delete:function(e){var t;hasOwnProperty.call(O,e)&&(b&&b(e),t=O[e],delete O[e],C&&i.emit("delete",e,t))},clear:function(){var e=O;y&&y(),O=u(null),i.emit("clear",e)},on:function(e,t){return"get"===e?E=!0:"set"===e?k=!0:"delete"===e&&(C=!0),m.call(this,e,t)},emit:h,updateEnv:function(){e=i.original}},j=g?r(function(e){var t,n=arguments;R&&(n=R(n)),null!==(t=g(n))&&i.delete(t)},f):0===t?function(){return i.delete("data")}:function(e){return R&&(e=R(arguments)[0]),i.delete(e)},x=r(function(){var e,n=arguments;return 0===t?O.data:(R&&(n=R(n)),e=g?g(n):String(n[0]),O[e])}),w=r(function(){var e,n=arguments;return 0===t?i.has("data"):(R&&(n=R(n)),null!==(e=g?g(n):String(n[0]))&&i.has(e))}),p(S,{__memoized__:o(!0),delete:o(j),clear:o(i.clear),_get:o(x),_has:o(w)}),i}},"../node_modules/memoizee/lib/registered-extensions.js":function(e,t,n){"use strict"},"../node_modules/memoizee/lib/resolve-length.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/number/to-pos-integer.js");e.exports=function(e,t,n){var r;return isNaN(e)?(r=t,r>=0?n&&r?r-1:r:1):!1!==e&&s(e)}},"../node_modules/memoizee/lib/resolve-normalize.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/valid-callable.js");e.exports=function(e){var t;return"function"==typeof e?{set:e,get:e}:(t={get:s(e.get)},void 0!==e.set?(t.set=s(e.set),e.delete&&(t.delete=s(e.delete)),e.clear&&(t.clear=s(e.clear)),t):(t.set=t.get,t))}},"../node_modules/memoizee/lib/resolve-resolve.js":function(e,t,n){"use strict";var s,r=n("../node_modules/es5-ext/array/to-array.js"),o=n("../node_modules/es5-ext/object/is-value.js"),i=n("../node_modules/es5-ext/object/valid-callable.js"),a=Array.prototype.slice;s=function(e){return this.map(function(t,n){return t?t(e[n]):e[n]}).concat(a.call(e,this.length))},e.exports=function(e){return e=r(e),e.forEach(function(e){o(e)&&i(e)}),s.bind(e)}},"../node_modules/memoizee/lib/weak.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/error/custom.js"),r=n("../node_modules/es5-ext/function/_define-length.js"),o=n("../node_modules/es5-ext/function/#/partial.js"),i=n("../node_modules/es5-ext/object/copy.js"),a=n("../node_modules/es5-ext/object/normalize-options.js"),l=n("../node_modules/es5-ext/object/valid-callable.js"),c=n("../node_modules/d/index.js"),d=n("../node_modules/es6-weak-map/index.js"),u=n("../node_modules/memoizee/lib/resolve-length.js"),p=n("../node_modules/memoizee/lib/registered-extensions.js"),m=n("../node_modules/memoizee/lib/resolve-resolve.js"),h=n("../node_modules/memoizee/lib/resolve-normalize.js"),f=Array.prototype.slice,g=Object.defineProperties;e.exports=function(e){return function(t){var n,v,b,y,j,x=a(arguments[1]);return l(t),hasOwnProperty.call(t,"__memoized__")&&!x.force?t:(v=u(x.length,t.length,x.async&&p.async),x.length=v?v-1:0,n=new d,x.resolvers&&(y=m(x.resolvers)),x.normalizer&&(j=h(x.normalizer)),1!==v||j||x.async||x.dispose||x.maxAge||x.max||x.refCounter?(b=g(r(function(s){var r,a=arguments;return y&&(a=y(a),s=a[0]),r=n.get(s),r||(j&&(x=i(x),x.normalizer=i(j),x.normalizer.get=o.call(x.normalizer.get,s),x.normalizer.set=o.call(x.normalizer.set,s),x.normalizer.delete&&(x.normalizer.delete=o.call(x.normalizer.delete,s))),n.set(s,r=e(o.call(t,s),x))),r.apply(this,f.call(a,1))},v),{__memoized__:c(!0),delete:c(r(function(e){var t,s=arguments;y&&(s=y(s),e=s[0]),(t=n.get(e))&&t.delete.apply(this,f.call(s,1))},v))}),x.refCounter?(g(b,{deleteRef:c(r(function(e){var t,s=arguments;return y&&(s=y(s),e=s[0]),t=n.get(e),t?t.deleteRef.apply(this,f.call(s,1)):null},v)),getRefCount:c(r(function(e){var t,s=arguments;return y&&(s=y(s),e=s[0]),t=n.get(e),t?t.getRefCount.apply(this,f.call(s,1)):0},v))}),b):b):g(function(e){var r,o=arguments;if(y&&(o=y(o)),e=o[0],n.has(e))return n.get(e);if(r=t.apply(this,o),n.has(e))throw s("Circular invocation","CIRCULAR_INVOCATION");return n.set(e,r),r},{__memoized__:c(!0),delete:c(function(e){return y&&(e=y(arguments)[0]),n.delete(e)})}))}}},"../node_modules/memoizee/normalizers/get-1.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/array/#/e-index-of.js");e.exports=function(){var e=0,t=[],n=[];return{get:function(e){var r=s.call(t,e[0]);return-1===r?null:n[r]},set:function(s){return t.push(s[0]),n.push(++e),e},delete:function(e){var r=s.call(n,e);-1!==r&&(t.splice(r,1),n.splice(r,1))},clear:function(){t=[],n=[]}}}},"../node_modules/memoizee/normalizers/get-fixed.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/array/#/e-index-of.js"),r=Object.create;e.exports=function(e){var t=0,n=[[],[]],o=r(null);return{get:function(t){for(var r,o=0,i=n;o<e-1;){if(-1===(r=s.call(i[0],t[o])))return null;i=i[1][r],++o}return r=s.call(i[0],t[o]),-1===r?null:i[1][r]||null},set:function(r){for(var i,a=0,l=n;a<e-1;)i=s.call(l[0],r[a]),-1===i&&(i=l[0].push(r[a])-1,l[1].push([[],[]])),l=l[1][i],++a;return i=s.call(l[0],r[a]),-1===i&&(i=l[0].push(r[a])-1),l[1][i]=++t,o[t]=r,t},delete:function(t){for(var r,i=0,a=n,l=[],c=o[t];i<e-1;){if(-1===(r=s.call(a[0],c[i])))return;l.push(a,r),a=a[1][r],++i}if(-1!==(r=s.call(a[0],c[i]))){for(t=a[1][r],a[0].splice(r,1),a[1].splice(r,1);!a[0].length&&l.length;)r=l.pop(),a=l.pop(),a[0].splice(r,1),a[1].splice(r,1);delete o[t]}},clear:function(){n=[[],[]],o=r(null)}}}},"../node_modules/memoizee/normalizers/get-primitive-fixed.js":function(e,t,n){"use strict";e.exports=function(e){return e?function(t){for(var n=String(t[0]),s=0,r=e;--r;)n+=""+t[++s];return n}:function(){return""}}},"../node_modules/memoizee/normalizers/get.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/array/#/e-index-of.js"),r=Object.create;e.exports=function(){var e=0,t=[],n=r(null);return{get:function(e){var n,r=0,o=t,i=e.length;if(0===i)return o[i]||null;if(o=o[i]){for(;r<i-1;){if(-1===(n=s.call(o[0],e[r])))return null;o=o[1][n],++r}return n=s.call(o[0],e[r]),-1===n?null:o[1][n]||null}return null},set:function(r){var o,i=0,a=t,l=r.length;if(0===l)a[l]=++e;else{for(a[l]||(a[l]=[[],[]]),a=a[l];i<l-1;)o=s.call(a[0],r[i]),-1===o&&(o=a[0].push(r[i])-1,a[1].push([[],[]])),a=a[1][o],++i;o=s.call(a[0],r[i]),-1===o&&(o=a[0].push(r[i])-1),a[1][o]=++e}return n[e]=r,e},delete:function(e){var r,o=0,i=t,a=n[e],l=a.length,c=[];if(0===l)delete i[l];else if(i=i[l]){for(;o<l-1;){if(-1===(r=s.call(i[0],a[o])))return;c.push(i,r),i=i[1][r],++o}if(-1===(r=s.call(i[0],a[o])))return;for(e=i[1][r],i[0].splice(r,1),i[1].splice(r,1);!i[0].length&&c.length;)r=c.pop(),i=c.pop(),i[0].splice(r,1),i[1].splice(r,1)}delete n[e]},clear:function(){t=[],n=r(null)}}}},"../node_modules/memoizee/normalizers/primitive.js":function(e,t,n){"use strict";e.exports=function(e){var t,n,s=e.length;if(!s)return"";for(t=String(e[n=0]);--s;)t+=""+e[++n];return t}},"../node_modules/memoizee/plain.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/object/valid-callable.js"),r=n("../node_modules/es5-ext/object/for-each.js"),o=n("../node_modules/memoizee/lib/registered-extensions.js"),i=n("../node_modules/memoizee/lib/configure-map.js"),a=n("../node_modules/memoizee/lib/resolve-length.js");e.exports=function e(t){var n,l,c;if(s(t),n=Object(arguments[1]),n.async&&n.promise)throw new Error("Options 'async' and 'promise' cannot be used together");return hasOwnProperty.call(t,"__memoized__")&&!n.force?t:(l=a(n.length,t.length,n.async&&o.async),c=i(t,l,n),r(o,function(e,t){n[t]&&e(n[t],c,n)}),e.__profiler__&&e.__profiler__(c),c.updateEnv(),c.memoized)}},"../node_modules/memoizee/weak.js":function(e,t,n){"use strict";e.exports=n("../node_modules/memoizee/lib/weak.js")(n("../node_modules/memoizee/index.js"))},"../node_modules/next-tick/index.js":function(e,t,n){"use strict";(function(t,n){var s,r;s=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e},r=function(e){var t,n,r=document.createTextNode(""),o=0;return new e(function(){var e;if(t)n&&(t=n.concat(t));else{if(!n)return;t=n}if(n=t,t=null,"function"==typeof n)return e=n,n=null,void e();for(r.data=o=++o%2;n;)e=n.shift(),n.length||(n=null),e()}).observe(r,{characterData:!0}),function(e){if(s(e),t)return void("function"==typeof t?t=[t,e]:t.push(e));t=e,r.data=o=++o%2}},e.exports=function(){if("object"==typeof t&&t&&"function"==typeof t.nextTick)return t.nextTick;if("object"==typeof document&&document){if("function"==typeof MutationObserver)return r(MutationObserver);if("function"==typeof WebKitMutationObserver)return r(WebKitMutationObserver)}return"function"==typeof n?function(e){n(s(e))}:"function"==typeof setTimeout||"object"==typeof setTimeout?function(e){setTimeout(s(e),0)}:null}()}).call(t,n("../node_modules/process/browser.js"),n("../node_modules/timers-browserify/main.js").setImmediate)},"../node_modules/octicons/build/svg/file-text.svg":function(e,t,n){function s(e){return r.createElement("svg",e,r.createElement("path",{d:"M6 5H2V4h4v1zM2 8h7V7H2v1zm0 2h7V9H2v1zm0 2h7v-1H2v1zm10-7.5V14c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1h7.5L12 4.5zM11 5L8 2H1v12h10V5z"}))}var r=n("../node_modules/react/react.js");s.displayName="FileText",s.defaultProps={viewBox:"0 0 12 16"},e.exports=s,s.default=s},"../node_modules/octicons/build/svg/git-branch.svg":function(e,t,n){function s(e){return r.createElement("svg",e,r.createElement("path",{fillRule:"evenodd",d:"M10 5c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v.3c-.02.52-.23.98-.63 1.38-.4.4-.86.61-1.38.63-.83.02-1.48.16-2 .45V4.72a1.993 1.993 0 0 0-1-3.72C.88 1 0 1.89 0 3a2 2 0 0 0 1 1.72v6.56c-.59.35-1 .99-1 1.72 0 1.11.89 2 2 2 1.11 0 2-.89 2-2 0-.53-.2-1-.53-1.36.09-.06.48-.41.59-.47.25-.11.56-.17.94-.17 1.05-.05 1.95-.45 2.75-1.25S8.95 7.77 9 6.73h-.02C9.59 6.37 10 5.73 10 5zM2 1.8c.66 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2C1.35 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2zm0 12.41c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm6-8c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"}))}var r=n("../node_modules/react/react.js");s.displayName="GitBranch",s.defaultProps={viewBox:"0 0 10 16"},e.exports=s,s.default=s},"../node_modules/octicons/build/svg/git-merge.svg":function(e,t,n){function s(e){return r.createElement("svg",e,r.createElement("path",{fillRule:"evenodd",d:"M10 7c-.73 0-1.38.41-1.73 1.02V8C7.22 7.98 6 7.64 5.14 6.98c-.75-.58-1.5-1.61-1.89-2.44A1.993 1.993 0 0 0 2 .99C.89.99 0 1.89 0 3a2 2 0 0 0 1 1.72v6.56c-.59.35-1 .99-1 1.72 0 1.11.89 2 2 2a1.993 1.993 0 0 0 1-3.72V7.67c.67.7 1.44 1.27 2.3 1.69.86.42 2.03.63 2.97.64v-.02c.36.61 1 1.02 1.73 1.02 1.11 0 2-.89 2-2 0-1.11-.89-2-2-2zm-6.8 6c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm8 6c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"}))}var r=n("../node_modules/react/react.js");s.displayName="GitMerge",s.defaultProps={viewBox:"0 0 12 16"},e.exports=s,s.default=s},"../node_modules/octicons/build/svg/git-pull-request.svg":function(e,t,n){function s(e){return r.createElement("svg",e,r.createElement("path",{fillRule:"evenodd",d:"M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"}))}var r=n("../node_modules/react/react.js");s.displayName="GitPullRequest",s.defaultProps={viewBox:"0 0 12 16"},e.exports=s,s.default=s},"../node_modules/octicons/build/svg/issue-closed.svg":function(e,t,n){function s(e){return r.createElement("svg",e,r.createElement("path",{fillRule:"evenodd",d:"M7 10h2v2H7v-2zm2-6H7v5h2V4zm1.5 1.5l-1 1L12 9l4-4.5-1-1L12 7l-1.5-1.5zM8 13.7A5.71 5.71 0 0 1 2.3 8c0-3.14 2.56-5.7 5.7-5.7 1.83 0 3.45.88 4.5 2.2l.92-.92A6.947 6.947 0 0 0 8 1C4.14 1 1 4.14 1 8s3.14 7 7 7 7-3.14 7-7l-1.52 1.52c-.66 2.41-2.86 4.19-5.48 4.19v-.01z"}))}var r=n("../node_modules/react/react.js");s.displayName="IssueClosed",s.defaultProps={viewBox:"0 0 16 16"},e.exports=s,s.default=s},"../node_modules/octicons/build/svg/issue-opened.svg":function(e,t,n){function s(e){return r.createElement("svg",e,r.createElement("path",{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))}var r=n("../node_modules/react/react.js");s.displayName="IssueOpened",s.defaultProps={viewBox:"0 0 14 16"},e.exports=s,s.default=s},"../node_modules/octicons/build/svg/issue-reopened.svg":function(e,t,n){function s(e){return r.createElement("svg",e,r.createElement("path",{fillRule:"evenodd",d:"M8 9H6V4h2v5zm-2 3h2v-2H6v2zm6.33-2H10l1.5 1.5c-1.05 1.33-2.67 2.2-4.5 2.2A5.71 5.71 0 0 1 1.3 8c0-.34.03-.67.09-1H.08C.03 7.33 0 7.66 0 8c0 3.86 3.14 7 7 7 2.19 0 4.13-1.02 5.41-2.59L14 14v-4h-1.67zM1.67 6H4L2.5 4.5C3.55 3.17 5.17 2.3 7 2.3c3.14 0 5.7 2.56 5.7 5.7 0 .34-.03.67-.09 1h1.31c.05-.33.08-.66.08-1 0-3.86-3.14-7-7-7-2.19 0-4.13 1.02-5.41 2.59L0 2v4h1.67z"}))}var r=n("../node_modules/react/react.js");s.displayName="IssueReopened",s.defaultProps={viewBox:"0 0 14 16"},e.exports=s,s.default=s},"../node_modules/octicons/build/svg/list-ordered.svg":function(e,t,n){function s(e){return r.createElement("svg",e,r.createElement("path",{fillRule:"evenodd",d:"M12 13c0 .59 0 1-.59 1H4.59C4 14 4 13.59 4 13c0-.59 0-1 .59-1h6.81c.59 0 .59.41.59 1H12zM4.59 4h6.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1H4.59C4 2 4 2.41 4 3c0 .59 0 1 .59 1zm6.81 3H4.59C4 7 4 7.41 4 8c0 .59 0 1 .59 1h6.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1zM2 1h-.72c-.3.19-.58.25-1.03.34V2H1v2.14H.16V5H3v-.86H2V1zm.25 8.13c-.17 0-.45.03-.66.06.53-.56 1.14-1.25 1.14-1.89C2.71 6.52 2.17 6 1.37 6c-.59 0-.97.2-1.38.64l.58.58c.19-.19.38-.38.64-.38.28 0 .48.16.48.52 0 .53-.77 1.2-1.7 2.06V10h3l-.09-.88h-.66l.01.01zm-.08 3.78v-.03c.44-.19.64-.47.64-.86 0-.7-.56-1.11-1.44-1.11-.48 0-.89.19-1.28.52l.55.64c.25-.2.44-.31.69-.31.27 0 .42.13.42.36 0 .27-.2.44-.86.44v.75c.83 0 .98.17.98.47 0 .25-.23.38-.58.38-.28 0-.56-.14-.81-.38l-.48.66c.3.36.77.56 1.41.56.83 0 1.53-.41 1.53-1.16 0-.5-.31-.81-.77-.94v.01z"}))}var r=n("../node_modules/react/react.js");s.displayName="ListOrdered",s.defaultProps={viewBox:"0 0 12 16"},e.exports=s,s.default=s},"../node_modules/octicons/build/svg/list-unordered.svg":function(e,t,n){function s(e){return r.createElement("svg",e,r.createElement("path",{fillRule:"evenodd",d:"M2 13c0 .59 0 1-.59 1H.59C0 14 0 13.59 0 13c0-.59 0-1 .59-1h.81c.59 0 .59.41.59 1H2zm2.59-9h6.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1H4.59C4 2 4 2.41 4 3c0 .59 0 1 .59 1zM1.41 7H.59C0 7 0 7.41 0 8c0 .59 0 1 .59 1h.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1h.01zm0-5H.59C0 2 0 2.41 0 3c0 .59 0 1 .59 1h.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1h.01zm10 5H4.59C4 7 4 7.41 4 8c0 .59 0 1 .59 1h6.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1h.01zm0 5H4.59C4 12 4 12.41 4 13c0 .59 0 1 .59 1h6.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1h.01z"}))}var r=n("../node_modules/react/react.js");s.displayName="ListUnordered",s.defaultProps={viewBox:"0 0 12 16"},e.exports=s,s.default=s},"../node_modules/octicons/build/svg/milestone.svg":function(e,t,n){function s(e){return r.createElement("svg",e,r.createElement("path",{fillRule:"evenodd",d:"M8 2H6V0h2v2zm4 5H2c-.55 0-1-.45-1-1V4c0-.55.45-1 1-1h10l2 2-2 2zM8 4H6v2h2V4zM6 16h2V8H6v8z"}))}var r=n("../node_modules/react/react.js");s.displayName="Milestone",s.defaultProps={viewBox:"0 0 14 16"},e.exports=s,s.default=s},"../node_modules/octicons/build/svg/note.svg":function(e,t,n){function s(e){return r.createElement("svg",e,r.createElement("path",{fillRule:"evenodd",d:"M3 10h4V9H3v1zm0-2h6V7H3v1zm0-2h8V5H3v1zm10 6H1V3h12v9zM1 2c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1H1z"}))}var r=n("../node_modules/react/react.js");s.displayName="Note",s.defaultProps={viewBox:"0 0 14 16"},e.exports=s,s.default=s},"../node_modules/octicons/build/svg/person.svg":function(e,t,n){function s(e){return r.createElement("svg",e,r.createElement("path",{fillRule:"evenodd",d:"M12 14.002a.998.998 0 0 1-.998.998H1.001A1 1 0 0 1 0 13.999V13c0-2.633 4-4 4-4s.229-.409 0-1c-.841-.62-.944-1.59-1-4 .173-2.413 1.867-3 3-3s2.827.586 3 3c-.056 2.41-.159 3.38-1 4-.229.59 0 1 0 1s4 1.367 4 4v1.002z"}))}var r=n("../node_modules/react/react.js");s.displayName="Person",s.defaultProps={viewBox:"0 0 12 16"},e.exports=s,s.default=s},"../node_modules/octicons/build/svg/repo-push.svg":function(e,t,n){function s(e){return r.createElement("svg",e,r.createElement("path",{fillRule:"evenodd",d:"M4 3H3V2h1v1zM3 5h1V4H3v1zm4 0L4 9h2v7h2V9h2L7 5zm4-5H1C.45 0 0 .45 0 1v12c0 .55.45 1 1 1h4v-1H1v-2h4v-1H2V1h9.02L11 10H9v1h2v2H9v1h2c.55 0 1-.45 1-1V1c0-.55-.45-1-1-1z"}))}var r=n("../node_modules/react/react.js");s.displayName="RepoPush",s.defaultProps={viewBox:"0 0 12 16"},e.exports=s,s.default=s},"../node_modules/octicons/build/svg/repo.svg":function(e,t,n){function s(e){return r.createElement("svg",e,r.createElement("path",{fillRule:"evenodd",d:"M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"}))}var r=n("../node_modules/react/react.js");s.displayName="Repo",s.defaultProps={viewBox:"0 0 12 16"},e.exports=s,s.default=s},"../node_modules/promise/index.js":function(e,t,n){"use strict";e.exports=n("../node_modules/promise/lib/index.js")},"../node_modules/promise/lib/core.js":function(e,t,n){"use strict";function s(){}function r(e){try{return e.then}catch(e){return v=e,b}}function o(e,t){try{return e(t)}catch(e){return v=e,b}}function i(e,t,n){try{e(t,n)}catch(e){return v=e,b}}function a(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("Promise constructor's argument is not a function");this._40=0,this._65=0,this._55=null,this._72=null,e!==s&&f(e,this)}function l(e,t,n){return new e.constructor(function(r,o){var i=new a(s);i.then(r,o),c(e,new h(t,n,i))})}function c(e,t){for(;3===e._65;)e=e._55;if(a._37&&a._37(e),0===e._65)return 0===e._40?(e._40=1,void(e._72=t)):1===e._40?(e._40=2,void(e._72=[e._72,t])):void e._72.push(t);d(e,t)}function d(e,t){g(function(){var n=1===e._65?t.onFulfilled:t.onRejected;if(null===n)return void(1===e._65?u(t.promise,e._55):p(t.promise,e._55));var s=o(n,e._55);s===b?p(t.promise,v):u(t.promise,s)})}function u(e,t){if(t===e)return p(e,new TypeError("A promise cannot be resolved with itself."));if(t&&("object"==typeof t||"function"==typeof t)){var n=r(t);if(n===b)return p(e,v);if(n===e.then&&t instanceof a)return e._65=3,e._55=t,void m(e);if("function"==typeof n)return void f(n.bind(t),e)}e._65=1,e._55=t,m(e)}function p(e,t){e._65=2,e._55=t,a._87&&a._87(e,t),m(e)}function m(e){if(1===e._40&&(c(e,e._72),e._72=null),2===e._40){for(var t=0;t<e._72.length;t++)c(e,e._72[t]);e._72=null}}function h(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function f(e,t){var n=!1,s=i(e,function(e){n||(n=!0,u(t,e))},function(e){n||(n=!0,p(t,e))});n||s!==b||(n=!0,p(t,v))}var g=n("../node_modules/asap/browser-raw.js"),v=null,b={};e.exports=a,a._37=null,a._87=null,a._61=s,a.prototype.then=function(e,t){if(this.constructor!==a)return l(this,e,t);var n=new a(s);return c(this,new h(e,t,n)),n}},"../node_modules/promise/lib/done.js":function(e,t,n){"use strict";var s=n("../node_modules/promise/lib/core.js");e.exports=s,s.prototype.done=function(e,t){(arguments.length?this.then.apply(this,arguments):this).then(null,function(e){setTimeout(function(){throw e},0)})}},"../node_modules/promise/lib/es6-extensions.js":function(e,t,n){"use strict";function s(e){var t=new r(r._61);return t._65=1,t._55=e,t}var r=n("../node_modules/promise/lib/core.js");e.exports=r;var o=s(!0),i=s(!1),a=s(null),l=s(void 0),c=s(0),d=s("");r.resolve=function(e){if(e instanceof r)return e;if(null===e)return a;if(void 0===e)return l;if(!0===e)return o;if(!1===e)return i;if(0===e)return c;if(""===e)return d;if("object"==typeof e||"function"==typeof e)try{var t=e.then;if("function"==typeof t)return new r(t.bind(e))}catch(e){return new r(function(t,n){n(e)})}return s(e)},r.all=function(e){var t=Array.prototype.slice.call(e);return new r(function(e,n){function s(i,a){if(a&&("object"==typeof a||"function"==typeof a)){if(a instanceof r&&a.then===r.prototype.then){for(;3===a._65;)a=a._55;return 1===a._65?s(i,a._55):(2===a._65&&n(a._55),void a.then(function(e){s(i,e)},n))}var l=a.then;if("function"==typeof l){return void new r(l.bind(a)).then(function(e){s(i,e)},n)}}t[i]=a,0==--o&&e(t)}if(0===t.length)return e([]);for(var o=t.length,i=0;i<t.length;i++)s(i,t[i])})},r.reject=function(e){return new r(function(t,n){n(e)})},r.race=function(e){return new r(function(t,n){e.forEach(function(e){r.resolve(e).then(t,n)})})},r.prototype.catch=function(e){return this.then(null,e)}},"../node_modules/promise/lib/finally.js":function(e,t,n){"use strict";var s=n("../node_modules/promise/lib/core.js");e.exports=s,s.prototype.finally=function(e){return this.then(function(t){return s.resolve(e()).then(function(){return t})},function(t){return s.resolve(e()).then(function(){throw t})})}},"../node_modules/promise/lib/index.js":function(e,t,n){"use strict";e.exports=n("../node_modules/promise/lib/core.js"),n("../node_modules/promise/lib/done.js"),n("../node_modules/promise/lib/finally.js"),n("../node_modules/promise/lib/es6-extensions.js"),n("../node_modules/promise/lib/node-extensions.js"),n("../node_modules/promise/lib/synchronous.js")},"../node_modules/promise/lib/node-extensions.js":function(e,t,n){"use strict";function s(e,t){for(var n=[],s=0;s<t;s++)n.push("a"+s);var r=["return function ("+n.join(",")+") {","var self = this;","return new Promise(function (rs, rj) {","var res = fn.call(",["self"].concat(n).concat([a]).join(","),");","if (res &&",'(typeof res === "object" || typeof res === "function") &&','typeof res.then === "function"',") {rs(res);}","});","};"].join("");return Function(["Promise","fn"],r)(o,e)}function r(e){for(var t=Math.max(e.length-1,3),n=[],s=0;s<t;s++)n.push("a"+s);var r=["return function ("+n.join(",")+") {","var self = this;","var args;","var argLength = arguments.length;","if (arguments.length > "+t+") {","args = new Array(arguments.length + 1);","for (var i = 0; i < arguments.length; i++) {","args[i] = arguments[i];","}","}","return new Promise(function (rs, rj) {","var cb = "+a+";","var res;","switch (argLength) {",n.concat(["extra"]).map(function(e,t){return"case "+t+":res = fn.call("+["self"].concat(n.slice(0,t)).concat("cb").join(",")+");break;"}).join(""),"default:","args[argLength] = cb;","res = fn.apply(self, args);","}","if (res &&",'(typeof res === "object" || typeof res === "function") &&','typeof res.then === "function"',") {rs(res);}","});","};"].join("");return Function(["Promise","fn"],r)(o,e)}var o=n("../node_modules/promise/lib/core.js"),i=n("../node_modules/asap/browser-asap.js");e.exports=o,o.denodeify=function(e,t){return"number"==typeof t&&t!==1/0?s(e,t):r(e)};var a="function (err, res) {if (err) { rj(err); } else { rs(res); }}";o.nodeify=function(e){return function(){var t=Array.prototype.slice.call(arguments),n="function"==typeof t[t.length-1]?t.pop():null,s=this;try{return e.apply(this,arguments).nodeify(n,s)}catch(e){if(null===n||void 0===n)return new o(function(t,n){n(e)});i(function(){n.call(s,e)})}}},o.prototype.nodeify=function(e,t){if("function"!=typeof e)return this;this.then(function(n){i(function(){e.call(t,null,n)})},function(n){i(function(){e.call(t,n)})})}},"../node_modules/promise/lib/synchronous.js":function(e,t,n){"use strict";var s=n("../node_modules/promise/lib/core.js");e.exports=s,s.enableSynchronous=function(){s.prototype.isPending=function(){return 0==this.getState()},s.prototype.isFulfilled=function(){return 1==this.getState()},s.prototype.isRejected=function(){return 2==this.getState()},s.prototype.getValue=function(){if(3===this._65)return this._55.getValue();if(!this.isFulfilled())throw new Error("Cannot get a value of an unfulfilled promise.");return this._55},s.prototype.getReason=function(){if(3===this._65)return this._55.getReason();if(!this.isRejected())throw new Error("Cannot get a rejection reason of a non-rejected promise.");return this._55},s.prototype.getState=function(){return 3===this._65?this._55.getState():-1===this._65||-2===this._65?0:this._65}},s.disableSynchronous=function(){s.prototype.isPending=void 0,s.prototype.isFulfilled=void 0,s.prototype.isRejected=void 0,s.prototype.getValue=void 0,s.prototype.getReason=void 0,s.prototype.getState=void 0}},"../node_modules/relaks/index.js":function(e,t,n){function s(){}function r(e,t){var n=e.relaks;this.component=e,this.synchronous=!0,this.showingProgress=!1,this.showingProgressInitially=!1,this.delayWhenEmpty=50,this.delayWhenRendered=1/0,this.canceled=!1,this.prior=t?t.prior:n.previous,this.previous=n.previous,this.current=n.current,this.updateTimeout=0,this.startTime=u(),this.onCancel=null,this.onComplete=null,this.onProgress=null}function o(){this.message="Async rendering interrupted"}function i(e){if(e.render)throw new Error("Class definition should not contain render()");if(!e.renderAsync)throw new Error("Class definition should contain renderAsync()");var t=s.prototype;return e=l(e),e.render=t.render,e.componentWillMount=d(e.componentWillMount,t.componentWillMount),e.componentWillUnmount=d(e.componentWillUnmount,t.componentWillUnmount),e.shouldComponentUpdate=e.shouldComponentUpdate||t.shouldComponentUpdate,p.createClass(e)}function a(e){return!(!e||"function"!=typeof e.then)}function l(e){var t={};for(var n in e)t[n]=e[n];return t}function c(e,t){if(e===t)return!0;if(!e||!t)return!1;for(var n in t){var s=e[n];if(t[n]!==s)return!1}return!0}function d(e,t){return e?function(){e.call(this),t.call(this)}:t}function u(){return new Date-m}var p=n("../node_modules/react/react.js");t.Component=s,t.createClass=i,t.AsyncRenderingInterrupted=o,t.Meanwhile=r,s.prototype=Object.create(p.Component.prototype),s.prototype.constructor=s,s.prototype.render=function(){var e=this.relaks;if(!e)return console.warn("Relaks context is missing. Make sure you are calling componentWillMount() and componentWillUnmount() of the superclass"),null;if(e.promisedElementExpected)return e.promisedElementExpected=!1,e.progressElement=null,e.progressElementRendered=null,e.promisedElement;if(e.progressElementExpected)return e.progressElementExpected=!1,e.progressElementRendered=e.progressElement,e.progressElement;var t=e.meanwhile;if(t){e.meanwhile=null;try{t.cancel()}catch(e){console.error(e)}}e.previous=e.current,e.current={props:this.props,state:this.state||{}};var n=e.meanwhile=new r(this,t);try{var s=this.renderAsync(n);n.synchronous=!1}catch(t){return console.error(t),e.meanwhile.clear(),e.meanwhile=null,e.progressElement||e.progressElementRendered||e.promisedElement}if(a(s)){var i=this,l=function(t){n!==e.meanwhile?n.cancel():i.relaks?(n.finish(),e.promisedElement=t,e.promisedElementExpected=!0,e.meanwhile=null,i.forceUpdate()):n.cancel()},c=function(t){if(t instanceof o);else{console.error(t);var n=e.progressElement||e.promisedElement;l(n)}};s.then(l,c)}else{var d=s;e.meanwhile=null,e.promisedElement=d,e.progressElement=null,e.progressElementRendered=null}return e.promisedElement?e.promisedElement:e.progressElement&&(n.showingProgress||n.showingProgressInitially)?e.progressElement:e.progressElementRendered?e.progressElementRendered:null},s.prototype.shouldComponentUpdate=function(e,t){return!c(this.props,e)||!c(this.state,t)},s.prototype.componentWillMount=function(){this.relaks={progressElement:null,progressElementExpected:!1,promisedElement:null,promisedElementExpected:!1,progressElementRendered:null,meanwhile:null,previous:null,current:{props:{},state:{}}}},s.prototype.componentWillUnmount=function(){var e=this.relaks;e&&(e.meanwhile&&e.meanwhile.cancel(),this.relaks=void 0)},r.prototype.check=function(){var e=this.component.relaks;if(!e||this!==e.meanwhile)throw new o},r.prototype.show=function(e,t){var n=this.component.relaks;if(this.check(),n.progressElement=e,this.showingProgress)return this.update(),!0;if("always"===t)return this.update(!0),!0;if("initial"===t&&!n.promisedElement&&!n.progressElementRendered)return this.update(!0),!0;if(this.updateTimeout)return!1;var s;if((s=n.promisedElement?this.delayWhenRendered:this.delayWhenEmpty)>0){if(s!==1/0){var r=this;this.updateTimeout=setTimeout(function(){0!==r.updateTimeout&&r.update()},s)}return!1}return this.update(),!0},r.prototype.revising=function(){return!!this.component.relaks.promisedElement},r.prototype.delay=function(e,t){this.delayWhenEmpty=e,this.delayWhenRendered=t},r.prototype.update=function(e){var t=this.component.relaks;if(e||(this.showingProgress=!0),t.promisedElement&&(t.promisedElement=null),this.synchronous)return void(e&&(this.showingProgressInitially=!0));if(this.onProgress){var n=u()-this.startTime;this.onProgress({type:"progress",target:this,elapsed:n})}t.progressElement!==t.progressElementRendered&&(t.progressElementExpected=!0,this.component.forceUpdate())},r.prototype.cancel=function(){this.clear(),this.canceled||(this.canceled=!0,this.onCancel&&this.onCancel({type:"cancel",target:this}))},r.prototype.finish=function(){if(this.clear(),this.onComplete){var e=u()-this.startTime;this.onComplete({type:"complete",target:this,elapsed:e})}},r.prototype.clear=function(){this.component.relaks;this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updateTimeout=0)},o.prototype=Object.create(Error.prototype);var m=new Date},"../node_modules/timers-ext/max-timeout.js":function(e,t,n){"use strict";e.exports=2147483647},"../node_modules/timers-ext/valid-timeout.js":function(e,t,n){"use strict";var s=n("../node_modules/es5-ext/number/to-pos-integer.js"),r=n("../node_modules/timers-ext/max-timeout.js");e.exports=function(e){if((e=s(e))>r)throw new TypeError(e+" exceeds maximum possible timeout");return e}},"./application.jsx":function(e,t,n){"use strict";function s(e){for(;e&&"A"!==e.tagName;)e=e.parentNode;return e}var r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},i=n("../node_modules/lodash/lodash.js"),a=n("../node_modules/bluebird/js/browser/bluebird.js"),l=n("../node_modules/react/react.js"),c=(l.PropTypes,n("../../common/src/utils/component-refs.js")),d=(n("../../common/src/errors/http-error.js"),n("../../common/src/routing/cors-rewriter.js")),u=n("../../common/src/data/remote-data-source/index.jsx"),p=n("../../common/src/data/database.js"),m=n("../../common/src/routing/route-manager.jsx"),h=n("../../common/src/routing/route.js"),f=n("../../common/src/transport/payload-manager.jsx"),g=n("../../common/src/transport/payloads.js"),v=n("../../common/src/locale/locale-manager.jsx"),b=n("../../common/src/locale/locale.js"),y=n("../../common/src/theme/theme-manager.jsx"),j=n("../../common/src/theme/theme.js"),x=n("../../common/src/data/subscription-manager.jsx"),w=n("../../common/src/data/session-manager.jsx"),_=n("./pages/project-list-page.jsx"),E=n("./pages/project-summary-page.jsx"),k=n("./pages/member-list-page.jsx"),C=n("./pages/role-list-page.jsx"),S=n("./pages/role-summary-page.jsx"),R=n("./pages/repo-list-page.jsx"),O=n("./pages/repo-summary-page.jsx"),T=n("./pages/server-list-page.jsx"),P=n("./pages/server-summary-page.jsx"),N=n("./pages/settings-page.jsx"),L=n("./pages/start-page.jsx"),I=n("./pages/user-list-page.jsx"),M=n("./pages/user-summary-page.jsx"),A=n("./pages/sign-in-page.jsx"),z=n("./pages/error-page.jsx"),D=n("./widgets/side-navigation.jsx"),U=n("./widgets/task-alert-bar.jsx"),q=n("../../common/src/widgets/upload-progress.jsx"),B=n("../../common/src/data/indexed-db-cache.jsx"),H=n("../../common/src/data/local-storage-cache.jsx");B.isAvailable()?r=B:H.isAvailable()&&(r=H);var F=n("../../common/src/transport/websocket-notifier.jsx"),W=[_,E,k,C,S,R,O,T,P,N,L,I,M,z];n("../node_modules/setimmediate/setImmediate.js"),n("../../common/src/utils/lodash-extra.js"),n("./application.scss"),n("../node_modules/font-awesome-webpack/index.js"),e.exports=l.createClass({displayName:"Application",getInitialState:function(){return this.components=c({remoteDataSource:u,routeManager:m,localeManager:v,themeManager:y,payloadManager:f,cache:r,notifier:F,subscriptionManager:x,sessionManager:w}),{database:null,payloads:null,route:null,locale:null,theme:null,canAccessServer:!1,connection:null,showingUploadProgress:!1}},isReady:function(){return!!(this.state.database&&this.state.payloads&&this.state.route&&this.state.locale&&this.state.theme)},render:function(){return l.createElement("div",{onClick:this.handleClick},this.renderUserInterface(),this.renderConfiguration())},renderUserInterface:function(){if(!this.isReady())return null;var e={database:this.state.database,route:this.state.route,locale:this.state.locale,theme:this.state.theme,disabled:!this.state.canAccessServer};return l.createElement("div",{className:"application",id:"application"},l.createElement(D,e),l.createElement("section",{className:"page-view-port"},l.createElement("div",{className:"scroll-box"},this.renderCurrentPage()),this.renderTaskAlert(),this.renderUploadProgress()))},renderCurrentPage:function(){var e=this.state.route.component,t={database:this.state.database,route:this.state.route,payloads:this.state.payloads,locale:this.state.locale,theme:this.state.theme};return this.state.canAccessServer||e!==z&&(e=A),l.createElement(e,t)},renderTaskAlert:function(){if(!this.state.canAccessServer)return null;var e={database:this.state.database,route:this.state.route,payloads:this.state.payloads,locale:this.state.locale,theme:this.state.theme};return l.createElement(U,e)},renderConfiguration:function(){var e=this.components.setters,t=this.state.route,s=t?t.parameters.address:null,i={ref:e.remoteDataSource,basePath:"/srv/admin-data",online:this.state.online,connected:!!this.state.connection||void 0,retrievalFlags:{include_ctime:!0,include_mtime:!0},discoveryFlags:{include_deleted:!0},onChange:this.handleDatabaseChange,onAuthorization:this.handleAuthorization,onExpiration:this.handleExpiration,onStupefaction:this.handleStupefaction},a={ref:e.payloadManager,online:this.state.online,database:this.state.database,route:this.state.route,onChange:this.handlePayloadsChange},c={ref:e.routeManager,pages:W,database:this.state.database,rewrite:this.rewriteURL,onChange:this.handleRouteChange,onRedirectionRequest:this.handleRedirectionRequest},d={ref:e.localeManager,database:this.state.database,directory:n("../../common/src/languages.js"),onChange:this.handleLocaleChange},p={ref:e.themeManager,database:this.state.database,modes:{"ultra-narrow":0,narrow:700,standard:1e3,wide:1400,"super-wide":1700,"ultra-wide":2e3},serverAddress:s,onChange:this.handleThemeChange},h={ref:e.cache,databaseName:"trambar-admin"},g={ref:e.notifier,serverAddress:s,online:this.state.online,locale:this.state.locale,onNotify:this.handleChangeNotification,onConnect:this.handleConnection,onDisconnect:this.handleDisconnection},b={ref:e.subscriptionManager,area:"admin",connection:this.state.connection||null,schema:"*",database:this.state.database,locale:this.state.locale},j={ref:e.sessionManager,database:this.state.database};return l.createElement("div",null,l.createElement(r,h),l.createElement(F,g),l.createElement(u,o({},i,{cache:this.components.cache})),l.createElement(f,a),l.createElement(m,c),l.createElement(v,d),l.createElement(y,p),l.createElement(x,b),l.createElement(w,j))},renderUploadProgress:function(){if(!this.state.showingUploadProgress)return null;var e={payloads:this.state.payloads,locale:this.state.locale};return l.createElement(q,e)},componentDidMount:function(){window.addEventListener("beforeunload",this.handleBeforeUnload)},componentDidUpdate:function(e,t){var n=this;!this.splashScreenHidden&&this.isReady()&&(this.splashScreenHidden=!0,setTimeout(function(){n.hideSplashScreen()},100))},componentWillUnmount:function(){window.removeEventListener("beforeunload",this.handleBeforeUnload)},rewriteURL:function(e,t,n){"parse"===n?d.extract(e,t):(this.state.route&&(t=i.defaults(t,this.state.route.parameters)),d.insert(e,t))},handleDatabaseChange:function(e){var t;this.state.route&&(t={address:this.state.route.parameters.address,schema:this.state.route.parameters.schema});var n=new p(e.target,t);this.setState({database:n})},handleAuthorization:function(e){this.components.sessionManager.saveToCache(e.session);var t=this.state.route.parameters.address;e.session.address===t&&this.setState({canAccessServer:!0})},handleExpiration:function(e){this.components.sessionManager.removeFromCache(e.session);var t=this.state.route.parameters.address;e.session.address===t&&this.setState({canAccessServer:!1})},handleStupefaction:function(e){this.state.route.replace(n("./pages/error-page.jsx"),{code:404})},handlePayloadsChange:function(e){var t=new g(e.target),n=this.state.showingUploadProgress;t.uploading||(n=!1),this.setState({payloads:t,showingUploadProgress:n})},handleLocaleChange:function(e){var t=new b(e.target);this.setState({locale:t}),document.title=t.translate("app-title")},handleRouteChange:function(e){var t=this,n=new h(e.target),s=n.parameters.address,r=this.state.database;if(s!=this.state.database.context.address){var o=this.components.remoteDataSource;r=new p(o,{address:s})}r.hasAuthorization()?this.setState({route:n,database:r,canAccessServer:!0}):this.components.sessionManager.loadFromCache(s).then(function(e){e&&r.restoreSession(e),r.hasAuthorization()?t.setState({route:n,database:r,canAccessServer:!0}):t.setState({route:n,database:r,canAccessServer:!1})})},handleRedirectionRequest:function(e){var t=e.target,n=t.find(z,{code:404});return a.resolve(n)},handleClick:function(e){if(0===e.button){var t=s(e.target);if(t&&!t.target&&!t.download){var n=t.getAttribute("href")||t.getAttribute("data-url");n&&-1===n.indexOf(":")&&(this.state.route.change(n),e.preventDefault(),t.blur())}}},handleThemeChange:function(e){var t=new j(e.target);this.setState({theme:t})},handleConnection:function(e){this.setState({connection:e.connection})},handleDisconnection:function(e){this.setState({connection:null})},handleChangeNotification:function(e){this.components.remoteDataSource.invalidate(e.changes)},handleBeforeUnload:function(e){if(this.state.payloads&&this.state.payloads.uploading)return this.setState({showingUploadProgress:!0}),e.returnValue="Are you sure?"},hideSplashScreen:function(){var e=document.getElementById("splash-screen"),t=document.getElementById("splash-screen-style");e&&(e.className="transition-out",setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e),t&&t.parentNode&&t.parentNode.removeChild(t)},1e3))}})},"./application.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./application.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./dialogs/confirmation-dialog-box.jsx":function(e,t,n){"use strict";var s=(n("../node_modules/lodash/lodash.js"),n("../node_modules/react/react.js")),r=s.PropTypes,o=n("../../common/src/locale/locale.js"),i=n("../../common/src/theme/theme.js"),a=n("../../common/src/widgets/overlay.jsx"),l=n("./widgets/push-button.jsx");n("./dialogs/confirmation-dialog-box.scss"),e.exports=s.createClass({displayName:"ConfirmationDialogBox",propTypes:{show:r.bool,dangerous:r.bool,locale:r.instanceOf(o).isRequired,theme:r.instanceOf(i).isRequired,onConfirm:r.func,onCancel:r.func},getDefaultProps:function(){return{show:!0,dangerous:!0}},render:function(){var e=this.props.locale.translate,t={show:this.props.show,onBackgroundClick:this.handleCancelClick},n={className:"cancel",onClick:this.handleCancelClick},r={className:this.props.dangerous?"danger":"emphasis",onClick:this.handleConfirmClick};return s.createElement(a,t,s.createElement("div",{className:"confirmation-dialog-box"},s.createElement("div",{className:"message"},this.props.children),s.createElement("div",{className:"buttons"},s.createElement(l,n,e("confirmation-cancel"))," ",s.createElement(l,r,e("confirmation-confirm")))))},handleCancelClick:function(e){this.props.onCancel&&this.props.onCancel({type:"cancel",target:this})},handleConfirmClick:function(e){this.props.onConfirm&&this.props.onConfirm({type:"confirm",target:this})}})},"./dialogs/confirmation-dialog-box.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./dialogs/confirmation-dialog-box.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./dialogs/image-album-dialog-box.jsx":function(e,t,n){"use strict";var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/bluebird/js/browser/bluebird.js"),i=n("../node_modules/react/react.js"),a=i.PropTypes,l=n("../node_modules/relaks/index.js"),c=n("../../common/src/utils/memoize.js"),d=n("../../common/src/media/media-loader.js"),u=n("../../common/src/objects/finders/picture-finder.js"),p=n("../../common/src/data/database.js"),m=n("../../common/src/locale/locale.js"),h=n("../../common/src/theme/theme.js"),f=n("../../common/src/transport/payloads.js"),g=n("../../common/src/widgets/overlay.jsx"),v=n("./widgets/push-button.jsx"),b=n("../../common/src/widgets/resource-view.jsx");n("./dialogs/image-album-dialog-box.scss"),e.exports=l.createClass({displayName:"ImageAlbumDialogBox",propTypes:{show:a.bool,purpose:a.string.isRequired,image:a.object,database:a.instanceOf(p).isRequired,locale:a.instanceOf(m).isRequired,theme:a.instanceOf(h).isRequired,payloads:a.instanceOf(f).isRequired,onSelect:a.func,onCancel:a.func},getInitialState:function(){return{shown:!1}},componentWillReceiveProps:function(e){e.show&&this.setState({shown:!0})},renderAsync:function(e){var t=this,n=this.props.database.use({schema:"global",by:this}),s={pictures:null,show:this.props.show,purpose:this.props.purpose,image:this.props.image,database:this.props.database,locale:this.props.locale,theme:this.props.theme,payloads:this.props.payloads,onSelect:this.props.onSelect,onCancel:this.props.onCancel};return n.start().then(function(e){if(t.props.show||t.state.shown)return u.findPictures(n,t.props.purpose).then(function(e){s.pictures=e})}).then(function(){return i.createElement(y,s)})}});var y=e.exports.Sync=i.createClass({displayName:"ImageAlbumDialogBox.Sync",propTypes:{show:a.bool,projects:a.arrayOf(a.object),purpose:a.string.isRequired,image:a.object,database:a.instanceOf(p).isRequired,locale:a.instanceOf(m).isRequired,theme:a.instanceOf(h).isRequired,payloads:a.instanceOf(f).isRequired,onSelect:a.func,onCancel:a.func},getInitialState:function(){return{managingImages:!1,selectedPictureId:null,deletionCandidateIds:[],isDropTarget:!1}},render:function(){var e={show:this.props.show,onBackgroundClick:this.handleBackgroundClick},t={className:"image-album-dialog-box",onDragEnter:this.handleDragEnter};return i.createElement(g,e,i.createElement("div",t,this.renderPictures(),this.renderButtons(),this.renderDropIndicator()))},renderPictures:function(){var e=j(this.props.pictures);return i.createElement("div",{className:"scrollable"},r.map(e,this.renderPicture))},renderPicture:function(e,t){var n=e.details,o={className:"picture",onClick:this.handleImageClick,"data-picture-id":e.id};return this.state.managingImages?r.includes(this.state.deletionCandidateIds,e.id)&&(o.className+=" deleting"):this.state.selectedPictureId?this.state.selectedPictureId===e.id&&(o.className+=" selected"):this.props.image&&this.props.image.url===e.url&&(o.className+=" selected"),i.createElement("div",s({key:t},o),i.createElement(b,{resource:n,height:120,theme:this.props.theme}))},renderButtons:function(){var e=this.props.locale.translate;if(this.state.managingImages){var t={type:"file",value:"",accept:"image/*",multiple:!0,onChange:this.handleUploadChange},n={className:"remove",disabled:r.isEmpty(this.state.deletionCandidateIds),onClick:this.handleRemoveClick},s={className:"done",onClick:this.handleDoneClick};return i.createElement("div",{key:"manage",className:"buttons"},i.createElement("div",{className:"left"},i.createElement(v,n,e("image-album-remove"))," ",i.createElement("label",{className:"push-button"},e("image-album-upload"),i.createElement("input",t))),i.createElement("div",{className:"right"},i.createElement(v,s,e("image-album-done"))))}var o={className:"manage",onClick:this.handleManageClick},a={className:"cancel",onClick:this.handleCancelClick},l={className:"select",disabled:!this.state.selectedPictureId,onClick:this.handleSelectClick};return i.createElement("div",{key:"select",className:"buttons"},i.createElement("div",{className:"left"},i.createElement(v,o,e("image-album-manage"))),i.createElement("div",{className:"right"},i.createElement(v,a,e("image-album-cancel"))," ",i.createElement(v,l,e("image-album-select"))))},renderDropIndicator:function(){if(!this.state.isDropTarget)return null;var e={className:"drop-target",onDragLeave:this.handleDragLeave,onDragOver:this.handleDragOver,onDrop:this.handleDrop};return i.createElement("div",e)},uploadPictures:function(e){var t=this;e=r.filter(e,function(e){return/^image\//.test(e.type)});var n=this.props.database.use({schema:"global",by:this});return n.start().then(function(s){return o.mapSeries(e,function(e,n){var r=t.props.payloads.add("image").attachFile(e);return d.getImageMetadata(e).then(function(e){return{purpose:t.props.purpose,user_id:s,details:{payload_token:r.token,width:e.width,height:e.height,format:e.format}}})}).then(function(e){return n.save({table:"picture"},e).each(function(e){return t.props.payloads.dispatch(e),null})})})},removePictures:function(e){var t=r.keyBy(this.props.pictures,"id"),n=r.filter(r.map(e,function(e){return t[e]}));if(!r.isEmpty(n)){var s=this.props.database.use({schema:"global",by:this});return s.start().then(function(e){var t=r.map(n,function(e){return{id:e.id,deleted:!0}});return s.save({table:"picture"},t)})}},handleImageClick:function(e){var t=parseInt(e.currentTarget.getAttribute("data-picture-id"));if(this.state.managingImages){var n=r.slice(this.state.deletionCandidateIds);r.includes(this.state.deletionCandidateIds,t)?r.pull(n,t):n.push(t),this.setState({deletionCandidateIds:n})}else{var s=t,o=r.find(this.props.pictures,{id:t});this.props.image&&o.url===this.props.image.url&&(s=null),this.setState({selectedPictureId:s})}},handleManageClick:function(e){this.setState({managingImages:!0})},handleDoneClick:function(e){this.setState({managingImages:!1,deletionCandidateIds:[]})},handleCancelClick:function(e){this.props.onCancel&&this.props.onCancel({type:"cancel",target:this})},handleSelectClick:function(e){if(this.props.onSelect){var t=this.state.selectedPictureId,n=r.find(this.props.pictures,{id:t});this.props.onSelect({type:"select",target:this,image:n.details})}},handleBackgroundClick:function(e){this.props.onCancel&&this.props.onCancel({type:"cancel",target:this})},handleUploadChange:function(e){var t=e.target.files;if(t.length)return this.uploadPictures(t)},handleDragEnter:function(e){this.setState({isDropTarget:!0})},handleDragLeave:function(e){this.setState({isDropTarget:!1})},handleDragOver:function(e){e.preventDefault()},handleDrop:function(e){e.preventDefault();var t=e.dataTransfer.files;e.dataTransfer.items;t.length>0&&this.uploadPictures(t),this.setState({isDropTarget:!1})},handleRemoveClick:function(e){var t=this,n=this.state.deletionCandidateIds;this.setState({deletionCandidateIds:[]},function(){t.removePictures(n)})}}),j=c(function(e){return r.orderBy(e,"mtime","desc")})},"./dialogs/image-album-dialog-box.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./dialogs/image-album-dialog-box.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./dialogs/image-cropping-dialog-box.jsx":function(e,t,n){"use strict";function s(e){return o.startsWith(e,"json:")}function r(e){var t=e.substr(5);return JSON.parse(t)}var o=n("../node_modules/lodash/lodash.js"),i=n("../node_modules/react/react.js"),a=i.PropTypes,l=(n("../../common/src/data/database.js"),n("../../common/src/locale/locale.js")),c=n("../../common/src/theme/theme.js"),d=n("../../common/src/widgets/overlay.jsx"),u=n("./widgets/push-button.jsx"),p=n("../../common/src/widgets/image-cropper.jsx");n("./dialogs/image-cropping-dialog-box.scss"),e.exports=i.createClass({displayName:"ImageCroppingDialogBox",propTypes:{image:a.object,desiredWidth:a.number,desiredHeight:a.number,locale:a.instanceOf(l).isRequired,theme:a.instanceOf(c).isRequired,onSelect:a.func,onCancel:a.func},getInitialState:function(){return{clippingRect:this.props.image.clip,hasChanged:!1}},zoom:function(e){var t=this.resizeClippingRect(e);this.setState({clippingRect:t})},canZoom:function(e){var t=this.resizeClippingRect(e);return!o.isEqual(t,this.state.clippingRect)},resizeClippingRect:function(e){var t=this.state.clippingRect,n=Math.round(t.width*e),s=Math.round(t.height*e),r=this.props.image.width,o=this.props.image.height,i=this.props.desiredWidth/this.props.desiredHeight;n>r&&(n=r,s=Math.round(n/i)),s>o&&(s=o,n=Math.round(s*i));var a=t.left-Math.round((n-t.width)/2),l=t.top-Math.round((s-t.height)/2);return a<0&&(a=0),l<0&&(l=0),{left:a,top:l,width:n,height:s}},render:function(){return i.createElement(d,{show:this.props.show},i.createElement("div",{className:"image-cropping-dialog-box"},this.renderImage(),this.renderButtons()))},renderImage:function(){var e=this.props.image,t=this.props.theme.getImageURL(e,{clip:null});if(s(t)){t=r(t).url}var n={url:t,clippingRect:this.state.clippingRect,vector:"svg"===e.format,onChange:this.handleChange},o={width:this.props.desiredWidth,height:this.props.desiredHeight};return i.createElement("div",{className:"image",style:o},i.createElement(p,n))},renderButtons:function(){var e=this.props.locale.translate,t={className:"zoom",disabled:!this.canZoom(1/.9),onClick:this.handleZoomOutClick},n={className:"zoom",disabled:!this.canZoom(.9),onClick:this.handleZoomInClick},s={className:"cancel",onClick:this.handleCancelClick},r={className:"select",disabled:!this.state.hasChanged,onClick:this.handleSelectClick};return i.createElement("div",{key:"select",className:"buttons"},i.createElement("div",{className:"left"},i.createElement(u,t,i.createElement("i",{className:"fa fa-search-minus"})),i.createElement(u,n,i.createElement("i",{className:"fa fa-search-plus"}))),i.createElement("div",{className:"right"},i.createElement(u,s,e("image-cropping-cancel"))," ",i.createElement(u,r,e("image-cropping-select"))))},handleChange:function(e){var t=this.props.image,n=o.mapValues(e.rect,function(e){return Math.round(e)}),s=!0;o.isEqual(n,t.rect)&&(s=!1),this.setState({clippingRect:n,hasChanged:s})},handleCancelClick:function(e){this.props.onCancel&&this.props.onCancel({type:"cancel",target:this})},handleSelectClick:function(e){this.props.onSelect&&this.props.onSelect({type:"select",target:this,clippingRect:this.state.clippingRect})},handleZoomInClick:function(e){this.zoom(.9)},handleZoomOutClick:function(e){this.zoom(1/.9)}})},"./dialogs/image-cropping-dialog-box.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./dialogs/image-cropping-dialog-box.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./instructions lazy recursive ^\\.\\/.*$":function(e,t,n){function s(e){var t=r[e];return t?n.e(t[1]).then(function(){return n(t[0])}):Promise.reject(new Error("Cannot find module '"+e+"'."))}var r={"./project/project-summary.en.md":["./instructions/project/project-summary.en.md",11],"./repo/repo-summary.en.md":["./instructions/repo/repo-summary.en.md",10],"./role/role-summary.en.md":["./instructions/role/role-summary.en.md",9],"./server/dropbox-icons.zip":["./instructions/server/dropbox-icons.zip",15],"./server/facebook-icons.zip":["./instructions/server/facebook-icons.zip",14],"./server/github-icons.zip":["./instructions/server/github-icons.zip",13],"./server/icon-64x64-black.png":["./instructions/server/icon-64x64-black.png",18],"./server/icon-64x64-blue.png":["./instructions/server/icon-64x64-blue.png",17],"./server/icon-64x64.png":["./instructions/server/icon-64x64.png",16],"./server/server-summary-dropbox.en.md":["./instructions/server/server-summary-dropbox.en.md",8],"./server/server-summary-facebook.en.md":["./instructions/server/server-summary-facebook.en.md",7],"./server/server-summary-github.en.md":["./instructions/server/server-summary-github.en.md",6],"./server/server-summary-gitlab.en.md":["./instructions/server/server-summary-gitlab.en.md",5],"./server/server-summary-google.en.md":["./instructions/server/server-summary-google.en.md",4],"./server/server-summary-windows.en.md":["./instructions/server/server-summary-windows.en.md",3],"./server/server-summary.en.md":["./instructions/server/server-summary.en.md",2],"./server/windows-icons.zip":["./instructions/server/windows-icons.zip",12],"./settings/settings.en.md":["./instructions/settings/settings.en.md",1],"./user/user-summary.en.md":["./instructions/user/user-summary.en.md",0]};s.keys=function(){return Object.keys(r)},e.exports=s,s.id="./instructions lazy recursive ^\\.\\/.*$"},"./instructions lazy recursive ^\\.\\/.*\\.en\\.md$":function(e,t,n){function s(e){var t=r[e];return t?n.e(t[1]).then(function(){return n(t[0])}):Promise.reject(new Error("Cannot find module '"+e+"'."))}var r={"./project/project-summary.en.md":["./instructions/project/project-summary.en.md",11],"./repo/repo-summary.en.md":["./instructions/repo/repo-summary.en.md",10],"./role/role-summary.en.md":["./instructions/role/role-summary.en.md",9],"./server/server-summary-dropbox.en.md":["./instructions/server/server-summary-dropbox.en.md",8],"./server/server-summary-facebook.en.md":["./instructions/server/server-summary-facebook.en.md",7],"./server/server-summary-github.en.md":["./instructions/server/server-summary-github.en.md",6],"./server/server-summary-gitlab.en.md":["./instructions/server/server-summary-gitlab.en.md",5],"./server/server-summary-google.en.md":["./instructions/server/server-summary-google.en.md",4],"./server/server-summary-windows.en.md":["./instructions/server/server-summary-windows.en.md",3],"./server/server-summary.en.md":["./instructions/server/server-summary.en.md",2],"./settings/settings.en.md":["./instructions/settings/settings.en.md",1],"./user/user-summary.en.md":["./instructions/user/user-summary.en.md",0]};s.keys=function(){return Object.keys(r)},e.exports=s,s.id="./instructions lazy recursive ^\\.\\/.*\\.en\\.md$"},"./instructions lazy recursive ^\\.\\/.*\\.md$":function(e,t,n){function s(e){var t=r[e];return t?n.e(t[1]).then(function(){return n(t[0])}):Promise.reject(new Error("Cannot find module '"+e+"'."))}var r={"./project/project-summary.en.md":["./instructions/project/project-summary.en.md",11],"./repo/repo-summary.en.md":["./instructions/repo/repo-summary.en.md",10],"./role/role-summary.en.md":["./instructions/role/role-summary.en.md",9],"./server/server-summary-dropbox.en.md":["./instructions/server/server-summary-dropbox.en.md",8],"./server/server-summary-facebook.en.md":["./instructions/server/server-summary-facebook.en.md",7],"./server/server-summary-github.en.md":["./instructions/server/server-summary-github.en.md",6],"./server/server-summary-gitlab.en.md":["./instructions/server/server-summary-gitlab.en.md",5],"./server/server-summary-google.en.md":["./instructions/server/server-summary-google.en.md",4],"./server/server-summary-windows.en.md":["./instructions/server/server-summary-windows.en.md",3],"./server/server-summary.en.md":["./instructions/server/server-summary.en.md",2],"./settings/settings.en.md":["./instructions/settings/settings.en.md",1],"./user/user-summary.en.md":["./instructions/user/user-summary.en.md",0]};s.keys=function(){return Object.keys(r)},e.exports=s,s.id="./instructions lazy recursive ^\\.\\/.*\\.md$"},"./pages/error-page.jsx":function(e,t,n){"use strict";var s=n("../node_modules/react/react.js"),r=s.PropTypes,o=n("../../common/src/errors/http-error.js"),i=n("../../common/src/data/database.js"),a=n("../../common/src/routing/route.js"),l=n("../../common/src/locale/locale.js"),c=n("../../common/src/theme/theme.js");n("./pages/error-page.scss"),e.exports=s.createClass({displayName:"ErrorPage",propTypes:{database:r.instanceOf(i).isRequired,route:r.instanceOf(a).isRequired,locale:r.instanceOf(l).isRequired,theme:r.instanceOf(c).isRequired},statics:{parseURL:function(e,t){return a.match(e,["/error/:code"],function(e){return{code:parseInt(e.code)}})},getURL:function(e){var t=e.code;t=e.error?e.error.statusCode:e.code||400;var n="/error/"+t;return{path:n,query:void 0}},getOptions:function(e){return{}}},render:function(){var e=this.props.route.parameters,t=new o(e.code),r=n("../assets/unicorn.svg");return s.createElement("div",{className:"error-page"},s.createElement("div",null,s.createElement("div",{className:"graphic"},s.createElement(r,null)),s.createElement("div",{className:"text"},s.createElement("h1",{className:"title"},t.statusCode," ",t.message),s.createElement("p",null,"The page you're trying to reach doesn't exist. But then again, who does?"))))}})},"./pages/error-page.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/error-page.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./pages/member-list-page.jsx":function(e,t,n){"use strict";var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/moment/moment.js"),i=n("../node_modules/react/react.js"),a=i.PropTypes,l=n("../node_modules/relaks/index.js"),c=n("../../common/src/utils/memoize.js"),d=n("../../common/src/objects/finders/project-finder.js"),u=n("../../common/src/objects/finders/role-finder.js"),p=n("../../common/src/objects/finders/user-finder.js"),m=n("../../common/src/objects/finders/statistics-finder.js"),h=n("../../common/src/data/database.js"),f=n("../../common/src/routing/route.js"),g=n("../../common/src/locale/locale.js"),v=n("../../common/src/theme/theme.js"),b=n("./widgets/push-button.jsx"),y=n("./widgets/combo-button.jsx"),j=n("./widgets/sortable-table.jsx"),x=j.TH,w=n("./widgets/profile-image.jsx"),_=n("./tooltips/activity-tooltip.jsx"),E=n("./tooltips/role-tooltip.jsx"),k=n("./widgets/action-badge.jsx"),C=n("./tooltips/modified-time-tooltip.jsx"),S=n("./widgets/data-loss-warning.jsx");n("./pages/member-list-page.scss"),e.exports=l.createClass({displayName:"MemberListPage",propTypes:{database:a.instanceOf(h).isRequired,route:a.instanceOf(f).isRequired,locale:a.instanceOf(g).isRequired,theme:a.instanceOf(v).isRequired},statics:{parseURL:function(e,t){return f.match(e,["/projects/:project/members/?"],function(e){return{project:f.parseId(e.project),edit:!!t.edit}})},getURL:function(e){var t,n="/projects/"+e.project+"/members/";return e.edit&&(t={edit:1}),{path:n,query:t}}},renderAsync:function(e){var t=this.props.route.parameters,n=this.props.database.use({schema:"global",by:this}),s={project:null,users:null,roles:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(i.createElement(R,s)),n.start().then(function(e){return d.findProject(n,t.project).then(function(e){s.project=e})}).then(function(){return p.findExistingUsers(n).then(function(e){s.users=e})}).then(function(){return e.show(i.createElement(R,s)),u.findRolesOfUsers(n,s.users).then(function(e){s.roles=e})}).then(function(){e.show(i.createElement(R,s));var t=T(s.users,s.project);return m.findDailyActivitiesOfUsers(n,s.project,t).then(function(e){s.statistics=e})}).then(function(){return i.createElement(R,s)})}});var R=e.exports.Sync=i.createClass({displayName:"MemberListPage.Sync",propTypes:{project:a.object,users:a.arrayOf(a.object),roles:a.arrayOf(a.object),statistics:a.objectOf(a.object),database:a.instanceOf(h).isRequired,route:a.instanceOf(f).isRequired,locale:a.instanceOf(g).isRequired,theme:a.instanceOf(v).isRequired},getInitialState:function(){return{sortColumns:["name"],sortDirections:["asc"],removingUserIds:[],addingUserIds:[],hasChanges:!1,renderingFullList:this.isEditing()}},isEditing:function(e){return e=e||this.props,e.route.parameters.edit},setEditability:function(t){var n=this.props.route,s=r.clone(n.parameters);return s.edit=t,this.props.route.replace(e.exports,s)},componentWillReceiveProps:function(e){var t=this;this.isEditing()!==this.isEditing(e)&&(this.isEditing(e)?this.setState({renderingFullList:!0,removingUserIds:[],addingUserIds:[],changes:!1}):setTimeout(function(){t.isEditing()||t.setState({renderingFullList:!1})},500))},render:function(){var e=this.props.locale.translate;return i.createElement("div",{className:"member-list-page"},this.renderButtons(),i.createElement("h2",null,e("member-list-title")),this.renderTable(),i.createElement(S,{changes:this.state.hasChanges,locale:this.props.locale,theme:this.props.theme,route:this.props.route}))},renderButtons:function(){var e=this.props.locale.translate;if(this.isEditing())return i.createElement("div",{key:"edit",className:"buttons"},i.createElement(b,{onClick:this.handleCancelClick},e("member-list-cancel"))," ",i.createElement(b,{className:"emphasis",disabled:!this.state.hasChanges,onClick:this.handleSaveClick},e("member-list-save")));var t=r.get(this.props.project,"user_ids"),n=r.some(this.props.users,function(e){return!r.includes(t,e.id)}),s=n?"approve":void 0;r.isEmpty(this.props.users);return i.createElement("div",{key:"view",className:"buttons"},i.createElement(y,{preselected:s},i.createElement("option",{name:"approve",disabled:!n,onClick:this.handleApproveClick},e("member-list-approve-all")),i.createElement("option",{name:"reject",disabled:!n,onClick:this.handleRejectClick},e("member-list-reject-all")),i.createElement("option",{name:"add",separator:!0,onClick:this.handleAddClick},e("member-list-add")))," ",i.createElement(b,{className:"emphasis",onClick:this.handleEditClick},e("member-list-edit")))},renderTable:function(){var e={sortColumns:this.state.sortColumns,sortDirections:this.state.sortDirections,onSort:this.handleSort};return this.state.renderingFullList&&(e.expandable=!0,e.selectable=!0,e.expanded=this.isEditing()),i.createElement(j,e,i.createElement("thead",null,this.renderHeadings()),i.createElement("tbody",{ref:"tbody"},this.renderRows()))},renderHeadings:function(){return i.createElement("tr",null,this.renderNameColumn(),this.renderTypeColumn(),this.renderRolesColumn(),this.renderDateRangeColumn(),this.renderLastMonthColumn(),this.renderThisMonthColumn(),this.renderToDateColumn(),this.renderModifiedTimeColumn())},renderRows:function(){var e;e=this.state.renderingFullList?this.props.users:T(this.props.users,this.props.project);var e=O(e,this.props.roles,this.props.statistics,this.props.locale,this.state.sortColumns,this.state.sortDirections);return r.map(e,this.renderRow)},renderRow:function(e){var t,n,o=this.props.locale.translate,a=[],l=r.includes(this.props.project.user_ids,e.id),c=r.includes(e.requested_project_ids,this.props.project.id);l||(c?(a.push("pending"),t=o("member-list-status-pending")):(a.push("disabled"),t=o("member-list-status-non-member"))),this.state.renderingFullList&&((l||c)&&a.push("fixed"),l?r.includes(this.state.removingUserIds,e.id)||a.push("selected"):r.includes(this.state.addingUserIds,e.id)&&a.push("selected"),n=this.handleRowClick);var d={className:a.join(" "),"data-user-id":e.id,onClick:n,title:t};return i.createElement("tr",s({key:e.id},d),this.renderNameColumn(e),this.renderTypeColumn(e),this.renderRolesColumn(e),this.renderDateRangeColumn(e),this.renderLastMonthColumn(e),this.renderThisMonthColumn(e),this.renderToDateColumn(e),this.renderModifiedTimeColumn(e))},renderNameColumn:function(e){var t=this.props.locale.translate,s=this.props.locale.pick;if(e){var o,a,l=s(e.details.name);if(this.state.renderingFullList){var c,d=r.get(this.props.project,"user_ids",[]),u=r.includes(d,e.id);c=u?!r.includes(this.state.removingUserIds,e.id):r.includes(this.state.addingUserIds,e.id),u!==c&&(a=c?i.createElement(k,{type:"add",locale:this.props.locale}):i.createElement(k,{type:"remove",locale:this.props.locale}))}else o=this.props.route.find(n("./pages/user-summary-page.jsx"),{user:e.id,project:this.props.project.id});var p=i.createElement(w,{user:e,theme:this.props.theme});return i.createElement("td",null,i.createElement("a",{href:o},p," ",l),a)}return i.createElement(x,{id:"name"},t("table-heading-name"))},renderTypeColumn:function(e){if(this.props.theme.isBelowMode("narrow"))return null;var t=this.props.locale.translate;return e?i.createElement("td",null,t("user-list-type-"+e.type)):i.createElement(x,{id:"type"},t("table-heading-type"))},renderRolesColumn:function(e){if(this.props.theme.isBelowMode("standard"))return null;var t=this.props.locale.translate;if(e){var n={roles:P(this.props.roles,e),route:this.props.route,locale:this.props.locale,theme:this.props.theme,disabled:this.state.renderingFullList};return i.createElement("td",null,i.createElement(E,n))}return i.createElement(x,{id:"roles"},t("table-heading-roles"))},renderEmailColumn:function(e){if(this.props.theme.isBelowMode("wide"))return null;var t=this.props.locale.translate;if(e){var n,s=e.details.email;return!this.state.renderingFullList&&s&&(n="mailto:"+s),i.createElement("td",null,i.createElement("a",{href:n},s))}return i.createElement(x,{id:"email"},t("table-heading-email"))},renderDateRangeColumn:function(e,t){if(this.props.theme.isBelowMode("ultra-wide"))return null;var n=this.props.locale.translate,s=this.props.locale.localeCode;if(e){var a,l,c=r.get(this.props.statistics,[e.id,"range"]);return c&&(a=o(c.start).locale(s).format("ll"),l=o(c.end).locale(s).format("ll")),i.createElement("td",null,n("date-range-$start-$end",a,l))}return i.createElement(x,{id:"range"},n("table-heading-date-range"))},renderLastMonthColumn:function(e){if(this.props.theme.isBelowMode("super-wide"))return null;var t=this.props.locale.translate;if(e){var n={statistics:r.get(this.props.statistics,[e.id,"last_month"]),locale:this.props.locale,theme:this.props.theme,disabled:this.state.renderingFullList};return i.createElement("td",null,i.createElement(_,n))}return i.createElement(x,{id:"last_month"},t("table-heading-last-month"))},renderThisMonthColumn:function(e){if(this.props.theme.isBelowMode("super-wide"))return null;var t=this.props.locale.translate;if(e){var n={statistics:r.get(this.props.statistics,[e.id,"this_month"]),locale:this.props.locale,theme:this.props.theme,disabled:this.state.renderingFullList};return i.createElement("td",null,i.createElement(_,n))}return i.createElement(x,{id:"this_month"},t("table-heading-this-month"))},renderToDateColumn:function(e){if(this.props.theme.isBelowMode("super-wide"))return null;var t=this.props.locale.translate;if(e){var n={statistics:r.get(this.props.statistics,[e.id,"to_date"]),locale:this.props.locale,theme:this.props.theme,disabled:this.state.renderingFullList};return i.createElement("td",null,i.createElement(_,n))}return i.createElement(x,{id:"to_date"},t("table-heading-to-date"))},renderModifiedTimeColumn:function(e){if(this.props.theme.isBelowMode("standard"))return null;var t=this.props.locale.translate;if(e){var n={time:e.mtime,disabled:this.state.renderingFullList,locale:this.props.locale};return i.createElement("td",null,i.createElement(C,n))}return i.createElement(x,{id:"mtime"},t("table-heading-last-modified"))},handleSort:function(e){this.setState({sortColumns:e.columns,sortDirections:e.directions})},handleEditClick:function(e){this.setEditability(!0)},handleAddClick:function(e){var t=this.props.route,s=r.clone(t.parameters);return s.user="new",t.push(n("./pages/user-summary-page.jsx"),s)},handleCancelClick:function(e){this.setEditability(!1)},handleSaveClick:function(e){var t=this,n=this.props.database.use({schema:"global",by:this});return n.start().then(function(e){var s=t.state.removingUserIds,o=t.state.addingUserIds,i=t.props.project.user_ids,a=r.union(r.difference(i,s),o),l={id:t.props.project.id,user_ids:a};return n.saveOne({table:"project"},l).then(function(e){return t.setState({hasChanges:!1},function(){return t.setEditability(!1)}),null})})},handleApproveClick:function(e){var t=this,n=this.props.database.use({schema:"global",by:this});return n.start().then(function(e){var s=t.props.project.id,o=r.filter(t.props.users,function(e){if(r.includes(e.requested_project_ids,s))return!0}),i=r.map(o,"id"),a=t.props.project.user_ids,l=r.union(a,i),c={id:t.props.project.id,user_ids:l};return n.saveOne({table:"project"},c)})},handleRejectClick:function(e){var t=this,n=this.props.database.use({schema:"global",by:this});return n.start().then(function(e){var s=t.props.project.id,o=r.filter(t.props.users,function(e){if(r.includes(e.requested_project_ids,s))return!0}),i=r.map(o,function(e){return{id:e.id,requested_project_ids:r.without(e.requested_project_ids,s)}});return n.save({table:"user"},i)})},handleRowClick:function(e){var t=parseInt(e.currentTarget.getAttribute("data-user-id")),n=this.props.project.user_ids,s=r.slice(this.state.addingUserIds),o=r.slice(this.state.removingUserIds);r.includes(n,t)?r.includes(o,t)?r.pull(o,t):o.push(t):r.includes(s,t)?r.pull(s,t):s.push(t);var i=!r.isEmpty(s)||!r.isEmpty(o);this.setState({addingUserIds:s,removingUserIds:o,hasChanges:i})}}),O=c(function(e,t,n,s,o,i){var a=s.pick;return o=r.map(o,function(e){switch(e){case"name":return function(e){return a(e.details.name)};case"range":return function(e){return r.get(n,[e.id,"range","start"],"")};case"last_month":return function(e){return r.get(n,[e.id,"last_month","total"],0)};case"this_month":return function(e){return r.get(n,[e.id,"this_month","total"],0)};case"to_date":return function(e){return r.get(n,[e.id,"to_date","total"],0)};default:return e}}),r.orderBy(e,o,i)}),T=c(function(e,t){if(t){var n=r.keyBy(e,"id"),s=r.filter(r.map(t.user_ids,function(e){return n[e]})),o=r.filter(e,function(e){return r.includes(e.requested_project_ids,t.id)});return r.union(s,o)}return[]}),P=c(function(e,t){var n=r.keyBy(e,"id");return r.filter(r.map(t.role_ids,function(e){return n[e]}))})},"./pages/member-list-page.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/member-list-page.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./pages/project-list-page.jsx":function(e,t,n){"use strict";var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},r=n("../node_modules/lodash/lodash.js"),o=(n("../node_modules/bluebird/js/browser/bluebird.js"),n("../node_modules/moment/moment.js")),i=n("../node_modules/react/react.js"),a=i.PropTypes,l=n("../node_modules/relaks/index.js"),c=n("../../common/src/utils/memoize.js"),d=n("../../common/src/utils/component-refs.js"),u=n("../../common/src/objects/finders/project-finder.js"),p=n("../../common/src/objects/finders/repo-finder.js"),m=n("../../common/src/objects/finders/user-finder.js"),h=n("../../common/src/objects/finders/statistics-finder.js"),f=n("../../common/src/data/database.js"),g=n("../../common/src/routing/route.js"),v=n("../../common/src/locale/locale.js"),b=n("../../common/src/theme/theme.js"),y=n("./widgets/push-button.jsx"),j=n("./widgets/combo-button.jsx"),x=n("./widgets/sortable-table.jsx"),w=x.TH,_=n("./tooltips/user-tooltip.jsx"),E=n("./tooltips/repository-tooltip.jsx"),k=n("./tooltips/activity-tooltip.jsx"),C=n("./tooltips/modified-time-tooltip.jsx"),S=n("./widgets/action-badge.jsx"),R=n("./widgets/action-confirmation.jsx"),O=n("./widgets/data-loss-warning.jsx");n("./pages/project-list-page.scss"),e.exports=l.createClass({displayName:"ProjectListPage",propTypes:{database:a.instanceOf(f).isRequired,route:a.instanceOf(g).isRequired,locale:a.instanceOf(v).isRequired,theme:a.instanceOf(b).isRequired},statics:{parseURL:function(e,t){return g.match(e,["/projects/?"],function(e){return{edit:!!t.edit}})},getURL:function(e){var t;return e&&e.edit&&(t={edit:1}),{path:"/projects/",query:t}}},renderAsync:function(e){var t=this.props.database.use({schema:"global",by:this}),n={projects:null,repos:null,users:null,statistics:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(i.createElement(T,n)),t.start().then(function(e){return u.findAllProjects(t).then(function(e){n.projects=e})}).then(function(s){return e.show(i.createElement(T,n)),p.findProjectRepos(t,n.projects).then(function(e){n.repos=e})}).then(function(){return m.findProjectMembers(t,n.projects).then(function(e){n.users=e})}).then(function(){return h.findDailyActivitiesOfProjects(t,n.projects).then(function(e){n.statistics=e})}).then(function(){return i.createElement(T,n)})}});var T=e.exports.Sync=i.createClass({displayName:"ProjectListPage.Sync",propTypes:{projects:a.arrayOf(a.object),repos:a.arrayOf(a.object),users:a.arrayOf(a.object),statistics:a.objectOf(a.object),database:a.instanceOf(f).isRequired,route:a.instanceOf(g).isRequired,locale:a.instanceOf(v).isRequired,theme:a.instanceOf(b).isRequired},getInitialState:function(){return this.components=d({confirmation:R}),{sortColumns:["name"],sortDirections:["asc"],restoringProjectIds:[],archivingProjectIds:[],hasChanges:!1,renderingFullList:this.isEditing()}},isEditing:function(e){return e=e||this.props,e.route.parameters.edit},setEditability:function(t){var n=this.props.route,s=r.clone(n.parameters);return s.edit=t,this.props.route.replace(e.exports,s)},componentWillReceiveProps:function(e){var t=this;this.isEditing()!==this.isEditing(e)&&(this.isEditing(e)?this.setState({renderingFullList:!0,restoringProjectIds:[],archivingProjectIds:[],hasChanges:!1}):setTimeout(function(){t.isEditing()||t.setState({renderingFullList:!1})},500))},render:function(){var e=this.props.locale.translate;return i.createElement("div",{className:"project-list-page"},this.renderButtons(),i.createElement("h2",null,e("project-list-title")),this.renderTable(),i.createElement(R,{ref:this.components.setters.confirmation,locale:this.props.locale,theme:this.props.theme}),i.createElement(O,{changes:this.state.hasChanges,locale:this.props.locale,theme:this.props.theme,route:this.props.route}))},renderButtons:function(){var e=this.props.locale.translate;if(this.isEditing())return i.createElement("div",{className:"buttons"},i.createElement(y,{onClick:this.handleCancelClick},e("project-list-cancel"))," ",i.createElement(y,{className:"emphasis",disabled:!this.state.hasChanges,onClick:this.handleSaveClick},e("project-list-save")));var t=r.isEmpty(this.props.projects);return i.createElement("div",{className:"buttons"},i.createElement(j,{preselected:void 0},i.createElement("option",{name:"add",className:"separated",onClick:this.handleAddClick},e("project-list-add")))," ",i.createElement(y,{className:"emphasis",disabled:t,onClick:this.handleEditClick},e("project-list-edit")))},renderTable:function(){var e={sortColumns:this.state.sortColumns,sortDirections:this.state.sortDirections,onSort:this.handleSort};return this.state.renderingFullList&&(e.expandable=!0,e.selectable=!0,e.expanded=this.isEditing(),e.onClick=this.handleRowClick),i.createElement(x,e,i.createElement("thead",null,this.renderHeadings()),i.createElement("tbody",null,this.renderRows()))},renderHeadings:function(){return i.createElement("tr",null,this.renderTitleColumn(),this.renderUsersColumn(),this.renderRepositoriesColumn(),this.renderDateRangeColumn(),this.renderLastMonthColumn(),this.renderThisMonthColumn(),this.renderToDateColumn(),this.renderModifiedTimeColumn())},renderRows:function(){var e=this.props.projects;return this.state.renderingFullList||(e=N(e)),e=P(e,this.props.users,this.props.repos,this.props.statistics,this.props.locale,this.state.sortColumns,this.state.sortDirections),r.map(e,this.renderRow)},renderRow:function(e){var t,n,o=this.props.locale.translate,a=[];e.deleted?(a.push("deleted"),n=o("project-list-status-deleted")):e.archived&&(a.push("disabled"),n=o("project-list-status-archived")),this.state.renderingFullList&&(e.deleted||e.archived?r.includes(this.state.restoringProjectIds,e.id)&&a.push("selected"):(a.push("fixed"),r.includes(this.state.disablingProjectIds,e.id)||a.push("selected")),t=this.handleRowClick);var l={className:a.join(" "),"data-project-id":e.id,title:n,onClick:t};return i.createElement("tr",s({key:e.id},l),this.renderTitleColumn(e),this.renderUsersColumn(e),this.renderRepositoriesColumn(e),this.renderDateRangeColumn(e),this.renderLastMonthColumn(e),this.renderThisMonthColumn(e),this.renderToDateColumn(e),this.renderModifiedTimeColumn(e))},renderTitleColumn:function(e){var t=this.props.locale.translate;if(e){var s,o,a=this.props.locale.pick,l=a(e.details.title)||e.name;if(this.state.renderingFullList){var c,d;e.deleted||e.archived?(c=!1,d=r.includes(this.state.restoringProjectIds,e.id)):(c=!0,d=!r.includes(this.state.archivingProjectIds,e.id)),c!==d&&(o=d?i.createElement(S,{type:"restore",locale:this.props.locale}):i.createElement(S,{type:"archive",locale:this.props.locale}))}else{var u=this.props.route,p={project:e.id};s=u.find(n("./pages/project-summary-page.jsx"),p)}return i.createElement("td",null,i.createElement("a",{href:s},l),o)}return i.createElement(w,{id:"title"},t("table-heading-name"))},renderUsersColumn:function(e){if(this.props.theme.isBelowMode("narrow"))return null;var t=this.props.locale.translate;if(e){var n={users:I(this.props.users,e),project:e,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return i.createElement("td",null,i.createElement(_,n))}return i.createElement(w,{id:"users"},t("table-heading-users"))},renderRepositoriesColumn:function(e){if(this.props.theme.isBelowMode("narrow"))return null;var t=this.props.locale.translate;if(e){var n={repos:L(this.props.repos,e),project:e,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return i.createElement("td",null,i.createElement(E,n))}return i.createElement(w,{id:"repos"},t("table-heading-repositories"))},renderDateRangeColumn:function(e){if(this.props.theme.isBelowMode("ultra-wide"))return null;var t=this.props.locale.translate,n=this.props.locale.localeCode;if(e){if(e.deleted)return i.createElement("td",null,t("project-list-deleted"));var s,a,l=r.get(this.props.statistics,[e.id,"range"]);return l&&(s=o(l.start).locale(n).format("ll"),a=o(l.end).locale(n).format("ll")),i.createElement("td",null,t("date-range-$start-$end",s,a))}return i.createElement(w,{id:"range"},t("table-heading-date-range"))},renderLastMonthColumn:function(e){if(this.props.theme.isBelowMode("super-wide"))return null;var t=this.props.locale.translate;if(e){var n={statistics:r.get(this.props.statistics,[e.id,"last_month"]),locale:this.props.locale,theme:this.props.theme};return i.createElement("td",null,i.createElement(k,n))}return i.createElement(w,{id:"last_month"},t("table-heading-last-month"))},renderThisMonthColumn:function(e){if(this.props.theme.isBelowMode("super-wide"))return null;var t=this.props.locale.translate;if(e){var n={statistics:r.get(this.props.statistics,[e.id,"this_month"]),locale:this.props.locale,theme:this.props.theme};return i.createElement("td",null,i.createElement(k,n))}return i.createElement(w,{id:"this_month"},t("table-heading-this-month"))},renderToDateColumn:function(e){if(this.props.theme.isBelowMode("super-wide"))return null;var t=this.props.locale.translate;if(e){var n={statistics:r.get(this.props.statistics,[e.id,"to_date"]),locale:this.props.locale,theme:this.props.theme};return i.createElement("td",null,i.createElement(k,n))}return i.createElement(w,{id:"to_date"},t("table-heading-to-date"))},renderModifiedTimeColumn:function(e){if(this.props.theme.isBelowMode("standard"))return null;var t=this.props.locale.translate;if(e){var n={time:e.mtime,locale:this.props.locale};return i.createElement("td",null,i.createElement(C,n))}return i.createElement(w,{id:"mtime"},t("table-heading-last-modified"))},handleSort:function(e){this.setState({sortColumns:e.columns,sortDirections:e.directions})},handleAddClick:function(e){return this.props.route.push(n("./pages/project-summary-page.jsx"),{project:"new"})},handleEditClick:function(e){this.setEditability(!0)},handleCancelClick:function(e){this.setEditability(!1)},handleSaveClick:function(e){var t=this,n=this.props.locale.translate,s=this.state.archivingProjectIds,o=this.state.restoringProjectIds,i=[n("project-list-confirm-archive-$count",s.length),n("project-list-confirm-restore-$count",o.length)],a=[r.isEmpty(s)||void 0,r.isEmpty(o)||void 0];return this.components.confirmation.askSeries(i,a).then(function(e){if(e){var n=t.props.database.use({schema:"global",by:t});return n.start().then(function(e){var i=[];return r.each(t.props.projects,function(e){var t={};if(r.includes(s,e.id))t.archived=!0;else{if(!r.includes(o,e.id))return;t.archived=t.deleted=!1}var n=r.assign({},e,t);i.push(n)}),n.save({table:"project"},i).then(function(e){return t.setState({hasChanges:!1},function(){t.setEditability(!1)}),null})})}})},handleRowClick:function(e){var t=parseInt(e.currentTarget.getAttribute("data-project-id")),n=r.find(this.props.projects,{id:t}),s=r.slice(this.state.restoringProjectIds),o=r.slice(this.state.archivingProjectIds);n.deleted||n.archived?r.includes(s,n.id)?r.pull(s,n.id):s.push(n.id):r.includes(o,n.id)?r.pull(o,n.id):o.push(n.id);var i=!r.isEmpty(s)||!r.isEmpty(o);this.setState({restoringProjectIds:s,archivingProjectIds:o,hasChanges:i})}}),P=c(function(e,t,n,s,o,i,a){var l=this;return i=r.map(i,function(e){switch(e){case"title":return function(e){return o.pick(e.details.title)};case"users":return function(e){return r.size(I(t,e))};case"repos":return function(e){return r.size(I(n,e))};case"range":return function(e){return r.get(l.props.statistics,[e.id,"range","start"],"")};case"last_month":return function(e){return r.get(l.props.statistics,[e.id,"last_month","total"],0)};case"this_month":return function(e){return r.get(l.props.statistics,[e.id,"this_month","total"],0)};case"to_date":return function(e){return r.get(l.props.statistics,[e.id,"to_date","total"],0)};default:return e}}),r.orderBy(e,i,a)}),N=c(function(e){return r.filter(e,function(e){return!e.deleted&&!e.archived})}),L=c(function(e,t){var n=r.keyBy(e,"id");return r.filter(r.map(t.repo_ids,function(e){return n[e]}))}),I=c(function(e,t){var n=r.keyBy(e,"id");return r.filter(r.map(t.user_ids,function(e){return n[e]}))})},"./pages/project-list-page.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/project-list-page.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./pages/project-summary-page.jsx":function(e,t,n){"use strict";var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/react/react.js"),i=o.PropTypes,a=n("../node_modules/relaks/index.js"),l=n("../../common/src/utils/component-refs.js"),c=n("../../common/src/objects/finders/project-finder.js"),d=n("../../common/src/objects/settings/project-settings.js"),u=n("../../common/src/objects/finders/statistics-finder.js"),p=n("../../common/src/objects/finders/system-finder.js"),m=n("../../common/src/utils/slug-generator.js"),h=n("../../common/src/data/database.js"),f=n("../../common/src/routing/route.js"),g=n("../../common/src/locale/locale.js"),v=n("../../common/src/theme/theme.js"),b=n("../../common/src/transport/payloads.js"),y=n("./widgets/push-button.jsx"),j=n("./widgets/combo-button.jsx"),x=n("./widgets/instruction-block.jsx"),w=n("./widgets/text-field.jsx"),_=n("./widgets/multilingual-text-field.jsx"),E=n("./widgets/option-list.jsx"),k=n("./widgets/image-selector.jsx"),C=n("./widgets/activity-chart.jsx"),S=n("./widgets/input-error.jsx"),R=n("./widgets/action-confirmation.jsx"),O=n("./widgets/data-loss-warning.jsx");n("./pages/project-summary-page.scss"),e.exports=a.createClass({displayName:"ProjectSummaryPage",propTypes:{database:i.instanceOf(h).isRequired,route:i.instanceOf(f).isRequired,locale:i.instanceOf(g).isRequired,theme:i.instanceOf(v).isRequired,payloads:i.instanceOf(b).isRequired},statics:{parseURL:function(e,t){return f.match(e,["/projects/:project/?"],function(e){return{project:"new"===e.project?"new":f.parseId(e.project),edit:!!t.edit}})},getURL:function(e){var t,n="/projects/"+e.project+"/";return e.edit&&(t={edit:1}),{path:n,query:t}}},renderAsync:function(e){var t=this.props.route.parameters,n=this.props.database.use({schema:"global",by:this}),s={system:null,project:null,statistics:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,payloads:this.props.payloads};return e.show(o.createElement(T,s)),n.start().then(function(e){return p.findSystem(n).then(function(e){s.system=e})}).then(function(){if("new"!==t.project)return c.findProject(n,t.project).then(function(e){s.project=e})}).then(function(){if("new"!==t.project)return e.show(o.createElement(T,s)),u.findDailyActivitiesOfProject(n,s.project).then(function(e){s.statistics=e})}).then(function(){return o.createElement(T,s)})}});var T=e.exports.Sync=o.createClass({displayName:"ProjectSummaryPage.Sync",propTypes:{system:i.object,project:i.object,statistics:i.object,database:i.instanceOf(h).isRequired,route:i.instanceOf(f).isRequired,locale:i.instanceOf(g).isRequired,theme:i.instanceOf(v).isRequired,payloads:i.instanceOf(b).isRequired},getInitialState:function(){return this.components=l({confirmation:R}),{newProject:null,saving:!1,adding:!1,problems:{}}},getProject:function(e){return!this.isEditing()||e&&"current"!==e?this.props.project||P:this.state.newProject||this.props.project||P},getProjectProperty:function(e,t){var n=this.getProject(t);return r.get(n,e)},setProjectProperty:function(e,t){var n=this.getProject("current"),s=r.decoupleSet(n,e,t);if("details.title"===e&&!n.id){var o=m.fromTitle(n.details.title),i=m.fromTitle(s.details.title);n.name&&n.name!==o||(s.name=i)}r.size(s.name)>128&&(s.name=s.name.substr(0,128));var a=!0;r.isEqual(s,this.props.project)&&(s=null,a=!1),this.setState({newProject:s,hasChanges:a})},findProblems:function(){var e={},t=this.getProject(),n=r.toLower(r.trim(t.name)),s=["global","admin","public","srv"];return n?r.includes(s,n)&&(e.name="validation-illegal-project-name"):e.name="validation-required",e},isCreating:function(e){return e=e||this.props,"new"===e.route.parameters.project},isEditing:function(e){return e=e||this.props,this.isCreating(e)||e.route.parameters.edit},setEditability:function(t,n){var s=this;if(!this.isCreating()||t||n){var o=this.props.route,i=r.clone(o.parameters);return i.edit=t,n&&(i.project=n.id),o.replace(e.exports,i).then(function(e){e&&s.setState({problems:{}})})}this.returnToList()},returnToList:function(){return this.props.route.push(n("./pages/project-list-page.jsx"))},startNew:function(){var t=this.props.route,n=r.clone(t.parameters);return n.project="new",t.replace(e.exports,n)},getInputLanguages:function(){return r.get(this.props.system,"settings.input_languages",[])},componentWillReceiveProps:function(e){this.isEditing()!==this.isEditing(e)&&this.isEditing(e)&&this.setState({newProject:null,hasChanges:!1})},render:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=this.getProject(),s=t(n.details.title)||n.name;return o.createElement("div",{className:"project-summary-page"},this.renderButtons(),o.createElement("h2",null,e("project-summary-$title",s)),this.renderForm(),this.renderInstructions(),this.renderChart(),o.createElement(R,{ref:this.components.setters.confirmation,locale:this.props.locale,theme:this.props.theme}),o.createElement(O,{changes:this.state.hasChanges,locale:this.props.locale,theme:this.props.theme,route:this.props.route}))},renderButtons:function(){var e=this.props.locale.translate;if(this.isEditing())return o.createElement("div",{key:"edit",className:"buttons"},o.createElement(y,{onClick:this.handleCancelClick},e("project-summary-cancel"))," ",o.createElement(y,{className:"emphasis",disabled:!this.state.hasChanges,onClick:this.handleSaveClick},e("project-summary-save")));var t,n=this.props.project,s=!n||!n.deleted&&!n.archived;return t=s?this.state.adding?"add":"return":"restore",o.createElement("div",{key:"view",className:"buttons"},o.createElement(j,{preselected:t},o.createElement("option",{name:"return",onClick:this.handleReturnClick},e("project-summary-return")),o.createElement("option",{name:"add",onClick:this.handleAddClick},e("project-summary-add")),o.createElement("option",{name:"archive",disabled:!s,separator:!0,onClick:this.handleArchiveClick},e("project-summary-archive")),o.createElement("option",{name:"delete",disabled:!s,onClick:this.handleDeleteClick},e("project-summary-delete")),o.createElement("option",{name:"restore",hidden:s,onClick:this.handleRestoreClick},e("project-summary-restore")))," ",o.createElement(y,{className:"emphasis",onClick:this.handleEditClick},e("project-summary-edit")))},renderForm:function(){return o.createElement("div",{className:"form"},this.renderTitleInput(),this.renderNameInput(),this.renderDescriptionInput(),this.renderEmblemSelector(),this.renderMembershipOptions(),this.renderAccessControlOptions())},renderTitleInput:function(){var e=this.props.locale.translate,t={id:"title",value:this.getProjectProperty("details.title"),availableLanguageCodes:this.getInputLanguages(),locale:this.props.locale,onChange:this.handleTitleChange,readOnly:!this.isEditing()};return o.createElement(_,t,e("project-summary-title"))},renderNameInput:function(){var e=this.props.locale.translate,t={id:"name",value:this.getProjectProperty("name"),locale:this.props.locale,onChange:this.handleNameChange,readOnly:!this.isEditing()},n=this.state.problems;return o.createElement(w,t,e("project-summary-name"),o.createElement(S,null,e(n.name)))},renderDescriptionInput:function(){var e=this.props.locale.translate,t={id:"description",value:this.getProjectProperty("details.description"),availableLanguageCodes:this.getInputLanguages(),type:"textarea",locale:this.props.locale,onChange:this.handleDescriptionChange,readOnly:!this.isEditing()};return o.createElement(_,t,e("project-summary-description"))},renderEmblemSelector:function(){var e=this.props.locale.translate,t={purpose:"project-emblem",desiredWidth:500,desiredHeight:500,resources:this.getProjectProperty("details.resources"),database:this.props.database,locale:this.props.locale,theme:this.props.theme,payloads:this.props.payloads,onChange:this.handleEmblemChange,readOnly:!this.isEditing()};return o.createElement(k,t,e("project-summary-emblem"))},renderMembershipOptions:function(){var e=this.props.locale.translate,t=this.getProjectProperty("settings.membership","current")||{},n=this.getProjectProperty("settings.membership","original")||{},i=!!this.getProjectProperty("id"),a=[{name:"manual",selected:!r.some(t),previous:i?!r.some(n):void 0,children:e("project-summary-new-members-manual")},{name:"allow_user_request",selected:t.allow_user_request,previous:n.allow_user_request,children:e("project-summary-new-members-join-user")},{name:"approve_user_request",selected:t.approve_user_request,previous:n.approve_user_request,hidden:!t.allow_user_request,children:e("project-summary-new-members-auto-accept-user")},{name:"allow_guest_request",selected:t.allow_guest_request,previous:n.allow_guest_request,children:e("project-summary-new-members-join-guest")},{name:"approve_guest_request",selected:t.approve_guest_request,previous:n.approve_guest_request,hidden:!t.allow_guest_request,children:e("project-summary-new-members-auto-accept-guest")}],l={onOptionClick:this.handleMembershipOptionClick,readOnly:!this.isEditing()};return o.createElement(E,l,o.createElement("label",null,e("project-summary-new-members")),r.map(a,function(e,t){return o.createElement("option",s({key:t},e))}))},renderAccessControlOptions:function(){var e=this.props.locale.translate,t=this.getProjectProperty("settings.access_control","current")||{},n=this.getProjectProperty("settings.access_control","original")||{},i=!!this.getProjectProperty("id"),a=[{name:"members_only",selected:!r.some(t),previous:i?!r.some(n):void 0,children:e("project-summary-access-control-member-only")},{name:"grant_view_access",selected:t.grant_view_access,previous:n.grant_view_access,children:e("project-summary-access-control-non-member-view")},{name:"grant_comment_access",selected:t.grant_comment_access,previous:n.grant_comment_access,hidden:!t.grant_view_access,children:e("project-summary-access-control-non-member-comment")}],l={onOptionClick:this.handleAccessControlOptionClick,readOnly:!this.isEditing()};return o.createElement(E,l,o.createElement("label",null,e("project-summary-access-control")),r.map(a,function(e,t){return o.createElement("option",s({key:t},e))}))},renderInstructions:function(){var e={folder:"project",topic:"project-summary",hidden:!this.isEditing(),locale:this.props.locale};return o.createElement("div",{className:"instructions"},o.createElement(x,e))},renderChart:function(){if(this.isCreating())return null;var e=this.props.locale.translate,t={statistics:this.props.statistics,locale:this.props.locale,theme:this.props.theme};return o.createElement("div",{className:"statistics"},o.createElement(C,t,e("project-summary-statistics")))},changeFlags:function(e){var t=this.props.database.use({schema:"global",by:this}),n=r.assign({},this.props.project,e);return t.saveOne({table:"project"},n)},handleArchiveClick:function(e){var t=this,n=this.props.locale.translate,s=n("project-summary-confirm-archive");return this.components.confirmation.ask(s).then(function(e){if(e)return t.changeFlags({archived:!0}).then(function(e){return t.returnToList()})})},handleDeleteClick:function(e){var t=this,n=this.props.locale.translate,s=n("project-summary-confirm-delete");return this.components.confirmation.ask(s).then(function(e){if(e)return t.changeFlags({deleted:!0}).then(function(e){return t.returnToList()})})},handleRestoreClick:function(e){var t=this,n=this.props.locale.translate,s=n("project-summary-confirm-restore");return this.components.confirmation.ask(s).then(function(e){if(e)return t.changeFlags({archived:!1,deleted:!1})})},handleReturnClick:function(e){return this.returnToList()},handleAddClick:function(e){return this.startNew()},handleEditClick:function(e){return this.setEditability(!0)},handleCancelClick:function(e){return this.setEditability(!1)},handleSaveClick:function(e){var t=this;if(!this.state.saving){var n=this.findProblems();if(r.some(n))return void this.setState({problems:n});var s=r.omit(this.getProject(),"user_ids","repo_ids");this.setState({saving:!0,adding:!s.id,problems:{}},function(){var e=t.props.database.use({schema:"global",by:t});return e.start().then(function(n){return e.saveOne({table:"project"},s).then(function(e){return t.props.payloads.dispatch(e),t.setState({hasChanges:!1,saving:!1},function(){t.setEditability(!1,e)}),null})}).catch(function(e){var n={};409===e.statusCode?n.name="validation-duplicate-project-name":(n.general=e.message,console.error(e)),t.setState({problems:n,saving:!1})})})}},handleTitleChange:function(e){this.setProjectProperty("details.title",e.target.value)},handleNameChange:function(e){var t=r.toLower(e.target.value).replace(/\W+/g,"");this.setProjectProperty("name",t)},handleDescriptionChange:function(e){this.setProjectProperty("details.description",e.target.value)},handleEmblemChange:function(e){this.setProjectProperty("details.resources",e.target.value)},handleMembershipOptionClick:function(e){var t=r.clone(this.getProjectProperty("settings.membership"))||{};switch(e.name){case"manual":t={};break;case"allow_user_request":t.allow_user_request?(delete t.allow_user_request,delete t.approve_user_request):t.allow_user_request=!0;break;case"approve_user_request":t.approve_user_request?delete t.approve_user_request:t.approve_user_request=!0;break;case"allow_guest_request":t.allow_guest_request?(delete t.allow_guest_request,delete t.approve_guest_request):t.allow_guest_request=!0;break;case"approve_guest_request":t.approve_guest_request?delete t.approve_guest_request:t.approve_guest_request=!0}this.setProjectProperty("settings.membership",t)},handleAccessControlOptionClick:function(e){var t=r.clone(this.getProjectProperty("settings.access_control"))||{};switch(e.name){case"members_only":t={};break;case"grant_view_access":t.grant_view_access?delete t.grant_view_access:t.grant_view_access=!0;break;case"grant_comment_access":t.grant_comment_access?delete t.grant_comment_access:t.grant_comment_access=!0}this.setProjectProperty("settings.access_control",t)}}),P={details:{},settings:d.default}},"./pages/project-summary-page.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/project-summary-page.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./pages/repo-list-page.jsx":function(e,t,n){"use strict";var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/moment/moment.js"),i=n("../node_modules/react/react.js"),a=i.PropTypes,l=n("../node_modules/relaks/index.js"),c=n("../../common/src/utils/memoize.js"),d=n("../../common/src/utils/component-refs.js"),u=n("../../common/src/objects/utils/external-data-utils.js"),p=n("../../common/src/objects/finders/project-finder.js"),m=n("../../common/src/objects/finders/repo-finder.js"),h=n("../../common/src/objects/finders/server-finder.js"),f=n("../../common/src/objects/finders/statistics-finder.js"),g=n("../../common/src/data/database.js"),v=n("../../common/src/routing/route.js"),b=n("../../common/src/locale/locale.js"),y=n("../../common/src/theme/theme.js"),j=n("./widgets/push-button.jsx"),x=n("./widgets/sortable-table.jsx"),w=x.TH,_=n("./tooltips/activity-tooltip.jsx"),E=n("./tooltips/modified-time-tooltip.jsx"),k=n("./widgets/action-badge.jsx"),C=n("./widgets/action-confirmation.jsx"),S=n("./widgets/data-loss-warning.jsx");n("./pages/repo-list-page.scss"),e.exports=l.createClass({displayName:"RepoListPage",propTypes:{database:a.instanceOf(g).isRequired,route:a.instanceOf(v).isRequired,locale:a.instanceOf(b).isRequired,theme:a.instanceOf(y).isRequired},statics:{parseURL:function(e,t){return v.match(e,["/projects/:project/repos/?"],function(e){return{project:v.parseId(e.project),edit:!!t.edit}})},getURL:function(e){var t,n="/projects/"+e.project+"/repos/";return e.edit&&(t={edit:1}),{path:n,query:t}}},renderAsync:function(e){var t=this.props.route.parameters,n=this.props.database.use({schema:"global",by:this}),s={project:null,repos:null,servers:null,statistics:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(i.createElement(R,s)),n.start().then(function(e){return p.findProject(n,t.project).then(function(e){s.project=e})}).then(function(){return m.findExistingRepos(n).then(function(e){s.repos=e})}).then(function(){return e.show(i.createElement(R,s)),h.findServersOfRepos(n,s.repos).then(function(e){s.servers=e})}).then(function(){e.show(i.createElement(R,s));var t=P(s.repos,s.project);return f.findDailyActivitiesOfRepos(n,s.project,t).then(function(e){s.statistics=e})}).then(function(){return i.createElement(R,s)})}});var R=e.exports.Sync=i.createClass({displayName:"RepoListPage.Sync",propTypes:{repos:a.arrayOf(a.object),project:a.object,servers:a.arrayOf(a.object),statistics:a.objectOf(a.object),database:a.instanceOf(g).isRequired,route:a.instanceOf(v).isRequired,locale:a.instanceOf(b).isRequired,theme:a.instanceOf(y).isRequired},getInitialState:function(){return this.components=d({confirmation:C}),{sortColumns:["name"],sortDirections:["asc"],selectedRepoIds:[],hasChanges:!1,renderingFullList:this.isEditing()}},isEditing:function(e){return e=e||this.props,e.route.parameters.edit},setEditability:function(t){var n=this.props.route,s=r.clone(n.parameters);return s.edit=t,this.props.route.replace(e.exports,s)},componentWillReceiveProps:function(e){var t=this;if(this.isEditing()!==this.isEditing(e)&&(this.isEditing(e)?this.setState({renderingFullList:!0,selectedRepoIds:r.get(e.project,"repo_ids",[]),hasChanges:!1}):setTimeout(function(){t.isEditing()||t.setState({renderingFullList:!1})},500)),this.props.project!==e.project&&e.project){var n=this.state.selectedRepoIds,s=r.get(this.props.project,"repo_ids",[]),o=r.get(e.project,"repo_ids",[]);n===s?n=o:r.isEqual(s,o)||(n=r.union(n,o)),this.setState({selectedRepoIds:n})}},render:function(){var e=this.props.locale.translate;return i.createElement("div",{className:"repo-list-page"},this.renderButtons(),i.createElement("h2",null,e("repo-list-title")),this.renderTable(),i.createElement(C,{ref:this.components.setters.confirmation,locale:this.props.locale,theme:this.props.theme}),i.createElement(S,{changes:this.state.hasChanges,locale:this.props.locale,theme:this.props.theme,route:this.props.route}))},renderButtons:function(){var e=this.props.locale.translate;if(this.isEditing())return i.createElement("div",{className:"buttons"},i.createElement(j,{onClick:this.handleCancelClick},e("repo-list-cancel"))," ",i.createElement(j,{className:"emphasis",disabled:!this.state.hasChanges,onClick:this.handleSaveClick},e("repo-list-save")));var t=r.isEmpty(this.props.repos);return i.createElement("div",{className:"buttons"},i.createElement(j,{className:"emphasis",disabled:t,onClick:this.handleEditClick},e("repo-list-edit")))},renderTable:function(){var e={sortColumns:this.state.sortColumns,sortDirections:this.state.sortDirections,onSort:this.handleSort};return this.state.renderingFullList&&(e.expandable=!0,e.selectable=!0,e.expanded=this.isEditing()),i.createElement(x,e,i.createElement("thead",null,this.renderHeadings()),i.createElement("tbody",null,this.renderRows()))},renderHeadings:function(){return i.createElement("tr",null,this.renderTitleColumn(),this.renderServerColumn(),this.renderIssueTrackerColumn(),this.renderDateRangeColumn(),this.renderLastMonthColumn(),this.renderThisMonthColumn(),this.renderToDateColumn(),this.renderModifiedTimeColumn())},renderRows:function(){var e=this.props.repos;return this.state.renderingFullList||(e=P(e,this.props.project)),e=O(e,this.props.servers,this.props.statistics,this.props.locale,this.state.sortColumns,this.state.sortDirections),r.map(e,this.renderRow)},renderRow:function(e,t){var n={};if(this.state.renderingFullList){var o=r.get(this.props.project,"repo_ids",[]);r.includes(o,e.id)&&(n.className="fixed"),r.includes(this.state.selectedRepoIds,e.id)&&(n.className+=" selected"),n.onClick=this.handleRowClick,n["data-repo-id"]=e.id}return i.createElement("tr",s({key:e.id},n),this.renderTitleColumn(e),this.renderServerColumn(e),this.renderIssueTrackerColumn(e),this.renderDateRangeColumn(e),this.renderLastMonthColumn(e),this.renderThisMonthColumn(e),this.renderToDateColumn(e),this.renderModifiedTimeColumn(e))},renderTitleColumn:function(e){var t=this.props.locale.translate;if(e){var s,o,a=this.props.locale.pick,l=a(e.details.title)||e.name;if(this.state.renderingFullList){var c=r.get(this.props.project,"repo_ids",[]),d=r.includes(c,e.id),u=r.includes(this.state.selectedRepoIds,e.id);d!==u&&(o=u?i.createElement(k,{type:"add",locale:this.props.locale}):i.createElement(k,{type:"remove",locale:this.props.locale}))}else{var p=this.props.route,m=r.clone(p.parameters);m.repo=e.id,s=p.find(n("./pages/repo-summary-page.jsx"),m)}return i.createElement("td",null,i.createElement("a",{href:s},l),o)}return i.createElement(w,{id:"title"},t("table-heading-title"))},renderServerColumn:function(e){var t=this.props.locale.translate;if(e){var s,r=this.props.locale.pick,o=T(this.props.servers,e);if(o){var a=r(o.details.title)||t("server-type-"+o.type),l=this.props.route,c={server:o.id},d=l.find(n("./pages/server-summary-page.jsx"),c);s=i.createElement("a",{href:d},i.createElement("i",{className:"fa fa-"+o.type+" fa-fw"})," ",a)}return i.createElement("td",null,s)}return i.createElement(w,{id:"server"},t("table-heading-server"))},renderIssueTrackerColumn:function(e){if(this.props.theme.isBelowMode("ultra-wide"))return null;var t=this.props.locale.translate;if(e){var n=(this.props.locale.pick,!!e.details.issues_enabled);return i.createElement("td",null,t("repo-list-issue-tracker-enabled-"+n))}return i.createElement(w,{id:"issue_tracker"},t("table-heading-issue-tracker"))},renderDateRangeColumn:function(e){if(this.props.theme.isBelowMode("wide"))return null;var t=this.props.locale.translate,n=this.props.locale.localeCode;if(e){var s,a,l=r.get(this.props.statistics,[e.id,"range"]);return l&&(s=o(l.start).locale(n).format("ll"),a=o(l.end).locale(n).format("ll")),i.createElement("td",null,t("date-range-$start-$end",s,a))}return i.createElement(w,{id:"range"},t("table-heading-date-range"))},renderLastMonthColumn:function(e){if(this.props.theme.isBelowMode("super-wide"))return null;var t=this.props.locale.translate;if(e){var n={statistics:r.get(this.props.statistics,[e.id,"last_month"]),locale:this.props.locale,theme:this.props.theme};return i.createElement("td",null,i.createElement(_,n))}return i.createElement(w,{id:"last_month"},t("table-heading-last-month"))},renderThisMonthColumn:function(e){if(this.props.theme.isBelowMode("super-wide"))return null;var t=this.props.locale.translate;if(e){var n={statistics:r.get(this.props.statistics,[e.id,"this_month"]),locale:this.props.locale,theme:this.props.theme};return i.createElement("td",null,i.createElement(_,n))}return i.createElement(w,{id:"this_month"},t("table-heading-this-month"))},renderToDateColumn:function(e){if(this.props.theme.isBelowMode("super-wide"))return null;var t=this.props.locale.translate;if(e){var n={statistics:r.get(this.props.statistics,[e.id,"to_date"]),locale:this.props.locale,theme:this.props.theme};return i.createElement("td",null,i.createElement(_,n))}return i.createElement(w,{id:"to_date"},t("table-heading-to-date"))},renderModifiedTimeColumn:function(e){if(this.props.theme.isBelowMode("standard"))return null;var t=this.props.locale.translate;if(e){var n={time:e.mtime,locale:this.props.locale};return i.createElement("td",null,i.createElement(E,n))}return i.createElement(w,{id:"mtime"},t("table-heading-last-modified"))},handleSort:function(e){this.setState({sortColumns:e.columns,sortDirections:e.directions})},handleEditClick:function(e){this.setEditability(!0)},handleCancelClick:function(e){this.setEditability(!1)},handleSaveClick:function(e){var t=this,n=this.props.locale.translate,s=r.get(this.props.project,"repo_ids",[]),o=r.difference(s,this.state.selectedRepoIds),i=n("repo-list-confirm-remove-$count",o.length);return this.components.confirmation.ask(i,r.isEmpty(o)||void 0).then(function(e){if(e){var n=t.props.database.use({schema:"global",by:t});return n.start().then(function(e){var s=r.map(t.props.repos,"id"),o={id:t.props.project.id,repo_ids:r.intersection(t.state.selectedRepoIds,s)};return n.saveOne({table:"project"},o).then(function(e){t.setState({hasChanges:!1},function(){t.setEditability(!1)})})})}})},handleRowClick:function(e){var t=parseInt(e.currentTarget.getAttribute("data-repo-id")),n=this.props.project.repo_ids,s=r.slice(this.state.selectedRepoIds),o=!0;r.includes(s,t)?r.pull(s,t):s.push(t),s.length===n.length&&0===r.difference(s,n).length&&(s=n,o=!1),this.setState({selectedRepoIds:s,hasChanges:o})}}),O=c(function(e,t,n,s,o,i){var a=s.translate,l=s.pick;return o=r.map(o,function(e){switch(e){case"title":return function(e){return l(e.details.title)||e.name};case"server":return function(e){var n=T(t,e);return n?l(n.details.title)||a("server-type-"+n.type):""};case"issue_tracker":return"details.issues_enabled";case"range":return function(e){return r.get(n,[e.id,"range","start"],"")};case"last_month":return function(e){return r.get(n,[e.id,"last_month","total"],0)};case"this_month":return function(e){return r.get(n,[e.id,"this_month","total"],0)};case"to_date":return function(e){return r.get(n,[e.id,"to_date","total"],0)};default:return e}}),r.orderBy(e,o,i)}),T=c(function(e,t){return r.find(e,function(e){return!!u.findLink(t,e)})}),P=c(function(e,t){if(t){var n=r.keyBy(e,"id");return r.filter(r.map(t.repo_ids,function(e){return n[e]}))}return[]})},"./pages/repo-list-page.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/repo-list-page.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./pages/repo-summary-page.jsx":function(e,t,n){"use strict";var s=(Object.assign,n("../node_modules/lodash/lodash.js")),r=n("../node_modules/react/react.js"),o=r.PropTypes,i=n("../node_modules/relaks/index.js"),a=n("../../common/src/utils/component-refs.js"),l=n("../../common/src/objects/finders/project-finder.js"),c=n("../../common/src/objects/finders/repo-finder.js"),d=n("../../common/src/objects/finders/statistics-finder.js"),u=n("../../common/src/objects/finders/system-finder.js"),p=n("../../common/src/data/database.js"),m=n("../../common/src/routing/route.js"),h=n("../../common/src/locale/locale.js"),f=n("../../common/src/theme/theme.js"),g=n("./widgets/push-button.jsx"),v=n("./widgets/combo-button.jsx"),b=n("./widgets/instruction-block.jsx"),y=n("./widgets/text-field.jsx"),j=n("./widgets/multilingual-text-field.jsx"),x=(n("./widgets/option-list.jsx"),n("./widgets/activity-chart.jsx")),w=n("./widgets/action-confirmation.jsx"),_=n("./widgets/data-loss-warning.jsx");n("./pages/repo-summary-page.scss"),e.exports=i.createClass({displayName:"RepoSummaryPage",propTypes:{database:o.instanceOf(p).isRequired,route:o.instanceOf(m).isRequired,locale:o.instanceOf(h).isRequired,theme:o.instanceOf(f).isRequired},statics:{parseURL:function(e,t){return m.match(e,["/projects/:project/repos/:repo/?"],function(e){return{project:m.parseId(e.project),repo:m.parseId(e.repo),edit:!!t.edit}})},getURL:function(e){var t,n="/projects/"+e.project+"/repos/"+e.repo+"/";return e.edit&&(t={edit:1}),{path:n,query:t}}},renderAsync:function(e){var t=this.props.route.parameters,n=this.props.database.use({schema:"global",by:this}),s={system:null,project:null,repo:null,statistics:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(r.createElement(E,s)),n.start().then(function(e){return u.findSystem(n).then(function(e){s.system=e})}).then(function(){return c.findRepo(n,t.repo).then(function(e){s.repo=e})}).then(function(){return e.show(r.createElement(E,s)),l.findProject(n,t.project).then(function(e){s.project=e})}).then(function(){return e.show(r.createElement(E,s)),d.findDailyActivitiesOfRepo(n,s.project,s.repo).then(function(e){s.statistics=e})}).then(function(){return r.createElement(E,s)})}});var E=e.exports.Sync=r.createClass({displayName:"RepoSummaryPage.Sync",propTypes:{system:o.object,repo:o.object,project:o.object,database:o.instanceOf(p).isRequired,route:o.instanceOf(m).isRequired,locale:o.instanceOf(h).isRequired,theme:o.instanceOf(f).isRequired},getInitialState:function(){return this.components=a({confirmation:w}),{newRepo:null}},getRepo:function(e){return!this.isEditing()||e&&"current"!==e?this.props.repo||k:this.state.newRepo||this.props.repo||k},getRepoProperty:function(e,t){var n=this.getRepo(t);return s.get(n,e)},setRepoProperty:function(e,t){var n=this.getRepo(),r=s.decoupleSet(n,e,t),o=!0;s.isEqual(r,this.props.repo)&&(r=null,o=!1),this.setState({newRepo:r,hasChanges:o})},isEditing:function(e){return e=e||this.props,e.route.parameters.edit},setEditability:function(t){var n=this.props.route,r=s.clone(n.parameters);return r.edit=t,n.replace(e.exports,r)},returnToList:function(){var e=this.props.route,t={project:e.parameters.project};return e.push(n("./pages/repo-list-page.jsx"),t)},getInputLanguages:function(){return s.get(this.props.system,"settings.input_languages",[])},componentWillReceiveProps:function(e){this.isEditing()!==this.isEditing(e)&&this.isEditing(e)&&this.setState({newRepo:null,hasChanges:!1})},render:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=this.getRepo(),o=t(s.get(n,"details.title"))||n.name;return r.createElement("div",{className:"repo-summary-page"},this.renderButtons(),r.createElement("h2",null,e("repo-summary-$title",o)),this.renderForm(),this.renderInstructions(),this.renderChart(),r.createElement(w,{ref:this.components.setters.confirmation,locale:this.props.locale,theme:this.props.theme}),r.createElement(_,{changes:this.state.hasChanges,locale:this.props.locale,theme:this.props.theme,route:this.props.route}))},renderButtons:function(){var e=this.props.locale.translate;if(this.isEditing())return r.createElement("div",{key:"edit",className:"buttons"},r.createElement(g,{onClick:this.handleCancelClick},e("repo-summary-cancel"))," ",r.createElement(g,{className:"emphasis",disabled:!this.state.hasChanges,onClick:this.handleSaveClick},e("repo-summary-save")));var t=this.props.route.parameters.repo,n=this.props.project,o=!n||s.includes(n.repo_ids,t),i=o?void 0:"restore";return r.createElement("div",{key:"view",className:"buttons"},r.createElement(v,{preselected:i},r.createElement("option",{name:"return",onClick:this.handleReturnClick},e("repo-summary-return")),r.createElement("option",{name:"remove",disabled:!o,onClick:this.handleRemoveClick},e("repo-summary-remove")),r.createElement("option",{name:"restore",hidden:o,onClick:this.handleRestoreClick},e("repo-summary-restore")))," ",r.createElement(g,{className:"emphasis",onClick:this.handleEditClick},e("repo-summary-edit")))},renderForm:function(){return r.createElement("div",{className:"form"},this.renderTitleInput(),this.renderNameInput(),this.renderIssueTrackingStatus())},renderTitleInput:function(){var e=this.props.locale.translate,t={id:"title",value:this.getRepoProperty("details.title"),availableLanguageCodes:this.getInputLanguages(),locale:this.props.locale,onChange:this.handleTitleChange,readOnly:!this.isEditing()};return r.createElement(j,t,e("repo-summary-title"))},renderNameInput:function(){var e=this.props.locale.translate,t={id:"name",value:this.getRepoProperty("name"),locale:this.props.locale,readOnly:!0};return r.createElement(y,t,e("repo-summary-gitlab-name"))},renderIssueTrackingStatus:function(){var e,t=this.props.locale.translate;e=t(this.getRepoProperty("details.issues_enabled")?"repo-summary-issue-tracker-enabled":"repo-summary-issue-tracker-disabled");var n={id:"issue-tracker",value:e,locale:this.props.locale,readOnly:!0};return r.createElement(y,n,t("repo-summary-issue-tracker"))},renderInstructions:function(){var e={folder:"repo",topic:"repo-summary",hidden:!this.isEditing(),locale:this.props.locale};return r.createElement("div",{className:"instructions"},r.createElement(b,e))},renderChart:function(){var e=this.props.locale.translate,t={statistics:this.props.statistics,locale:this.props.locale,theme:this.props.theme};return r.createElement("div",{className:"statistics"},r.createElement(x,t,e("repo-summary-statistics")))},changeInclusion:function(e){var t=this.props.database.use({schema:"global",by:this}),n=this.props.repo,r=this.props.project.repo_ids;r=e?s.union(r,[n.id]):s.difference(r,[n.id]);var o=s.assign({},this.props.project,{repo_ids:r});return t.saveOne({table:"project"},o)},handleRemoveClick:function(e){var t=this,n=this.props.locale.translate,s=n("repo-summary-confirm-remove");return this.components.confirmation.ask(s).then(function(e){if(e)return t.changeInclusion(!1).then(function(e){return t.returnToList()})})},handleRestoreClick:function(e){var t=this,n=this.props.locale.translate,s=n("repo-summary-confirm-restore");return this.components.confirmation.ask(s).then(function(e){if(e)return t.changeInclusion(!0)})},handleReturnClick:function(e){return this.returnToList()},handleEditClick:function(e){return this.setEditability(!0)},handleCancelClick:function(e){return this.setEditability(!1)},handleSaveClick:function(e){var t=this,n=this.props.database.use({schema:"global",by:this}),s=this.getRepo();return n.start().then(function(e){return n.saveOne({table:"repo"},s).then(function(e){t.setState({hasChanges:!1},function(){t.setEditability(!1)})})})},handleTitleChange:function(e){this.setRepoProperty("details.title",e.target.value)}}),k={details:{}}},"./pages/repo-summary-page.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/repo-summary-page.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./pages/role-list-page.jsx":function(e,t,n){"use strict";var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/react/react.js"),i=o.PropTypes,a=n("../node_modules/relaks/index.js"),l=n("../../common/src/utils/memoize.js"),c=n("../../common/src/utils/component-refs.js"),d=n("../../common/src/objects/finders/role-finder.js"),u=n("../../common/src/objects/finders/user-finder.js"),p=n("../../common/src/data/database.js"),m=n("../../common/src/routing/route.js"),h=n("../../common/src/locale/locale.js"),f=n("../../common/src/theme/theme.js"),g=n("./widgets/push-button.jsx"),v=n("./widgets/combo-button.jsx"),b=n("./widgets/sortable-table.jsx"),y=b.TH,j=n("./tooltips/user-tooltip.jsx"),x=n("./tooltips/modified-time-tooltip.jsx"),w=n("./widgets/action-badge.jsx"),_=n("./widgets/action-confirmation.jsx"),E=n("./widgets/data-loss-warning.jsx");n("./pages/role-list-page.scss"),e.exports=a.createClass({displayName:"RolesPage",propTypes:{database:i.instanceOf(p).isRequired,route:i.instanceOf(m).isRequired,locale:i.instanceOf(h).isRequired,theme:i.instanceOf(f).isRequired},statics:{parseURL:function(e,t){return m.match(e,["/roles/?"],function(e){return{edit:!!t.edit}})},getURL:function(e){var t;return e.edit&&(t={edit:1}),{path:"/roles/",query:t}}},renderAsync:function(e){var t=this.props.database.use({schema:"global",by:this}),n={roles:null,users:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(o.createElement(k,n)),t.start().then(function(e){return d.findAllRoles(t).then(function(e){n.roles=e})}).then(function(){return e.show(o.createElement(k,n)),u.findUsersWithRoles(t,n.roles).then(function(e){n.users=e})}).then(function(e){return o.createElement(k,n)})}});var k=e.exports.Sync=o.createClass({displayName:"RoleListPage.Sync",propTypes:{roles:i.arrayOf(i.object),users:i.arrayOf(i.object),database:i.instanceOf(p).isRequired,route:i.instanceOf(m).isRequired,locale:i.instanceOf(h).isRequired,theme:i.instanceOf(f).isRequired},getInitialState:function(){return this.components=c({confirmation:_}),{sortColumns:["name"],sortDirections:["asc"],restoringRoleIds:[],disablingRoleIds:[],hasChanges:!1,renderingFullList:this.isEditing()}},isEditing:function(e){return e=e||this.props,e.route.parameters.edit},setEditability:function(t){var n=this.props.route,s=r.clone(n.parameters);return s.edit=t,this.props.route.replace(e.exports,s)},componentWillReceiveProps:function(e){var t=this;this.isEditing()!==this.isEditing(e)&&(this.isEditing(e)?this.setState({renderingFullList:!0,restoringRoleIds:[],disablingRoleIds:[],hasChanges:!1}):setTimeout(function(){t.isEditing()||t.setState({renderingFullList:!1})},500))},render:function(){var e=this.props.locale.translate;return o.createElement("div",{className:"role-list-page"},this.renderButtons(),o.createElement("h2",null,e("role-list-title")),this.renderTable(),o.createElement(_,{ref:this.components.setters.confirmation,locale:this.props.locale,theme:this.props.theme}),o.createElement(E,{changes:this.state.hasChanges,locale:this.props.locale,theme:this.props.theme,route:this.props.route}))},renderButtons:function(){var e=this.props.locale.translate;if(this.isEditing())return o.createElement("div",{className:"buttons"},o.createElement(g,{onClick:this.handleCancelClick},e("role-list-cancel"))," ",o.createElement(g,{className:"emphasis",disabled:!this.state.hasChanges,onClick:this.handleSaveClick},e("role-list-save")));var t=r.isEmpty(this.props.roles);return o.createElement("div",{className:"buttons"},o.createElement(v,{preselected:"add"},o.createElement("option",{name:"add",onClick:this.handleAddClick},e("role-list-add")))," ",o.createElement(g,{className:"emphasis",disabled:t,onClick:this.handleEditClick},e("role-list-edit")))},renderTable:function(){var e={sortColumns:this.state.sortColumns,sortDirections:this.state.sortDirections,onSort:this.handleSort};return this.state.renderingFullList&&(e.expandable=!0,e.selectable=!0,e.expanded=this.isEditing(),e.onClick=this.handleRowClick),o.createElement(b,e,o.createElement("thead",null,this.renderHeadings()),o.createElement("tbody",null,this.renderRows()))},renderHeadings:function(){return o.createElement("tr",null,this.renderTitleColumn(),this.renderUsersColumn(),this.renderModifiedTimeColumn())},renderRows:function(){var e=this.props.roles;return this.state.renderingFullList||(e=C(e)),e=S(e,this.props.users,this.props.locale,this.state.sortColumns,this.state.sortDirections),r.map(e,this.renderRow)},renderRow:function(e){var t,n,i=this.props.locale.translate,a=[];e.deleted?(a.push("deleted"),n=i("role-list-status-deleted")):e.disabled&&(a.push("disabled"),n=i("role-list-status-disabled")),this.state.renderingFullList&&(e.deleted||e.disabled?r.includes(this.state.restoringRoleIds,e.id)&&a.push("selected"):(a.push("fixed"),r.includes(this.state.disablingRoleIds,e.id)||a.push("selected")),t=this.handleRowClick);var l={className:a.join(" "),"data-role-id":e.id,title:n,onClick:t};return o.createElement("tr",s({key:e.id},l),this.renderTitleColumn(e),this.renderUsersColumn(e),this.renderModifiedTimeColumn(e))},renderTitleColumn:function(e){var t=this.props.locale.translate;if(e){var s,i,a=this.props.locale.pick,l=a(e.details.title)||"-";if(this.state.renderingFullList){var c,d;e.deleted||e.disabled?(c=!1,d=r.includes(this.state.restoringRoleIds,e.id)):(c=!0,d=!r.includes(this.state.disablingRoleIds,e.id)),c!==d&&(i=d?o.createElement(w,{type:"reactivate",locale:this.props.locale}):o.createElement(w,{type:"disable",locale:this.props.locale}))}else{var u=this.props.route,p={role:e.id};s=u.find(n("./pages/role-summary-page.jsx"),p)}return o.createElement("td",null,o.createElement("a",{href:s},l)," ",i)}return o.createElement(y,{id:"title"},t("table-heading-title"))},renderUsersColumn:function(e){if(this.props.theme.isBelowMode("narrow"))return null;var t=this.props.locale.translate;if(e){var n={users:R(this.props.users,e),route:this.props.route,locale:this.props.locale,theme:this.props.theme};return o.createElement("td",null,o.createElement(j,n))}return o.createElement(y,{id:"users"},t("table-heading-users"))},renderModifiedTimeColumn:function(e){if(this.props.theme.isBelowMode("standard"))return null;var t=this.props.locale.translate;if(e){var n={time:e.mtime,locale:this.props.locale};return o.createElement("td",null,o.createElement(x,n))}return o.createElement(y,{id:"mtime"},t("table-heading-last-modified"))},handleSort:function(e){this.setState({sortColumns:e.columns,sortDirections:e.directions})},handleAddClick:function(e){var t=this.props.route,s={role:"new"};return t.push(n("./pages/role-summary-page.jsx"),s)},handleEditClick:function(e){this.setEditability(!0)},handleCancelClick:function(e){this.setEditability(!1)},handleSaveClick:function(e){var t=this,n=this.props.locale.translate,s=this.state.disablingRoleIds,o=this.state.restoringRoleIds,i=[n("role-list-confirm-disable-$count",s.length),n("role-list-confirm-reactivate-$count",o.length)],a=[r.isEmpty(s)||void 0,r.isEmpty(o)||void 0];return this.components.confirmation.askSeries(i,a).then(function(e){if(e){var n=t.props.database.use({schema:"global",by:t});return n.start().then(function(e){var i=[];return r.each(t.props.roles,function(e){var t={};if(r.includes(s,e.id))t.disabled=!0;else{if(!r.includes(o,e.id))return;t.disabled=t.deleted=!1}var n=r.assign({},e,t);i.push(n)}),n.save({table:"role"},i).then(function(e){return t.setState({hasChanges:!1},function(){t.setEditability(!1)}),null})})}})},handleRowClick:function(e){var t=parseInt(e.currentTarget.getAttribute("data-role-id")),n=r.find(this.props.roles,{id:t}),s=r.slice(this.state.restoringRoleIds),o=r.slice(this.state.disablingRoleIds);n.deleted||n.disabled?r.includes(s,n.id)?r.pull(s,n.id):s.push(n.id):r.includes(o,n.id)?r.pull(o,n.id):o.push(n.id);var i=!r.isEmpty(s)||!r.isEmpty(o);this.setState({restoringRoleIds:s,disablingRoleIds:o,hasChanges:i})}}),C=l(function(e){return r.filter(e,function(e){return!e.deleted&&!e.disabled})}),S=l(function(e,t,n,s,o){return s=r.map(s,function(e){switch(e){case"title":return function(e){return n.pick(e.details.title)};default:return e}}),r.orderBy(e,s,o)}),R=l(function(e,t){return r.filter(e,function(e){return r.includes(e.role_ids,t.id)})})},"./pages/role-list-page.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/role-list-page.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./pages/role-summary-page.jsx":function(e,t,n){"use strict";var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/react/react.js"),i=o.PropTypes,a=n("../node_modules/relaks/index.js"),l=n("../../common/src/utils/memoize.js"),c=n("../../common/src/utils/component-refs.js"),d=n("../../common/src/objects/finders/role-finder.js"),u=n("../../common/src/objects/finders/system-finder.js"),p=n("../../common/src/objects/finders/user-finder.js"),m=n("../../common/src/data/database.js"),h=n("../../common/src/routing/route.js"),f=n("../../common/src/locale/locale.js"),g=n("../../common/src/theme/theme.js"),v=n("../../common/src/utils/slug-generator.js"),b=n("./widgets/push-button.jsx"),y=n("./widgets/combo-button.jsx"),j=n("./widgets/instruction-block.jsx"),x=n("./widgets/text-field.jsx"),w=n("./widgets/multilingual-text-field.jsx"),_=n("./widgets/option-list.jsx"),E=n("./widgets/input-error.jsx"),k=n("./widgets/action-confirmation.jsx"),C=n("./widgets/data-loss-warning.jsx");n("./pages/role-summary-page.scss"),e.exports=a.createClass({displayName:"RoleSummaryPage",propTypes:{database:i.instanceOf(m).isRequired,route:i.instanceOf(h).isRequired,locale:i.instanceOf(f).isRequired,theme:i.instanceOf(g).isRequired},statics:{parseURL:function(e,t){return h.match(e,["/roles/:role/?"],function(e){return{role:"new"===e.role?"new":h.parseId(e.role),edit:!!t.edit}})},getURL:function(e){var t,n="/roles/"+e.role+"/";return e.edit&&(t={edit:1}),{path:n,query:t}}},renderAsync:function(e){var t=this.props.route.parameters,n=this.props.database.use({by:this}),s={system:null,role:null,users:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(o.createElement(S,s)),n.start().then(function(e){return u.findSystem(n).then(function(e){s.system=e})}).then(function(){if("new"!==t.role)return d.findRole(n,t.role).then(function(e){s.role=e})}).then(function(){return e.show(o.createElement(S,s)),p.findActiveUsers(n).then(function(e){s.users=e})}).then(function(){return o.createElement(S,s)})}});var S=e.exports.Sync=o.createClass({displayName:"RoleSummaryPage.Sync",propTypes:{system:i.object,role:i.object,users:i.arrayOf(i.object),database:i.instanceOf(m).isRequired,route:i.instanceOf(h).isRequired,locale:i.instanceOf(f).isRequired,theme:i.instanceOf(g).isRequired},getInitialState:function(){return this.components=c({confirmation:k}),{newRole:null,hasChanges:!1,saving:!1,adding:!1,removeList:[],addList:[],problems:{}}},getRole:function(e){return!this.isEditing()||e&&"current"!==e?this.props.role||O:this.state.newRole||this.props.role||O},getRoleProperty:function(e,t){var n=this.getRole(t);return r.get(n,e)},setRoleProperty:function(e,t){var n=this.getRole("current"),s=r.decoupleSet(n,e,t);if("details.title"===e){var o=v.fromTitle(n.details.title),i=v.fromTitle(s.details.title);n.name&&n.name!==o||(s.name=i)}r.size(s.name)>128&&(s.name=s.name.substr(0,128));var a=!0;r.isEqual(s,this.props.role)&&(s=null,a=!r.isEmpty(this.state.addList)||!r.isEmpty(this.state.removeList)),this.setState({newRole:s,hasChanges:a})},findProblems:function(){var e={};return this.getRole().name||(e.name="validation-required"),e},isCreating:function(e){return e=e||this.props,"new"===e.route.parameters.role},isEditing:function(e){return e=e||this.props,this.isCreating(e)||e.route.parameters.edit},setEditability:function(t,n){var s=this;if(!this.isCreating()||t||n){var o=this.props.route,i=r.clone(o.parameters);return i.edit=t,n&&(i.role=n.id),o.replace(e.exports,i).then(function(e){e&&s.setState({problems:{}})})}return this.returnToList()},returnToList:function(){return this.props.route.push(n("./pages/role-list-page.jsx"))},startNew:function(){var t=this.props.route,n=r.clone(t.parameters);return n.role="new",t.replace(e.exports,n)},getInputLanguages:function(){return r.get(this.props.system,"settings.input_languages",[])},componentWillReceiveProps:function(e){this.isEditing()!==this.isEditing(e)&&this.setState({newRole:null,hasChanges:!1,addList:[],removeList:[]})},render:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=this.getRole(),s=t(r.get(n,"details.title"))||n.name;return o.createElement("div",{className:"role-summary-page"},this.renderButtons(),o.createElement("h2",null,e("role-summary-$title",s)),this.renderForm(),this.renderInstructions(),o.createElement(k,{ref:this.components.setters.confirmation,locale:this.props.locale,theme:this.props.theme}),o.createElement(C,{changes:this.state.hasChanges,locale:this.props.locale,theme:this.props.theme,route:this.props.route}))},renderButtons:function(){var e=this.props.locale.translate;if(this.isEditing())return o.createElement("div",{className:"buttons"},o.createElement(b,{onClick:this.handleCancelClick},e("role-summary-cancel"))," ",o.createElement(b,{className:"emphasis",disabled:!this.state.hasChanges,onClick:this.handleSaveClick},e("role-summary-save")));var t,n=this.props.role,s=!n||!n.deleted&&!n.disabled;return t=s?this.state.adding?"add":"return":"reactivate",o.createElement("div",{className:"buttons"},o.createElement(y,{preselected:t},o.createElement("option",{name:"return",onClick:this.handleReturnClick},e("role-summary-return")),o.createElement("option",{name:"add",onClick:this.handleAddClick},e("role-summary-add")),o.createElement("option",{name:"archive",disabled:!s,separator:!0,onClick:this.handleDisableClick},e("role-summary-disable")),o.createElement("option",{name:"delete",disabled:!s,onClick:this.handleDeleteClick},e("role-summary-delete")),o.createElement("option",{name:"reactivate",hidden:s,onClick:this.handleReactivateClick},e("role-summary-reactivate")))," ",o.createElement(b,{className:"emphasis",onClick:this.handleEditClick},e("role-summary-edit")))},renderForm:function(){return o.createElement("div",{className:"form"},this.renderTitleInput(),this.renderNameInput(),this.renderDescriptionInput(),this.renderRatingSelector(),this.renderUserSelector())},renderTitleInput:function(){var e=this.props.locale.translate,t={id:"title",value:this.getRoleProperty("details.title"),availableLanguageCodes:this.getInputLanguages(),locale:this.props.locale,onChange:this.handleTitleChange,readOnly:!this.isEditing()};return o.createElement(w,t,e("role-summary-title"))},renderNameInput:function(){var e=this.props.locale.translate,t={id:"name",value:this.getRoleProperty("name"),locale:this.props.locale,onChange:this.handleNameChange,readOnly:!this.isEditing()},n=this.state.problems;return o.createElement(x,t,e("role-summary-name"),o.createElement(E,null,e(n.name)))},renderDescriptionInput:function(){var e=this.props.locale.translate,t={id:"description",value:this.getRoleProperty("details.description"),availableLanguageCodes:this.getInputLanguages(),type:"textarea",locale:this.props.locale,onChange:this.handleDescriptionChange,readOnly:!this.isEditing()};return o.createElement(w,t,e("role-summary-description"))},renderRatingSelector:function(){var e=this.props.locale.translate,t=this.getRoleProperty("settings.rating","current")||0,n=(this.getRoleProperty("settings.rating","original"),r.map(T,function(n,s){return{name:s,selected:t===n,previous:t===n,children:e("role-summary-rating-"+s)}})),i={onOptionClick:this.handleRatingOptionClick,readOnly:!this.isEditing()};return o.createElement(_,i,o.createElement("label",null,e("role-summary-rating")),r.map(n,function(e,t){return o.createElement("option",s({key:t},e))}))},renderUserSelector:function(){var e=this,t=this.props.locale.translate,n=this.props.locale.pick,i=this.getRoleProperty("id"),a=R(this.props.users,this.props.locale),l=r.map(a,function(t){var s,o=r.includes(t.role_ids,i);return s=o?!r.includes(e.state.removeList,t.id):r.includes(e.state.addList,t.id),{name:String(t.id),selected:s,previous:o,children:n(t.details.name)||n.username}}),c={onOptionClick:this.handleUserOptionClick,readOnly:!this.isEditing()};return o.createElement(_,c,o.createElement("label",null,t("role-summary-users")),r.map(l,function(e,t){return o.createElement("option",s({key:t},e))}))},renderInstructions:function(){var e={folder:"role",topic:"role-summary",hidden:!this.isEditing(),locale:this.props.locale};return o.createElement("div",{className:"instructions"},o.createElement(j,e))},changeFlags:function(e){var t=this.props.database.use({schema:"global",by:this}),n=r.assign({},this.props.role,e);return t.saveOne({table:"role"},n)},handleDisableClick:function(e){var t=this,n=this.props.locale.translate,s=n("role-summary-confirm-disable");return this.components.confirmation.ask(s).then(function(e){if(e)return t.changeFlags({disabled:!0}).then(function(){return t.returnToList()})})},handleDeleteClick:function(e){var t=this,n=this.props.locale.translate,s=n("role-summary-confirm-delete");return this.components.confirmation.ask(s).then(function(e){if(e)return t.changeFlags({deleted:!0}).then(function(){return t.returnToList()})})},handleReactivateClick:function(e){var t=this,n=this.props.locale.translate,s=n("role-summary-confirm-reactivate");return this.components.confirmation.ask(s).then(function(e){if(e)return t.changeFlags({disabled:!1,deleted:!1})})},handleReturnClick:function(e){return this.returnToList()},handleAddClick:function(e){return this.startNew()},handleEditClick:function(e){return this.setEditability(!0)},handleCancelClick:function(e){return this.setEditability(!1)},handleSaveClick:function(e){var t=this;if(!this.state.saving){var n=this.findProblems();if(r.some(n))return void this.setState({problems:n});var s=this.getRole();this.setState({saving:!0,adding:!s.id,problems:{}},function(){var e=t.props.database.use({schema:"global",by:t});return e.start().then(function(n){return e.saveOne({table:"role"},s).then(function(n){var s=[];return r.each(t.state.addList,function(e){var o=r.find(t.props.users,{id:e});s.push({id:o.id,role_ids:r.union(o.role_ids,[n.id])})}),r.each(t.state.removeList,function(e){var o=r.find(t.props.users,{id:e});s.push({id:o.id,role_ids:r.difference(o.role_ids,[n.id])})}),r.isEmpty(s)?n:e.save({table:"user"},s).return(n)}).then(function(e){return t.setState({hasChanges:!1,saving:!1},function(){return t.setEditability(!1,e)}),null})}).catch(function(e){var n={};409===e.statusCode?n.name="validation-duplicate-role-name":(n.general=e.message,console.error(e)),t.setState({problems:n,saving:!1})})})}},handleTitleChange:function(e){this.setRoleProperty("details.title",e.target.value)},handleNameChange:function(e){var t=r.toLower(e.target.value).replace(/\W+/g,"");this.setRoleProperty("name",t)},handleDescriptionChange:function(e){this.setRoleProperty("details.description",e.target.value)},handleRatingOptionClick:function(e){var t=e.name,n=T[t];this.setRoleProperty("settings.rating",n)},handleUserOptionClick:function(e){var t=parseInt(e.name),n=r.find(this.props.users,{id:t}),s=this.getRoleProperty("id"),o=r.slice(this.state.addList),i=r.slice(this.state.removeList);r.includes(n.role_ids,s)?r.includes(i,n.id)?r.pull(i,n.id):i.push(n.id):r.includes(o,n.id)?r.pull(o,n.id):o.push(n.id);var a=!0;this.state.newRole||(a=!r.isEmpty(o)||!r.isEmpty(i)),this.setState({addList:o,removeList:i,hasChanges:a})}}),R=l(function(e,t){var n=t.pick,s=function(e){return n(e.details.name)||e.username};return r.sortBy(e,s)}),O={details:{}},T={"very-high":50,high:20,normal:0,low:-20,"very-low":-50}},"./pages/role-summary-page.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/role-summary-page.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./pages/server-list-page.jsx":function(e,t,n){"use strict";function s(e){switch(e){case"facebook":return"facebook-official";default:return e}}function r(e){var t=e.settings.oauth;return!!(t&&t.client_id&&t.client_secret)}function o(e){var t=e.settings.api;return!(!t||!t.access_token)}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},a=n("../node_modules/lodash/lodash.js"),l=(n("../node_modules/moment/moment.js"),n("../node_modules/react/react.js")),c=l.PropTypes,d=n("../node_modules/relaks/index.js"),u=n("../../common/src/utils/memoize.js"),p=n("../../common/src/utils/component-refs.js"),m=n("../../common/src/objects/finders/server-finder.js"),h=n("../../common/src/objects/finders/user-finder.js"),f=n("../../common/src/data/database.js"),g=n("../../common/src/routing/route.js"),v=n("../../common/src/locale/locale.js"),b=n("../../common/src/theme/theme.js"),y=n("./widgets/push-button.jsx"),j=n("./widgets/combo-button.jsx"),x=n("./widgets/sortable-table.jsx"),w=x.TH,_=n("./tooltips/user-tooltip.jsx"),E=n("./tooltips/modified-time-tooltip.jsx"),k=n("./widgets/action-badge.jsx"),C=n("./widgets/action-confirmation.jsx"),S=n("./widgets/data-loss-warning.jsx");n("./pages/server-list-page.scss"),e.exports=d.createClass({displayName:"ServerListPage",propTypes:{database:c.instanceOf(f).isRequired,route:c.instanceOf(g).isRequired,locale:c.instanceOf(v).isRequired,theme:c.instanceOf(b).isRequired},statics:{parseURL:function(e,t){return g.match(e,["/servers/?"],function(e){return{edit:!!t.edit}})},getURL:function(e){var t;return e.edit&&(t={edit:1}),{path:"/servers/",query:t}}},renderAsync:function(e){var t=this.props.database.use({schema:"global",by:this}),n={servers:null,users:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(l.createElement(R,n)),t.start().then(function(e){return m.findAllServers(t).then(function(e){n.servers=e})}).then(function(){return e.show(l.createElement(R,n)),h.findActiveUsers(t).then(function(e){n.users=e})}).then(function(){return l.createElement(R,n)})}});var R=e.exports.Sync=l.createClass({displayName:"ServerListPage.Sync",propTypes:{servers:c.arrayOf(c.object),users:c.arrayOf(c.object),database:c.instanceOf(f).isRequired,route:c.instanceOf(g).isRequired,locale:c.instanceOf(v).isRequired,theme:c.instanceOf(b).isRequired},getInitialState:function(){return this.components=p({confirmation:C}),{sortColumns:["name"],sortDirections:["asc"],restoringServerIds:[],disablingServerIds:[],hasChanges:!1,renderingFullList:this.isEditing()}},isEditing:function(e){return e=e||this.props,e.route.parameters.edit},setEditability:function(t){var n=this.props.route,s=a.clone(n.parameters);return s.edit=t,this.props.route.replace(e.exports,s)},componentWillReceiveProps:function(e){var t=this;this.isEditing()!==this.isEditing(e)&&(this.isEditing(e)?this.setState({renderingFullList:!0,restoringServerIds:[],disablingServerIds:[],hasChanges:!1}):setTimeout(function(){t.isEditing()||t.setState({renderingFullList:!1})},500))},render:function(){var e=this.props.locale.translate;return l.createElement("div",{className:"server-list-page"},this.renderButtons(),l.createElement("h2",null,e("server-list-title")),this.renderTable(),l.createElement(C,{ref:this.components.setters.confirmation,locale:this.props.locale,theme:this.props.theme}),l.createElement(S,{changes:this.state.hasChanges,locale:this.props.locale,theme:this.props.theme,route:this.props.route}))},renderButtons:function(){var e=this.props.locale.translate;if(this.isEditing())return l.createElement("div",{className:"buttons"},l.createElement(y,{onClick:this.handleCancelClick},e("server-list-cancel"))," ",l.createElement(y,{className:"emphasis",disabled:!this.state.hasChanges,onClick:this.handleSaveClick},e("server-list-save")));var t=a.isEmpty(this.props.servers);return l.createElement("div",{className:"buttons"},l.createElement(j,{preselected:"add"},l.createElement("option",{name:"add",onClick:this.handleAddClick},e("server-list-add")))," ",l.createElement(y,{name:"edit",className:"emphasis",disabled:t,onClick:this.handleEditClick},e("server-list-edit")))},renderTable:function(){var e={sortColumns:this.state.sortColumns,sortDirections:this.state.sortDirections,onSort:this.handleSort};return this.state.renderingFullList&&(e.expandable=!0,e.selectable=!0,e.expanded=this.isEditing(),e.onClick=this.handleRowClick),l.createElement(x,e,l.createElement("thead",null,this.renderHeadings()),l.createElement("tbody",null,this.renderRows()))},renderHeadings:function(){return l.createElement("tr",null,this.renderTitleColumn(),this.renderTypeColumn(),this.renderOAuthColumn(),this.renderAPIColumn(),this.renderUsersColumn(),this.renderModifiedTimeColumn())},renderRows:function(){var e=this.props.servers;return this.state.renderingFullList||(e=O(e)),e=T(e,this.props.users,this.props.locale,this.state.sortColumns,this.state.sortDirections),a.map(e,this.renderRow)},renderRow:function(e){var t,n,s=this.props.locale.translate,r=[];e.deleted?(r.push("deleted"),n=s("server-list-status-deleted")):e.disabled&&(r.push("disabled"),n=s("server-list-status-disabled")),this.state.renderingFullList&&(e.deleted||e.disabled?a.includes(this.state.restoringServerIds,e.id)&&r.push("selected"):(r.push("fixed"),a.includes(this.state.disablingServerIds,e.id)||r.push("selected")),t=this.handleRowClick);var o={className:r.join(" "),"data-server-id":e.id,title:n,onClick:t};return l.createElement("tr",i({key:e.id},o),this.renderTitleColumn(e),this.renderTypeColumn(e),this.renderOAuthColumn(e),this.renderAPIColumn(e),this.renderUsersColumn(e),this.renderModifiedTimeColumn(e))},renderTitleColumn:function(e){var t=this.props.locale.translate;if(e){var r,o,i=this.props.locale.pick,c=i(e.details.title)||t("server-type-"+e.type);if(this.state.renderingFullList){var d,u;e.deleted||e.disabled?(d=!1,u=a.includes(this.state.restoringServerIds,e.id)):(d=!0,u=!a.includes(this.state.disablingServerIds,e.id)),d!==u&&(o=u?l.createElement(k,{type:"reactivate",locale:this.props.locale}):l.createElement(k,{type:"disable",locale:this.props.locale}))}else{var p=this.props.route,m={server:e.id};r=p.find(n("./pages/server-summary-page.jsx"),m)}var h=s(e.type),f=l.createElement("i",{className:"fa fa-"+h+" fa-fw"});return l.createElement("td",null,l.createElement("a",{href:r},f," ",c),o)}return l.createElement(w,{id:"title"},t("table-heading-title"))},renderTypeColumn:function(e){var t=this.props.locale.translate;return e?l.createElement("td",null,t("server-type-"+e.type)):l.createElement(w,{id:"type"},t("table-heading-type"))},renderOAuthColumn:function(e){if(this.props.theme.isBelowMode("wide"))return null;var t=this.props.locale.translate;if(e){var n=r(e);return l.createElement("td",null,t("server-list-oauth-"+n))}return l.createElement(w,{id:"oauth"},t("table-heading-oauth"))},renderAPIColumn:function(e){if(this.props.theme.isBelowMode("wide"))return null;var t=this.props.locale.translate;if(e){var n=o(e);return l.createElement("td",null,t("server-list-api-access-"+n))}return l.createElement(w,{id:"api"},t("table-heading-api-access"))},renderUsersColumn:function(e){if(this.props.theme.isBelowMode("standard"))return null;var t=this.props.locale.translate;if(e){var n={users:P(this.props.users,e),route:this.props.route,locale:this.props.locale,theme:this.props.theme};return l.createElement("td",null,l.createElement(_,n))}return l.createElement(w,{id:"users"},t("table-heading-users"))},renderModifiedTimeColumn:function(e){if(this.props.theme.isBelowMode("standard"))return null;var t=this.props.locale.translate;if(e){var n={time:e.mtime,locale:this.props.locale};return l.createElement("td",null,l.createElement(E,n))}return l.createElement(w,{id:"mtime"},t("table-heading-last-modified"))},handleSort:function(e){this.setState({sortColumns:e.columns,sortDirections:e.directions})},handleAddClick:function(e){return this.props.route.push(n("./pages/server-summary-page.jsx"),{server:"new"})},handleEditClick:function(e){this.setEditability(!0)},handleCancelClick:function(e){this.setEditability(!1)},handleSaveClick:function(e){var t=this,n=this.props.locale.translate,s=this.state.disablingServerIds,r=this.state.restoringServerIds,o=[n("server-list-confirm-disable-$count",s.length),n("server-list-confirm-reactivate-$count",r.length)],i=[a.isEmpty(s)||void 0,a.isEmpty(r)||void 0];return this.components.confirmation.askSeries(o,i).then(function(e){if(e){var n=t.props.database.use({schema:"global",by:t});return n.start().then(function(e){var o=[];return a.each(t.props.servers,function(e){var t={};if(a.includes(s,e.id))t.disabled=!0;else{if(!a.includes(r,e.id))return;t.disabled=t.deleted=!1}var n=a.assign({},e,t);o.push(n)}),n.save({table:"server"},o).then(function(e){return t.setState({hasChanges:!1},function(){t.setEditability(!1)}),null})})}})},handleRowClick:function(e){var t=parseInt(e.currentTarget.getAttribute("data-server-id")),n=a.find(this.props.servers,{id:t}),s=a.slice(this.state.restoringServerIds),r=a.slice(this.state.disablingServerIds);n.deleted||n.disabled?a.includes(s,n.id)?a.pull(s,n.id):s.push(n.id):a.includes(r,n.id)?a.pull(r,n.id):r.push(n.id);var o=!a.isEmpty(s)||!a.isEmpty(r);this.setState({restoringServerIds:s,disablingServerIds:r,hasChanges:o})}}),O=u(function(e){return a.filter(e,function(e){return!e.deleted&&!e.disabled})}),T=u(function(e,t,n,s,r){var o=n.translate,i=n.pick;return s=a.map(s,function(e){switch(e){case"title":return function(e){return i(e.details.title)||o("server-type-"+e.type)};case"type":return function(e){return o("server-type-"+e.type)};case"users":return function(e){return a.size(P(t,e))};default:return e}}),a.orderBy(e,s,r)}),P=u(function(e,t){return a.filter(e,function(e){return a.some(e.external,function(e){if(e.server_id===t.id)return!0})})})},"./pages/server-list-page.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/server-list-page.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./pages/server-summary-page.jsx":function(e,t,n){"use strict";function s(e){switch(e){case"facebook":return"facebook-official";default:return e}}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},o=n("../node_modules/lodash/lodash.js"),i=n("../node_modules/react/react.js"),a=i.PropTypes,l=(n("../node_modules/react-dom/index.js"),n("../node_modules/relaks/index.js")),c=n("../../common/src/utils/memoize.js"),d=n("../../common/src/utils/component-refs.js"),u=n("../../common/src/objects/finders/role-finder.js"),p=n("../../common/src/objects/finders/server-finder.js"),m=n("../../common/src/objects/types/server-types.js"),h=n("../../common/src/objects/settings/server-settings.js"),f=n("../../common/src/objects/finders/system-finder.js"),g=n("../../common/src/data/database.js"),v=n("../../common/src/routing/route.js"),b=n("../../common/src/locale/locale.js"),y=n("../../common/src/theme/theme.js"),j=n("../../common/src/utils/slug-generator.js"),x=n("./widgets/push-button.jsx"),w=n("./widgets/combo-button.jsx"),_=n("./widgets/instruction-block.jsx"),E=n("./widgets/text-field.jsx"),k=n("./widgets/multilingual-text-field.jsx"),C=n("./widgets/option-list.jsx"),S=n("../../common/src/widgets/collapsible-container.jsx"),R=n("./widgets/task-list.jsx"),O=n("./widgets/input-error.jsx"),T=n("./widgets/action-confirmation.jsx"),P=n("./widgets/data-loss-warning.jsx");n("./pages/server-summary-page.scss"),e.exports=l.createClass({displayName:"ServerSummaryPage",propTypes:{database:a.instanceOf(g).isRequired,route:a.instanceOf(v).isRequired,locale:a.instanceOf(b).isRequired,theme:a.instanceOf(y).isRequired},statics:{parseURL:function(e,t){return v.match(e,["/servers/:server/?"],function(e){return{server:"new"===e.server?"new":v.parseId(e.server),edit:!!t.edit}})},getURL:function(e){var t,n="/servers/"+e.server+"/";return e.edit&&(t={edit:1}),{path:n,query:t}}},renderAsync:function(e){var t=this.props.route.parameters,n=this.props.database.use({schema:"global",by:this}),s={system:null,server:null,roles:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(i.createElement(N,s)),n.start().then(function(e){return f.findSystem(n).then(function(e){s.system=e||void 0})}).then(function(){if("new"!==t.server)return p.findServer(n,t.server).then(function(e){s.server=e})}).then(function(){return e.show(i.createElement(N,s)),u.findActiveRoles(n).then(function(e){s.roles=e})}).then(function(){return i.createElement(N,s)})}});var N=e.exports.Sync=i.createClass({displayName:"ServerSummaryPage.Sync",propTypes:{system:a.object,server:a.object,roles:a.arrayOf(a.object),database:a.instanceOf(g).isRequired,route:a.instanceOf(v).isRequired,locale:a.instanceOf(b).isRequired,theme:a.instanceOf(y).isRequired},getInitialState:function(){return this.components=d({confirmation:T}),{newServer:null,hasChanges:!1,saving:!1,adding:!1,credentialsChanged:!1,problems:{}}},getServer:function(e){return!this.isEditing()||e&&"current"!==e?this.props.server||L:this.state.newServer||this.props.server||L},getServerProperty:function(e,t){var n=this.getServer(t);return o.get(n,e)},setServerProperty:function(e,t){var n=this.getServer(),s=o.decoupleSet(n,e,t);if("type"===e){var r=this.props.locale.translate,i=this.props.locale.pick,a=r("server-type-"+n.type),l=r("server-type-"+s.type),c=i(n.details.title);if(!c||c===a){var d=this.props.locale.languageCode;s=o.decoupleSet(s,"details.title."+d,l)}}if("details.title"===e||"type"===e){var u=j.fromTitle(n.details.title),p=j.fromTitle(s.details.title);n.name&&n.name!==u||(s.name=p)}"settings.user.type"===e&&(t||(s=o.decoupleSet(s,"settings.user.role_ids",void 0))),o.size(s.name)>128&&(s.name=s.name.substr(0,128));var m=!0;o.isEqual(s,this.props.server)&&(s=null,m=!1),this.setState({newServer:s,hasChanges:m})},findProblems:function(){var e={},t=this.getServer();t.name||(e.name="validation-required"),t.type||(e.type="validation-required");var n=t.settings.oauth;return n&&(n.client_id&&!n.client_secret&&(e.client_secret="validation-required"),!n.client_id&&n.client_secret&&(e.client_id="validation-required"),!n.client_id&&!n.client_secret||n.base_url||"gitlab"===t.type&&(e.base_url="validation-required")),e},isCreating:function(e){return e=e||this.props,"new"===e.route.parameters.server},isEditing:function(e){return e=e||this.props,this.isCreating(e)||e.route.parameters.edit},setEditability:function(t,n){var s=this;if(!this.isCreating()||t||n){var r=this.props.route,i=o.clone(r.parameters);return i.edit=t,n&&(i.server=n.id),r.replace(e.exports,i).then(function(e){e&&s.setState({problems:{}})})}return this.returnToList()},returnToList:function(){return this.props.route.push(n("./pages/server-list-page.jsx"))},startNew:function(){var t=this.props.route,n=o.clone(t.parameters);return n.server="new",t.replace(e.exports,n)},getInputLanguages:function(){return o.get(this.props.system,"settings.input_languages",[])},componentWillReceiveProps:function(e){this.isEditing()!==this.isEditing(e)&&this.setState({newServer:null,hasChanges:!1})},render:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=this.getServer(),s=t(o.get(n,"details.title"));return!s&&n.type&&(s=e("server-type-"+n.type)),i.createElement("div",{className:"server-summary-page"},this.renderButtons(),i.createElement("h2",null,e("server-summary-member-$name",s)),this.renderForm(),this.renderInstructions(),this.renderTaskList(),i.createElement(T,{ref:this.components.setters.confirmation,locale:this.props.locale,theme:this.props.theme}),i.createElement(P,{changes:this.state.hasChanges,locale:this.props.locale,theme:this.props.theme,route:this.props.route}))},renderButtons:function(){var e=this.props.locale.translate;if(this.isEditing())return i.createElement("div",{key:"edit",className:"buttons"},i.createElement(x,{onClick:this.handleCancelClick},e("server-summary-cancel"))," ",i.createElement(x,{className:"emphasis",disabled:!this.state.hasChanges,onClick:this.handleSaveClick},e("server-summary-save")));var t,n,s=this.getServer(),r=!s.deleted&&!s.disabled,a=o.includes(m.integrated,s.type),l=!!o.get(s,"settings.api.access_token"),c=!(!o.get(s,"settings.oauth.client_id")||!o.get(s,"settings.oauth.client_secret")),d=this.state.credentialsChanged;return r?a&&!l?(t="acquire",n=!0):t=c&&d?"test":this.state.adding?"add":"return":t="reactivate",i.createElement("div",{key:"view",className:"buttons"},i.createElement(w,{preselected:t,alert:n},i.createElement("option",{name:"return",onClick:this.handleReturnClick},e("server-summary-return")),i.createElement("option",{name:"add",onClick:this.handleAddClick},e("server-summary-add")),i.createElement("option",{name:"acquire",disabled:!r||!a,separator:!0,onClick:this.handleAcquireClick},e("server-summary-acquire")),i.createElement("option",{name:"test",disabled:!r||!c,onClick:this.handleTestClick},e("server-summary-test-oauth")),i.createElement("option",{name:"disable",disabled:!r,separator:!0,onClick:this.handleDisableClick},e("server-summary-disable")),i.createElement("option",{name:"delete",disabled:!r,onClick:this.handleDeleteClick},e("server-summary-delete")),i.createElement("option",{name:"reactivate",hidden:r,onClick:this.handleReactivateClick},e("server-summary-reactivate")))," ",i.createElement(x,{className:"emphasis",onClick:this.handleEditClick},e("server-summary-edit")))},renderForm:function(){return i.createElement("div",{className:"form"},this.renderTypeSelector(),this.renderTitleInput(),this.renderNameInput(),this.renderUserOptions(),this.renderRoleSelector(),this.renderSiteURL(),this.renderOAuthCallbackURL(),this.renderPrivacyPolicyURL(),this.renderTermsAndConditionsURL(),this.renderGitlabURLInput(),this.renderOAuthClientIdInput(),this.renderOAuthClientSecretInput(),this.renderAPIStatus())},renderTypeSelector:function(){var e=this.props.locale.translate,t=this.getServerProperty("type","current"),n=this.getServerProperty("type","original"),a=o.map(m,function(r){var o=s(r);return{name:r,selected:t===r,previous:n===r,children:[i.createElement("i",{className:"fa fa-"+o+" fa-fw",key:0})," ",e("server-type-"+r)]}}),l={onOptionClick:this.handleTypeOptionClick,readOnly:!this.isEditing()},c=this.state.problems;return i.createElement(C,l,i.createElement("label",null,e("server-summary-type"),i.createElement(O,null,e(c.type))),o.map(a,function(e,t){return i.createElement("option",r({key:t},e))}))},renderTitleInput:function(){var e=this.props.locale.translate,t={id:"title",value:this.getServerProperty("details.title"),availableLanguageCodes:this.getInputLanguages(),locale:this.props.locale,onChange:this.handleTitleChange,readOnly:!this.isEditing()};return i.createElement(k,t,e("server-summary-title"))},renderNameInput:function(){var e=this.props.locale.translate,t={id:"name",value:this.getServerProperty("name"),locale:this.props.locale,onChange:this.handleNameChange,readOnly:!this.isEditing()},n=this.state.problems;return i.createElement(E,t,e("server-summary-name"),i.createElement(O,null,e(n.name)))},renderUserOptions:function(){switch(this.getServerProperty("type")){case"gitlab":return this.renderGitlabUserOptions();default:return this.renderOAuthUserOptions()}},renderGitlabUserOptions:function(){var e=this.props.locale.translate,t=this.getServerProperty("settings.user","current")||{},n=this.getServerProperty("settings.user","original")||{},s=!!this.getServerProperty("id"),a=[{name:"import-admin-disabled",selected:!o.get(t,"mapping.admin"),previous:s?!o.get(n,"mapping.admin"):void 0,children:e("server-summary-user-import-gitlab-admin-disabled")},{name:"import-admin-as-admin",selected:"admin"===o.get(t,"mapping.admin"),previous:"admin"===o.get(n,"mapping.admin"),children:i.createElement("span",null,e("server-summary-gitlab-admin")," ",i.createElement("i",{className:"fa fa-arrow-right"})," ",e("server-summary-user-type-admin"))},{name:"import-admin-as-moderator",selected:"moderator"===o.get(t,"mapping.admin"),previous:"moderator"===o.get(n,"mapping.admin"),children:i.createElement("span",null,e("server-summary-gitlab-admin")," ",i.createElement("i",{className:"fa fa-arrow-right"})," ",e("server-summary-user-type-moderator"))},{name:"import-admin-as-regular-user",selected:"regular"===o.get(t,"mapping.admin"),previous:"regular"===o.get(n,"mapping.admin"),children:i.createElement("span",null,e("server-summary-gitlab-admin")," ",i.createElement("i",{className:"fa fa-arrow-right"})," ",e("server-summary-user-type-regular"))},{name:"import-user-disabled",selected:!o.get(t,"mapping.user"),previous:s?!o.get(n,"mapping.user"):void 0,children:e("server-summary-user-import-gitlab-user-disabled")},{name:"import-user-as-moderator",selected:"moderator"===o.get(t,"mapping.user"),previous:"moderator"===o.get(n,"mapping.user"),children:i.createElement("span",null,e("server-summary-gitlab-regular-user")," ",i.createElement("i",{className:"fa fa-arrow-right"})," ",e("server-summary-user-type-moderator"))},{name:"import-user-as-regular-user",selected:"regular"===o.get(t,"mapping.user"),previous:"regular"===o.get(n,"mapping.user"),children:i.createElement("span",null,e("server-summary-gitlab-regular-user")," ",i.createElement("i",{className:"fa fa-arrow-right"})," ",e("server-summary-user-type-regular"))},{name:"import-user-as-guest",selected:"guest"===o.get(t,"mapping.user"),previous:"guest"===o.get(n,"mapping.user"),children:i.createElement("span",null,e("server-summary-gitlab-regular-user")," ",i.createElement("i",{className:"fa fa-arrow-right"})," ",e("server-summary-user-type-guest"))},{name:"import-external-user-disabled",selected:!o.get(t,"mapping.external_user"),previous:s?!o.get(n,"mapping.external_user"):void 0,children:e("server-summary-user-import-gitlab-external-user-disabled")},{name:"import-external-user-as-regular-user",selected:"regular"===o.get(t,"mapping.external_user"),previous:"regular"===o.get(n,"mapping.external_user"),children:i.createElement("span",null,e("server-summary-gitlab-external-user")," ",i.createElement("i",{className:"fa fa-arrow-right"})," ",e("server-summary-user-type-regular"))},{name:"import-external-user-as-guest",selected:"guest"===o.get(t,"mapping.external_user"),previous:"guest"===o.get(n,"mapping.external_user"),children:i.createElement("span",null,e("server-summary-gitlab-external-user")," ",i.createElement("i",{className:"fa fa-arrow-right"})," ",e("server-summary-user-type-guest"))}],l={onOptionClick:this.handleGitlabUserOptionClick,readOnly:!this.isEditing()};return i.createElement(C,l,i.createElement("label",null,e("server-summary-new-users")),o.map(a,function(e,t){return i.createElement("option",r({key:t},e))}))},renderOAuthUserOptions:function(){var e=this.props.locale.translate,t=this.getServerProperty("settings.user","current")||{},n=this.getServerProperty("settings.user","original")||{},s=!!this.getServerProperty("id"),a=[{name:"import-disabled",selected:!t.type,previous:s?!n.type:void 0,children:e("server-summary-user-import-disabled")},{name:"import-user-as-guest",selected:"guest"===t.type,previous:"guest"===n.type,children:i.createElement("span",null,e("server-summary-new-user")," ",i.createElement("i",{className:"fa fa-arrow-right"})," ",e("server-summary-user-type-guest"))},{name:"import-user-as-regular-user",selected:"regular"===t.type,previous:"regular"===n.type,children:i.createElement("span",null,e("server-summary-new-user")," ",i.createElement("i",{className:"fa fa-arrow-right"})," ",e("server-summary-user-type-regular"))}],l={onOptionClick:this.handleOAuthUserOptionClick,readOnly:!this.isEditing()};return i.createElement(C,l,i.createElement("label",null,e("server-summary-new-users")),o.map(a,function(e,t){return i.createElement("option",r({key:t},e))}))},renderRoleSelector:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=this.getServerProperty("settings.user.role_ids","current")||[],s=this.getServerProperty("settings.user.role_ids","original")||[],a=!!this.getServerProperty("id"),l=I(this.props.roles,this.props.locale),c=o.concat({name:"none",selected:o.isEmpty(n),previous:a?o.isEmpty(s):void 0,children:e("server-summary-role-none")},o.map(l,function(r){var a=t(r.details.title)||t.name;return{name:String(r.id),selected:o.includes(n,r.id),previous:o.includes(s,r.id),children:i.createElement("span",null,e("server-summary-new-user")," ",i.createElement("i",{className:"fa fa-arrow-right"})," ",a)}})),d={onOptionClick:this.handleRoleOptionClick,readOnly:!this.isEditing()};return i.createElement(C,d,i.createElement("label",null,e("server-summary-roles")),o.map(c,function(e,t){return i.createElement("option",r({key:t},e))}))},renderSiteURL:function(){var e,t=this.props.locale.translate,n=o.get(this.props.system,"settings.address");n||(void 0===this.props.system&&(e=t("server-summary-system-address-missing")),n=window.location.origin);var s={id:"oauth_callback",value:n,locale:this.props.locale,readOnly:!0};return i.createElement(E,s,t("server-summary-oauth-site-url"),i.createElement(O,{type:"warning"},e))},renderOAuthCallbackURL:function(){var e=this.props.locale.translate,t=this.getServerProperty("type"),n=o.get(this.props.system,"settings.address");n||(n=window.location.origin);var s=n+"/srv/session/"+(t||"...")+"/callback/",r={id:"oauth_callback",value:s,locale:this.props.locale,readOnly:!0},a=(this.state.problems,"server-summary-oauth-callback-url");switch(t){case"dropbox":case"facebook":a="server-summary-oauth-redirect-uri";break;case"github":case"gitlab":a="server-summary-oauth-callback-url";break;case"google":a="server-summary-oauth-redirect-uri";break;case"windows":a="server-summary-oauth-redirect-url"}return i.createElement(E,r,e(a))},renderPrivacyPolicyURL:function(){var e=this.props.locale.translate,t=this.getServerProperty("type"),n=["facebook","google","windows"];if(!o.includes(n,t))return null;var s,s,r=o.get(this.props.system,"settings.address");r||(s=e("server-summary-system-address-missing"),r=window.location.origin);var a=r+"/srv/session/privacy/",l={id:"oauth_privacy",value:a,locale:this.props.locale,readOnly:!0};return i.createElement(E,l,e("server-summary-privacy-policy-url"),i.createElement(O,{type:"warning"},s))},renderTermsAndConditionsURL:function(){var e=this.props.locale.translate,t=this.getServerProperty("type"),n=["facebook","google","windows"];if(!o.includes(n,t))return null;var s,s,r=o.get(this.props.system,"settings.address");r||(s=e("server-summary-system-address-missing"),r=window.location.origin);var a=r+"/srv/session/terms/",l={id:"oauth_terms",value:a,locale:this.props.locale,readOnly:!0};return i.createElement(E,l,e("server-summary-terms-and-conditions-url"),i.createElement(O,{type:"warning"},s))},renderGitlabURLInput:function(){var e=this.props.locale.translate,t=this.getServerProperty("type"),n={id:"oauth_token",value:this.getServerProperty("settings.oauth.base_url"),locale:this.props.locale,onChange:this.handleOAuthURLChange,readOnly:!this.isEditing()},s=this.state.problems;return i.createElement(S,{open:"gitlab"===t},i.createElement(E,n,e("server-summary-oauth-gitlab-url"),i.createElement(O,null,e(s.base_url))))},renderOAuthClientIdInput:function(){var e=this.props.locale.translate,t={id:"oauth_id",value:this.getServerProperty("settings.oauth.client_id"),locale:this.props.locale,onChange:this.handleOAuthIdChange,readOnly:!this.isEditing()},n=this.state.problems,s="server-summary-oauth-client-id";switch(this.getServerProperty("type")){case"dropbox":s="server-summary-oauth-app-key";break;case"facebook":s="server-summary-oauth-app-id";break;case"github":s="server-summary-oauth-client-id";break;case"gitlab":s="server-summary-oauth-application-id";break;case"google":s="server-summary-oauth-client-id";break;case"windows":s="server-summary-oauth-application-id"}return i.createElement(E,t,e(s),i.createElement(O,null,e(n.client_id)))},renderOAuthClientSecretInput:function(){var e=this.props.locale.translate,t={id:"oauth_secret",value:this.getServerProperty("settings.oauth.client_secret"),locale:this.props.locale,onChange:this.handleOAuthSecretChange,readOnly:!this.isEditing()},n=this.state.problems,s="server-summary-oauth-client-secret";switch(this.getServerProperty("type")){case"dropbox":case"facebook":s="server-summary-oauth-app-secret";break;case"github":s="server-summary-oauth-client-secret";break;case"gitlab":s="server-summary-oauth-application-secret";break;case"google":s="server-summary-oauth-client-secret";break;case"windows":s="server-summary-oauth-application-secret"}return i.createElement(E,t,e(s),i.createElement(O,null,e(n.client_secret)))},renderAPIStatus:function(){var e,t=this.props.locale.translate,n=this.getServerProperty("type");if(o.includes(m.integrated,n)){e=t(this.getServerProperty("settings.api.access_token")?"server-summary-api-access-acquired":"server-summary-api-access-pending")}else e=t("server-summary-api-access-not-applicable");var s={id:"access",value:e,locale:this.props.locale,readOnly:!0};return i.createElement(E,s,t("server-summary-api-access"))},renderInstructions:function(){var e={folder:"server",topic:"server-summary",hidden:!this.isEditing(),locale:this.props.locale},t=this.getServerProperty("type");return t&&(e.topic+="-"+t),i.createElement("div",{className:"instructions"},i.createElement(_,e))},renderTaskList:function(){if(!this.props.server)return null;var e=this.props.locale.translate,t=(this.props.route.parameters,{server:this.props.server,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelectionClear:this.handleTaskSelectionClear});return i.createElement("div",{className:"task-history"},i.createElement("h2",null,e("server-summary-activities")),i.createElement(R,t))},changeFlags:function(e){var t=this.props.database.use({schema:"global",by:this}),n=o.assign({},this.props.server,e);return t.saveOne({table:"server"},n)},handleDisableClick:function(e){var t=this,n=this.props.locale.translate,s=n("server-summary-confirm-disable");return this.components.confirmation.ask(s).then(function(e){if(e)return t.changeFlags({disabled:!0}).then(function(){return t.returnToList()})})},handleDeleteClick:function(e){var t=this,n=this.props.locale.translate,s=n("server-summary-confirm-delete");return this.components.confirmation.ask(s).then(function(e){if(e)return t.changeFlags({deleted:!0}).then(function(){return t.returnToList()})})},handleReactivateClick:function(e){var t=this,n=this.props.locale.translate,s=n("server-summary-confirm-reactivate");return this.components.confirmation.ask(s).then(function(e){if(e)return t.changeFlags({disabled:!1,deleted:!1})})},openOAuthPopup:function(e){var t=this.props.database.use({by:this}),n=this.getServer(),s=t.getOAuthURL(n,e),r={width:800,height:600,left:window.screenLeft+Math.round((window.outerWidth-800)/2),top:window.screenTop+Math.round((window.outerHeight-600)/2),toolbar:"no",menubar:"no",status:"no"},i=o.map(r,function(e,t){return t+"="+e});window.open(s,"api-access-oauth",i.join(","))},handleAcquireClick:function(e){this.openOAuthPopup("activation")},handleTestClick:function(e){this.openOAuthPopup("test")},handleReturnClick:function(e){return this.returnToList()},handleAddClick:function(e){return this.startNew()},handleEditClick:function(e){return this.setEditability(!0)},handleCancelClick:function(e){return this.setEditability(!1)},handleSaveClick:function(e){var t=this;if(!this.state.saving){var n=this.findProblems();if(o.some(n))return void this.setState({problems:n});var s=this.getServer(),r=this.getServerProperty("settings.oauth","original"),i=this.getServerProperty("settings.oauth","current"),a=!o.isEqual(r,i);this.setState({saving:!0,adding:!s.id,credentialsChanged:a,problems:{}},function(){var e=t.props.database.use({schema:"global",by:t});return e.start().then(function(n){return e.saveOne({table:"server"},s).then(function(e){return t.setState({hasChanges:!1,saving:!1},function(){return t.setEditability(!1,e)}),null})}).catch(function(e){var n={};409===e.statusCode?n.name="validation-duplicate-server-name":(n.general=e.message,console.error(e)),t.setState({problems:n,saving:!1})})})}},handleTitleChange:function(e){this.setServerProperty("details.title",e.target.value)},handleNameChange:function(e){var t=o.toLower(e.target.value).replace(/\W+/g,"");this.setServerProperty("name",t)},handleTypeOptionClick:function(e){this.setServerProperty("type",e.name)},handleApiTokenChange:function(e){this.setServerProperty("settings.api.token",e.target.value)},handleOAuthURLChange:function(e){var t=e.target.value;this.setServerProperty("settings.oauth.base_url",t);var n=o.clone(this.state);/https?:\/\/localhost\b/.test(t)?n.base_url="validation-localhost-is-wrong":delete n.base_url,this.setState({problems:n})},handleOAuthIdChange:function(e){this.setServerProperty("settings.oauth.client_id",e.target.value)},handleOAuthSecretChange:function(e){this.setServerProperty("settings.oauth.client_secret",e.target.value)},handleGitlabUserOptionClick:function(e){var t=this.getServerProperty("settings.user.mapping")||{};switch(e.name){case"import-admin-disabled":t.admin=void 0;break;case"import-admin-as-regular-user":t.admin="regular"!==t.admin?"regular":void 0;break;case"import-admin-as-moderator":t.admin="moderator"!==t.admin?"moderator":void 0;break;case"import-admin-as-admin":t.admin="admin"!==t.admin?"admin":void 0;break;case"import-user-disabled":t.user=void 0;break;case"import-user-as-guest":t.user="guest"!==t.user?"guest":void 0;break;case"import-user-as-regular-user":t.user="regular"!==t.user?"regular":void 0;break;case"import-user-as-moderator":t.user="moderator"!==t.user?"moderator":void 0;break;case"import-external-user-disabled":t.external_user=void 0;break;case"import-external-user-as-guest":t.external_user="guest"!==t.external_user?"guest":void 0;break;case"import-external-user-as-regular-user":t.external_user="regular"!==t.external_user?"regular":void 0}this.setServerProperty("settings.user.mapping",t)},handleOAuthUserOptionClick:function(e){var t=this.getServerProperty("settings.user.type");switch(e.name){case"import-disabled":t=void 0;break;case"import-user-as-guest":t="guest"!==t?"guest":void 0;break;case"import-user-as-regular-user":t="regular"!==t?"regular":void 0}this.setServerProperty("settings.user.type",t)},handleRoleOptionClick:function(e){var t=this.getServer(),n=o.slice(o.get(t,"settings.user.role_ids",[]));if("none"===e.name)n=[];else{var s=parseInt(e.name);o.includes(n,s)?o.pull(n,s):n.push(s)}this.setServerProperty("settings.user.role_ids",n)},handleTaskSelectionClear:function(){this.props.route.unanchor()}}),L={details:{},settings:h.default},I=c(function(e,t){var n=t.pick,s=function(e){return n(e.details.title)||e.name};return o.sortBy(e,s)})},"./pages/server-summary-page.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/server-summary-page.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./pages/settings-page.jsx":function(e,t,n){"use strict";var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/react/react.js"),i=o.PropTypes,a=n("../node_modules/relaks/index.js"),l=n("../../common/src/objects/finders/system-finder.js"),c=n("../../common/src/objects/settings/system-settings.js"),d=n("../../common/src/data/database.js"),u=n("../../common/src/routing/route.js"),p=n("../../common/src/locale/locale.js"),m=n("../../common/src/theme/theme.js"),h=n("../../common/src/transport/payloads.js"),f=n("./widgets/push-button.jsx"),g=n("./widgets/instruction-block.jsx"),v=n("./widgets/text-field.jsx"),b=n("./widgets/multilingual-text-field.jsx"),y=n("./widgets/option-list.jsx"),j=n("./widgets/image-selector.jsx"),x=n("./widgets/data-loss-warning.jsx");n("./pages/settings-page.scss"),e.exports=a.createClass({displayName:"SettingsPage",propTypes:{database:i.instanceOf(d).isRequired,route:i.instanceOf(u).isRequired,locale:i.instanceOf(p).isRequired,theme:i.instanceOf(m).isRequired,payloads:i.instanceOf(h).isRequired},statics:{parseURL:function(e,t){return u.match(e,["/settings/?"],function(e){return{edit:!!t.edit}})},getURL:function(e){var t;return e&&e.edit&&(t={edit:1}),{path:"/settings/",query:t}}},renderAsync:function(e){var t=(this.props.route.parameters,this.props.database.use({schema:"global",by:this})),n={system:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,payloads:this.props.payloads};return e.show(o.createElement(_,n)),t.start().then(function(e){return l.findSystem(t).then(function(e){n.system=r.isEmpty(e)?null:e})}).then(function(){return o.createElement(_,n)})}});var w,_=e.exports.Sync=o.createClass({displayName:"SettingsPage.Sync",propTypes:{system:i.object,database:i.instanceOf(d).isRequired,route:i.instanceOf(u).isRequired,locale:i.instanceOf(p).isRequired,theme:i.instanceOf(m).isRequired,payloads:i.instanceOf(h).isRequired},getInitialState:function(){return{newSystem:null,saving:!1}},getSystem:function(e){return!this.isEditing()||e&&"current"!==e?this.props.system||C:this.state.newSystem||this.props.system||k},getSystemProperty:function(e,t){var n=this.getSystem(t);return r.get(n,e)},setSystemProperty:function(e,t){var n=this.getSystem("current"),s=r.decoupleSet(n,e,t),o=!0;r.isEqual(s,this.props.system)&&(s=null,o=!1),this.setState({newSystem:s,hasChanges:o})},isEditing:function(e){return e=e||this.props,e.route.parameters.edit},setEditability:function(t){var n=this.props.route,s=r.clone(n.parameters);return s.edit=t,n.replace(e.exports,s)},getInputLanguages:function(){var e=this.getSystem();return r.get(e,"settings.input_languages",[])},componentWillReceiveProps:function(e){this.isEditing()!==this.isEditing(e)&&this.isEditing(e)&&this.setState({newSystem:null,hasChanges:!1})},render:function(){var e=this.props.locale.translate;return o.createElement("div",{className:"settings-page"},this.renderButtons(),o.createElement("h2",null,e("settings-title")),this.renderForm(),this.renderInstructions())},renderButtons:function(){var e=this.props.locale.translate;return this.isEditing()?o.createElement("div",{key:"edit",className:"buttons"},o.createElement(f,{onClick:this.handleCancelClick},e("settings-cancel"))," ",o.createElement(f,{className:"emphasis",disabled:!this.state.hasChanges,onClick:this.handleSaveClick},e("settings-save")),o.createElement(x,{changes:this.state.hasChanges,locale:this.props.locale,theme:this.props.theme,route:this.props.route})):o.createElement("div",{key:"view",className:"buttons"},o.createElement(f,{className:"emphasis",onClick:this.handleEditClick},e("settings-edit")))},renderForm:function(){return o.createElement("div",{className:"form"},this.renderTitleInput(),this.renderCompanyNameInput(),this.renderDescriptionInput(),this.renderSiteAddressInput(),this.renderPushRelayInput(),this.renderBackgroundSelector(),this.renderInputLanguageSelector())},renderTitleInput:function(){var e=this.props.locale.translate,t={id:"title",value:this.getSystemProperty("details.title"),availableLanguageCodes:this.getInputLanguages(),locale:this.props.locale,onChange:this.handleTitleChange,readOnly:!this.isEditing()};return o.createElement(b,t,e("settings-site-title"))},renderCompanyNameInput:function(){var e=this.props.locale.translate,t={id:"company_name",value:this.getSystemProperty("details.company_name"),locale:this.props.locale,onChange:this.handleCompanyNameChange,readOnly:!this.isEditing()};return o.createElement(v,t,e("settings-company-name"))},renderDescriptionInput:function(){var e=this.props.locale.translate,t={id:"description",value:this.getSystemProperty("details.description"),availableLanguageCodes:this.getInputLanguages(),type:"textarea",locale:this.props.locale,onChange:this.handleDescriptionChange,readOnly:!this.isEditing()};return o.createElement(b,t,e("settings-site-description"))},renderSiteAddressInput:function(){var e=this.props.locale.translate,t={id:"address",value:this.getSystemProperty("settings.address"),locale:this.props.locale,placeholder:"https://",onChange:this.handleAddressChange,readOnly:!this.isEditing()};return o.createElement(v,t,e("settings-site-address"))},renderPushRelayInput:function(){var e=this.props.locale.translate,t={id:"relay",value:this.getSystemProperty("settings.push_relay"),locale:this.props.locale,placeholder:"https://",onChange:this.handlePushRelayChange,readOnly:!this.isEditing()};return o.createElement(v,t,e("settings-push-relay"))},renderBackgroundSelector:function(){var e=this.props.locale.translate,t={purpose:"background",resources:this.getSystemProperty("details.resources"),database:this.props.database,locale:this.props.locale,theme:this.props.theme,payloads:this.props.payloads,onChange:this.handleBackgroundImageChange,readOnly:!this.isEditing()};return o.createElement(j,t,e("settings-background-image"))},renderInputLanguageSelector:function(){var e=this.props.locale.translate,t=this.props.locale.directory,n=this.getSystemProperty("settings.input_languages","current")||[],i=this.getSystemProperty("settings.input_languages","original")||[],a=r.map(t,function(e){var t,s=r.indexOf(n,e.code);return-1!==s&&(t=o.createElement("span",{className:"pos"},s+1)),{name:e.code,selected:r.includes(n,e.code),previous:r.includes(i,e.code),children:o.createElement("span",null,e.name," ",t)}}),l={onOptionClick:this.handleLanguageOptionClick,readOnly:!this.isEditing()};return o.createElement(y,l,o.createElement("label",null,e("settings-input-languages")),r.map(a,function(e,t){return o.createElement("option",s({key:t},e))}))},renderInstructions:function(){var e={folder:"settings",topic:"settings",hidden:!this.isEditing(),locale:this.props.locale};return o.createElement("div",{className:"instructions"},o.createElement(g,e))},handleEditClick:function(e){return this.setEditability(!0)},handleCancelClick:function(e){return this.setEditability(!1)},handleSaveClick:function(e){var t=this;this.state.saving||this.setState({saving:!0},function(){var e=t.props.database.use({schema:"global",by:t}),n=t.getSystem();return e.start().then(function(s){return e.saveOne({table:"system"},n).then(function(e){return t.props.payloads.dispatch(e),t.setState({hasChanges:!1,saving:!1},function(){t.setEditability(!1)}),null})}).catch(function(e){console.error(e),t.setState({saving:!1})})})},handleTitleChange:function(e){this.setSystemProperty("details.title",e.target.value)},handleCompanyNameChange:function(e){this.setSystemProperty("details.company_name",e.target.value)},handleAddressChange:function(e){this.setSystemProperty("settings.address",e.target.value)},handlePushRelayChange:function(e){this.setSystemProperty("settings.push_relay",e.target.value)},handleDescriptionChange:function(e){this.setSystemProperty("details.description",e.target.value)},handleBackgroundImageChange:function(e){this.setSystemProperty("details.resources",e.target.value)},handleLanguageOptionClick:function(e){var t=this.getSystem(),n=r.slice(t.settings.input_languages),s=e.name;r.includes(n,s)?r.pull(n,s):n.push(s),this.setSystemProperty("settings.input_languages",n)}}),E=(new Date).getTimezoneOffset()/60;w=-5<=E&&E<=0?"https://eu-west-1.push.trambar.io":"https://us-east-1.push.trambar.io";var k={details:{},settings:{address:window.location.protocol+"//"+window.location.host,push_relay:w}},C={details:{},settings:c.default}},"./pages/settings-page.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/settings-page.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./pages/sign-in-page.jsx":function(e,t,n){"use strict";function s(e){switch(e){case"facebook":return"facebook-official";default:return e}}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},o=n("../node_modules/lodash/lodash.js"),i=n("../node_modules/react/react.js"),a=i.PropTypes,l=n("../node_modules/relaks/index.js"),c=n("../node_modules/moment/moment.js"),d=(n("../../common/src/transport/http-request.js"),n("../../common/src/data/database.js")),u=n("../../common/src/routing/route.js"),p=n("../../common/src/locale/locale.js"),m=n("../../common/src/theme/theme.js"),h=n("./widgets/push-button.jsx"),f=n("./widgets/text-field.jsx");n("./pages/sign-in-page.scss"),e.exports=l.createClass({displayName:"SignInPage",propTypes:{database:a.instanceOf(d).isRequired,route:a.instanceOf(u).isRequired,locale:a.instanceOf(p).isRequired,theme:a.instanceOf(m).isRequired},renderAsync:function(e){var t=this.props.database.use({by:this}),n={system:null,servers:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(i.createElement(g,n)),t.beginSession("admin").then(function(e){return n.system=e.system,n.servers=e.servers,i.createElement(g,n)})}});var g=e.exports.Sync=i.createClass({displayName:"SignInPage.Sync",propTypes:{system:a.object,servers:a.arrayOf(a.object),database:a.instanceOf(d).isRequired,route:a.instanceOf(u).isRequired,locale:a.instanceOf(p).isRequired,theme:a.instanceOf(m).isRequired},getInitialState:function(){return{username:"",password:"",savedCredentials:!1,submitting:!1,problem:null,errors:{}}},canSubmitForm:function(){return!!o.trim(this.state.username)&&!!o.trim(this.state.password)},render:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=this.props.system,s=t(o.get(n,"details.title"));return i.createElement("div",{className:"sign-in-page"},i.createElement("h2",null,e("sign-in-$title",s)),i.createElement("section",null,this.renderForm()),i.createElement("h2",null,e("sign-in-oauth")),i.createElement("section",null,this.renderOAuthButtons()))},renderForm:function(){var e=this.props.locale.translate,t=this.canSubmitForm(),n={id:"username",type:"text",value:this.state.username,disabled:this.state.submitting,locale:this.props.locale,onChange:this.handleUsernameChange},s={id:"password",type:"password",value:this.state.password,disabled:this.state.submitting,locale:this.props.locale,onChange:this.handlePasswordChange},r=!t;return this.state.savedCredentials&&(r=!1),this.state.submitting&&(r=!0),i.createElement("form",{onSubmit:this.handleFormSubmit},this.renderProblem(),i.createElement(f,n,e("sign-in-username")),i.createElement(f,s,e("sign-in-password")),i.createElement("div",{className:"button-row"},i.createElement(h,{disabled:r},e("sign-in-submit"))))},renderProblem:function(){if(!this.state.problem)return null;var e=this.props.locale.translate;return i.createElement("div",{className:"error"},i.createElement("i",{className:"fa fa-exclamation-circle"})," ",e("sign-in-problem-"+this.state.problem))},renderOAuthButtons:function(){var e=(this.props.locale.translate,o.sortBy(this.props.servers,["type"]));return i.createElement("div",{className:"oauth-buttons"},o.map(e,this.renderOAuthButton))},renderOAuthButton:function(e,t){var n=this.props.locale.translate,o=this.props.locale.pick,a=o(e.details.title)||n("server-type-"+e.type),l=s(e.type),c=this.props.database.getOAuthURL(e),d={className:"oauth-button",href:c,onClick:this.handleOAuthButtonClick,"data-type":e.type},u=this.state.errors[e.type];if(u){var n=this.props.locale.translate,p=n("sign-in-error-"+u.reason);return d.className+=" error",i.createElement("a",r({key:t},d),i.createElement("span",{className:"icon"},i.createElement("i",{className:"fa fa-fw fa-"+l})),i.createElement("span",{className:"error"},p))}return i.createElement("a",r({key:t},d),i.createElement("span",{className:"icon"},i.createElement("i",{className:"fa fa-fw fa-"+l})),i.createElement("span",{className:"label"},a))},componentDidMount:function(){this.mountTime=c()},openPopUpWindow:function(e){return new Promise(function(t,n){var s={width:800,height:600,left:window.screenLeft+Math.round((window.outerWidth-800)/2),top:window.screenTop+Math.round((window.outerHeight-600)/2),toolbar:"no",menubar:"no",status:"no"},r=o.map(s,function(e,t){return t+"="+e}),i=window.open(e,"sign-in",r.join(","));if(i){i.location=e;var a=setInterval(function(){i.closed&&(clearInterval(a),t())},50)}else n(new Error("Unable to open popup"))})},handleOAuthButtonClick:function(e){var t=this,n=e.currentTarget.getAttribute("href"),s=e.currentTarget.getAttribute("data-type");return e.preventDefault(),this.openPopUpWindow(n).then(function(){return t.props.database.use({by:t}).checkSession().catch(function(e){var n=o.clone(t.state.errors);n[s]=e,console.log(e),t.setState({errors:n})})})},handleUsernameChange:function(e){var t=c(),n=e.target.value,s=!1;n.length>3&&t-this.mountTime<500&&(s=!0),this.setState({username:n,savedCredentials:s})},handlePasswordChange:function(e){var t=e.target.value;this.setState({password:t,savedCredentials:!1})},handleFormSubmit:function(e){var t=this;e.preventDefault(),this.canSubmitForm()&&this.setState({submitting:!0},function(){t.props.database.use({by:t}).submitPassword(t.state.username,t.state.password).catch(function(e){var n;switch(e.statusCode){case 401:n="incorrect-username-password";break;case 403:n="no-support-for-username-password";break;default:n="unexpected-error"}t.setState({problem:n,submitting:!1})})})}})},"./pages/sign-in-page.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/sign-in-page.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./pages/start-page.jsx":function(e,t,n){"use strict";var s=n("../node_modules/lodash/lodash.js"),r=(n("../node_modules/bluebird/js/browser/bluebird.js"),n("../node_modules/react/react.js")),o=r.PropTypes,i=n("../node_modules/relaks/index.js"),a=n("../../common/src/objects/finders/system-finder.js"),l=n("../../common/src/data/database.js"),c=n("../../common/src/routing/route.js"),d=n("../../common/src/locale/locale.js"),u=n("../../common/src/theme/theme.js");n("./pages/start-page.scss"),e.exports=i.createClass({displayName:"StartPage",propTypes:{database:o.instanceOf(l).isRequired,route:o.instanceOf(c).isRequired,locale:o.instanceOf(d).isRequired,theme:o.instanceOf(u).isRequired},statics:{parseURL:function(e,t){return c.match(e,["/:extra?"],function(e){return s.trimEnd(e.extra,"/")?null:e})},getURL:function(e){return{path:"/",query:void 0}}},renderAsync:function(e){var t=this,o=this.props.database.use({by:this}),i={locale:this.props.locale};return o.start().then(function(e){return a.findSystem(o).then(function(e){if(!s.isEmpty(e))return t.props.route.replace(n("./pages/project-list-page.jsx"));t.redirectTimeout||(t.redirectTimeout=setTimeout(function(){t.props.route.replace(n("./pages/settings-page.jsx"),{edit:!0})},2500))})}).then(function(e){return r.createElement(p,i)}).catch(function(e){return null})}});var p=e.exports.Sync=r.createClass({displayName:"StartPage.Sync",propType:{locale:o.instanceOf(d).isRequired},render:function(){var e=this.props.locale.translate;return r.createElement("div",{className:"start-page "+this.props.stage},r.createElement("h2",null,e("welcome")))}})},"./pages/start-page.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/start-page.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./pages/user-list-page.jsx":function(e,t,n){"use strict";var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},r=n("../node_modules/lodash/lodash.js"),o=(n("../node_modules/moment/moment.js"),n("../node_modules/react/react.js")),i=o.PropTypes,a=n("../node_modules/relaks/index.js"),l=n("../../common/src/utils/memoize.js"),c=n("../../common/src/utils/component-refs.js"),d=n("../../common/src/objects/finders/project-finder.js"),u=n("../../common/src/objects/finders/role-finder.js"),p=n("../../common/src/objects/finders/user-finder.js"),m=n("../../common/src/objects/types/user-types.js"),h=n("../../common/src/data/database.js"),f=n("../../common/src/routing/route.js"),g=n("../../common/src/locale/locale.js"),v=n("../../common/src/theme/theme.js"),b=n("./widgets/push-button.jsx"),y=n("./widgets/combo-button.jsx"),j=n("./widgets/sortable-table.jsx"),x=j.TH,w=n("./widgets/profile-image.jsx"),_=n("./tooltips/project-tooltip.jsx"),E=n("./tooltips/role-tooltip.jsx"),k=n("./tooltips/modified-time-tooltip.jsx"),C=n("./widgets/action-badge.jsx"),S=n("./widgets/action-confirmation.jsx"),R=n("./widgets/data-loss-warning.jsx");n("./pages/user-list-page.scss"),e.exports=a.createClass({displayName:"UserListPage",propTypes:{database:i.instanceOf(h).isRequired,route:i.instanceOf(f).isRequired,locale:i.instanceOf(g).isRequired,theme:i.instanceOf(v).isRequired},statics:{parseURL:function(e,t){return f.match(e,["/users/?"],function(e){return{edit:!!t.edit}})},getURL:function(e){var t;return e&&e.edit&&(t={edit:1}),{path:"/users/",query:t}}},renderAsync:function(e){var t=(this.props.route.parameters,this.props.database.use({schema:"global",by:this})),n={users:null,projects:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(o.createElement(O,n)),t.start().then(function(e){return p.findAllUsers(t).then(function(e){n.users=e})}).then(function(){return e.show(o.createElement(O,n)),d.findProjectsWithMembers(t,n.users).then(function(e){n.projects=e})}).then(function(){return e.show(o.createElement(O,n)),u.findRolesOfUsers(t,n.users).then(function(e){n.roles=e})}).then(function(e){return o.createElement(O,n)})}});var O=e.exports.Sync=o.createClass({displayName:"UserListPage.Sync",propTypes:{users:i.arrayOf(i.object),projects:i.arrayOf(i.object),roles:i.arrayOf(i.object),database:i.instanceOf(h).isRequired,route:i.instanceOf(f).isRequired,locale:i.instanceOf(g).isRequired,theme:i.instanceOf(v).isRequired},getInitialState:function(){return this.components=c({confirmation:S}),{sortColumns:["name"],sortDirections:["asc"],restoringUserIds:[],disablingUserIds:[],hasChanges:!1,renderingFullList:this.isEditing()}},setEditability:function(t){var n=this.props.route,s={edit:t};return n.replace(e.exports,s)},isEditing:function(e){return e=e||this.props,e.route.parameters.edit},componentWillReceiveProps:function(e){var t=this;this.isEditing()!==this.isEditing(e)&&(this.isEditing(e)?this.setState({renderingFullList:!0,restoringUserIds:[],disablingUserIds:[],hasChanges:!1}):setTimeout(function(){t.isEditing()||t.setState({renderingFullList:!1})},500))},render:function(){var e=this.props.locale.translate;return o.createElement("div",{className:"user-list-page"},this.renderButtons(),o.createElement("h2",null,e("user-list-title")),this.renderTable(),o.createElement(S,{ref:this.components.setters.confirmation,locale:this.props.locale,theme:this.props.theme}),o.createElement(R,{changes:this.state.hasChanges,locale:this.props.locale,theme:this.props.theme,route:this.props.route}))},renderButtons:function(){var e=this.props.locale.translate;if(this.isEditing())return o.createElement("div",{className:"buttons"},o.createElement(b,{onClick:this.handleCancelClick},e("user-list-cancel"))," ",o.createElement(b,{className:"emphasis",disabled:!this.state.hasChanges,onClick:this.handleSaveClick},e("user-list-save")));var t=r.isEmpty(this.props.users);return o.createElement("div",{className:"buttons"},o.createElement(y,null,o.createElement("option",{name:"add",separator:!0,onClick:this.handleAddClick},e("user-list-add")))," ",o.createElement(b,{className:"emphasis",disabled:t,onClick:this.handleEditClick},e("user-list-edit")))},renderTable:function(){var e={sortColumns:this.state.sortColumns,sortDirections:this.state.sortDirections,onSort:this.handleSort};return this.state.renderingFullList&&(e.expanded=this.isEditing(),e.expandable=!0,e.selectable=!0),o.createElement(j,e,o.createElement("thead",null,this.renderHeadings()),o.createElement("tbody",null,this.renderRows()))},renderHeadings:function(){return o.createElement("tr",null,this.renderNameColumn(),this.renderUsernameColumn(),this.renderTypeColumn(),this.renderRolesColumn(),this.renderProjectsColumn(),this.renderEmailColumn(),this.renderModifiedTimeColumn())},renderRows:function(){var e=this.props.users;return this.state.renderingFullList||(e=P(e)),e=T(e,this.props.roles,this.props.projects,this.props.locale,this.state.sortColumns,this.state.sortDirections),r.map(e,this.renderRow)},renderRow:function(e){var t,n,i=this.props.locale.translate,a=[];e.deleted?(a.push("deleted"),n=i("user-list-status-deleted")):e.disabled&&(a.push("disabled"),n=i("user-list-status-disabled")),this.state.renderingFullList&&(e.deleted||e.disabled?r.includes(this.state.restoringUserIds,e.id)&&a.push("selected"):(a.push("fixed"),r.includes(this.state.disablingUserIds,e.id)||a.push("selected")),t=this.handleRowClick);var l={className:a.join(" "),"data-user-id":e.id,title:n,onClick:t};return o.createElement("tr",s({key:e.id},l),this.renderNameColumn(e),this.renderUsernameColumn(e),this.renderTypeColumn(e),this.renderRolesColumn(e),this.renderProjectsColumn(e),this.renderEmailColumn(e),this.renderModifiedTimeColumn(e))},renderNameColumn:function(e){var t=this.props.locale.translate,s=this.props.locale.pick;if(e){var i,a,l=s(e.details.name);if(this.state.renderingFullList){var c,d;e.deleted||e.disabled?(c=!1,d=r.includes(this.state.restoringUserIds,e.id)):(c=!0,d=!r.includes(this.state.disablingUserIds,e.id)),c!==d&&(a=d?o.createElement(C,{type:"reactivate",locale:this.props.locale}):o.createElement(C,{type:"disable",locale:this.props.locale}))}else{var u=this.props.route,p={user:e.id};i=u.find(n("./pages/user-summary-page.jsx"),p)}var m=o.createElement(w,{user:e,theme:this.props.theme});return o.createElement("td",null,o.createElement("a",{href:i},m," ",l),a)}return o.createElement(x,{id:"name"},t("table-heading-name"))},renderUsernameColumn:function(e){if(this.props.theme.isBelowMode("narrow"))return null;var t=this.props.locale.translate;if(e){e.username;return o.createElement("td",null,e.username)}return o.createElement(x,{id:"username"},t("table-heading-username"))},renderTypeColumn:function(e){if(this.props.theme.isBelowMode("standard"))return null;var t=this.props.locale.translate;return e?o.createElement("td",null,t("user-list-type-"+e.type)):o.createElement(x,{id:"type"},t("table-heading-type"))},renderProjectsColumn:function(e){if(this.props.theme.isBelowMode("super-wide"))return null;var t=this.props.locale.translate;if(e){var n={projects:N(this.props.projects,e),omit:1,route:this.props.route,locale:this.props.locale,theme:this.props.theme,disabled:this.state.renderingFullList};return o.createElement("td",null,o.createElement(_,n))}return o.createElement(x,{id:"projects"},t("table-heading-projects"))},renderRolesColumn:function(e){if(this.props.theme.isBelowMode("wide"))return null;var t=this.props.locale.translate;if(e){var n={roles:L(this.props.roles,e),route:this.props.route,locale:this.props.locale,theme:this.props.theme,disabled:this.state.renderingFullList};return o.createElement("td",null,o.createElement(E,n))}return o.createElement(x,{id:"roles"},t("table-heading-roles"))},renderEmailColumn:function(e){if(this.props.theme.isBelowMode("wide"))return null;var t=this.props.locale.translate;if(e){var n="-",s=e.details.email;if(s){var r;this.state.renderingFullList||(r="mailto:"+s),n=o.createElement("a",{href:r},s)}return o.createElement("td",{className:"email"},n)}return o.createElement(x,{id:"email"},t("table-heading-email"))},renderModifiedTimeColumn:function(e){if(this.props.theme.isBelowMode("standard"))return null;var t=this.props.locale.translate;if(e){var n={time:e.mtime,disabled:this.state.renderingFullList,locale:this.props.locale};return o.createElement("td",null,o.createElement(k,n))}return o.createElement(x,{id:"mtime"},t("table-heading-last-modified"))},handleSort:function(e){console.log(e.columns),this.setState({sortColumns:e.columns,sortDirections:e.directions})},handleAddClick:function(e){var t=this.props.route,s={user:"new"};return t.push(n("./pages/user-summary-page.jsx"),s)},handleEditClick:function(e){this.setEditability(!0)},handleCancelClick:function(e){this.setEditability(!1)},handleSaveClick:function(e){var t=this,n=this.props.locale.translate,s=this.state.disablingUserIds,o=this.state.restoringUserIds,i=[n("user-list-confirm-disable-$count",s.length),n("user-list-confirm-reactivate-$count",o.length)],a=[r.isEmpty(s)||void 0,r.isEmpty(o)||void 0];return this.components.confirmation.askSeries(i,a).then(function(e){if(e){var n=t.props.database.use({schema:"global",by:t});return n.start().then(function(e){var i=[];return r.each(t.props.users,function(e){var t={};if(r.includes(s,e.id))t.disabled=!0;else{if(!r.includes(o,e.id))return;t.disabled=t.deleted=!1}var n=r.assign({},e,t);i.push(n)}),n.save({table:"user"},i).then(function(e){return t.setState({hasChanges:!1},function(){t.setEditability(!1)}),null})})}})},handleRowClick:function(e){var t=parseInt(e.currentTarget.getAttribute("data-user-id")),n=r.find(this.props.users,{id:t}),s=r.slice(this.state.restoringUserIds),o=r.slice(this.state.disablingUserIds);n.deleted||n.disabled?r.includes(s,n.id)?r.pull(s,n.id):s.push(n.id):r.includes(o,n.id)?r.pull(o,n.id):o.push(n.id);var i=!r.isEmpty(s)||!r.isEmpty(o);this.setState({restoringUserIds:s,disablingUserIds:o,hasChanges:i})}}),T=l(function(e,t,n,s,o,i){var a=s.pick;return o=r.map(o,function(e){switch(e){case"name":return function(e){return a(e.details.name)};case"username":return function(e){return r.toLower(e.username)};case"type":return function(e){return r.indexOf(m,e.type)};case"roles":return function(e){var n=r.first(L(t,e));return n?a(n.details.title)||n.name:""};case"projects":return function(e){var t=r.first(N(n,e));return t?a(t.details.title)||t.name:""};case"email":return"details.email";default:return e}}),r.orderBy(e,o,i)}),P=l(function(e){return r.filter(e,function(e){return!0!==e.disabled&&!0!==e.deleted})}),N=l(function(e,t){return r.filter(e,function(e){return r.includes(e.user_ids,t.id)})}),L=l(function(e,t){var n=r.keyBy(e,"id");return r.filter(r.map(t.role_ids,function(e){return n[e]}))})},"./pages/user-list-page.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/user-list-page.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./pages/user-summary-page.jsx":function(e,t,n){"use strict";function s(e,t){if(/https?:/.test(e)){e=o.trim(e.replace(/\?.*/,""));var n=o.filter(e.split("/"));return n[n.length-1]}return e}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},o=n("../node_modules/lodash/lodash.js"),i=n("../node_modules/react/react.js"),a=i.PropTypes,l=n("../node_modules/relaks/index.js"),c=n("../../common/src/utils/memoize.js"),d=n("../../common/src/utils/component-refs.js"),u=n("../../common/src/objects/finders/project-finder.js"),p=n("../../common/src/objects/finders/role-finder.js"),m=n("../../common/src/objects/finders/user-finder.js"),h=n("../../common/src/objects/types/user-types.js"),f=n("../../common/src/objects/settings/user-settings.js"),g=n("../../common/src/objects/finders/statistics-finder.js"),v=n("../../common/src/objects/finders/system-finder.js"),b=n("../../common/src/utils/slug-generator.js"),y=n("../../common/src/data/database.js"),j=n("../../common/src/routing/route.js"),x=n("../../common/src/locale/locale.js"),w=n("../../common/src/theme/theme.js"),_=n("../../common/src/transport/payloads.js"),E=n("./widgets/push-button.jsx"),k=n("./widgets/combo-button.jsx"),C=n("./widgets/instruction-block.jsx"),S=n("./widgets/text-field.jsx"),R=(n("./widgets/multilingual-text-field.jsx"),n("./widgets/option-list.jsx")),O=n("./widgets/image-selector.jsx"),T=n("../../common/src/widgets/collapsible-container.jsx"),P=n("./widgets/activity-chart.jsx"),N=n("./widgets/input-error.jsx"),L=n("./widgets/action-confirmation.jsx"),I=n("./widgets/data-loss-warning.jsx");n("./pages/user-summary-page.scss"),e.exports=l.createClass({displayName:"UserSummaryPage",propTypes:{database:a.instanceOf(y).isRequired,route:a.instanceOf(j).isRequired,locale:a.instanceOf(x).isRequired,theme:a.instanceOf(w).isRequired,payloads:a.instanceOf(_).isRequired},statics:{parseURL:function(e,t){return j.match(e,["/users/:user/","/projects/:project/members/:user/?"],function(e){return{user:"new"===e.user?"new":j.parseId(e.user),project:j.parseId(e.project),edit:!!t.edit}})},getURL:function(e){var t,n;return t=e.project?"/projects/"+e.project+"/members/"+e.user+"/":"/users/"+e.user+"/",e.edit&&(n={edit:1}),{path:t,query:n}}},renderAsync:function(e){var t=this.props.route.parameters,n=this.props.database.use({schema:"global",by:this}),s={system:null,user:null,roles:null,project:null,statistics:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,payloads:this.props.payloads};return e.show(i.createElement(M,s)),n.start().then(function(e){return v.findSystem(n).then(function(e){s.system=e})}).then(function(){if("new"!==t.user)return m.findUser(n,t.user).then(function(e){s.user=e})}).then(function(){return e.show(i.createElement(M,s)),p.findActiveRoles(n).then(function(e){s.roles=e})}).then(function(){if(t.project)return e.show(i.createElement(M,s)),u.findProject(n,t.project).then(function(e){s.project=e})}).then(function(){if(e.show(i.createElement(M,s)),s.project&&s.user)return g.findDailyActivitiesOfUser(n,s.project,s.user).then(function(e){s.statistics=e})}).then(function(){return i.createElement(M,s)})}});var M=e.exports.Sync=i.createClass({displayName:"UserSummaryPage.Sync",propTypes:{system:a.object,user:a.object,roles:a.arrayOf(a.object),project:a.object,statistics:a.object,database:a.instanceOf(y).isRequired,route:a.instanceOf(j).isRequired,locale:a.instanceOf(x).isRequired,theme:a.instanceOf(w).isRequired,payloads:a.instanceOf(_).isRequired},getInitialState:function(){return this.components=d({confirmation:L}),{newUser:null,hasChanges:!1,showingSocialLinks:!1,saving:!1,adding:!1,problems:{}}},getUser:function(e){return!this.isEditing()||e&&"current"!==e?this.props.user||A:this.state.newUser||this.props.user||A},getUserProperty:function(e,t){var n=this.getUser(t);return o.get(n,e)},setUserProperty:function(e,t){var n=this.getUser("current"),s=o.decoupleSet(n,e,t);if("details.name"===e){var r=b.fromPersonalName(n.details.name),i=b.fromPersonalName(s.details.name);n.username&&n.username!==r||(s.username=i)}o.size(s.username)>128&&(s.username=s.username.substr(0,128));var a=!0;o.isEqual(s,this.props.user)&&(s=null,a=!1),this.setState({newUser:s,hasChanges:a})},findProblems:function(){var e={},t=this.getUser();return t.username||(e.username="validation-required"),t.type||(e.type="validation-required"),e},isCreating:function(e){return e=e||this.props,"new"===e.route.parameters.user},isEditing:function(e){return e=e||this.props,this.isCreating(e)||e.route.parameters.edit},isProjectMember:function(e){return e=e||this.props,!!e.route.parameters.project},setEditability:function(t,n){var s=this,r=this.props.route;if(!this.isCreating()||t||n){var i=o.clone(r.parameters);return i.edit=t,n&&(i.user=n.id),r.replace(e.exports,i).then(function(e){e&&s.setState({problems:{}})})}return this.returnToList()},returnToList:function(){var e=this.props.route;if(e.parameters.project){var t={project:e.parameters.project};return e.push(n("./pages/member-list-page.jsx"),t)}return e.push(n("./pages/user-list-page.jsx"))},startNew:function(){var t=this.props.route,n=o.clone(t.parameters);return n.user="new",t.replace(e.exports,n)},getInputLanguages:function(){return o.get(this.props.system,"settings.input_languages",[])},componentWillReceiveProps:function(e){this.isEditing()!==this.isEditing(e)&&this.isEditing(e)&&this.setState({newUser:null,hasChanges:!1})},render:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=this.isProjectMember(),s=this.getUser(),r=t(s.details.name);return i.createElement("div",{className:"user-summary-page"},this.renderButtons(),i.createElement("h2",null,e(n?"user-summary-member-$name":"user-summary-$name",r)),this.renderForm(),this.renderSocialLinksToggle(),this.renderSocialLinksForm(),this.renderInstructions(),this.renderChart(),i.createElement(L,{ref:this.components.setters.confirmation,locale:this.props.locale,theme:this.props.theme}),i.createElement(I,{changes:this.state.hasChanges,locale:this.props.locale,theme:this.props.theme,route:this.props.route}))},renderButtons:function(){var e=this.props.locale.translate,t=this.isProjectMember();if(this.isEditing())return i.createElement("div",{className:"buttons"},i.createElement(E,{onClick:this.handleCancelClick},e("user-summary-cancel"))," ",i.createElement(E,{className:"emphasis",disabled:!this.state.hasChanges,onClick:this.handleSaveClick},e(t?"user-summary-member-save":"user-summary-save")));var n,s=this.props.user,r=!s||!s.deleted&&!s.disabled;return n=r?this.state.adding?"add":"return":"reactivate",i.createElement("div",{className:"buttons"},i.createElement(k,{preselected:n},i.createElement("option",{name:"return",onClick:this.handleReturnClick},e(t?"user-summary-member-return":"user-summary-return")),i.createElement("option",{name:"add",onClick:this.handleAddClick},e("user-summary-add")),i.createElement("option",{name:"disable",disabled:!r,separator:!0,onClick:this.handleDisableClick},e("user-summary-disable")),i.createElement("option",{name:"delete",disabled:!r,onClick:this.handleDeleteClick},e("user-summary-delete")),i.createElement("option",{name:"reactivate",hidden:r,onClick:this.handleReactivateClick},e("user-summary-reactivate")))," ",i.createElement(E,{className:"emphasis",onClick:this.handleEditClick},e(t?"user-summary-member-edit":"user-summary-edit")))},renderForm:function(){return i.createElement("div",{className:"form"},this.renderNameInput(),this.renderUsernameInput(),this.renderEmailInput(),this.renderPhoneInput(),this.renderProfileImageSelector(),this.renderTypeSelector(),this.renderRoleSelector())},renderNameInput:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=t(this.getUserProperty("details.name")),s={id:"name",value:n,locale:this.props.locale,onChange:this.handleNameChange,readOnly:!this.isEditing()};return i.createElement(S,s,e("user-summary-name"))},renderUsernameInput:function(){var e=this.props.locale.translate,t={id:"username",value:this.getUserProperty("username"),locale:this.props.locale,onChange:this.handleUsernameChange,readOnly:!this.isEditing()},n=this.state.problems;return i.createElement(S,t,e("user-summary-username"),i.createElement(N,null,e(n.username)))},renderEmailInput:function(){var e=this.props.locale.translate,t={id:"email",value:this.getUserProperty("details.email"),locale:this.props.locale,onChange:this.handleEmailChange,readOnly:!this.isEditing()},n=this.state.problems;return i.createElement(S,t,e("user-summary-email"),i.createElement(N,null,e(n.email)))},renderPhoneInput:function(){var e=this.props.locale.translate,t={id:"phone",value:this.getUserProperty("details.phone"),locale:this.props.locale,onChange:this.handlePhoneChange,readOnly:!this.isEditing()};return i.createElement(S,t,e("user-summary-phone"))},renderProfileImageSelector:function(){var e=this.props.locale.translate,t={purpose:"profile-image",desiredWidth:500,desiredHeight:500,resources:this.getUserProperty("details.resources"),database:this.props.database,locale:this.props.locale,theme:this.props.theme,payloads:this.props.payloads,onChange:this.handleProfileImageChange,readOnly:!this.isEditing()};return i.createElement(O,t,e("user-summary-profile-image"))},renderTypeSelector:function(){var e=this.props.locale.translate,t=this.getUserProperty("type","current"),n=this.getUserProperty("type","original"),s=o.map(h,function(s){return{name:s,selected:t===s,previous:n===s,children:e("user-summary-type-"+s)}}),a={onOptionClick:this.handleTypeOptionClick,readOnly:!this.isEditing()},l=this.state.problems;return i.createElement(R,a,i.createElement("label",null,e("user-summary-type"),i.createElement(N,null,e(l.type))),o.map(s,function(e,t){return i.createElement("option",r({key:t},e))}))},renderRoleSelector:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=this.getUserProperty("role_ids","current")||[],s=this.getUserProperty("role_ids","original")||[],a=!!this.getUserProperty("id"),l=z(this.props.roles,this.props.locale),c=o.concat({name:"none",selected:o.isEmpty(n),previous:a?o.isEmpty(s):void 0,children:e("user-summary-role-none")},o.map(l,function(e){return{name:String(e.id),selected:o.includes(n,e.id),previous:o.includes(s,e.id),children:t(e.details.title)||t.name}})),d={onOptionClick:this.handleRoleOptionClick,readOnly:!this.isEditing()};return i.createElement(R,d,i.createElement("label",null,e("user-summary-roles")),o.map(c,function(e,t){return i.createElement("option",r({key:t},e))}))},renderSocialLinksToggle:function(){var e=this.props.locale.translate,t=this.state.showingSocialLinks?"angle-double-up":"angle-double-down";return i.createElement("h2",{className:"social-toggle",onClick:this.handleSocialLinksToggleClick},e("user-summary-social-links")," ",i.createElement("i",{className:"fa fa-"+t}))},renderSocialLinksForm:function(){this.props.locale.translate,this.getUser(),this.isEditing();return i.createElement("div",{className:"form social"},i.createElement(T,{open:this.state.showingSocialLinks},this.renderSkypeNameInput(),this.renderIChatInput(),this.renderTwitterInput(),this.renderGithubURLInput(),this.renderGitlabURLInput(),this.renderLinkedInURLInput(),this.renderStackoverflowURLInput()))},renderSkypeNameInput:function(){var e=this.props.locale.translate,t={id:"skype",value:this.getUserProperty("details.skype_username"),locale:this.props.locale,onChange:this.handleSkypeUsernameChange,readOnly:!this.isEditing()};return i.createElement(S,t,e("user-summary-skype"))},renderIChatInput:function(){var e=this.props.locale.translate,t={id:"ichat",value:this.getUserProperty("details.ichat_username"),locale:this.props.locale,onChange:this.handleIchatUsernameChange,readOnly:!this.isEditing()};return i.createElement(S,t,e("user-summary-ichat"))},renderTwitterInput:function(){var e=this.props.locale.translate,t={id:"twitter",value:this.getUserProperty("details.twitter_username"),locale:this.props.locale,onChange:this.handleTwitterUsernameChange,readOnly:!this.isEditing()};return i.createElement(S,t,e("user-summary-twitter"))},renderGithubURLInput:function(){var e=this.props.locale.translate,t={id:"github",value:this.getUserProperty("details.github_url"),locale:this.props.locale,onChange:this.handleGitHubURLChange,readOnly:!this.isEditing()};return i.createElement(S,t,e("user-summary-github"))},renderGitlabURLInput:function(){var e=this.props.locale.translate,t={id:"github",value:this.getUserProperty("details.gitlab_url"),locale:this.props.locale,onChange:this.handleGitlabURLChange,readOnly:!this.isEditing()};return i.createElement(S,t,e("user-summary-gitlab"))},renderLinkedInURLInput:function(){var e=this.props.locale.translate,t={id:"linkedin",value:this.getUserProperty("details.linkedin_url"),locale:this.props.locale,onChange:this.handleLinkedinURLChange,readOnly:!this.isEditing()};return i.createElement(S,t,e("user-summary-linkedin"))},renderStackoverflowURLInput:function(){var e=this.props.locale.translate,t={id:"stackoverflow",value:this.getUserProperty("details.stackoverflow_url"),locale:this.props.locale,onChange:this.handleStackoverflowURLChange,readOnly:!this.isEditing()};return i.createElement(S,t,e("user-summary-stackoverflow"))},renderInstructions:function(){var e={folder:"user",topic:"user-summary",hidden:!this.isEditing(),locale:this.props.locale};return i.createElement("div",{className:"instructions"},i.createElement(C,e))},renderChart:function(){if(!this.isProjectMember())return null;if(this.isCreating())return null;var e=this.props.locale.translate,t={statistics:this.props.statistics,locale:this.props.locale,theme:this.props.theme};return i.createElement("div",{className:"statistics"},i.createElement(P,t,e("user-summary-statistics")))},changeFlags:function(e){var t=this.props.database.use({schema:"global",by:this}),n=o.assign({},this.props.user,e);return t.saveOne({table:"user"},n)},handleDisableClick:function(e){var t=this,n=this.props.locale.translate,s=n("user-summary-confirm-disable");return this.components.confirmation.ask(s).then(function(e){if(e)return t.changeFlags({disabled:!0}).then(function(){return t.returnToList()})})},handleDeleteClick:function(e){var t=this,n=this.props.locale.translate,s=n("user-summary-confirm-delete");return this.components.confirmation.ask(s).then(function(e){if(e)return t.changeFlags({deleted:!0}).then(function(){return t.returnToList()})})},handleReactivateClick:function(e){var t=this,n=this.props.locale.translate,s=n("user-summary-confirm-reactivate");return this.components.confirmation.ask(s).then(function(e){if(e)return t.changeFlags({disabled:!1,deleted:!1})})},handleReturnClick:function(e){return this.returnToList()},handleAddClick:function(e){return this.startNew()},handleEditClick:function(e){return this.setEditability(!0)},handleCancelClick:function(e){return this.setEditability(!1)},handleSaveClick:function(e){var t=this;if(!this.state.saving){var n=this.findProblems();if(o.some(n))return void this.setState({problems:n});var s=this.getUser();this.setState({saving:!0,adding:!s.id,problems:{}},function(){var e=t.props.database.use({schema:"global",by:t});return e.start().then(function(n){return e.saveOne({table:"user"},s).then(function(n){if(t.props.payloads.dispatch(n),t.setState({hasChanges:!1,saving:!1},function(){return t.setEditability(!1,n)}),t.props.project){var s=t.props.project.user_ids;if(!o.includes(s,n.id)){var r=o.union(s,[n.id]),i={id:t.props.project.id,user_ids:r};return e.saveOne({table:"project"},i)}}return null})}).catch(function(e){var n={};409===e.statusCode?n.username="validation-duplicate-user-name":(n.general=e.message,console.error(e)),t.setState({problems:n,saving:!1})})})}},handleNameChange:function(e){this.setUserProperty("details.name",e.target.value)},handleUsernameChange:function(e){var t=o.toLower(e.target.value).replace(/\W+/g,"");this.setUserProperty("username",t)},handleEmailChange:function(e){this.setUserProperty("details.email",e.target.value)},handlePhoneChange:function(e){this.setUserProperty("details.phone",e.target.value)},handleProfileImageChange:function(e){this.setUserProperty("details.resources",e.target.value)},handleTypeOptionClick:function(e){this.setUserProperty("type",e.name)},handleRoleOptionClick:function(e){var t=this.getUser(),n=o.slice(t.role_ids);if("none"===e.name)n=[];else{var s=parseInt(e.name);o.includes(n,s)?o.pull(n,s):n.push(s)}this.setUserProperty("role_ids",n)},handleSocialLinksToggleClick:function(e){this.setState({showingSocialLinks:!this.state.showingSocialLinks})},handleSkypeUsernameChange:function(e){var t=o.trim(e.target.value);this.setUserProperty("details.skype_username",t)},handleIchatUsernameChange:function(e){var t=o.trim(e.target.value);this.setUserProperty("details.ichat_username",t)},handleTwitterUsernameChange:function(e){var t=s(e.target.value);this.setUserProperty("details.twitter_username",t)},handleLinkedinURLChange:function(e){var t=o.trim(e.target.value);this.setUserProperty("details.linkedin_url",t)},handleGitHubURLChange:function(e){var t=o.trim(e.target.value);this.setUserProperty("details.github_url",t)},handleGitlabURLChange:function(e){var t=o.trim(e.target.value);this.setUserProperty("details.gitlab_url",t)},handleStackoverflowURLChange:function(e){var t=o.trim(e.target.value);this.setUserProperty("details.stackoverflow_url",t)}}),A={details:{},settings:f.default},z=c(function(e,t){var n=t.pick,s=function(e){return n(e.details.title)||e.name};return o.sortBy(e,s)});c(function(e,t){if(t.role_ids){var n=o.keyBy(e,"id");return o.filter(o.map(t.role_ids,function(e){return n[e]}))}})},"./pages/user-summary-page.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./pages/user-summary-page.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./tooltips/activity-tooltip.jsx":function(e,t,n){"use strict";var s=n("../node_modules/lodash/lodash.js"),r=n("../node_modules/react/react.js"),o=r.PropTypes,i=n("../../common/src/locale/locale.js"),a=n("../../common/src/theme/theme.js"),l=n("../../common/src/objects/types/story-types.js"),c=n("../../common/src/mixins/update-check.js"),d=n("./widgets/tooltip.jsx");n("./tooltips/activity-tooltip.scss"),e.exports=r.createClass({displayName:"ActivityTooltip",mixins:[c],propTypes:{statistics:o.object,locale:o.instanceOf(i),theme:o.instanceOf(a)},render:function(){var e=this;if(null==this.props.statistics)return null;var t=this.props.locale.translate,n=t("activity-tooltip-$count",this.props.statistics.total);void 0===this.props.statistics.total&&(n="-");var o=[];return s.each(l,function(n,s){var i=e.props.statistics[n];if(i){var a=l.icons[n];o.push(r.createElement("div",{className:"item",key:s},r.createElement(a,{className:"icon"})," ",t("activity-tooltip-$count-"+n,i)))}}),r.createElement(d,{className:"activity",disabled:this.props.disabled},r.createElement("inline",null,n),r.createElement("window",null,o))}})},"./tooltips/activity-tooltip.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./tooltips/activity-tooltip.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./tooltips/modified-time-tooltip.jsx":function(e,t,n){"use strict";var s=n("../node_modules/lodash/lodash.js"),r=n("../node_modules/react/react.js"),o=r.PropTypes,i=n("../node_modules/moment/moment.js"),a=n("../../common/src/locale/locale.js"),l=(n("../../common/src/mixins/update-check.js"),n("./widgets/tooltip.jsx"));e.exports=r.createClass({displayName:"ModifiedTimeTooltip",propTypes:{time:o.string,disabled:o.bool,locale:o.instanceOf(a).isRequired},componentWillMount:function(){this.updateLabels()},componentWillReceiveProps:function(e){this.updateLabels(e)},updateLabels:function(e){e=e||this.props;var t;e.time&&(t=i(e.time),t.locale(e.locale.localeCode));var n={relativeTime:t?t.fromNow():null,absoluteTime:t?t.format("lll"):null};s.isEqual(n,this.state)||this.setState(n)},render:function(){return r.createElement(l,{disabled:this.props.disabled},r.createElement("inline",null,this.state.relativeTime),r.createElement("window",null,this.state.absoluteTime))},componentDidMount:function(){c.push(this)},componentWillUnmount:function(){s.pull(c,this)}});var c=[];setInterval(function(){s.each(c,function(e){e.updateLabels()})},3e4)},"./tooltips/project-tooltip.jsx":function(e,t,n){"use strict";var s=n("../node_modules/lodash/lodash.js"),r=n("../node_modules/react/react.js"),o=r.PropTypes,i=n("../../common/src/routing/route.js"),a=n("../../common/src/locale/locale.js"),l=n("../../common/src/theme/theme.js"),c=n("../../common/src/mixins/update-check.js"),d=n("./widgets/tooltip.jsx");n("./tooltips/project-tooltip.scss"),e.exports=r.createClass({displayName:"ProjectTooltip",mixins:[c],propTypes:{projects:o.arrayOf(o.object),route:o.instanceOf(i).isRequired,locale:o.instanceOf(a).isRequired,theme:o.instanceOf(l).isRequired},render:function(){if(null==this.props.projects)return null;var e=this.props.locale.translate,t=this.props.locale.pick,o=this.props.route,i=this.props.projects,a="-";if(i.length>0){var l,c=i[0];this.props.disabled||(l=o.find(n("./pages/project-summary-page.jsx"),{project:c.id}));var u=t(c.details.title)||c.name,a=r.createElement("a",{href:l,key:0},u);i=s.slice(i,1)}var p;if(i.length>0){var m,h=e("project-tooltip-$count-others",i.length);i.length>10&&(i=s.slice(i,0,10),m=r.createElement("div",{className:"ellipsis"},r.createElement("i",{className:"fa fa-ellipsis-v"})));var f=s.map(i,function(e,s){var i=o.find(n("./pages/project-summary-page.jsx"),{project:e.id}),a=t(e.details.title)||e.name;return r.createElement("div",{className:"item",key:s},r.createElement("a",{href:i},a))}),g=o.find(n("./pages/project-list-page.jsx"),{});p=e("tooltip-$first-and-$tooltip",a,r.createElement(d,{className:"project",disabled:this.props.disabled||0===f.length,key:1},r.createElement("inline",null,h),r.createElement("window",null,f,m,r.createElement("div",{className:"bottom"},r.createElement("a",{href:g},e("tooltip-more"))))))}else p=a;return r.createElement("span",null,p)}})},"./tooltips/project-tooltip.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./tooltips/project-tooltip.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./tooltips/repository-tooltip.jsx":function(e,t,n){"use strict";var s=n("../node_modules/lodash/lodash.js"),r=n("../node_modules/react/react.js"),o=r.PropTypes,i=(n("../../common/src/routing/route.js"),n("../../common/src/locale/locale.js")),a=n("../../common/src/theme/theme.js"),l=n("../../common/src/mixins/update-check.js"),c=n("./widgets/tooltip.jsx");n("./tooltips/repository-tooltip.scss"),e.exports=r.createClass({displayName:"RepositoryTooltip",mixins:[l],propTypes:{repos:o.arrayOf(o.object),project:o.object.isRequired,route:o.object.isRequired,locale:o.instanceOf(i).isRequired,theme:o.instanceOf(a).isRequired,disabled:o.bool},render:function(){var e=this;if(null==this.props.repos)return null;var t=this.props.locale.translate,o=this.props.locale.pick,i=this.props.route,a=t("repository-tooltip-$count",this.props.repos.length),l=s.map(this.props.repos,function(s,a){var l=i.find(n("./pages/repo-summary-page.jsx"),{project:e.props.project.id,repo:s.id}),c=s.type,d=o(s.details.title)||t("server-type-"+s.type);return r.createElement("div",{className:"item",key:a},r.createElement("a",{href:l},r.createElement("i",{className:"fa fa-"+c})," ",d))}),d=i.find(n("./pages/repo-list-page.jsx"),{project:this.props.project.id});return r.createElement(c,{className:"repository",disabled:this.props.disabled||0===l.length},r.createElement("inline",null,a),r.createElement("window",null,l,r.createElement("div",{className:"bottom"},r.createElement("a",{href:d},t("tooltip-more")))))}})},"./tooltips/repository-tooltip.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./tooltips/repository-tooltip.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./tooltips/role-tooltip.jsx":function(e,t,n){"use strict";var s=n("../node_modules/lodash/lodash.js"),r=n("../node_modules/react/react.js"),o=r.PropTypes,i=(n("../../common/src/routing/route.js"),n("../../common/src/locale/locale.js")),a=n("../../common/src/theme/theme.js"),l=n("../../common/src/mixins/update-check.js"),c=n("./widgets/tooltip.jsx");n("./tooltips/role-tooltip.scss"),e.exports=r.createClass({displayName:"RoleTooltip",mixins:[l],propTypes:{roles:o.arrayOf(o.object),disabled:o.bool,route:o.object.isRequired,locale:o.instanceOf(i).isRequired,theme:o.instanceOf(a).isRequired},render:function(){if(null==this.props.roles)return null;var e=this.props.locale.translate,t=this.props.locale.pick,o=this.props.route,i=this.props.roles,a="-";if(i.length>0){var l,d=i[0];this.props.disabled||(l=o.find(n("./pages/role-summary-page.jsx"),{role:d.id}));var u=t(d.details.title)||d.name,a=r.createElement("a",{href:l,key:0},u);i=s.slice(i,1)}var p;if(i.length>0){var m,h=e("role-tooltip-$count-others",i.length);i.length>10&&(i=s.slice(i,0,10),m=r.createElement("div",{className:"ellipsis"},r.createElement("i",{className:"fa fa-ellipsis-v"})));var f=s.map(i,function(e,s){var i=o.find(n("./pages/role-summary-page.jsx"),{role:e.id}),a=t(e.details.title)||e.name;return r.createElement("div",{className:"item",key:s},r.createElement("a",{href:i},a))}),g=o.find(n("./pages/role-list-page.jsx"));p=e("tooltip-$first-and-$tooltip",a,r.createElement(c,{className:"role",disabled:this.props.disabled||0===f.length,key:1},r.createElement("inline",null,h),r.createElement("window",null,f,m,r.createElement("div",{className:"bottom"},r.createElement("a",{href:g},e("tooltip-more"))))))}else p=a;return r.createElement("span",null,p)}})},"./tooltips/role-tooltip.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./tooltips/role-tooltip.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./tooltips/user-tooltip.jsx":function(e,t,n){"use strict";var s=n("../node_modules/lodash/lodash.js"),r=n("../node_modules/react/react.js"),o=r.PropTypes,i=n("../../common/src/routing/route.js"),a=n("../../common/src/locale/locale.js"),l=n("../../common/src/theme/theme.js"),c=n("../../common/src/mixins/update-check.js"),d=n("./widgets/tooltip.jsx"),u=n("./widgets/profile-image.jsx");n("./tooltips/user-tooltip.scss"),e.exports=r.createClass({displayName:"UserTooltip",mixins:[c],propTypes:{users:o.arrayOf(o.object),project:o.object,route:o.instanceOf(i).isRequired,locale:o.instanceOf(a).isRequired,theme:o.instanceOf(l).isRequired,disabled:o.bool},render:function(){var e=this;if(null==this.props.users)return null;var t,o=this.props.locale.translate,i=this.props.route,a=o("user-tooltip-$count",this.props.users.length),l=this.props.users;l.length>10&&(l=s.slice(l,0,10),t=r.createElement("div",{className:"ellipsis"},r.createElement("i",{className:"fa fa-ellipsis-v"})));var c,p=s.map(l,function(t,s){var o;return o=e.props.project?i.find(n("./pages/user-summary-page.jsx"),{project:e.props.project.id,user:t.id}):i.find(n("./pages/user-summary-page.jsx"),{user:t.id}),r.createElement("div",{className:"item",key:s},r.createElement("a",{href:o},r.createElement(u,{user:t,theme:e.props.theme})," ",t.details.name))});return c=this.props.project?i.find(n("./pages/member-list-page.jsx"),{project:this.props.project.id}):i.find(n("./pages/user-list-page.jsx")),r.createElement(d,{className:"user",disabled:0===p.length},r.createElement("inline",null,a),r.createElement("window",null,p,t,r.createElement("div",{className:"bottom"},r.createElement("a",{href:c},o("tooltip-more")))))}})},"./tooltips/user-tooltip.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./tooltips/user-tooltip.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/action-badge.jsx":function(e,t,n){"use strict";function s(e){var t,n=e.locale.translate,s="action-badge";switch(e.type){case"add":case"approve":case"restore":case"reactivate":s+=" add",t="plus";break;case"remove":case"archive":case"disable":s+=" remove",t="times"}var o=n("action-badge-"+e.type);return r.createElement("div",{className:s},r.createElement("i",{className:"fa fa-"+t})," ",o)}var r=n("../node_modules/react/react.js"),o=r.PropTypes,i=n("../../common/src/locale/locale.js");e.exports=s,n("./widgets/action-badge.scss"),s.propTypes={type:o.string.isRequired,locale:o.instanceOf(i).isRequired}},"./widgets/action-badge.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/action-badge.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/action-confirmation.jsx":function(e,t,n){"use strict";var s=(n("../node_modules/lodash/lodash.js"),n("../node_modules/bluebird/js/browser/bluebird.js")),r=n("../node_modules/react/react.js"),o=r.PropTypes,i=n("../../common/src/locale/locale.js"),a=n("../../common/src/theme/theme.js"),l=n("../../common/src/mixins/update-check.js"),c=n("./dialogs/confirmation-dialog-box.jsx");e.exports=r.createClass({displayName:"ActionConfirmation",mixins:[l],propTypes:{locale:o.instanceOf(i).isRequired,theme:o.instanceOf(a).isRequired},getInitialState:function(){return{showing:!1,rendering:!1,message:null,resolve:null,promise:null}},render:function(){if(!this.state.rendering)return null;var e=(this.props.locale.translate,{show:this.state.showing,dangerous:!0,locale:this.props.locale,theme:this.props.theme,onConfirm:this.handleConfirm,onCancel:this.handleCancel});return r.createElement(c,e,this.state.message)},ask:function(e,t){if("boolean"==typeof t){if(this.state.promise){var n=this.state.promise;return t?this.handleConfirm():this.handleCancel(),n}return s.resolve(t)}if(!this.state.promise){var r,n=new s(function(e){r=e});return this.setState({showing:!0,rendering:!0,message:e,resolve:r,promise:n}),n}this.setState({message:e})},askSeries:function(e,t){var n=this;return s.reduce(e,function(e,s,r){return!!e&&n.ask(s,t?t[r]:void 0)},!0)},handleConfirm:function(e){var t=this.state.resolve;this.setState({showing:!1,rendering:!1,resolve:null,promise:null},function(){t&&t(!0)})},handleCancel:function(e){var t=this,n=this.state.resolve;this.setState({showing:!1,resolve:null,promise:null},function(){n&&n(!1),setTimeout(function(){t.state.showing||t.setState({rendering:!1})})})}})},"./widgets/activity-chart.jsx":function(e,t,n){"use strict";function s(e){return parseInt(e.substr(8))}function r(e){return a.createElement("div",{className:"item"},a.createElement("svg",{className:"ct-chart-bar",viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg"},a.createElement("g",{className:"ct-series ct-series-"+e.series},a.createElement("line",{className:"ct-bar",x1:0,y1:5,x2:10,y2:5}))),a.createElement("span",{className:"label"},e.label))}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},i=n("../node_modules/lodash/lodash.js"),a=(n("../node_modules/promise/index.js"),n("../node_modules/react/react.js")),l=a.PropTypes,c=n("../../common/src/widgets/chartist.jsx"),d=n("../node_modules/moment/moment.js"),u=n("../../common/src/utils/date-tracker.js"),p=n("../../common/src/utils/memoize.js"),m=n("../../common/src/locale/locale.js"),h=n("../../common/src/theme/theme.js"),f=n("../../common/src/objects/types/story-types.js");n("./widgets/activity-chart.scss"),e.exports=a.createClass({displayName:"ActivityChart",propTypes:{statistics:l.object,locale:l.instanceOf(m),theme:l.instanceOf(h)},render:function(){return a.createElement("div",{className:"activity-chart"},a.createElement("h2",null,this.props.children),this.renderLegend(),this.renderChart())},renderChart:function(){if(!this.props.statistics)return a.createElement("div",{className:"scroll-container"},a.createElement("div",{className:"contents no-data"}));var e=d(u.today),t=d(this.props.statistics.range.start),n=d(this.props.statistics.range.end),r=e.clone().endOf("month"),o=t.clone().startOf("month"),i=n.clone().endOf("month");r.diff(i,"month")<=1?i=r:i.add(1,"month");var l=g(o,i),p=v(this.props.statistics.daily,l),m=b(p,!0),h=g(o,i),f={type:"bar",data:{labels:h,series:p},options:{fullWidth:!0,height:200,chartPadding:{left:-25,right:30},stackBars:!0,high:m,low:0,axisX:{labelInterpolationFnc:function(e){var t=s(e);return 1===t?e:t>10&&e==u.today?"Today":""}}},onDraw:this.handleDraw},y=Math.round(.75*h.length)+"em";return a.createElement("div",{className:"scroll-container"},a.createElement("div",{className:"contents",style:{width:y}},a.createElement(c,f)))},renderLegend:function(){if(!this.props.statistics)return null;var e=this.props.locale.translate,t=this.props.statistics.to_date,n={};i.each(f,function(e,s){t[e]>0&&(n[e]=s)});var s=i.map(n,function(t,n){var s={series:String.fromCharCode("a".charCodeAt(0)+t),label:e("activity-chart-legend-"+n)};return a.createElement(r,o({key:t},s))});return i.isEmpty(s)&&(s=""),a.createElement("div",{className:"legend"},s)},handleDraw:function(e){if("label"===e.type&&"y"===e.axis.units.pos&&e.element.attr({x:e.axis.chartRect.width()+20}),"grid"===e.type&&"x"===e.axis.units.pos){var t=e.axis.ticks[e.index];1===s(t)?e.element.addClass("month-start"):t===u.today&&e.element.addClass("today")}}});var g=p(function(e,t){for(var n=[],s=e.clone();s<=t;s.add(1,"day"))n.push(s.format("YYYY-MM-DD"));return n}),v=(p(function(e,t){for(var n=[],s=e.clone();s<=t;s.add(1,"month")){n.push(s.format("ll"));for(var r=s.daysInMonth(),o=1;o<r;o++)n.push(null)}return n}),p(function(e,t){return i.map(f,function(n){var s=!0,r=i.map(t,function(t){var r=i.get(e,[t,n],0);return r&&(s=!1),r});return s?[]:r})})),b=p(function(e,t){var n=0;if(t){var s=[];i.each(e,function(e){i.each(e,function(e,t){s[t]=s[t]?s[t]+e:e})}),i.isEmpty(s)||(n=i.max(s))}else i.each(e,function(e){var t=i.max(e);t>n&&(n=t)});return n<=20?20:n<=50?50:100*Math.ceil(n/100)})},"./widgets/activity-chart.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/activity-chart.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/chartist.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/chartist.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/combo-button.jsx":function(e,t,n){"use strict";function s(e,t){for(var n=e;n!==document.body.parentNode;n=n.parentNode)if(n===t)return!0;return!1}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},o=n("../node_modules/lodash/lodash.js"),i=n("../node_modules/react/react.js"),a=i.PropTypes,l=n("../node_modules/react-dom/index.js");n("./widgets/combo-button.scss"),e.exports=i.createClass({displayName:"ComboButton",propType:{preselected:a.string,alert:a.bool},getDefaultProps:function(){return{preselected:void 0,alert:!1}},getInitialState:function(){return{open:!1,selected:this.props.preselected}},componentWillReceiveProps:function(e){this.props.preselected!==e.preselected&&this.setState({selected:e.preselected})},render:function(){return i.createElement("div",{className:"combo-button"},this.renderMainButton(),this.renderSideButton(),this.renderMenu())},renderMainButton:function(){var e=this,t=i.Children.toArray(this.props.children),n=o.find(t,function(t){return t.props.name===e.state.selected});n||(n=o.first(t));var s=o.omit(n.props,"separator");return s.className=s.className?"main "+s.className:"main",this.props.alert&&(s.className+=" alert"),s.onClick||(s.onClick=this.handleSideButtonClick),i.createElement("button",s,n.props.children)},renderSideButton:function(){return i.createElement("button",{className:"side",onClick:this.handleSideButtonClick},i.createElement("i",{className:"fa fa-angle-down"}))},renderMenu:function(){if(!this.state.open)return null;var e=i.Children.toArray(this.props.children);return i.createElement("div",{className:"container"},i.createElement("div",{className:"menu"},o.map(e,this.renderOption)))},renderOption:function(e,t){if(!e.props.name||e.props.hidden)return null;var n={"data-name":e.props.name,className:"option",onClick:this.handleItemClick},s=o.omit(e.props,"name","separator","disabled");return e.props.disabled&&(n.className+=" disabled",n.onClick=null,s.onClick=null),e.props.separator&&(n.className+=" separator"),i.createElement("div",r({key:t},n),i.createElement("div",s,e.props.children))},componentDidUpdate:function(e,t){var n=document.getElementById("app-container");!t.open&&this.state.open?n.addEventListener("mousedown",this.handleBodyMouseDown):t.open&&!this.state.open&&n.removeEventListener("mousedown",this.handleBodyMouseDown)},handleSideButtonClick:function(e){this.setState({open:!this.state.open})},handleItemClick:function(e){var t=e.currentTarget.getAttribute("data-name");this.setState({selected:t,open:!1})},handleBodyMouseDown:function(e){var t=l.findDOMNode(this);s(e.target,t)||this.setState({open:!1})}})},"./widgets/combo-button.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/combo-button.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/data-loss-warning.jsx":function(e,t,n){"use strict";var s=(n("../node_modules/lodash/lodash.js"),n("../node_modules/react/react.js")),r=s.PropTypes,o=n("../../common/src/utils/component-refs.js"),i=n("../../common/src/routing/route.js"),a=n("../../common/src/locale/locale.js"),l=n("../../common/src/theme/theme.js"),c=n("../../common/src/mixins/update-check.js"),d=n("./widgets/action-confirmation.jsx");e.exports=s.createClass({displayName:"DataLossWarning",mixins:[c],propTypes:{route:r.instanceOf(i).isRequired,locale:r.instanceOf(a).isRequired,theme:r.instanceOf(l).isRequired,changes:r.bool},getInitialState:function(){return this.components=o({confirmation:d}),{}},componentWillReceiveProps:function(e){this.props.changes!==e.changes&&(e.changes?e.route.keep(this.confirmRouteChange):e.route.free(this.confirmRouteChange))},render:function(){var e=this.components.setters,t={ref:e.confirmation,locale:this.props.locale,theme:this.props.theme};return s.createElement(d,t)},confirmRouteChange:function(){var e=this.props.locale.translate,t=e("confirmation-data-loss");return this.components.confirmation.ask(t)}})},"./widgets/image-selector.jsx":function(e,t,n){"use strict";var s=n("../node_modules/lodash/lodash.js"),r=n("../node_modules/react/react.js"),o=r.PropTypes,i=n("../../common/src/media/media-loader.js"),a=n("../../common/src/data/database.js"),l=n("../../common/src/locale/locale.js"),c=n("../../common/src/theme/theme.js"),d=n("../../common/src/transport/payloads.js"),u=n("./dialogs/image-cropping-dialog-box.jsx"),p=n("./dialogs/image-album-dialog-box.jsx"),m=n("../../common/src/widgets/resource-view.jsx");n("./widgets/image-selector.scss"),e.exports=r.createClass({displayName:"ImageSelector",propTypes:{purpose:o.string,desiredWidth:o.number,desiredHeight:o.number,resources:o.arrayOf(o.object),readOnly:o.bool,database:o.instanceOf(a).isRequired,locale:o.instanceOf(l).isRequired,theme:o.instanceOf(c).isRequired,payloads:o.instanceOf(d).isRequired,onChange:o.func},getDefaultProps:function(){return{resources:[],readOnly:!1}},getInitialState:function(){return{showingCroppingDialogBox:!1,renderingCroppingDialogBox:!1,showingAlbumDialogBox:!1,renderingAlbumDialogBox:!1}},getImage:function(){return s.find(this.props.resources,{type:"image"})},setImage:function(e){if(this.props.desiredWidth&&this.props.desiredHeight&&!e.clip){var t=this.props.desiredWidth/this.props.desiredHeight,n=e.width,r=Math.round(n/t),o=0,i=Math.round((e.height-r)/2);i<0&&(r=e.height,n=Math.round(r*t),o=Math.round((e.width-n)/2),i=0),e=s.clone(e),e.clip={left:o,top:i,width:n,height:r}}var a=s.slice(this.props.resources),l=s.findIndex(a,{type:"image"});-1!==l?e?a[l]=e:a.splice(l,1):a.push(e),this.props.onChange&&(this.value=a,this.props.onChange({type:"change",target:this}))},render:function(){var e=["image-selector"];return this.props.readOnly&&e.push("readonly"),r.createElement("div",{className:e.join(" ")},r.createElement("label",null,this.props.children),r.createElement("div",{className:"contents"},this.renderImage(),this.renderOptions()),this.renderDialogBox())},renderImage:function(){var e,t=this.getImage();if(t){var n=this.props.theme.getImageURL(t,{clip:null,remote:!0}),s={href:n,target:"_blank","data-width":t.width,"data-height":t.height,onClick:this.handleImageClick},o={resource:t,clip:!(!this.props.desiredWidth||!this.props.desiredHeight),height:120,theme:this.props.theme};return r.createElement("div",{className:"image"},r.createElement("a",s,r.createElement(m,o)))}return e=this.props.desiredWidth&&this.props.desiredHeight?Math.round(120*this.props.desiredWidth/this.props.desiredHeight):160,r.createElement("div",{className:"image"},r.createElement("div",{className:"placeholder",style:{width:e,height:120}},r.createElement("i",{className:"fa fa-photo"})))},renderOptions:function(){return r.createElement("div",{className:"options"},this.renderChooseOption(),this.renderUploadOption(),this.renderResizeOption())},renderResizeOption:function(){if(!this.props.desiredWidth||!this.props.desiredHeight)return null;var e=this.props.locale.translate,t={className:"option"};return this.props.readOnly||(t.onClick=this.handleCropClick),this.getImage()||(t.className+=" disabled"),r.createElement("div",t,r.createElement("i",{className:"fa fa-crop"})," ",e("image-selector-crop-image"))},renderChooseOption:function(){if(!this.props.purpose)return null;var e=this.props.locale.translate,t={className:"option"};return this.props.readOnly||(t.onClick=this.handleChooseClick),r.createElement("div",t,r.createElement("i",{className:"fa fa-th"})," ",e("image-selector-choose-from-album"))},renderUploadOption:function(){var e={type:"file",value:"",accept:"image/*",disabled:this.props.readOnly,onChange:this.handleUploadChange},t=this.props.locale.translate;return r.createElement("label",{className:"option"},r.createElement("i",{className:"fa fa-upload"})," ",t("image-selector-upload-file"),r.createElement("input",e))},renderDialogBox:function(){var e=this.getImage();if(this.state.renderingAlbumDialogBox){var t={show:this.state.showingAlbumDialogBox,purpose:this.props.purpose,image:e,database:this.props.database,locale:this.props.locale,theme:this.props.theme,payloads:this.props.payloads,onSelect:this.handleImageSelect,onCancel:this.handleDialogCancel};return r.createElement(p,t)}if(this.state.renderingCroppingDialogBox){var t={show:this.state.showingCroppingDialogBox,image:e,desiredWidth:this.props.desiredWidth,desiredHeight:this.props.desiredHeight,locale:this.props.locale,theme:this.props.theme,onSelect:this.handleImageSectionSelect,onCancel:this.handleDialogCancel};return r.createElement(u,t)}return null},handleChooseClick:function(e){this.setState({showingAlbumDialogBox:!0,renderingAlbumDialogBox:!0})},handleCropClick:function(e){this.setState({showingCroppingDialogBox:!0,renderingCroppingDialogBox:!0})},handleImageSelect:function(e){var t=s.clone(e.image);t.type="image",this.setImage(t),this.handleDialogCancel()},handleImageSectionSelect:function(e){var t=s.clone(this.getImage());t.clip=e.clippingRect,this.setImage(t),this.handleDialogCancel()},handleUploadChange:function(e){var t=this,n=e.target.files[0];if(n){var s=this.props.payloads.add("image").attachFile(n);return i.getImageMetadata(n).then(function(e){var n={payload_token:s.token,width:e.width,height:e.height,format:e.format,type:"image"};return t.setImage(n)})}},handleDialogCancel:function(e){var t=this;this.state.showingAlbumDialogBox&&(this.setState({showingAlbumDialogBox:!1}),setTimeout(function(){t.state.showingAlbumDialogBox||t.setState({renderingAlbumDialogBox:!1})},500)),this.state.showingCroppingDialogBox&&(this.setState({showingCroppingDialogBox:!1}),setTimeout(function(){t.state.showingCroppingDialogBox||t.setState({renderingCroppingDialogBox:!1})},500))},handleImageClick:function(e){var t=e.currentTarget.href;if(t){var n=parseInt(e.currentTarget.getAttribute("data-width")),s=parseInt(e.currentTarget.getAttribute("data-height")),r=n,o=s,i=screen.width-100,a=screen.height-100;r>i&&(r=i,o=Math.round(r*s/n)),o>a&&(o=a,r=Math.round(o*n/s));var l=Math.round((screen.width-o)/3),c=Math.round((screen.height-o)/3),d=["left="+l,"top="+c,"width="+r,"height="+o];window.open(t,"_blank",d.join(",")),e.preventDefault()}}})},"./widgets/image-selector.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/image-selector.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/input-error.jsx":function(e,t,n){"use strict";function s(e){if(!e.children)return null;var t="input-error",n="exclamation-circle";return"warning"===e.type&&(t+=" warning",n="exclamation-triangle"),r.createElement("div",{className:t},r.createElement("i",{className:"fa fa-"+n})," ",e.children)}var r=n("../node_modules/react/react.js");r.PropTypes,n("../../common/src/locale/locale.js");e.exports=s,n("./widgets/input-error.scss")},"./widgets/input-error.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/input-error.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/instruction-block.jsx":function(e,t,n){"use strict";function s(e,t,n){return r(e,t,n).then(function(t){return o(d.parse(t),e)})}function r(e,t,s){return n("./instructions lazy recursive ^\\.\\/.*\\.md$")("./"+e+"/"+t+"."+s+".md").catch(function(){return n("./instructions lazy recursive ^\\.\\/.*\\.en\\.md$")("./"+e+"/"+t+".en.md")})}function o(e,t){if("string"==typeof e)return e;if(e instanceof Array)return a.map(e,function(e){return o(e,t)});if("img"===e.type){var s=e.props.src;return s&&!/^\w+:/.test(s)?n("./instructions lazy recursive ^\\.\\/.*$")("./"+t+"/"+s).then(function(t){return l.cloneElement(e,{src:t})}).catch(function(t){return e}):e}if("a"===e.type){var s=e.props.href;return s&&!/^\w+:/.test(s)?n("./instructions lazy recursive ^\\.\\/.*$")("./"+t+"/"+s).then(function(t){var n={href:t};return/\.html$/.test(t)?n.target="_blank":n.download=t,l.cloneElement(e,n)}).catch(function(t){return e}):l.cloneElement(e,{target:"_blank"})}return e.props&&!i.isEmpty(e.props.children)?a.map(e.props.children,function(e){return o(e,t)}).then(function(t){return l.cloneElement(e,{},t)}):e}var i=n("../node_modules/lodash/lodash.js"),a=n("../node_modules/bluebird/js/browser/bluebird.js"),l=n("../node_modules/react/react.js"),c=l.PropTypes,d=n("../node_modules/mark-gor/react.js"),u=n("../../common/src/locale/locale.js"),p=n("../../common/src/mixins/update-check.js"),m=n("../../common/src/widgets/collapsible-container.jsx");n("./widgets/instruction-block.scss"),e.exports=l.createClass({displayName:"InstructionBlock",mixins:[p],propTypes:{folder:c.string.isRequired,topic:c.string.isRequired,hidden:c.bool,locale:c.instanceOf(u).isRequired},getDefaultProps:function(){return{hidden:!1}},getInitialState:function(){return{contents:null}},componentWillMount:function(){var e=this;if(this.props.topic){s(this.props.folder,this.props.topic,this.props.locale.languageCode).then(function(t){e.setState({contents:t})})}},componentWillReceiveProps:function(e){var t=this;if(this.props.topic!==e.topic||this.props.locale!==e.locale){s(e.folder,e.topic,e.locale.languageCode).then(function(e){t.setState({contents:e})})}},render:function(){if(!this.state.contents)return null;var e=["instruction-block"];return this.props.hidden&&e.push("hidden"),l.createElement("div",{className:e.join(" ")},l.createElement(m,{open:!this.props.hidden},l.createElement("div",{className:"contents"},this.state.contents)))}})},"./widgets/instruction-block.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/instruction-block.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/multilingual-text-field.jsx":function(e,t,n){"use strict";var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/react/react.js"),i=o.PropTypes,a=n("../../common/src/locale/locale.js"),l=n("../../common/src/widgets/autosize-text-area.jsx");n("./widgets/multilingual-text-field.scss"),e.exports=o.createClass({displayName:"MultilingualTextField",propTypes:{type:i.string,value:i.oneOfType([i.object,i.string]),availableLanguageCodes:i.arrayOf(i.string),locale:i.instanceOf(a).isRequired,onChange:i.func},getDefaultProps:function(){return{type:"text",value:{},availableLanguageCodes:[]}},getInitialState:function(){var e,t=r.keys(this.props.value),n=this.props.availableLanguageCodes,s=this.props.locale.languageCode;return e=r.includes(t,s)?s:r.isEmpty(t)?r.includes(n,s)?s:r.isEmpty(n)?s:n[0]:t[0],{selectedLanguageCode:e,hoverLanguageCode:null,expandedByMouseOver:!1,expandedByTouch:!1,arrowPosition:0}},getLanguages:function(){var e=r.keys(this.props.value),t=this.props.availableLanguageCodes,n=r.union(t,e);0===n.length&&n.push(this.props.locale.languageCode);var s=r.keyBy(this.props.locale.directory,"code");return r.filter(r.map(n,function(e){return s[e]}))},componentWillReceiveProps:function(e){if(this.props.locale!==e.locale){var t=e.locale.languageCode,n=this.props.availableLanguageCodes;r.includes(n,t)&&this.setState({selectedLanguageCode:t})}},render:function(){var e=["multilingual-text-field"],t="input",n=r.omit(this.props,"children","availableLanguageCodes","locale");if("textarea"===this.props.type&&(t=l,n=r.omit(n,"type")),this.props.readOnly){e.push("readonly"),this.state.expandedByMouseOver||this.state.expandedByTouch||e.push("collapsed");var s=this.props.locale.translate;n.placeholder=s("text-field-placeholder-none"),n.spellCheck=!1}return this.getLanguages().length>1&&e.push("multiple-languages"),this.props.value instanceof Object?n.value=this.props.value[this.state.selectedLanguageCode]||"":"string"==typeof this.props.value?n.value=this.props.value:n.value="",n.value&&!1===n.spellCheck&&(n.value+="\ufeff"),n.lang=this.state.selectedLangaugeCode,n.onChange=this.handleTextChange,o.createElement("div",{className:e.join(" ")},o.createElement("label",{htmlFor:this.props.id},this.props.children),o.createElement(t,n),this.renderTabs())},renderTabs:function(){var e=this.getLanguages();return e.length<=1?null:o.createElement("div",{className:"tabs"},r.map(e,this.renderTab),this.renderPopup())},renderTab:function(e,t){var n={className:"tab",lang:e.code,onClick:this.handleLanguageClick,onMouseOver:this.handleLanguageMouseOver,onMouseOut:this.handleLanguageMouseOut};return e.code===this.state.selectedLanguageCode&&(n.className+=" selected",n.onClick=n.onMouseOver=n.onMouseOut=null),o.createElement("div",s({key:t},n),e.name)},renderPopup:function(){if(!this.state.hoverLanguageCode||this.props.readOnly)return null;var e=this.props.value[this.state.hoverLanguageCode];return r.trim(e)?o.createElement("div",{className:"bubble"},o.createElement("div",{className:"arrow",style:{left:this.state.arrowPosition}}),o.createElement("div",{className:"box"},e)):null},handleTextChange:function(e){var t=this,n=e.target.value,s=this.state.selectedLanguageCode;if(n)this.props.value instanceof Object?this.value=r.clone(this.props.value):"string"==typeof this.props.value?this.value=r.transform(this.props.availableLanguageCodes,function(e,n){e[n]=t.props.value},{}):this.value={},this.value[s]=n;else if(this.value=r.omit(this.props.value,s),!r.includes(this.props.availableLanguageCodes,s)){var o=r.first(this.getLanguages());o&&this.setState({selectedLanguageCode:o.code})}this.props.onChange&&this.props.onChange({type:"change",target:this})},handleLanguageClick:function(e){var t=e.currentTarget.lang;this.setState({selectedLanguageCode:t,hoverLanguageCode:null})},handleLanguageMouseOver:function(e){var t=e.currentTarget,n=t.parentNode,s=n.getBoundingClientRect(),r=t.getBoundingClientRect(),o=r.left+r.width/2-s.left,i=t.lang;this.setState({hoverLanguageCode:i,arrowPosition:o})},handleLanguageMouseOut:function(e){e.currentTarget.lang===this.state.hoverLanguageCode&&this.setState({hoverLanguageCode:null})}})},"./widgets/multilingual-text-field.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/multilingual-text-field.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/navigation-tree.jsx":function(e,t,n){"use strict";var s=n("../node_modules/lodash/lodash.js"),r=n("../node_modules/bluebird/js/browser/bluebird.js"),o=n("../node_modules/react/react.js"),i=o.PropTypes,a=n("../node_modules/relaks/index.js"),l=n("../../common/src/objects/finders/project-finder.js"),c=n("../../common/src/objects/finders/repo-finder.js"),d=n("../../common/src/objects/finders/role-finder.js"),u=n("../../common/src/objects/finders/server-finder.js"),p=n("../../common/src/objects/finders/user-finder.js"),m=n("../../common/src/utils/component-refs.js"),h=n("../../common/src/data/database.js"),f=n("../../common/src/routing/route.js"),g=n("../../common/src/locale/locale.js"),v=n("../../common/src/theme/theme.js"),b=n("../../common/src/widgets/collapsible-container.jsx");n("./widgets/navigation-tree.scss"),e.exports=a.createClass({displayName:"NavigationTree",propTypes:{disabled:i.bool,database:i.instanceOf(h).isRequired,route:i.instanceOf(f).isRequired,locale:i.instanceOf(g).isRequired,theme:i.instanceOf(v).isRequired},renderAsync:function(e){var t=this.props.route.parameters,n=this.props.database.use({schema:"global",by:this}),i={project:null,user:null,role:null,repo:null,server:null,disabled:this.props.disabled,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(o.createElement(y,i)),n.start().then(function(e){var o={};return"number"==typeof t.project&&(o.project=l.findProject(n,t.project)),"number"==typeof t.user&&(o.user=p.findUser(n,t.user)),"number"==typeof t.role&&(o.role=d.findRole(n,t.role)),"number"==typeof t.repo&&(o.repo=c.findRepo(n,t.repo)),"number"==typeof t.server&&(o.server=u.findServer(n,t.server)),r.props(o).then(function(e){s.assign(i,e)}).catch(function(e){})}).then(function(){return o.createElement(y,i)}).catch(function(e){if(401===e.statusCode)return o.createElement(y,i);throw e})}});var y=e.exports.Sync=o.createClass({displayName:"NavigationTree.Sync",propTypes:{disabled:i.bool,project:i.object,user:i.object,role:i.object,repo:i.object,server:i.object,route:i.instanceOf(f).isRequired,locale:i.instanceOf(g).isRequired,theme:i.instanceOf(v).isRequired},getInitialState:function(){return this.components=m({activeLink:HTMLAnchorElement,container:HTMLElement,arrow:HTMLElement}),{arrowPosition:0,arrowCount:0,arrowAction:"",project:this.props.project||j,user:this.props.user||j,role:this.props.role||j,repo:this.props.repo||j,server:this.props.server||j}},componentWillReceiveProps:function(e){var t=s.keys(this.state),n=s.pickBy(s.pick(e,t),Boolean);s.isEmpty(n)||this.setState(n)},render:function(){var e=this.components.setters,t=["navigation-tree"];this.props.disabled&&t.push("disabled");var n=this.getRootNodes();return o.createElement("div",{ref:e.container,className:t.join(" ")},s.map(n,this.renderRootNode),this.renderArrow())},renderRootNode:function(e,t){return this.renderNode(e,1,t)},renderNode:function(e,t,n){if(e){var s;this.isActive(e)&&(s=this.components.setters.activeLink);var r;this.props.disabled||(r=e.url);return o.createElement("div",{key:n,className:"level"+t},o.createElement("a",{ref:s,href:r},e.label),this.renderChildNodes(e,t+1))}},renderChildNodes:function(e,t){var n=this;if(s.isEmpty(e.children))return null;var r={open:e.showChildren||this.hasActiveChild(e),children:s.map(e.children,function(e,s){return n.renderNode(e,t,s)})};return o.createElement(b,r)},renderArrow:function(){var e=["zero","one","two","three","four"],t={ref:this.components.setters.arrow,className:"arrow "+e[this.state.arrowCount]+" "+this.state.arrowAction,style:{top:this.state.arrowPosition}};return o.createElement("div",t,o.createElement("i",{className:"fa fa-play first"}),o.createElement("i",{className:"fa fa-play second"}),o.createElement("i",{className:"fa fa-play third"}),o.createElement("i",{className:"fa fa-play fourth"}))},componentDidMount:function(){var e=this;setTimeout(function(){e.repositionArrow()},100)},componentDidUpdate:function(e,t){e.route!==this.props.route&&this.repositionArrow()},isActive:function(e){return e.url===this.props.route.path},hasActiveChild:function(e){var t=this;return s.some(e.children,function(e){return t.isActive(e)||t.hasActiveChild(e)})},getRootNodes:function(){return[this.getProjectListNode(),this.getUserListNode(),this.getRoleListNode(),this.getServerListNode(),this.getSettingsNode()]},getProjectListNode:function(){var e=this.props.locale.translate,t=this.props.route;return{label:e("nav-projects"),url:t.find(n("./pages/project-list-page.jsx")),children:[this.getProjectNode()]}},getProjectNode:function(){var e,t=this.props.locale.translate,s=this.props.locale.pick,r=this.props.route,i=r.parameters,a=this.state.project;e="new"===i.project?o.createElement("i",null,t("nav-project-new")):s(a.details.title)||a.name||"-";var l=r.find(n("./pages/project-summary-page.jsx"),{project:i.project}),c="number"==typeof i.project;return{label:e,url:l,children:[this.getMemberListNode(),this.getRepoListNode()],showChildren:c}},getMemberListNode:function(){var e,t=this.props.locale.translate,s=this.props.route,r=s.parameters,o=t("nav-members");return"number"==typeof r.project&&(e=s.find(n("./pages/member-list-page.jsx"),{project:r.project})),{label:o,url:e,children:[this.getMemberNode()]}},getMemberNode:function(){var e,t,s=this.props.locale.translate,r=this.props.locale.pick,i=this.props.route,a=i.parameters,l=this.state.user;return e="new"===a.user?o.createElement("i",null,s("nav-member-new")):r(l.details.name)||l.username||"-","number"==typeof a.project&&(t=i.find(n("./pages/user-summary-page.jsx"),{project:a.project,user:a.user})),{label:e,url:t}},getRepoListNode:function(){var e,t=this.props.locale.translate,s=this.props.route,r=s.parameters,o=t("nav-repositories");return"number"==typeof r.project&&(e=s.find(n("./pages/repo-list-page.jsx"),{project:r.project})),{label:o,url:e,children:[this.getRepoNode()]}},getRepoNode:function(){var e,t=(this.props.locale.translate,this.props.locale.pick),s=this.props.route,r=s.parameters,o=this.state.repo,i=t(o.details.title)||o.name||"-";return r.project&&r.repo&&(e=s.find(n("./pages/repo-summary-page.jsx"),{project:r.project,repo:r.repo})),{label:i,url:e}},getUserListNode:function(){return{label:(0,this.props.locale.translate)("nav-users"),url:this.props.route.find(n("./pages/user-list-page.jsx")),children:[this.getUserNode()]}},getUserNode:function(){var e,t,s=this.props.locale.translate,r=this.props.locale.pick,i=this.props.route,a=i.parameters,l=this.state.user;return e="new"===a.user?o.createElement("i",null,s("nav-user-new")):r(l.details.name)||l.username||"-",a.user&&(t=i.find(n("./pages/user-summary-page.jsx"),{user:a.user})),{label:e,url:t}},getRoleListNode:function(){var e=this.props.locale.translate,t=this.props.route;return{label:e("nav-roles"),url:t.find(n("./pages/role-list-page.jsx")),children:[this.getRoleNode()]}},getRoleNode:function(){var e,t,s=this.props.locale.translate,r=this.props.locale.pick,i=this.props.route,a=i.parameters,l=this.state.role;return e="new"===a.role?o.createElement("i",null,s("nav-role-new")):r(l.details.title)||l.name||"-",a.role&&(t=i.find(n("./pages/role-summary-page.jsx"),{role:a.role})),{label:e,url:t}},getServerListNode:function(){var e=this.props.locale.translate,t=this.props.route;return{label:e("nav-servers"),url:t.find(n("./pages/server-list-page.jsx")),children:[this.getServerNode()]}},getServerNode:function(){var e,t,s=this.props.locale.translate,r=this.props.locale.pick,i=this.props.route,a=i.parameters,l=this.state.server;return"new"===a.server?e=o.createElement("i",null,s("nav-server-new")):(e=r(l.details.title),e||(e=l.type?s("server-type-"+l.type):"-"),t=i.find(n("./pages/server-summary-page.jsx"),{server:a.server})),{label:e,url:t}},getSettingsNode:function(){var e=this.props.locale.translate,t=this.props.route;return{label:e("nav-settings"),url:t.find(n("./pages/settings-page.jsx"))}},repositionArrow:function(){var e=this;setTimeout(function(){var t=0,n=e.components.activeLink;if(n)for(var s=n;s;s=s.parentNode){var r;if(r=/level(\d)/.exec(s.className)){t=parseInt(r[1]);break}}var o="";t>e.state.arrowCount?o="extending":t<e.state.arrowCount&&(o="retracting"),e.setState({arrowAction:o,arrowCount:t})},50);var t=this.components.arrow,n=this.components.container,s=setInterval(function(){var r=0,o=e.components.activeLink;if(o){var i=t.getBoundingClientRect(),a=o.getBoundingClientRect(),l=n.getBoundingClientRect();r=Math.floor(a.top+(a.height-i.height)/2-l.top)+1}r!==e.state.arrowPosition?e.setState({arrowPosition:r}):clearInterval(s)},50)}}),j={details:{}}},"./widgets/navigation-tree.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/navigation-tree.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/option-list.jsx":function(e,t,n){"use strict";var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/react/react.js"),i=o.PropTypes,a=n("./widgets/sortable-table.jsx");n("./widgets/option-list.scss"),e.exports=o.createClass({displayName:"OptionList",propTypes:{readOnly:i.bool,onOptionClick:i.func},render:function(){var e=o.Children.toArray(this.props.children),t=r.filter(e,{type:"option"}),n=r.find(e,{type:"label"}),s=["option-list"];this.props.readOnly&&s.push("readonly");var i={expandable:!0,selectable:!this.props.readOnly,expanded:!this.props.readOnly,sortColumns:[]};return o.createElement("div",{className:s.join(" ")},o.createElement("label",null,n?n.props.children:null),o.createElement("div",{className:"container"},o.createElement(a,i,o.createElement("tbody",null,r.map(t,this.renderRow)))))},renderRow:function(e,t){if(e.props.hidden)return null;var n=["option"];e.props.selected&&(n.push("fixed"),this.props.readOnly||n.push("selected"));var r;this.props.readOnly||(e.props.selected&&!e.props.previous?r=o.createElement("i",{className:"fa fa-check-circle-o badge add"}):!e.props.selected&&e.props.previous&&(r=o.createElement("i",{className:"fa fa-times-circle-o badge remove"})));var i={className:n.join(" "),"data-name":e.props.name,onClick:this.handleClick};return this.props.readOnly&&(i.onClick=void 0),o.createElement("tr",s({key:t},i),o.createElement("td",null,e.props.children,r))},handleClick:function(e){var t=e.currentTarget.getAttribute("data-name");this.props.onOptionClick&&this.props.onOptionClick({type:"optionclick",target:this,name:t})}})},"./widgets/option-list.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/option-list.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/profile-image.jsx":function(e,t,n){"use strict";function s(e){var t=["profile-image",e.size];if(e.user){var s=r.get(e.user,"details.resources"),i=r.find(s,{type:"image"});if(i){var a=c[e.size],e={className:t.join(" "),resource:i,width:a,height:a,theme:e.theme};return o.createElement(l,e)}}var d=n("../node_modules/octicons/build/svg/person.svg");return o.createElement(d,{className:t.join(" ")})}var r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/react/react.js"),i=o.PropTypes,a=n("../../common/src/theme/theme.js"),l=n("../../common/src/widgets/resource-view.jsx");e.exports=s,n("./widgets/profile-image.scss"),s.propTypes={user:i.object,size:i.oneOf(["small","large"]),theme:i.instanceOf(a)},s.defaultProps={size:"small"};var c={small:24,large:96}},"./widgets/profile-image.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/profile-image.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/push-button.jsx":function(e,t,n){"use strict";function s(e){return e=r.clone(e),e.className?e.className="push-button "+e.className:e.className="push-button",o.createElement("button",e,e.children)}var r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/react/react.js");e.exports=s,n("./widgets/push-button.scss"),s.defaultProps={className:"submit"}},"./widgets/push-button.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/push-button.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/side-navigation.jsx":function(e,t,n){"use strict";var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/react/react.js"),i=o.PropTypes,a=n("../../common/src/data/database.js"),l=n("../../common/src/routing/route.js"),c=n("../../common/src/locale/locale.js"),d=n("../../common/src/theme/theme.js"),u=n("./widgets/navigation-tree.jsx"),p=n("./widgets/tooltip.jsx"),m=n("./widgets/sign-off-menu.jsx");n("./widgets/side-navigation.scss"),e.exports=o.createClass({displayName:"SideNavigation",propTypes:{disabled:i.bool,database:i.instanceOf(a).isRequired,route:i.instanceOf(l).isRequired,locale:i.instanceOf(c).isRequired,theme:i.instanceOf(d).isRequired},getDefaultProps:function(){return{disabled:!1}},getInitialState:function(){return{ready:!1}},getLanguage:function(e){e||(e=this.props.locale.languageCode);var t=this.props.locale.directory;return r.find(t,{code:e})},render:function(){var e="side-navigation";return this.state.ready||(e+=" hidden"),o.createElement("nav",{className:e},this.renderHeader(),this.renderNavTree(),this.renderBottomButtons())},renderNavTree:function(){var e={disabled:this.props.disabled,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return o.createElement(u,e)},renderBottomButtons:function(){return o.createElement("div",{className:"bottom-buttons"},this.renderLanguageButton(),this.renderCountryButton(),this.renderUserButton())},renderLanguageButton:function(){var e=this,t=this.getLanguage(this.props.locale.languageCode),n=r.filter(this.props.locale.directory,function(e){return!!e.module}),i=r.map(n,function(n,r){var i={className:"item","data-code":n.code,onClick:e.handleLanguageClick};return n===t&&(i.className+=" selected",i.onClick=null),o.createElement("div",s({key:r},i),o.createElement("i",{className:"fa fa-check-circle-o"})," ",n.name)});return o.createElement("div",{className:"button language"},o.createElement(p,{upward:!0},o.createElement("inline",null,o.createElement("i",{className:"fa fa-language"})," ",t.name),o.createElement("window",null,i)))},renderCountryButton:function(){var e=this,t=this.getLanguage();if(r.size(t.countries)<=1)return null;var n=this.props.locale.countryCode;n||(n=t.defaultCountry);var i=t.countries[n],a=r.map(t.countries,function(t,r){var i={className:"item","data-code":r,onClick:e.handleCountryClick};return r===n&&(i.className+=" selected",i.onClick=null),o.createElement("div",s({key:r},i),o.createElement("i",{className:"fa fa-check-circle-o"})," ",t)});return o.createElement("div",{className:"button country"},o.createElement(p,{upward:!0},o.createElement("inline",null,i),o.createElement("window",null,a)))},renderUserButton:function(){var e=(this.props.locale.translate,{database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme});return o.createElement("div",{className:"button user"},o.createElement(p,{upward:!0,leftward:!0,disabled:this.props.disabled},o.createElement("inline",null,o.createElement("i",{className:"fa fa-user-circle-o"})),o.createElement("window",null,o.createElement(m,e))))},renderHeader:function(){return o.createElement("header",null,this.renderLogo(),this.renderAppName())},renderAppName:function(){var e=this.props.locale.translate;return o.createElement("h2",{className:"app-name"},e("app-name"))},renderLogo:function(){return o.createElement("svg",{className:"logo",xmlns:"http://www.w3.org/2000/svg",viewBox:"1000 1000 5080 6299",preserveAspectRatio:"xMidYMid",style:{strokeLinejoin:"round",strokeWidth:30}},o.createElement("defs",{className:"ClipPathGroup"},o.createElement("clipPath",{clipPathUnits:"userSpaceOnUse"},o.createElement("rect",{x:"1000",y:"1000",width:"5080",height:"6299"}))),o.createElement("defs",{className:"TextShapeIndex"}),o.createElement("defs",{className:"EmbeddedBulletChars"},o.createElement("path",{d:"M0.3-0.6L0.6-0.3 0.3 0 0-0.3 0.3-0.6Z"}),o.createElement("path",{d:"M0-0.6L0.6-0.6 0.6 0 0 0 0-0.6Z"}),o.createElement("path",{d:"M0.1 0L0.3-0.4 0.1-0.7 0.7-0.4 0.1 0ZM1358 739L309 1346 659 739 1358 739Z"}),o.createElement("path",{d:"M1-0.4L0.6 0 0.4 0 0.6-0.3 0.1-0.3 0.1-0.5 0.6-0.5 0.4-0.7 0.6-0.7 1-0.4Z"}),o.createElement("path",{d:"M0 0C0 0 0 0 0 0L0.2-0.3C0.1-0.4 0.1-0.5 0.1-0.5 0.1-0.5 0.1-0.5 0.1-0.5 0.1-0.5 0.1-0.5 0.1-0.5 0.2-0.5 0.2-0.5 0.2-0.5L0.2-0.5 0.2-0.4 0.4-0.5 0.4-0.5 0.4-0.5C0.4-0.5 0.4-0.5 0.5-0.5 0.4-0.5 0.4-0.4 0.4-0.4 0.4-0.4 0.3-0.3 0.3-0.3L0.4-0.1C0.4-0.1 0.4-0.1 0.3-0.1L0.4-0.1C0.4 0 0.3 0 0.3 0 0.3 0 0.3-0.1 0.2-0.2L0.1 0C0.1 0.1 0.1 0.1 0 0.1 0 0.1 0 0.1 0 0 0 0 0 0 0 0 0 0 0 0 0 0Z"}),o.createElement("path",{d:"M0.1 0C0.1 0 0.1 0 0-0.1 0-0.1 0-0.2 0-0.2 0-0.3 0-0.3 0-0.3 0.1-0.4 0.1-0.4 0.1-0.4 0.1-0.4 0.2-0.4 0.2-0.3L0.2-0.2C0.2-0.2 0.2-0.2 0.2-0.2L0.6-0.5C0.6-0.6 0.6-0.6 0.6-0.6 0.6-0.6 0.6-0.5 0.6-0.5L0.6-0.5C0.6-0.5 0.6-0.4 0.6-0.4L0.2 0C0.2 0 0.2 0 0.1 0Z"}),o.createElement("path",{d:"M0.4 0C0.3 0 0.2 0 0.2-0.1 0.1-0.1 0.1-0.2 0.1-0.3 0.1-0.4 0.1-0.4 0.2-0.5 0.2-0.6 0.3-0.6 0.4-0.6 0.5-0.6 0.6-0.6 0.6-0.5 0.7-0.4 0.7-0.4 0.7-0.3 0.7-0.2 0.7-0.1 0.6-0.1 0.6 0 0.5 0 0.4 0Z"}),o.createElement("path",{d:"M0.2-0.2C0.1-0.2 0.1-0.2 0.1-0.3 0-0.3 0-0.3 0-0.4 0-0.4 0-0.4 0.1-0.4 0.1-0.5 0.1-0.5 0.2-0.5 0.2-0.5 0.2-0.5 0.3-0.4 0.3-0.4 0.3-0.4 0.3-0.4 0.3-0.3 0.3-0.3 0.3-0.3 0.2-0.2 0.2-0.2 0.2-0.2Z"}),o.createElement("path",{d:"M0-0.2L0.6-0.2 0.6-0.3 0-0.3 0-0.2Z"})),o.createElement("defs",{className:"TextEmbeddedBitmaps"}),o.createElement("g",{className:"SlideGroup"},o.createElement("g",{className:"Slide",clipPath:"url(#presentation_clip_path)"},o.createElement("g",{className:"Page"},o.createElement("g",{className:"com.sun.star.drawing.ClosedBezierShape"},o.createElement("rect",{className:"BoundingBox",x:"1000",y:"1000",width:"5082",height:"6301",fill:"none"}),o.createElement("path",{d:"M1655 2259L5444 2259 6080 2890 6080 3520 5233 3520 5233 3099 1847 3099 1847 3918 1847 4758 1847 5619 1847 6459 5233 6459 5233 5619 4809 5619 4809 4989 6080 4989 6080 6669 5444 7299 1635 7299 1000 6669 1000 2890 1655 2259ZM3116 6459L3116 4569 3963 4569 3963 6459 3116 6459ZM3540 3520C3780 3520 3963 3701 3963 3939 3963 4178 3780 4360 3540 4360 3300 4360 3116 4178 3116 3939 3116 3701 3300 3520 3540 3520ZM3116 3520L3116 3520ZM3964 4361L3964 4361ZM3328 2259L3328 1419 2693 1419 2693 1000 4387 1000 4387 1419 3752 1419 3752 2259 3328 2259Z",fill:"rgb(255,255,255)"}))))))},componentDidMount:function(){var e=this;setTimeout(function(){e.setState({ready:!0})},100)},handleLanguageClick:function(e){var t=e.currentTarget.getAttribute("data-code"),n=this.getLanguage(t);return this.props.locale.change(n.code+"-"+n.defaultCountry)},handleCountryClick:function(e){var t=e.currentTarget.getAttribute("data-code"),n=this.getLanguage();return this.props.locale.change(n.code+"-"+t)}})},"./widgets/side-navigation.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/side-navigation.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/sign-off-menu.jsx":function(e,t,n){"use strict";var s=(n("../node_modules/lodash/lodash.js"),n("../node_modules/bluebird/js/browser/bluebird.js"),n("../node_modules/react/react.js")),r=s.PropTypes,o=n("../node_modules/relaks/index.js"),i=n("../../common/src/objects/finders/user-finder.js"),a=n("../../common/src/data/database.js"),l=n("../../common/src/routing/route.js"),c=n("../../common/src/locale/locale.js"),d=n("../../common/src/theme/theme.js"),u=n("./widgets/profile-image.jsx");n("./widgets/sign-off-menu.scss"),e.exports=o.createClass({displayName:"SignOffMenu",propTypes:{database:r.instanceOf(a).isRequired,route:r.instanceOf(l).isRequired,locale:r.instanceOf(c).isRequired,theme:r.instanceOf(d).isRequired},renderAsync:function(e){var t=this,r=this.props.database.use({schema:"global",by:this});return e.show(s.createElement("div",{className:"sign-off-menu"})),r.start().then(function(e){return i.findUser(r,e).then(function(e){var r=t.props.locale.translate,o=t.props.locale.pick,i=n("./pages/user-summary-page.jsx").getURL({userId:e.id});return s.createElement("div",{className:"sign-off-menu"},s.createElement("a",{href:i},s.createElement(u,{user:e,theme:t.props.theme,size:"large"}),s.createElement("div",{className:"name"},o(e.details.name))),s.createElement("div",{className:"sign-off",onClick:t.handleSignOffClick},r("sign-off-menu-sign-off")))})})},handleSignOffClick:function(){var e=this;this.props.database.use({by:this}).endSession().then(function(){e.props.route.push(n("./pages/start-page.jsx"))})}})},"./widgets/sign-off-menu.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/sign-off-menu.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/sortable-table.jsx":function(e,t,n){"use strict";(function(t){function s(e,t){return e=a.Children.toArray(e),i.find(e,{type:t})}function r(e){return a.createElement("th",e,e.children,a.createElement("i",{className:"fa fa-chevron-down arrow down"}),a.createElement("i",{className:"fa fa-chevron-up arrow up"}))}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},i=n("../node_modules/lodash/lodash.js"),a=n("../node_modules/react/react.js"),l=a.PropTypes,c=n("../../common/src/widgets/collapsible-container.jsx");n("./widgets/sortable-table.scss"),e.exports=a.createClass({displayName:"SortableTable",propTypes:{sortColumns:l.arrayOf(l.string).isRequired,sortDirections:l.arrayOf(l.oneOf(["asc","desc"])),expanded:l.bool,expandable:l.bool,selectable:l.bool,onSort:l.func},getInitialState:function(){return{action:null}},componentWillReceiveProps:function(e){this.props.expanded!==e.expanded&&(e.expanded?this.setState({action:"expanding"}):this.setState({action:"collapsing"}))},render:function(){var e=s(this.props.children,"thead"),t=s(this.props.children,"tbody");e&&(e=this.highlightHeading(e)),t&&null!=this.props.expanded&&(t=this.wrapUnselectedRows(t));var n=i.omit(this.props,["sortColumns","sortDirections","expandable","selectable","expanded","onSort"]);return n.onClick=this.handleClick,n.className="sortable-table",this.props.expandable&&(n.className+=" expandable",this.props.expanded?n.className+=" expanded":n.className+=" collapsed"),this.props.selectable&&(n.className+=" selectable"),this.props.className&&(n.className+=" "+this.props.className),a.createElement("table",o({ref:"table"},n),e,t)},highlightHeading:function(e){var t=i.get(this.props.sortColumns,0),n=i.get(this.props.sortDirections,0,"asc"),r=s(e.props.children,"tr"),o=a.Children.toArray(r.props.children);return o=i.map(o,function(e){if(e.props.id===t){var s=e.props.className||"";s&&(s+=" "),s+=n,e=a.cloneElement(e,{className:s})}return e}),r=a.cloneElement(r,{},o),e=a.cloneElement(e,{},[r])},wrapUnselectedRows:function(e){var t=this,n=(this.state.cellHeights,e.props.children);return n=i.map(n,function(e,n){if(!e)return null;if(/\bfixed\b/.test(e.props.className))return e;var s,r=a.Children.toArray(e.props.children),o=e.props.className;return s="expanding"!==t.state.action&&("collapsing"===t.state.action||t.props.expanded),o?o+=" ":o="",o+=s?"expanded":"collapsed",r=i.map(r,function(e,t){var n=a.createElement(c,{open:s},e.props.children);return a.cloneElement(e,{},n)}),a.cloneElement(e,{className:o},r)}),e=a.cloneElement(e,{},n)},componentDidUpdate:function(e,n){var s=this;this.state.action&&t(function(){s.setState({action:null})})},handleClick:function(e){for(var t=(e.target,e.target);t&&"TABLE"!==t.tagName;t=t.parentNode)if("TH"===t.tagName){var n=t.id;if(!n)return;var s=i.slice(this.props.sortColumns),r=i.slice(this.props.sortDirections),o=i.indexOf(s,n);-1!==o&&(s.splice(o,1),r.splice(o,1));var a="asc";0===o&&"asc"===this.props.sortDirections[0]&&(a="desc"),s.unshift(n),r.unshift(a),this.props.onSort&&this.props.onSort({type:"sort",target:this,columns:s,directions:r})}}}),e.exports.TH=r}).call(t,n("../node_modules/timers-browserify/main.js").setImmediate)},"./widgets/sortable-table.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/sortable-table.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/task-alert-bar.jsx":function(e,t,n){"use strict";var s=n("../node_modules/lodash/lodash.js"),r=n("../node_modules/moment/moment.js"),o=n("../node_modules/react/react.js"),i=o.PropTypes,a=n("../node_modules/relaks/index.js"),l=(n("../../common/src/data/session-start-time.js"),n("../../common/src/objects/finders/task-finder.js")),c=n("../../common/src/data/database.js"),d=n("../../common/src/routing/route.js"),u=n("../../common/src/locale/locale.js"),p=n("../../common/src/theme/theme.js");n("./widgets/task-alert-bar.scss"),e.exports=a.createClass({displayName:"TaskAlertBar",propTypes:{database:i.instanceOf(c).isRequired,route:i.instanceOf(d).isRequired,locale:i.instanceOf(u).isRequired,theme:i.instanceOf(p).isRequired},getInitialState:function(){return{searchStartTime:this.getSearchStartTime()}},getSearchStartTime:function(){return r().subtract(8,"hour").startOf("hour").toISOString()},renderAsync:function(e){var t=this,n=this.props.database.use({schema:"global",by:this}),s={tasks:null,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(o.createElement(m,s)),n.start().then(function(e){return l.findActiveTasks(n,t.state.searchStartTime).then(function(e){s.tasks=e})}).then(function(){return o.createElement(m,s)}).catch(function(e){if(401!==e.statusCode)throw e})},componentDidMount:function(){var e=this;this.hourChangeTimeout=setInterval(function(){var t=e.getSearchStartTime();e.state.searchStartTime!==t&&e.setState({searchStartTime:t})},3e5)},componentWillUnmount:function(){clearInterval(this.hourChangeInterval)}});var m=e.exports.Sync=o.createClass({displayName:"TaskAlertBar.Sync",propTypes:{tasks:i.arrayOf(i.object),route:i.instanceOf(d).isRequired,locale:i.instanceOf(u).isRequired,theme:i.instanceOf(p).isRequired},getInitialState:function(){return{showing:!1,rendering:!1,hidden:!0,selectedTask:null,highestTaskId:0}},getMessage:function(){var e=this.props.locale.translate,t=this.state.selectedTask;switch(t.action){case"gitlab-repo-import":return e("task-importing-repos");case"gitlab-user-import":return e("task-importing-users");case"gitlab-hook-install":return e("task-installing-hooks");case"gitlab-hook-remove":return e("task-removing-hooks");case"gitlab-event-import":var n=t.options.repo;return e("task-importing-events-from-$repo",n);case"gitlab-push-import":var n=t.options.repo;return e("task-importing-push-from-$repo",n);case"gitlab-commit-comment-import":var n=t.options.repo;return e("task-importing-commit-comments-from-$repo",n);case"gitlab-issue-comment-import":var n=t.options.repo;return e("task-importing-issue-comments-from-$repo",n);case"gitlab-merge-request-comment-import":var n=t.options.repo;return e("task-importing-merge-request-comments-from-$repo",n);default:return""}},getURL:function(){var e=this.state.selectedTask,t=null,r=s.get(e,"options.server_id");if(r){var o=this.props.route,i=[n("./pages/server-summary-page.jsx"),n("./widgets/task-list.jsx")],a={server:r,task:e.id};t=o.find(i,a)}return t},componentWillReceiveProps:function(e){var t=this;if(this.props.tasks!==e.tasks){var n=this.state.highestTaskId,r=s.sortBy(s.filter(e.tasks,{failed:!1}),"ctime"),o=s.first(r);if(o)o.id>n&&(n=o.id);else{var i=s.sortBy(s.filter(e.tasks,{failed:!0},"ctime"));o=s.find(i,function(e){if(e.id>=n)return!0})}if(o)this.setState({selectedTask:o,highestTaskId:n,showing:!0});else{var a=this.state.selectedTask;setTimeout(function(){a===t.state.selectedTask&&t.setState({showing:!1})},5e3)}}},render:function(){if(!this.state.rendering)return null;var e="task-alert-bar";return this.state.hidden&&(e+=" hidden"),this.state.selectedTask.failed&&(e+=" failure"),o.createElement("div",{className:e},this.renderMessage(),this.renderProgressBar())},renderMessage:function(){var e=this.getMessage(this.state.selectedTask),t=this.getURL(this.state.selectedTask);return o.createElement("a",{href:t},e)},renderProgressBar:function(){var e=this.state.selectedTask,t=e.completion+"%";return o.createElement("div",{className:"progress-bar-frame"},o.createElement("div",{className:"bar",style:{width:t}}))},componentDidUpdate:function(e,t){var n=this;if(!t.showing&&this.state.showing)this.state.rendering||this.setState({rendering:!0,hidden:!0});else if(t.showing&&!this.state.showing)this.setState({hidden:!0}),setTimeout(function(){n.state.showing||n.setState({rendering:!1})},500);else if(!t.rendering&&this.state.rendering){r().subtract(2,"second").toISOString(),setTimeout(function(){!1!==n.mounted&&n.setState({hidden:!1})},10)}},componentWillUnmount:function(){this.mounted=!1}})},"./widgets/task-alert-bar.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/task-alert-bar.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/task-list.jsx":function(e,t,n){"use strict";function s(e){var t=[];return o.each(e.deleted,function(e){r(t,e,"item deleted")}),o.each(e.modified,function(e){r(t,e,"item modified")}),o.each(e.added,function(e){r(t,e,"item added")}),t}function r(e,t,n){var s=e.length;e.push(a.createElement("span",{className:n,key:s},t))}var o=n("../node_modules/lodash/lodash.js"),i=n("../node_modules/moment/moment.js"),a=n("../node_modules/react/react.js"),l=a.PropTypes,c=n("../node_modules/relaks/index.js"),d=n("../../common/src/utils/memoize.js"),u=n("../../common/src/objects/finders/task-finder.js"),p=n("../../common/src/data/database.js"),m=n("../../common/src/routing/route.js"),h=n("../../common/src/locale/locale.js"),f=n("../../common/src/theme/theme.js"),g=n("../../common/src/widgets/smart-list.jsx");n("./widgets/task-list.scss"),e.exports=c.createClass({displayName:"TaskList",propTypes:{server:l.object,database:l.instanceOf(p).isRequired,route:l.instanceOf(m).isRequired,locale:l.instanceOf(h).isRequired,theme:l.instanceOf(f).isRequired},statics:{parseHash:function(e){return{task:m.parseId(e,/t(\d+)/)}},getHash:function(e){return e.task?"t"+e.task:""}},renderAsync:function(e){var t=this,n=this.props.database.use({schema:"global",by:this}),s={tasks:null,server:this.props.server,locale:this.props.locale,route:this.props.route,theme:this.props.theme};return e.show(a.createElement(v,s)),n.start().then(function(e){if(t.props.server)return u.findServerTasks(n,s.server).then(function(e){s.tasks=e})}).then(function(){return a.createElement(v,s)})}});var v=e.exports.Sync=a.createClass({displayName:"TaskList.Sync",propTypes:{tasks:l.arrayOf(l.object),route:l.instanceOf(m).isRequired,locale:l.instanceOf(h).isRequired,theme:l.instanceOf(f).isRequired},getInitialState:function(){var t=e.exports.parseHash(this.props.route.hash);return{expandedTaskIds:t.task?[t.task]:[]}},getMessage:function(e){var t=this.props.locale.translate;if(100===e.completion)switch(e.action){case"gitlab-repo-import":var n=o.size(e.details.added),s=o.size(e.details.deleted),r=o.size(e.details.modified);if(n)return t("task-imported-$count-repos",n);if(s)return t("task-removed-$count-repos",s);if(r)return t("task-updated-$count-repos",r);break;case"gitlab-user-import":var n=o.size(e.details.added),s=o.size(e.details.deleted),r=o.size(e.details.modified);if(n)return t("task-imported-$count-users",n);if(s)return t("task-removed-$count-users",s);if(r)return t("task-updated-$count-users",r);break;case"gitlab-hook-install":var n=o.size(e.details.added);return t("task-installed-$count-hooks",n);case"gitlab-hook-remove":var s=o.size(e.details.deleted);return t("task-removed-$count-hooks",s);case"gitlab-event-import":var n=o.size(e.details.added),i=e.options.repo;return t("task-imported-$count-events-from-$repo",n,i);case"gitlab-push-import":var n=o.size(e.details.added),i=e.options.repo;return t("task-imported-push-with-$count-commits-from-$repo-$branch",n,i,e.options.branch);case"gitlab-commit-comment-import":var n=o.size(e.details.added),i=e.options.repo;return t("task-imported-$count-commit-comments-from-$repo",n,i);case"gitlab-issue-comment-import":var n=o.size(e.details.added),i=e.options.repo;return t("task-imported-$count-issue-comments-from-$repo",n,i);case"gitlab-merge-request-comment-import":var n=o.size(e.details.added),i=e.options.repo;return t("task-imported-$count-merge-request-comments-from-$repo",n,i)}else switch(e.action){case"gitlab-repo-import":return t("task-importing-repos");case"gitlab-user-import":return t("task-importing-users");case"gitlab-hook-install":return t("task-installing-hooks");case"gitlab-hook-remove":return t("task-removing-hooks");case"gitlab-event-import":var i=e.options.repo;return t("task-importing-events-from-$repo",i);case"gitlab-push-import":var i=e.options.repo;return t("task-importing-push-from-$repo",i);case"gitlab-commit-comment-import":var i=e.options.repo;return t("task-importing-commit-comments-from-$repo",i);case"gitlab-issue-comment-import":var i=e.options.repo;return t("task-importing-issue-comments-from-$repo",i);case"gitlab-merge-request-comment-import":var i=e.options.repo;return t("task-importing-merge-request-comments-from-$repo",i)}},getDetails:function(e){this.props.locale.translate;switch(e.action){case"gitlab-repo-import":case"gitlab-user-import":case"gitlab-hook-install":case"gitlab-hook-remove":case"gitlab-event-import":case"gitlab-push-import":case"gitlab-commit-comment-import":case"gitlab-issue-comment-import":case"gitlab-merge-request-comment-import":return s(e.details);default:return""}},setContainerNode:function(e){this.containerNode=e},render:function(){var t,n=e.exports.parseHash(this.props.route.hash);n.task&&(t="task-"+n.task);var s={items:b(this.props.tasks),offset:5,behind:20,ahead:20,anchor:t,onIdentity:this.handleTaskIdentity,onRender:this.handleTaskRender,onAnchorChange:this.handleAnchorChange};return a.createElement("div",{className:"task-list",ref:this.setContainerNode},a.createElement(g,s))},renderTask:function(e){var t="task";return e.failed&&(t+=" failure"),o.includes(this.state.expandedTaskIds,e.id)&&(t+=" expanded"),a.createElement("div",{className:t},a.createElement("div",{className:"summary","data-task-id":e.id,onClick:this.handleTaskClick},this.renderStartTime(e),this.renderMessage(e),this.renderProgress(e)),this.renderDetails(e))},renderStartTime:function(e){var t=i(e.ctime).format("YYYY-MM-DD HH:mm:ss");return a.createElement("div",{className:"start-time"},t)},renderMessage:function(e){var t,n=this.getMessage(e);return n||(n=e.action+" (noop)"),e.failed&&(t=a.createElement("i",{className:"fa fa-exclamation-triangle"})),a.createElement("div",{className:"message"},n,t)},renderProgress:function(e){if(100===e.completion&&e.etime){var t=this.props.locale.translate,n=i(e.etime)-i(e.ctime),s=Math.ceil(n/1e3);return a.createElement("div",{className:"duration"},t("task-$seconds",s))}var r=e.completion+"%";return a.createElement("div",{className:"progress-bar-frame"},a.createElement("div",{className:"bar",style:{width:r}}))},renderDetails:function(e){if(!o.includes(this.state.expandedTaskIds,e.id))return null;var t=this.getDetails(e);return a.createElement("div",null,a.createElement("div",{className:"details"},t),this.renderError(e))},renderError:function(e){if(!e.failed)return null;var t=o.get(e,"details.error.stack");return t||(t=o.get(e,"details.error.message")),a.createElement("div",{className:"error"},t)},componentDidMount:function(){e.exports.parseHash(this.props.route.hash).task&&this.containerNode&&this.containerNode.scrollIntoView()},handleTaskIdentity:function(e){return"task-"+e.item.id},handleTaskRender:function(e){return e.needed?this.renderTask(e.item):a.createElement("div",{className:"task"})},handleTaskClick:function(e){var t=parseInt(e.currentTarget.getAttribute("data-task-id")),n=o.slice(this.state.expandedTaskIds);o.includes(n,t)?o.pull(n,t):n.push(t),this.setState({expandedTaskIds:n})},handleAnchorChange:function(e){this.props.route.reanchor("")}}),b=d(function(e){return o.orderBy(e,"id","desc")})},"./widgets/task-list.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/task-list.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/text-field.jsx":function(e,t,n){"use strict";function s(e){var t=["text-field"],n="input",s=r.omit(e,"children","locale");if("textarea"===e.type&&(n=l,s=r.omit(s,"type")),e.readOnly){t.push("readonly");var i=e.locale.translate;s.placeholder=i("text-field-placeholder-none"),s.spellCheck=!1}return s.value=s.value||"",o.createElement("div",{className:t.join(" ")},o.createElement("label",{htmlFor:e.id},e.children),o.createElement(n,s))}var r=n("../node_modules/lodash/lodash.js"),o=n("../node_modules/react/react.js"),i=o.PropTypes,a=n("../../common/src/locale/locale.js"),l=n("../../common/src/widgets/autosize-text-area.jsx");n("./widgets/text-field.scss"),e.exports=s,s.defaultProps={type:"text"},s.propTypes={locale:i.instanceOf(a).isRequired}},"./widgets/text-field.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/text-field.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},"./widgets/tooltip.jsx":function(e,t,n){"use strict";function s(e){var t=i.Children.toArray(e.children),n=o.find(t,{type:"window"});return!!(n&&i.Children.count(n.props.children)>0)}function r(e,t){for(var n=e;n;n=n.parentNode)if(n===t)return!0;return!1}var o=n("../node_modules/lodash/lodash.js"),i=n("../node_modules/react/react.js"),a=i.PropTypes,l=n("../../common/src/utils/component-refs.js");n("./widgets/tooltip.scss"),e.exports=i.createClass({displayName:"Tooltip",propTypes:{upward:a.bool,leftward:a.bool,disabled:a.bool},getInitialState:function(){return this.components=l({container:HTMLElement}),{open:!1,live:s(this.props)}},componentWillReceiveProps:function(e){var t=s(e);if(this.state.live!==t||this.props.disabled!==e.disabled){var n=this.state.open&&t&&!e.disabled;this.setState({live:t,open:n})}},render:function(){var e=this.components.setters,t="tooltip";return this.state.live&&!this.props.disabled&&(t+=" live"),this.props.upward&&(t+=" upward"),this.props.leftward&&(t+=" leftward"),this.props.className&&(t+=" "+this.props.className),i.createElement("div",{ref:e.container,className:t},this.renderLabel(),this.renderWindow())},renderLabel:function(){var e=this.findElement("inline");return i.createElement("span",{className:"label",onClick:this.handleLabelClick},e.props.children)},renderWindow:function(){if(!this.state.open)return null;var e=this.findElement("window");return i.createElement("div",{className:"window-container",onClick:this.handleWindowClick},i.createElement("div",{className:"window"},e.props.children))},componentDidUpdate:function(e,t){t.open!==this.state.open&&(this.state.open?(document.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("keydown",this.handleKeyDown)):(document.removeEventListener("mousedown",this.handleMouseDown),document.removeEventListener("keydown",this.handleKeyDown)))},componentWillUnmount:function(){this.state.open&&(document.removeEventListener("mousedown",this.handleMouseDown),document.removeEventListener("keydown",this.handleKeyDown))},findElement:function(e){var t=i.Children.toArray(this.props.children);return o.find(t,{type:e})},handleLabelClick:function(e){this.state.live&&!this.props.disabled&&this.setState({open:!this.state.open})},handleMouseDown:function(e){r(e.target,this.components.container)||this.setState({open:!1})},handleKeyDown:function(e){27===e.keyCode&&this.setState({open:!1})}})},"./widgets/tooltip.scss":function(e,t,n){var s=n('../node_modules/css-loader/index.js!../node_modules/postcss-loader/lib/index.js?{"config":{"path":"/home/cleong/trambar-build/codebase/admin/postcss.config.js"}}!../node_modules/sass-loader/lib/loader.js!./widgets/tooltip.scss');"string"==typeof s&&(s=[[e.i,s,""]]);var r={};r.transform=void 0;n("../node_modules/style-loader/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)}});