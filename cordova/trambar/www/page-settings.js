webpackJsonp(["page-settings"],{"../../common/node_modules/base64-js/index.js":function(e,t,n){"use strict";function r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function o(e){var t=r(e),n=t[0],o=t[1];return 3*(n+o)/4-o}function a(e,t,n){return 3*(t+n)/4-n}function i(e){for(var t,n=r(e),o=n[0],i=n[1],s=new f(a(e,o,i)),u=0,l=i>0?o-4:o,c=0;c<l;c+=4)t=d[e.charCodeAt(c)]<<18|d[e.charCodeAt(c+1)]<<12|d[e.charCodeAt(c+2)]<<6|d[e.charCodeAt(c+3)],s[u++]=t>>16&255,s[u++]=t>>8&255,s[u++]=255&t;return 2===i&&(t=d[e.charCodeAt(c)]<<2|d[e.charCodeAt(c+1)]>>4,s[u++]=255&t),1===i&&(t=d[e.charCodeAt(c)]<<10|d[e.charCodeAt(c+1)]<<4|d[e.charCodeAt(c+2)]>>2,s[u++]=t>>8&255,s[u++]=255&t),s}function s(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function u(e,t,n){for(var r,o=[],a=t;a<n;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(s(r));return o.join("")}function l(e){for(var t,n=e.length,r=n%3,o=[],a=0,i=n-r;a<i;a+=16383)o.push(u(e,a,a+16383>i?i:a+16383));return 1===r?(t=e[n-1],o.push(c[t>>2]+c[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],o.push(c[t>>10]+c[t>>4&63]+c[t<<2&63]+"=")),o.join("")}t.byteLength=o,t.toByteArray=i,t.fromByteArray=l;for(var c=[],d=[],f="undefined"!=typeof Uint8Array?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,m=p.length;h<m;++h)c[h]=p[h],d[p.charCodeAt(h)]=h;d["-".charCodeAt(0)]=62,d["_".charCodeAt(0)]=63},"../../common/node_modules/ieee754/index.js":function(e,t){t.read=function(e,t,n,r,o){var a,i,s=8*o-r-1,u=(1<<s)-1,l=u>>1,c=-7,d=n?o-1:0,f=n?-1:1,p=e[t+d];for(d+=f,a=p&(1<<-c)-1,p>>=-c,c+=s;c>0;a=256*a+e[t+d],d+=f,c-=8);for(i=a&(1<<-c)-1,a>>=-c,c+=r;c>0;i=256*i+e[t+d],d+=f,c-=8);if(0===a)a=1-l;else{if(a===u)return i?NaN:1/0*(p?-1:1);i+=Math.pow(2,r),a-=l}return(p?-1:1)*i*Math.pow(2,a-r)},t.write=function(e,t,n,r,o,a){var i,s,u,l=8*a-o-1,c=(1<<l)-1,d=c>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:a-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,i=c):(i=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-i))<1&&(i--,u*=2),t+=i+d>=1?f/u:f*Math.pow(2,1-d),t*u>=2&&(i++,u/=2),i+d>=c?(s=0,i=c):i+d>=1?(s=(t*u-1)*Math.pow(2,o),i+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,o),i=0));o>=8;e[n+p]=255&s,p+=h,s/=256,o-=8);for(i=i<<o|s,l+=o;l>0;e[n+p]=255&i,p+=h,i/=256,l-=8);e[n+p-h]|=128*m}},"../../common/src/media/media-stream-utils.js":function(e,t,n){"use strict";function r(){return c.default.try(function(){var e={audio:!0};return navigator.mediaDevices.getUserMedia(e)})}function o(e){return c.default.try(function(){var t={video:!e||{deviceID:e},audio:!0};return navigator.mediaDevices.getUserMedia(t)})}function a(e){return c.default.try(function(){var t={video:!e||{deviceID:e}};return navigator.mediaDevices.getUserMedia(t)})}function i(e){var t=e.getVideoTracks()[0],n=t.getSettings(),r=n.width,o=n.height;return r>o&&screen.width<screen.height&&(r=n.height,o=n.width),{width:r,height:o}}function s(e,t){var n=function n(r){var o=e.videoWidth,a=e.videoHeight;t({width:o,height:a}),e.removeEventListener("loadedmetadata",n)};e.addEventListener("loadedmetadata",n)}function u(e){var t=e.getTracks();_.each(t,function(e){e.stop()})}Object.defineProperty(t,"__esModule",{value:!0}),t.stopAllTracks=t.getActualVideoDimensions=t.getVideoDimensions=t.getSilentVideoStream=t.getVideoStream=t.getAudioStream=void 0;var l=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),c=function(e){return e&&e.__esModule?e:{default:e}}(l);t.getAudioStream=r,t.getVideoStream=o,t.getSilentVideoStream=a,t.getVideoDimensions=i,t.getActualVideoDimensions=s,t.stopAllTracks=u},"../../common/src/media/media-tag-reader.js":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return new u.default(function(t,n){var r=new c.default.Reader(e);r.setTagsToRead(["picture"]),r.read({onSuccess:function(e){var n=i.default.get(e,"tags.picture");if(n&&n.data){var r=n.data,o=new Uint8Array(r),a=new Blob([o],{type:n.format});t(a)}else t(null)},onError:function(e){t(null)}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.extractAlbumArt=void 0;var a=n("../../common/node_modules/lodash/lodash.js"),i=r(a),s=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),u=r(s),l=n("../node_modules/jsmediatags/dist/jsmediatags.js"),c=r(l);t.extractAlbumArt=o},"../../common/src/media/quick-start.js":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return i(e).then(function(t){var n=p.default.findIndex(t,{name:"ftyp"}),r=p.default.findIndex(t,{name:"moov"});if(!(0===n&&r>1))return null;var o=t[n],i=t[r];return u(e,o).then(function(t){return u(e,i).then(function(n){var r=new Uint8Array(n);a(r,8,r.length,o.offset+o.size,i.offset,i.size);var s=e.slice(o.offset+o.size,i.offset),u=e.slice(i.offset+i.size),l=[t,n,s,u];return new Blob(l,{type:e.type})})})}).catch(function(e){return null})}function a(e,t,n,r,o,i){for(;t<n;){var s=l(e,t),u=d(e,t+4);if(s<8)break;switch(u){case"stco":for(var f=0,p=l(e,t+12);f<p;f++){var h=t+16+4*f,m=l(e,h);r<=m&&m<=o&&(m+=i,e[h+0]=m>>24&255,e[h+1]=m>>16&255,e[h+2]=m>>8&255,e[h+3]=m>>0&255)}break;case"co64":for(var v=0,g=l(e,t+12);v<g;v++){var y=t+16+8*v,b=c(e,y);r<=b&&b<=o&&(b+=i,e[y+0]=b>>56&255,e[y+1]=b>>48&255,e[y+2]=b>>40&255,e[y+3]=b>>32&255,e[y+4]=b>>24&255,e[y+5]=b>>16&255,e[y+6]=b>>8&255,e[y+7]=b>>0&255)}break;case"trak":case"mdia":case"minf":case"stbl":a(e,t+8,t+s,r,o,i)}t+=s}}function i(e){var t=[],n=0,r=e.size,o=!1,a=!1;return g.default.do(function(){return s(e,n).then(function(e){var i=!1;if(o?"moov"===e.name&&(a=!0):"ftyp"===e.name?o=!0:i=!0,n+=e.size,n>r&&(i=!0),i)throw new Error("File does not appear to a QuickTime container");t.push(e)})}),g.default.while(function(){return!(o&&a)}),g.default.return(function(){return t}),g.default.end()}function s(e,t){return new m.default(function(n,r){var o=e.slice(t,t+16),a=new FileReader;a.readAsArrayBuffer(o),a.onload=function(e){var o=new Uint8Array(e.target.result),a=l(o,0),i=8;1===a&&(a=c(o,8),i=16),a>=i||r(new Error("Invalid atom size"));var s=d(o,4);n({offset:t,size:a,name:s})},a.onerror=function(e){r(new Error("Unable to load data"))}})}function u(e,t){return new m.default(function(n,r){var o=e.slice(t.offset,t.offset+t.size),a=new FileReader;a.readAsArrayBuffer(o),a.onload=function(e){n(e.target.result)},a.onerror=function(e){r(new Error("Unable to load data"))}})}function l(e,t){return e[t+0]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function c(e,t){return e[t+0]<<56|e[t+1]<<48|e[t+2]<<40|e[t+3]<<32|e[t+4]<<24|e[t+5]<<16|e[t+6]<<8|e[t+7]}function d(e,t){return String.fromCharCode(e[t+0])+String.fromCharCode(e[t+1])+String.fromCharCode(e[t+2])+String.fromCharCode(e[t+3])}Object.defineProperty(t,"__esModule",{value:!0}),t.process=void 0;var f=n("../../common/node_modules/lodash/lodash.js"),p=r(f),h=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),m=r(h),v=n("../../common/node_modules/async-do-while/index.js"),g=r(v);t.process=o},"../../common/src/objects/finders/device-finder.js":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t?e.find({schema:"global",table:"device",criteria:{user_id:t.id},prefetch:!0,minimum:n}):s.default.resolve(u)}Object.defineProperty(t,"__esModule",{value:!0}),t.findUserDevices=void 0;var a=n("../../common/node_modules/lodash/lodash.js"),i=(r(a),n("../../common/node_modules/bluebird/js/browser/bluebird.js")),s=r(i),u=[];t.findUserDevices=o},"../../common/src/objects/finders/repo-finder.js":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return e.findOne({schema:"global",table:"repo",criteria:{id:t},required:!0})}function a(e,t){return e.find({schema:"global",table:"repo",criteria:{},minimum:t})}function i(e,t){return e.find({schema:"global",table:"repo",criteria:{deleted:!1},minimum:t})}function s(e,t){if(t instanceof Array){var n=l.default.flatten(l.default.map(t,"repo_ids"));return l.default.isEmpty(n)?d.default.resolve(f):(n=l.default.sortBy(l.default.uniq(n)),e.find({schema:"global",table:"repo",criteria:{id:n,deleted:!1}}))}var r=t;return r?e.find({schema:"global",table:"repo",criteria:{id:r.repo_ids,deleted:!1},prefetch:!0}):d.default.resolve(f)}Object.defineProperty(t,"__esModule",{value:!0}),t.findProjectRepos=t.findExistingRepos=t.findAllRepos=t.findRepo=void 0;var u=n("../../common/node_modules/lodash/lodash.js"),l=r(u),c=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),d=r(c),f=[];t.findRepo=o,t.findAllRepos=a,t.findExistingRepos=i,t.findProjectRepos=s},"../../common/src/objects/finders/system-finder.js":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return e.findOne({schema:"global",table:"system",criteria:{},prefetch:!0}).then(function(e){return e||{}})}Object.defineProperty(t,"__esModule",{value:!0}),t.findSystem=void 0;var a=n("../../common/node_modules/lodash/lodash.js"),i=(r(a),n("../../common/node_modules/bluebird/js/browser/bluebird.js"));r(i);t.findSystem=o},"../../common/src/objects/types/resource-types.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["image","video","audio","website"];t.default=r,t.ResourceTypes=r},"../../common/src/routing/universal-link.js":function(e,t,n){"use strict";function r(e,t,n){var r=e.replace("://","/");return a+"/"+r+"/?ac="+n+"&p="+t}function o(e){var t=new RegExp("^"+a+"/([^/]+)/([^/]+)/\\?ac=([^&]+)&p=([^&]+)"),n=t.exec(e);return n?{address:n[1]+"://"+n[2],schema:n[4],activationCode:n[3]}:null}Object.defineProperty(t,"__esModule",{value:!0});var a="https://trambar.io";t.createActivationURL=r,t.parseActivationURL=o},"../../common/src/utils/focus-manager.js":function(e,t,n){"use strict";function r(e,t){u.unshift({component:e,props:t}),l=s.default.filter(l,function(n){return!s.default.isMatch(t,n)||(e.focus(),!1)})}function o(e){u=s.default.filter(u,function(t){return t.component!==e})}function a(e){var t=s.default.find(u,{props:e});t?t.component.focus():l.push(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.focus=t.unregister=t.register=void 0;var i=n("../../common/node_modules/lodash/lodash.js"),s=function(e){return e&&e.__esModule?e:{default:e}}(i),u=[],l=[];t.register=r,t.unregister=o,t.focus=a},"../../common/src/utils/konami-code.js":function(e,t,n){"use strict";function r(e){u.push(e),1===u.length&&window.addEventListener("keydown",a)}function o(e){s.default.pull(u,e),0===u.length&&window.removeEventListener("keydown",a)}function a(e){c.push(e.keyCode),c.length>l.length&&c.splice(0,c.length-l.length),s.default.isEqual(c,l)&&s.default.each(u,function(e){e({type:"cheat",target:t})})}Object.defineProperty(t,"__esModule",{value:!0}),t.removeListener=t.addListener=void 0;var i=n("../../common/node_modules/lodash/lodash.js"),s=function(e){return e&&e.__esModule?e:{default:e}}(i),u=[],l=[38,38,40,40,37,39,37,39,66,65],c=[];t.addListener=r,t.removeListener=o},"../../common/src/utils/link-parser.js":function(e,t,n){"use strict";function r(e){var t={},n=a.default.split(e,/[\r\n]+/);return a.default.each(n,function(e){var n=/^(\w+)\s*=\s*(.*)/.exec(e);if(n){var r=a.default.lowerCase(n[1]),o=a.default.trim(n[2]);t[r]=o}}),console.log(t),t.url?t:null}Object.defineProperty(t,"__esModule",{value:!0}),t.parse=void 0;var o=n("../../common/node_modules/lodash/lodash.js"),a=function(e){return e&&e.__esModule?e:{default:e}}(o);t.parse=r},"../../common/src/widgets/image-cropper.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t,n){e.left<0?e.left=0:e.left+e.width>t&&(e.left=t-e.width),e.top<0?e.top=0:e.top+e.height>n&&(e.top=n-e.height)}Object.defineProperty(t,"__esModule",{value:!0}),t.ImageCropper=t.default=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n("../../common/node_modules/lodash/lodash.js"),c=r(l),d=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),f=(r(d),n("../../common/node_modules/react/index.js")),p=r(f),h=n("../../common/node_modules/react-dom/index.js"),m=(r(h),n("../../common/node_modules/hammerjs/hammer.js")),v=r(m),g=n("../../common/src/utils/component-refs.js"),y=r(g),b=n("../../common/src/widgets/bitmap-view.jsx"),w=r(b),C=n("../../common/src/widgets/vector-view.jsx"),_=r(C);n("../../common/src/widgets/image-cropper.scss");var k=function(e){function t(e){o(this,t);var n=(e.clippingRect,a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)));return E.call(n),n.components=(0,y.default)({container:HTMLElement,image:w.default}),n.state={uncommittedClippingRect:null,hasFocus:!1},n}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props,t=e.url,n=e.disabled,r=e.vector,o=e.onLoad,a=this.state.hasFocus,i=this.components.setters,s=this.getClippingRect(),u={ref:i.container,className:"image-cropper"};n||(c.default.assign(u,{tabIndex:0,onMouseDown:this.handleMouseDown,onFocus:this.handleFocus,onBlur:this.handleBlur}),a&&c.default.assign(u,{onWheel:this.handleMouseWheel,onKeyDown:this.handleKeyDown}));var l={ref:i.image,url:t,clippingRect:s,onLoad:o},d=w.default;return r&&(d=_.default),p.default.createElement("div",u,p.default.createElement(d,l))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.clippingRect,r=this.state,o=r.hasFocus,a=r.uncommittedClippingRect;!t.hasFocus&&o?this.activateTouchHandling():t.hasFocus&&!o&&this.deactivateTouchHandling(),e.clippingRect!==n&&a&&c.default.isEqual(a,n)&&this.setState({uncommittedClippingRect:null})}},{key:"componentWillUnmount",value:function(){this.dragStart&&this.handleMouseUp(),this.zoomChangeTimeout&&(clearTimeout(this.zoomChangeTimeout),this.handleZoomTimeout()),this.deactivateTouchHandling()}},{key:"focus",value:function(){this.components.container.focus()}},{key:"getClippingRect",value:function(){var e=this.props.clippingRect;return this.state.uncommittedClippingRect||e}},{key:"activateTouchHandling",value:function(){var e=this.components.container;if(e&&!this.hammer){this.hammer=new v.default(e);var t=this.hammer.get("pan").set({direction:v.default.DIRECTION_ALL,threshold:5});this.hammer.get("pinch").set({enable:!0}).recognizeWith(t),this.hammer.on("panstart",this.handlePanStart),this.hammer.on("panmove",this.handlePanMove),this.hammer.on("panend",this.handlePanEnd),this.hammer.on("pinchstart",this.handlePinchStart),this.hammer.on("pinchmove",this.handlePinchMove),this.hammer.on("pinchend",this.handlePinchEnd)}}},{key:"deactivateTouchHandling",value:function(){this.hammer&&(this.hammer.off("panstart",this.handlePanStart),this.hammer.off("panmove",this.handlePanMove),this.hammer.off("panend",this.handlePanEnd),this.hammer.off("pinchstart",this.handlePinchStart),this.hammer.off("pinchmove",this.handlePinchMove),this.hammer.off("pinchend",this.handlePinchEnd),this.hammer.stop(!0),this.hammer.element.style.touchAction="",this.hammer.destroy(),this.hammer=null)}},{key:"triggerChangeEvent",value:function(){var e=this.props.onChange,t=this.state.uncommittedClippingRect;t&&e&&e({type:"change",target:this,rect:t})}}]),t}(f.PureComponent);k.displayName="ImageCropper";var E=function(){var e=this;this.handleFocus=function(t){e.setState({hasFocus:!0})},this.handleBlur=function(t){e.setState({hasFocus:!1})},this.handleMouseDown=function(t){var n=e.components,r=n.image,o=n.container,a=e.getClippingRect();if(0===t.button&&r&&o&&a){var i=o.getBoundingClientRect();e.dragStart={clippingRect:a,boundingRect:i,pageX:t.pageX,pageY:t.pageY,naturalWidth:r.naturalWidth,naturalHeight:r.naturalHeight},document.addEventListener("mousemove",e.handleMouseMove),document.addEventListener("mouseup",e.handleMouseUp)}},this.handleMouseMove=function(t){if(t.preventDefault(),e.dragStart){var n={x:e.dragStart.pageX-t.pageX,y:e.dragStart.pageY-t.pageY},r=e.dragStart.boundingRect,o=c.default.clone(e.dragStart.clippingRect),a=n.x*o.width/r.width,i=n.y*o.height/r.height;o.left+=Math.round(a),o.top+=Math.round(i),s(o,e.dragStart.naturalWidth,e.dragStart.naturalHeight),e.setState({uncommittedClippingRect:o})}},this.handleMouseUp=function(t){e.dragStart&&(document.removeEventListener("mousemove",e.handleMouseMove),document.removeEventListener("mouseup",e.handleMouseUp),e.triggerChangeEvent(),e.dragStart=null)},this.handleMouseWheel=function(t){var n=e.components,r=n.image,o=n.container,a=e.getClippingRect();if(t.preventDefault(),r&&o&&a){var i=4;t.shiftKey&&(i=1);var u=o.getBoundingClientRect(),l=void 0;switch(t.deltaMode){case 0:l=t.deltaY;break;case 1:l=18*t.deltaY;break;case 2:l=480*t.deltaY}var d=Math.round(l*a.height/u.height/i),f=a.width+d;f>r.naturalWidth&&(f=r.naturalWidth,d=f-a.width);var p=a.height+d;p>r.naturalHeight&&(p=r.naturalHeight,d=p-a.height,f=a.width+d);var h={x:t.pageX-u.left,y:t.pageY-u.top},m=-h.x*d/u.width,v=-h.y*d/u.height;a=c.default.clone(a),a.left+=Math.round(m),a.top+=Math.round(v),a.width=f,a.height=p,s(a,r.naturalWidth,r.naturalHeight),e.setState({uncommittedClippingRect:a},function(){e.zoomChangeTimeout&&clearTimeout(e.zoomChangeTimeout),e.zoomChangeTimeout=setTimeout(e.handleZoomTimeout,1e3)}),e.dragStart&&(e.dragStart={clippingRect:a,boundingRect:u,pageX:t.pageX,pageY:t.pageY,naturalWidth:r.naturalWidth,naturalHeight:r.naturalHeight})}},this.handleZoomTimeout=function(){e.triggerChangeEvent(),e.zoomChangeTimeout=0},this.handlePanStart=function(t){var n=e.components,r=n.image,o=n.container,a=e.state.clippingRect;if("mouse"!==t.pointerType&&r&&o&&a){var i=o.getBoundingClientRect();e.panStart={clippingRect:a,boundingRect:i,naturalWidth:r.naturalWidth,naturalHeight:r.naturalHeight},e.handlePanMove(t)}},this.handlePanMove=function(t){if(e.panStart){var n=e.panStart.boundingRect,r=c.default.clone(e.panStart.clippingRect),o=-t.deltaX*r.width/n.width,a=-t.deltaY*r.height/n.height;r.left+=Math.round(o),r.top+=Math.round(a),s(r,e.panStart.naturalWidth,e.panStart.naturalHeight),e.setState({uncommittedClippingRect:r})}},this.handlePanEnd=function(t){e.panStart&&(e.triggerChangeEvent(),e.panStart=null)},this.handlePinchStart=function(t){var n=e.components,r=n.image,o=n.container,a=e.getClippingRect();if("mouse"!==t.pointerType&&r&&o&&a){var i=o.getBoundingClientRect();e.pinchStart={clippingRect:a,boundingRect:i,pointers:c.default.map(t.pointers,function(e){return{pageX:e.pageX,pageY:e.pageY}})},e.handlePinchMove(t)}},this.handlePinchMove=function(t){var n=e.components.image;if(e.pinchStart){var r=c.default.clone(e.pinchStart.clippingRect),o=e.pinchStart.boundingRect,a=1/t.scale,i=Math.round(r.width*a);i>n.naturalWidth&&(i=n.naturalWidth,a=i/r.width);var u=Math.round(r.height*a);u>n.naturalHeight&&(u=n.naturalHeight,a=u/r.height,i=Math.round(r.width*a));var l={x:e.pinchStart.pointers[0].pageX-o.left,y:e.pinchStart.pointers[0].pageY-o.top},d={x:e.pinchStart.pointers[1].pageX-o.left,y:e.pinchStart.pointers[1].pageY-o.top},f={x:t.pointers[0].pageX-o.left,y:t.pointers[0].pageY-o.top},p={x:t.pointers[1].pageX-o.left,y:t.pointers[1].pageY-o.top},h=(l.x*r.width-f.x*i)/o.width,m=(d.x*r.width-p.x*i)/o.width,v=(l.y*r.height-f.y*u)/o.height,g=(d.y*r.height-p.y*u)/o.height;r.left+=Math.round((h+m)/2),r.top+=Math.round((v+g)/2),r.width=i,r.height=u,s(r,n.naturalWidth,n.naturalHeight),e.setState({uncommittedClippingRect:r})}},this.handlePinchEnd=function(t){e.pinchStart&&(e.triggerChangeEvent(),e.pinchStart=null)},this.handleKeyDown=function(t){var n=e.components.container;27===t.keyCode&&n.blur()}};k.defaultProps={vector:!1},t.default=k,t.ImageCropper=k},"../../common/src/widgets/image-cropper.scss":function(e,t){},"../node_modules/buffer/index.js":function(e,t,n){"use strict";(function(e){function r(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=a.prototype):(null===e&&(e=new a(t)),e.length=t),e}function a(e,t,n){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return l(this,e)}return i(this,e,t,n)}function i(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?f(e,t,n,r):"string"==typeof t?c(e,t,n):p(e,t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t,n,r){return s(t),t<=0?o(e,t):void 0!==n?"string"==typeof r?o(e,t).fill(n,r):o(e,t).fill(n):o(e,t)}function l(e,t){if(s(t),e=o(e,t<0?0:0|h(t)),!a.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function c(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!a.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|v(t,n);e=o(e,r);var i=e.write(t,n);return i!==r&&(e=e.slice(0,i)),e}function d(e,t){var n=t.length<0?0:0|h(t.length);e=o(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),a.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=a.prototype):e=d(e,t),e}function p(e,t){if(a.isBuffer(t)){var n=0|h(t.length);return e=o(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||K(t.length)?o(e,0):d(e,t);if("Buffer"===t.type&&Q(t.data))return d(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function h(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function m(e){return+e!=e&&(e=0),a.alloc(+e)}function v(e,t){if(a.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(e).length;default:if(r)return H(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return x(this,t,n);case"utf8":case"utf-8":return R(this,t,n);case"ascii":return T(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return P(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function b(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=a.from(t,r)),a.isBuffer(t))return 0===t.length?-1:w(e,t,n,r,o);if("number"==typeof t)return t&=255,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):w(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function w(e,t,n,r,o){function a(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}var i=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;i=2,s/=2,u/=2,n/=2}var l;if(o){var c=-1;for(l=n;l<s;l++)if(a(e,l)===a(t,-1===c?0:l-c)){if(-1===c&&(c=l),l-c+1===u)return c*i}else-1!==c&&(l-=l-c),c=-1}else for(n+u>s&&(n=s-u),l=n;l>=0;l--){for(var d=!0,f=0;f<u;f++)if(a(e,l+f)!==a(t,f)){d=!1;break}if(d)return l}return-1}function C(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var i=0;i<r;++i){var s=parseInt(t.substr(2*i,2),16);if(isNaN(s))return i;e[n+i]=s}return i}function _(e,t,n,r){return q(H(t,e.length-n),e,n,r)}function k(e,t,n,r){return q(Y(t),e,n,r)}function E(e,t,n,r){return k(e,t,n,r)}function j(e,t,n,r){return q(G(t),e,n,r)}function S(e,t,n,r){return q(X(t,e.length-n),e,n,r)}function P(e,t,n){return 0===t&&n===e.length?J.fromByteArray(e):J.fromByteArray(e.slice(t,n))}function R(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var a=e[o],i=null,s=a>239?4:a>223?3:a>191?2:1;if(o+s<=n){var u,l,c,d;switch(s){case 1:a<128&&(i=a);break;case 2:u=e[o+1],128==(192&u)&&(d=(31&a)<<6|63&u)>127&&(i=d);break;case 3:u=e[o+1],l=e[o+2],128==(192&u)&&128==(192&l)&&(d=(15&a)<<12|(63&u)<<6|63&l)>2047&&(d<55296||d>57343)&&(i=d);break;case 4:u=e[o+1],l=e[o+2],c=e[o+3],128==(192&u)&&128==(192&l)&&128==(192&c)&&(d=(15&a)<<18|(63&u)<<12|(63&l)<<6|63&c)>65535&&d<1114112&&(i=d)}}null===i?(i=65533,s=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),o+=s}return O(r)}function O(e){var t=e.length;if(t<=$)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=$));return n}function T(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function x(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",a=t;a<n;++a)o+=W(e[a]);return o}function D(e,t,n){for(var r=e.slice(t,n),o="",a=0;a<r.length;a+=2)o+=String.fromCharCode(r[a]+256*r[a+1]);return o}function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function I(e,t,n,r,o,i){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function B(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,a=Math.min(e.length-n,2);o<a;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function U(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,a=Math.min(e.length-n,4);o<a;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function L(e,t,n,r,o,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function N(e,t,n,r,o){return o||L(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),Z.write(e,t,n,r,23,4),n+4}function F(e,t,n,r,o){return o||L(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),Z.write(e,t,n,r,52,8),n+8}function V(e){if(e=z(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function z(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function W(e){return e<16?"0"+e.toString(16):e.toString(16)}function H(e,t){t=t||1/0;for(var n,r=e.length,o=null,a=[],i=0;i<r;++i){if((n=e.charCodeAt(i))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(i+1===r){(t-=3)>-1&&a.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&a.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function Y(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function X(e,t){for(var n,r,o,a=[],i=0;i<e.length&&!((t-=2)<0);++i)n=e.charCodeAt(i),r=n>>8,o=n%256,a.push(o),a.push(r);return a}function G(e){return J.toByteArray(V(e))}function q(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function K(e){return e!==e}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var J=n("../../common/node_modules/base64-js/index.js"),Z=n("../../common/node_modules/ieee754/index.js"),Q=n("../../common/node_modules/isarray/index.js");t.Buffer=a,t.SlowBuffer=m,t.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=r(),a.poolSize=8192,a._augment=function(e){return e.__proto__=a.prototype,e},a.from=function(e,t,n){return i(null,e,t,n)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(e,t,n){return u(null,e,t,n)},a.allocUnsafe=function(e){return l(null,e)},a.allocUnsafeSlow=function(e){return l(null,e)},a.isBuffer=function(e){return!(null==e||!e._isBuffer)},a.compare=function(e,t){if(!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Q(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=a.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var i=e[n];if(!a.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},a.byteLength=v,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},a.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?R(this,0,e):g.apply(this,arguments)},a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},a.prototype.compare=function(e,t,n,r,o){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,o>>>=0,this===e)return 0;for(var i=o-r,s=n-t,u=Math.min(i,s),l=this.slice(r,o),c=e.slice(t,n),d=0;d<u;++d)if(l[d]!==c[d]){i=l[d],s=c[d];break}return i<s?-1:s<i?1:0},a.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},a.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},a.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},a.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return C(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return k(this,e,t,n);case"latin1":case"binary":return E(this,e,t,n);case"base64":return j(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;a.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r;if(a.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=a.prototype;else{var o=t-e;r=new a(o,void 0);for(var i=0;i<o;++i)r[i]=this[i+e]}return r},a.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],o=1,a=0;++a<t&&(o*=256);)r+=this[e+a]*o;return r},a.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},a.prototype.readUInt8=function(e,t){return t||M(e,1,this.length),this[e]},a.prototype.readUInt16LE=function(e,t){return t||M(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUInt16BE=function(e,t){return t||M(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUInt32LE=function(e,t){return t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUInt32BE=function(e,t){return t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],o=1,a=0;++a<t&&(o*=256);)r+=this[e+a]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*t)),r},a.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=t,o=1,a=this[e+--r];r>0&&(o*=256);)a+=this[e+--r]*o;return o*=128,a>=o&&(a-=Math.pow(2,8*t)),a},a.prototype.readInt8=function(e,t){return t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){t||M(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(e,t){t||M(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(e,t){return t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return t||M(e,4,this.length),Z.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return t||M(e,4,this.length),Z.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return t||M(e,8,this.length),Z.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return t||M(e,8,this.length),Z.read(this,e,!1,52,8)},a.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){I(this,e,t,n,Math.pow(2,8*n)-1,0)}var o=1,a=0;for(this[t]=255&e;++a<n&&(o*=256);)this[t+a]=e/o&255;return t+n},a.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){I(this,e,t,n,Math.pow(2,8*n)-1,0)}var o=n-1,a=1;for(this[t+o]=255&e;--o>=0&&(a*=256);)this[t+o]=e/a&255;return t+n},a.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,1,255,0),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},a.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},a.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},a.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):U(this,e,t,!0),t+4},a.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},a.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);I(this,e,t,n,o-1,-o)}var a=0,i=1,s=0;for(this[t]=255&e;++a<n&&(i*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/i>>0)-s&255;return t+n},a.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);I(this,e,t,n,o-1,-o)}var a=n-1,i=1,s=0;for(this[t+a]=255&e;--a>=0&&(i*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/i>>0)-s&255;return t+n},a.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,1,127,-128),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},a.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},a.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):U(this,e,t,!0),t+4},a.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},a.prototype.writeFloatLE=function(e,t,n){return N(this,e,t,!0,n)},a.prototype.writeFloatBE=function(e,t,n){return N(this,e,t,!1,n)},a.prototype.writeDoubleLE=function(e,t,n){return F(this,e,t,!0,n)},a.prototype.writeDoubleBE=function(e,t,n){return F(this,e,t,!1,n)},a.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!a.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},a.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var i;if("number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var s=a.isBuffer(e)?e:H(new a(e,r).toString()),u=s.length;for(i=0;i<n-t;++i)this[i+t]=s[i%u]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,n("../node_modules/webpack/buildin/global.js"))},"../node_modules/jsmediatags/dist/jsmediatags.js":function(e,t,n){(function(t,n){var r,r;!function(t){e.exports=t()}(function(){return function e(t,n,o){function a(s,u){if(!n[s]){if(!t[s]){var l="function"==typeof r&&r;if(!u&&l)return r(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return a(n||e)},d,d.exports,e,t,n,o)}return n[s].exports}for(var i="function"==typeof r&&r,s=0;s<o.length;s++)a(o[s]);return a}({1:[function(e,t,n){},{}],2:[function(e,t,n){t.exports=XMLHttpRequest},{}],3:[function(e,n,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("./MediaFileReader"),l=function(e){function n(e){o(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t._array=e,t._size=e.length,t._isInitialized=!0,t}return i(n,e),s(n,[{key:"init",value:function(e){setTimeout(e.onSuccess,0)}},{key:"loadRange",value:function(e,t){setTimeout(t.onSuccess,0)}},{key:"getByteAt",value:function(e){if(e>=this._array.length)throw new Error("Offset "+e+" hasn't been loaded yet.");return this._array[e]}}],[{key:"canReadFile",value:function(e){return Array.isArray(e)||"function"==typeof t&&t.isBuffer(e)}}]),n}(u);n.exports=l},{"./MediaFileReader":11}],4:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./ChunkedFileData"),u=e("./MediaFileReader"),l=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._blob=e,n._fileData=new s,n}return a(t,e),i(t,[{key:"_init",value:function(e){this._size=this._blob.size,setTimeout(e.onSuccess,1)}},{key:"loadRange",value:function(e,t){var n=this,r=this._blob.slice||this._blob.mozSlice||this._blob.webkitSlice,o=r.call(this._blob,e[0],e[1]+1),a=new FileReader;a.onloadend=function(r){var o=new Uint8Array(a.result);n._fileData.addData(e[0],o),t.onSuccess()},a.onerror=a.onabort=function(e){t.onError&&t.onError({type:"blob",info:a.error})},a.readAsArrayBuffer(o)}},{key:"getByteAt",value:function(e){return this._fileData.getByteAt(e)}}],[{key:"canReadFile",value:function(e){return"undefined"!=typeof Blob&&e instanceof Blob||"undefined"!=typeof File&&e instanceof File}}]),t}(u);t.exports=l},{"./ChunkedFileData":5,"./MediaFileReader":11}],5:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){r(this,e),this._fileData=[]}return o(e,null,[{key:"NOT_FOUND",get:function(){return-1}}]),o(e,[{key:"addData",value:function(e,t){var n=e+t.length-1,r=this._getChunkRange(e,n);if(-1===r.startIx)this._fileData.splice(r.insertIx||0,0,{offset:e,data:t});else{var o=this._fileData[r.startIx],a=this._fileData[r.endIx],i=e>o.offset,s=n<a.offset+a.data.length-1,u={offset:Math.min(e,o.offset),data:t};if(i){var l=this._sliceData(o.data,0,e-o.offset);u.data=this._concatData(l,t)}if(s){var l=this._sliceData(u.data,0,a.offset-u.offset);u.data=this._concatData(l,a.data)}this._fileData.splice(r.startIx,r.endIx-r.startIx+1,u)}}},{key:"_concatData",value:function(e,t){if("undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(e)){var n=new e.constructor(e.length+t.length);return n.set(e,0),n.set(t,e.length),n}return e.concat(t)}},{key:"_sliceData",value:function(e,t,n){return e.slice?e.slice(t,n):e.subarray(t,n)}},{key:"_getChunkRange",value:function(e,t){for(var n=-1,r=-1,o=0,a=0;a<this._fileData.length;a++,o=a){var i=this._fileData[a].offset,s=i+this._fileData[a].data.length;if(t<i-1)break;if(e<=s+1&&t>=i-1){n=a;break}}if(-1===n)return{startIx:-1,endIx:-1,insertIx:o};for(var a=n;a<this._fileData.length;a++){var i=this._fileData[a].offset,s=i+this._fileData[a].data.length;if(t>=i-1&&(r=a),t<=s+1)break}return-1===r&&(r=n),{startIx:n,endIx:r}}},{key:"hasDataRange",value:function(e,t){for(var n=0;n<this._fileData.length;n++){var r=this._fileData[n];if(t<r.offset)return!1;if(e>=r.offset&&t<r.offset+r.data.length)return!0}return!1}},{key:"getByteAt",value:function(e){for(var t,n=0;n<this._fileData.length;n++){var r=this._fileData[n].offset,o=r+this._fileData[n].data.length-1;if(e>=r&&e<=o){t=this._fileData[n];break}}if(t)return t.data[e-t.offset];throw new Error("Offset "+e+" hasn't been loaded yet.")}}]),e}();t.exports=a},{}],6:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./MediaTagReader"),u=[4,132],l=[6,134],c=["Other","32x32 pixels 'file icon' (PNG only)","Other file icon","Cover (front)","Cover (back)","Leaflet page","Media (e.g. label side of CD)","Lead artist/lead performer/soloist","Artist/performer","Conductor","Band/Orchestra","Composer","Lyricist/text writer","Recording Location","During recording","During performance","Movie/video screen capture","A bright coloured fish","Illustration","Band/artist logotype","Publisher/Studio logotype"],d=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),i(t,[{key:"_loadData",value:function(e,t){var n=this;e.loadRange([4,7],{onSuccess:function(){n._loadBlock(e,4,t)}})}},{key:"_loadBlock",value:function(e,t,n){var r=this,o=e.getByteAt(t),a=e.getInteger24At(t+1,!0);if(-1!==u.indexOf(o)){var i=t+4;e.loadRange([i,i+a],{onSuccess:function(){r._commentOffset=i,r._nextBlock(e,t,o,a,n)}})}else if(-1!==l.indexOf(o)){var i=t+4;e.loadRange([i,i+a],{onSuccess:function(){r._pictureOffset=i,r._nextBlock(e,t,o,a,n)}})}else r._nextBlock(e,t,o,a,n)}},{key:"_nextBlock",value:function(e,t,n,r,o){var a=this;n>127?a._commentOffset?o.onSuccess():o.onError({type:"loadData",info:"Comment block could not be found."}):e.loadRange([t+4+r,t+4+4+r],{onSuccess:function(){a._loadBlock(e,t+4+r,o)}})}},{key:"_parseData",value:function(e,t){for(var n,r,o,a,i,s,u=e.getLongAt(this._commentOffset,!1),l=this._commentOffset+4,d=u+l,f=e.getLongAt(d,!1),p=d+4,h=0;h<f;h++){var m=e.getLongAt(p,!1),v=e.getStringWithCharsetAt(p+4,m,"utf-8").toString(),g=v.indexOf("="),y=[v.slice(0,g),v.slice(g+1)];switch(y[0]){case"TITLE":n=y[1];break;case"ARTIST":r=y[1];break;case"ALBUM":o=y[1];break;case"TRACKNUMBER":a=y[1];break;case"GENRE":i=y[1]}p+=4+m}if(this._pictureOffset){var b=e.getLongAt(this._pictureOffset,!0),w=this._pictureOffset+4,C=e.getLongAt(w,!0),_=w+4,k=e.getStringAt(_,C),E=_+C,j=e.getLongAt(E,!0),S=E+4,P=e.getStringWithCharsetAt(S,j,"utf-8").toString(),R=S+j+16,O=e.getLongAt(R,!0),T=R+4,A=e.getBytesAt(T,O,!0);s={format:k,type:c[b],description:P,data:A}}return{type:"FLAC",version:"1",tags:{title:n,artist:r,album:o,track:a,genre:i,picture:s}}}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:0,length:4}}},{key:"canReadTagFormat",value:function(e){return"fLaC"===String.fromCharCode.apply(String,e.slice(0,4))}}]),t}(s);t.exports=d},{"./MediaTagReader":12}],7:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./MediaTagReader"),u=(e("./MediaFileReader"),function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),i(t,[{key:"_loadData",value:function(e,t){var n=e.getSize();e.loadRange([n-128,n-1],t)}},{key:"_parseData",value:function(e,t){var n=e.getSize()-128,r=e.getStringWithCharsetAt(n+3,30).toString(),o=e.getStringWithCharsetAt(n+33,30).toString(),a=e.getStringWithCharsetAt(n+63,30).toString(),i=e.getStringWithCharsetAt(n+93,4).toString(),s=e.getByteAt(n+97+28),u=e.getByteAt(n+97+29);if(0==s&&0!=u)var c="1.1",d=e.getStringWithCharsetAt(n+97,28).toString();else{var c="1.0",d=e.getStringWithCharsetAt(n+97,30).toString();u=0}var f=e.getByteAt(n+97+30);if(f<255)var p=l[f];else var p="";var h={type:"ID3",version:c,tags:{title:r,artist:o,album:a,year:i,comment:d,genre:p}};return u&&(h.tags.track=u),h}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:-128,length:128}}},{key:"canReadTagFormat",value:function(e){return"TAG"===String.fromCharCode.apply(String,e.slice(0,3))}}]),t}(s)),l=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","AlternRock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychadelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk-Rock","National Folk","Swing","Fast Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","Acapella","Euro-House","Dance Hall"];t.exports=u},{"./MediaFileReader":11,"./MediaTagReader":12}],8:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){var t;switch(e){case 0:t="iso-8859-1";break;case 1:t="utf-16";break;case 2:t="utf-16be";break;case 3:t="utf-8";break;default:t="iso-8859-1"}return t}function a(e,t,n,r){var o=n.getStringWithCharsetAt(e+1,t-1,r),a=n.getStringWithCharsetAt(e+1+o.bytesReadCount,t-1-o.bytesReadCount);return{user_description:o.toString(),data:a.toString()}}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=(e("./MediaFileReader"),e("./StringUtils")),u=e("./ArrayFileReader"),l={BUF:"Recommended buffer size",CNT:"Play counter",COM:"Comments",CRA:"Audio encryption",CRM:"Encrypted meta frame",ETC:"Event timing codes",EQU:"Equalization",GEO:"General encapsulated object",IPL:"Involved people list",LNK:"Linked information",MCI:"Music CD Identifier",MLL:"MPEG location lookup table",PIC:"Attached picture",POP:"Popularimeter",REV:"Reverb",RVA:"Relative volume adjustment",SLT:"Synchronized lyric/text",STC:"Synced tempo codes",TAL:"Album/Movie/Show title",TBP:"BPM (Beats Per Minute)",TCM:"Composer",TCO:"Content type",TCR:"Copyright message",TDA:"Date",TDY:"Playlist delay",TEN:"Encoded by",TFT:"File type",TIM:"Time",TKE:"Initial key",TLA:"Language(s)",TLE:"Length",TMT:"Media type",TOA:"Original artist(s)/performer(s)",TOF:"Original filename",TOL:"Original Lyricist(s)/text writer(s)",TOR:"Original release year",TOT:"Original album/Movie/Show title",TP1:"Lead artist(s)/Lead performer(s)/Soloist(s)/Performing group",TP2:"Band/Orchestra/Accompaniment",TP3:"Conductor/Performer refinement",TP4:"Interpreted, remixed, or otherwise modified by",TPA:"Part of a set",TPB:"Publisher",TRC:"ISRC (International Standard Recording Code)",TRD:"Recording dates",TRK:"Track number/Position in set",TSI:"Size",TSS:"Software/hardware and settings used for encoding",TT1:"Content group description",TT2:"Title/Songname/Content description",TT3:"Subtitle/Description refinement",TXT:"Lyricist/text writer",TXX:"User defined text information frame",TYE:"Year",UFI:"Unique file identifier",ULT:"Unsychronized lyric/text transcription",WAF:"Official audio file webpage",WAR:"Official artist/performer webpage",WAS:"Official audio source webpage",WCM:"Commercial information",WCP:"Copyright/Legal information",WPB:"Publishers official webpage",WXX:"User defined URL link frame",AENC:"Audio encryption",APIC:"Attached picture",ASPI:"Audio seek point index",CHAP:"Chapter",CTOC:"Table of contents",COMM:"Comments",COMR:"Commercial frame",ENCR:"Encryption method registration",EQU2:"Equalisation (2)",EQUA:"Equalization",ETCO:"Event timing codes",GEOB:"General encapsulated object",GRID:"Group identification registration",IPLS:"Involved people list",LINK:"Linked information",MCDI:"Music CD identifier",MLLT:"MPEG location lookup table",OWNE:"Ownership frame",PRIV:"Private frame",PCNT:"Play counter",POPM:"Popularimeter",POSS:"Position synchronisation frame",RBUF:"Recommended buffer size",RVA2:"Relative volume adjustment (2)",RVAD:"Relative volume adjustment",RVRB:"Reverb",SEEK:"Seek frame",SYLT:"Synchronized lyric/text",SYTC:"Synchronized tempo codes",TALB:"Album/Movie/Show title",TBPM:"BPM (beats per minute)",TCOM:"Composer",TCON:"Content type",TCOP:"Copyright message",TDAT:"Date",TDLY:"Playlist delay",TDRC:"Recording time",TDRL:"Release time",TDTG:"Tagging time",TENC:"Encoded by",TEXT:"Lyricist/Text writer",TFLT:"File type",TIME:"Time",TIPL:"Involved people list",TIT1:"Content group description",TIT2:"Title/songname/content description",TIT3:"Subtitle/Description refinement",TKEY:"Initial key",TLAN:"Language(s)",TLEN:"Length",TMCL:"Musician credits list",TMED:"Media type",TMOO:"Mood",TOAL:"Original album/movie/show title",TOFN:"Original filename",TOLY:"Original lyricist(s)/text writer(s)",TOPE:"Original artist(s)/performer(s)",TORY:"Original release year",TOWN:"File owner/licensee",TPE1:"Lead performer(s)/Soloist(s)",TPE2:"Band/orchestra/accompaniment",TPE3:"Conductor/performer refinement",TPE4:"Interpreted, remixed, or otherwise modified by",TPOS:"Part of a set",TPRO:"Produced notice",TPUB:"Publisher",TRCK:"Track number/Position in set",TRDA:"Recording dates",TRSN:"Internet radio station name",TRSO:"Internet radio station owner",TSOA:"Album sort order",TSOP:"Performer sort order",TSOT:"Title sort order",TSIZ:"Size",TSRC:"ISRC (international standard recording code)",TSSE:"Software/Hardware and settings used for encoding",TSST:"Set subtitle",TYER:"Year",TXXX:"User defined text information frame",UFID:"Unique file identifier",USER:"Terms of use",USLT:"Unsychronized lyric/text transcription",WCOM:"Commercial information",WCOP:"Copyright/Legal information",WOAF:"Official audio file webpage",WOAR:"Official artist/performer webpage",WOAS:"Official audio source webpage",WORS:"Official internet radio station homepage",WPAY:"Payment",WPUB:"Publishers official webpage",WXXX:"User defined URL link frame"},c=function(){function e(){r(this,e)}return i(e,null,[{key:"getFrameReaderFunction",value:function(e){return e in d?d[e]:"T"===e[0]?d["T*"]:"W"===e[0]?d["W*"]:null}},{key:"readFrames",value:function(t,n,r,o,a){for(var i={},s=this._getFrameHeaderSize(o);t<n-s;){var u=this._readFrameHeader(r,t,o),l=u.id;if(!l)break;var c=u.flags,d=u.size,f=t+u.headerSize,p=r;if(t+=u.headerSize+u.size,!a||-1!==a.indexOf(l)){if("MP3e"===l||"\0MP3"===l||"\0\0MP"===l||" MP3"===l)break;c&&c.format.unsynchronisation&&(p=this.getUnsyncFileReader(p,f,d),f=0,d=p.getSize()),c&&c.format.data_length_indicator&&(f+=4,d-=4);var h=e.getFrameReaderFunction(l),m=h?h.apply(this,[f,d,p,c,o]):null,v=this._getFrameDescription(l),g={id:l,size:d,description:v,data:m};l in i?(i[l].id&&(i[l]=[i[l]]),i[l].push(g)):i[l]=g}}return i}},{key:"_getFrameHeaderSize",value:function(e){var t=e.major;return 2==t?6:3==t||4==t?10:0}},{key:"_readFrameHeader",value:function(e,t,n){var r=n.major,o=null,a=this._getFrameHeaderSize(n);switch(r){case 2:var i=e.getStringAt(t,3),s=e.getInteger24At(t+3,!0);break;case 3:var i=e.getStringAt(t,4),s=e.getLongAt(t+4,!0);break;case 4:var i=e.getStringAt(t,4),s=e.getSynchsafeInteger32At(t+4)}return i!=String.fromCharCode(0,0,0)&&i!=String.fromCharCode(0,0,0,0)||(i=""),i&&r>2&&(o=this._readFrameFlags(e,t+8)),{id:i||"",size:s||0,headerSize:a||0,flags:o}}},{key:"_readFrameFlags",value:function(e,t){return{message:{tag_alter_preservation:e.isBitSetAt(t,6),file_alter_preservation:e.isBitSetAt(t,5),read_only:e.isBitSetAt(t,4)},format:{grouping_identity:e.isBitSetAt(t+1,7),compression:e.isBitSetAt(t+1,3),encryption:e.isBitSetAt(t+1,2),unsynchronisation:e.isBitSetAt(t+1,1),data_length_indicator:e.isBitSetAt(t+1,0)}}}},{key:"_getFrameDescription",value:function(e){return e in l?l[e]:"Unknown"}},{key:"getUnsyncFileReader",value:function(e,t,n){for(var r=e.getBytesAt(t,n),o=0;o<r.length-1;o++)255===r[o]&&0===r[o+1]&&r.splice(o+1,1);return new u(r)}}]),e}(),d={};d.APIC=function(e,t,n,r,a){var i=e,s=o(n.getByteAt(e));switch(a&&a.major){case 2:var u=n.getStringAt(e+1,3);e+=4;break;case 3:case 4:var u=n.getStringWithCharsetAt(e+1,t-1);e+=1+u.bytesReadCount;break;default:throw new Error("Couldn't read ID3v2 major version.")}var l=n.getByteAt(e),c=f[l],d=n.getStringWithCharsetAt(e+1,t-(e-i)-1,s);return e+=1+d.bytesReadCount,{format:u.toString(),type:c,description:d.toString(),data:n.getBytesAt(e,i+t-e)}},d.CHAP=function(e,t,n,r,o){var a=e,i={},u=s.readNullTerminatedString(n.getBytesAt(e,t));i.id=u.toString(),e+=u.bytesReadCount,i.startTime=n.getLongAt(e,!0),e+=4,i.endTime=n.getLongAt(e,!0),e+=4,i.startOffset=n.getLongAt(e,!0),e+=4,i.endOffset=n.getLongAt(e,!0),e+=4;var l=t-(e-a);return i.subFrames=this.readFrames(e,e+l,n,o),i},d.CTOC=function(e,t,n,r,o){var a=e,i={childElementIds:[],id:void 0,topLevel:void 0,ordered:void 0,entryCount:void 0,subFrames:void 0},u=s.readNullTerminatedString(n.getBytesAt(e,t));i.id=u.toString(),e+=u.bytesReadCount,i.topLevel=n.isBitSetAt(e,1),i.ordered=n.isBitSetAt(e,0),e++,i.entryCount=n.getByteAt(e),e++;for(var l=0;l<i.entryCount;l++){var c=s.readNullTerminatedString(n.getBytesAt(e,t-(e-a)));i.childElementIds.push(c.toString()),e+=c.bytesReadCount}var d=t-(e-a);return i.subFrames=this.readFrames(e,e+d,n,o),i},d.COMM=function(e,t,n,r,a){var i=e,s=o(n.getByteAt(e)),u=n.getStringAt(e+1,3),l=n.getStringWithCharsetAt(e+4,t-4,s);e+=4+l.bytesReadCount;var c=n.getStringWithCharsetAt(e,i+t-e,s);return{language:u,short_description:l.toString(),text:c.toString()}},d.COM=d.COMM,d.PIC=function(e,t,n,r,o){return d.APIC(e,t,n,r,o)},d.PCNT=function(e,t,n,r,o){return n.getLongAt(e,!1)},d.CNT=d.PCNT,d["T*"]=function(e,t,n,r,a){var i=o(n.getByteAt(e));return n.getStringWithCharsetAt(e+1,t-1,i).toString()},d.TXXX=function(e,t,n,r,i){return a(e,t,n,o(n.getByteAt(e)))},d.WXXX=function(e,t,n,r,i){return 0===t?null:a(e,t,n,o(n.getByteAt(e)))},d["W*"]=function(e,t,n,r,o){return 0===t?null:n.getStringWithCharsetAt(e,t,"iso-8859-1").toString()},d.TCON=function(e,t,n,r){return d["T*"].apply(this,arguments).replace(/^\(\d+\)/,"")},d.TCO=d.TCON,d.USLT=function(e,t,n,r,a){var i=e,s=o(n.getByteAt(e)),u=n.getStringAt(e+1,3),l=n.getStringWithCharsetAt(e+4,t-4,s);e+=4+l.bytesReadCount;var c=n.getStringWithCharsetAt(e,i+t-e,s);return{language:u,descriptor:l.toString(),lyrics:c.toString()}},d.ULT=d.USLT,d.UFID=function(e,t,n,r,o){var a=s.readNullTerminatedString(n.getBytesAt(e,t));e+=a.bytesReadCount;var i=n.getBytesAt(e,t-a.bytesReadCount);return{ownerIdentifier:a.toString(),identifier:i}};var f=["Other","32x32 pixels 'file icon' (PNG only)","Other file icon","Cover (front)","Cover (back)","Leaflet page","Media (e.g. label side of CD)","Lead artist/lead performer/soloist","Artist/performer","Conductor","Band/Orchestra","Composer","Lyricist/text writer","Recording Location","During recording","During performance","Movie/video screen capture","A bright coloured fish","Illustration","Band/artist logotype","Publisher/Studio logotype"];t.exports=c},{"./ArrayFileReader":3,"./MediaFileReader":11,"./StringUtils":13}],9:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./MediaTagReader"),u=(e("./MediaFileReader"),e("./ID3v2FrameReader")),l=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),i(t,[{key:"_loadData",value:function(e,t){e.loadRange([6,9],{onSuccess:function(){e.loadRange([0,10+e.getSynchsafeInteger32At(6)-1],t)},onError:t.onError})}},{key:"_parseData",value:function(e,t){var n=0,r=e.getByteAt(n+3);if(r>4)return{type:"ID3",version:">2.4",tags:{}};var o=e.getByteAt(n+4),a=e.isBitSetAt(n+5,7),i=e.isBitSetAt(n+5,6),s=e.isBitSetAt(n+5,5),l=e.getSynchsafeInteger32At(n+6);if(n+=10,i){n+=e.getLongAt(n,!0)+4}var d={type:"ID3",version:"2."+r+"."+o,major:r,revision:o,flags:{unsynchronisation:a,extended_header:i,experimental_indicator:s,footer_present:!1},size:l,tags:{}};if(t)var f=this._expandShortcutTags(t);var p=l+10;d.flags.unsynchronisation&&(e=u.getUnsyncFileReader(e,n,l),n=0,p=e.getSize());var h=u.readFrames(n,p,e,d,f);for(var m in c)if(c.hasOwnProperty(m)){var v=this._getFrameData(h,c[m]);v&&(d.tags[m]=v)}for(var g in h)h.hasOwnProperty(g)&&(d.tags[g]=h[g]);return d}},{key:"_getFrameData",value:function(e,t){for(var n,r,o=0;r=t[o];o++)if(r in e)return n=e[r]instanceof Array?e[r][0]:e[r],n.data}},{key:"getShortcuts",value:function(){return c}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:0,length:10}}},{key:"canReadTagFormat",value:function(e){return"ID3"===String.fromCharCode.apply(String,e.slice(0,3))}}]),t}(s),c={title:["TIT2","TT2"],artist:["TPE1","TP1"],album:["TALB","TAL"],year:["TYER","TYE"],comment:["COMM","COM"],track:["TRCK","TRK"],genre:["TCON","TCO"],picture:["APIC","PIC"],lyrics:["USLT","ULT"]};t.exports=l},{"./ID3v2FrameReader":8,"./MediaFileReader":11,"./MediaTagReader":12}],10:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./MediaTagReader"),u=(e("./MediaFileReader"),function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),i(t,[{key:"_loadData",value:function(e,t){var n=this;e.loadRange([0,16],{onSuccess:function(){n._loadAtom(e,0,"",t)},onError:t.onError})}},{key:"_loadAtom",value:function(e,t,n,r){if(t>=e.getSize())return void r.onSuccess();var o=this,a=e.getLongAt(t,!0);if(0==a||isNaN(a))return void r.onSuccess();var i=e.getStringAt(t+4,4);if(this._isContainerAtom(i)){"meta"==i&&(t+=4);var s=(n?n+".":"")+i;"moov.udta.meta.ilst"===s?e.loadRange([t,t+a],r):e.loadRange([t+8,t+8+8],{onSuccess:function(){o._loadAtom(e,t+8,s,r)},onError:r.onError})}else e.loadRange([t+a,t+a+8],{onSuccess:function(){o._loadAtom(e,t+a,n,r)},onError:r.onError})}},{key:"_isContainerAtom",value:function(e){return["moov","udta","meta","ilst"].indexOf(e)>=0}},{key:"_canReadAtom",value:function(e){return"----"!==e}},{key:"_parseData",value:function(e,t){var n={};t=this._expandShortcutTags(t),this._readAtom(n,e,0,e.getSize(),t);for(var r in d)if(d.hasOwnProperty(r)){var o=n[d[r]];o&&(n[r]="track"===r?o.data.track:o.data)}return{type:"MP4",ftyp:e.getStringAt(8,4),version:e.getLongAt(12,!0),tags:n}}},{key:"_readAtom",value:function(e,t,n,r,o,a,i){i=void 0===i?"":i+"  ";for(var s=n;s<n+r;){var u=t.getLongAt(s,!0);if(0==u)return;var l=t.getStringAt(s+4,4);if(this._isContainerAtom(l)){"meta"==l&&(s+=4);var c=(a?a+".":"")+l;return void this._readAtom(e,t,s+8,u-8,o,c,i)}(!o||o.indexOf(l)>=0)&&"moov.udta.meta.ilst"===a&&this._canReadAtom(l)&&(e[l]=this._readMetadataAtom(t,s)),s+=u}}},{key:"_readMetadataAtom",value:function(e,t){var n,r=e.getLongAt(t,!0),o=e.getStringAt(t+4,4),a=e.getInteger24At(t+16+1,!0),i=l[a];if("trkn"==o)n={track:e.getByteAt(t+16+11),total:e.getByteAt(t+16+13)};else if("disk"==o)n={disk:e.getByteAt(t+16+11),total:e.getByteAt(t+16+13)};else{var n,s=t+24,u=r-24;switch("covr"===o&&"uint8"===i&&(i="jpeg"),i){case"text":n=e.getStringWithCharsetAt(s,u,"utf-8").toString();break;case"uint8":n=e.getShortAt(s,!1);break;case"int":case"uint":var d="int"==i?1==u?e.getSByteAt:2==u?e.getSShortAt:4==u?e.getSLongAt:e.getLongAt:1==u?e.getByteAt:2==u?e.getShortAt:e.getLongAt;n=d.call(e,s+(8==u?4:0),!0);break;case"jpeg":case"png":n={format:"image/"+i,data:e.getBytesAt(s,u)}}}return{id:o,size:r,description:c[o]||"Unknown",data:n}}},{key:"getShortcuts",value:function(){return d}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:0,length:16}}},{key:"canReadTagFormat",value:function(e){return"ftyp"===String.fromCharCode.apply(String,e.slice(4,8))}}]),t}(s)),l={0:"uint8",1:"text",13:"jpeg",14:"png",21:"int",22:"uint"},c={"alb":"Album","ART":"Artist",aART:"Album Artist","day":"Release Date","nam":"Title","gen":"Genre",gnre:"Genre",trkn:"Track Number","wrt":"Composer","too":"Encoding Tool","enc":"Encoded By",cprt:"Copyright",covr:"Cover Art","grp":"Grouping",keyw:"Keywords","lyr":"Lyrics","cmt":"Comment",tmpo:"Tempo",cpil:"Compilation",disk:"Disc Number",tvsh:"TV Show Name",tven:"TV Episode ID",tvsn:"TV Season",tves:"TV Episode",tvnn:"TV Network",desc:"Description",ldes:"Long Description",sonm:"Sort Name",soar:"Sort Artist",soaa:"Sort Album",soco:"Sort Composer",sosn:"Sort Show",purd:"Purchase Date",pcst:"Podcast",purl:"Podcast URL",catg:"Category",hdvd:"HD Video",stik:"Media Type",rtng:"Content Rating",pgap:"Gapless Playback",apID:"Purchase Account",sfID:"Country Code",atID:"Artist ID",cnID:"Catalog ID",plID:"Collection ID",geID:"Genre ID","xid ":"Vendor Information",flvr:"Codec Flavor"},d={title:"nam",artist:"ART",album:"alb",year:"day",comment:"cmt",track:"trkn",genre:"gen",picture:"covr",lyrics:"lyr"};t.exports=u},{"./MediaFileReader":11,"./MediaTagReader":12}],11:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e("./StringUtils"),i=function(){function e(t){r(this,e),this._isInitialized=!1,this._size=0}return o(e,[{key:"init",value:function(e){var t=this;if(!this._isInitialized)return this._init({onSuccess:function(){t._isInitialized=!0,e.onSuccess()},onError:e.onError});setTimeout(e.onSuccess,1)}},{key:"_init",value:function(e){throw new Error("Must implement init function")}},{key:"loadRange",value:function(e,t){throw new Error("Must implement loadRange function")}},{key:"getSize",value:function(){if(!this._isInitialized)throw new Error("init() must be called first.");return this._size}},{key:"getByteAt",value:function(e){throw new Error("Must implement getByteAt function")}},{key:"getBytesAt",value:function(e,t){for(var n=new Array(t),r=0;r<t;r++)n[r]=this.getByteAt(e+r);return n}},{key:"isBitSetAt",value:function(e,t){return 0!=(this.getByteAt(e)&1<<t)}},{key:"getSByteAt",value:function(e){var t=this.getByteAt(e);return t>127?t-256:t}},{key:"getShortAt",value:function(e,t){var n=t?(this.getByteAt(e)<<8)+this.getByteAt(e+1):(this.getByteAt(e+1)<<8)+this.getByteAt(e);return n<0&&(n+=65536),n}},{key:"getSShortAt",value:function(e,t){var n=this.getShortAt(e,t);return n>32767?n-65536:n}},{key:"getLongAt",value:function(e,t){var n=this.getByteAt(e),r=this.getByteAt(e+1),o=this.getByteAt(e+2),a=this.getByteAt(e+3),i=t?(((n<<8)+r<<8)+o<<8)+a:(((a<<8)+o<<8)+r<<8)+n;return i<0&&(i+=4294967296),i}},{key:"getSLongAt",value:function(e,t){var n=this.getLongAt(e,t);return n>2147483647?n-4294967296:n}},{key:"getInteger24At",value:function(e,t){var n=this.getByteAt(e),r=this.getByteAt(e+1),o=this.getByteAt(e+2),a=t?((n<<8)+r<<8)+o:((o<<8)+r<<8)+n;return a<0&&(a+=16777216),a}},{key:"getStringAt",value:function(e,t){for(var n=[],r=e,o=0;r<e+t;r++,o++)n[o]=String.fromCharCode(this.getByteAt(r));return n.join("")}},{key:"getStringWithCharsetAt",value:function(e,t,n){var r,o=this.getBytesAt(e,t);switch((n||"").toLowerCase()){case"utf-16":case"utf-16le":case"utf-16be":r=a.readUTF16String(o,"utf-16be"===n);break;case"utf-8":r=a.readUTF8String(o);break;default:r=a.readNullTerminatedString(o)}return r}},{key:"getCharAt",value:function(e){return String.fromCharCode(this.getByteAt(e))}},{key:"getSynchsafeInteger32At",value:function(e){var t=this.getByteAt(e),n=this.getByteAt(e+1),r=this.getByteAt(e+2);return 127&this.getByteAt(e+3)|(127&r)<<7|(127&n)<<14|(127&t)<<21}}],[{key:"canReadFile",value:function(e){throw new Error("Must implement canReadFile function")}}]),e}();t.exports=i},{"./StringUtils":13}],12:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=(e("./MediaFileReader"),function(){function e(t){r(this,e),this._mediaFileReader=t,this._tags=null}return o(e,[{key:"setTagsToRead",value:function(e){return this._tags=e,this}},{key:"read",value:function(e){var t=this;this._mediaFileReader.init({onSuccess:function(){t._loadData(t._mediaFileReader,{onSuccess:function(){try{var n=t._parseData(t._mediaFileReader,t._tags)}catch(t){if(e.onError)return void e.onError({type:"parseData",info:t.message})}e.onSuccess(n)},onError:e.onError})},onError:e.onError})}},{key:"getShortcuts",value:function(){return{}}},{key:"_loadData",value:function(e,t){throw new Error("Must implement _loadData function")}},{key:"_parseData",value:function(e,t){throw new Error("Must implement _parseData function")}},{key:"_expandShortcutTags",value:function(e){if(!e)return null;for(var t,n=[],r=this.getShortcuts(),o=0;t=e[o];o++)n=n.concat(r[t]||[t]);return n}}],[{key:"getTagIdentifierByteRange",value:function(){throw new Error("Must implement")}},{key:"canReadTagFormat",value:function(e){throw new Error("Must implement")}}]),e}());t.exports=a},{"./MediaFileReader":11}],13:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t,n){r(this,e),this._value=t,this.bytesReadCount=n,this.length=t.length}return o(e,[{key:"toString",value:function(){return this._value}}]),e}(),i={readUTF16String:function(e,t,n){var r=0,o=1,i=0;n=Math.min(n||e.length,e.length),254==e[0]&&255==e[1]?(t=!0,r=2):255==e[0]&&254==e[1]&&(t=!1,r=2),t&&(o=0,i=1);for(var s=[],u=0;r<n;u++){var l=e[r+o],c=e[r+i],d=(l<<8)+c;if(r+=2,0==d)break;if(l<216||l>=224)s[u]=String.fromCharCode(d);else{var f=e[r+o],p=e[r+i],h=(f<<8)+p;r+=2,s[u]=String.fromCharCode(d,h)}}return new a(s.join(""),r)},readUTF8String:function(e,t){var n=0;t=Math.min(t||e.length,e.length),239==e[0]&&187==e[1]&&191==e[2]&&(n=3);for(var r=[],o=0;n<t;o++){var i=e[n++];if(0==i)break;if(i<128)r[o]=String.fromCharCode(i);else if(i>=194&&i<224){var s=e[n++];r[o]=String.fromCharCode(((31&i)<<6)+(63&s))}else if(i>=224&&i<240){var s=e[n++],u=e[n++];r[o]=String.fromCharCode(((255&i)<<12)+((63&s)<<6)+(63&u))}else if(i>=240&&i<245){var s=e[n++],u=e[n++],l=e[n++],c=((7&i)<<18)+((63&s)<<12)+((63&u)<<6)+(63&l)-65536;r[o]=String.fromCharCode(55296+(c>>10),56320+(1023&c))}}return new a(r.join(""),n)},readNullTerminatedString:function(e,t){var n=[];t=t||e.length;for(var r=0;r<t;){var o=e[r++];if(0==o)break;n[r-1]=String.fromCharCode(o)}return new a(n.join(""),r)}};t.exports=i},{}],14:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./ChunkedFileData"),u=e("./MediaFileReader"),l=function(t){function n(e){r(this,n);var t=o(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t._url=e,t._fileData=new s,t}return a(n,t),i(n,[{key:"_init",value:function(e){n._config.avoidHeadRequests?this._fetchSizeWithGetRequest(e):this._fetchSizeWithHeadRequest(e)}},{key:"_fetchSizeWithHeadRequest",value:function(e){var t=this;this._makeXHRRequest("HEAD",null,{onSuccess:function(n){var r=t._parseContentLength(n);r?(t._size=r,e.onSuccess()):t._fetchSizeWithGetRequest(e)},onError:e.onError})}},{key:"_fetchSizeWithGetRequest",value:function(e){var t=this,n=this._roundRangeToChunkMultiple([0,0]);this._makeXHRRequest("GET",n,{onSuccess:function(n){var r=t._parseContentRange(n),o=t._getXhrResponseContent(n);if(r){if(null==r.instanceLength)return void t._fetchEntireFile(e);t._size=r.instanceLength}else t._size=o.length;t._fileData.addData(0,o),e.onSuccess()},onError:e.onError})}},{key:"_fetchEntireFile",value:function(e){var t=this;this._makeXHRRequest("GET",null,{onSuccess:function(n){var r=t._getXhrResponseContent(n);t._size=r.length,t._fileData.addData(0,r),e.onSuccess()},onError:e.onError})}},{key:"_getXhrResponseContent",value:function(e){return e.responseBody||e.responseText||""}},{key:"_parseContentLength",value:function(e){var t=this._getResponseHeader(e,"Content-Length");return null==t?t:parseInt(t,10)}},{key:"_parseContentRange",value:function(e){var t=this._getResponseHeader(e,"Content-Range");if(t){var n=t.match(/bytes (\d+)-(\d+)\/(?:(\d+)|\*)/i);if(!n)throw new Error("FIXME: Unknown Content-Range syntax: "+t);return{firstBytePosition:parseInt(n[1],10),lastBytePosition:parseInt(n[2],10),instanceLength:n[3]?parseInt(n[3],10):null}}return null}},{key:"loadRange",value:function(e,t){var n=this;if(n._fileData.hasDataRange(e[0],Math.min(n._size,e[1])))return void setTimeout(t.onSuccess,1);e=this._roundRangeToChunkMultiple(e),e[1]=Math.min(n._size,e[1]),this._makeXHRRequest("GET",e,{onSuccess:function(r){var o=n._getXhrResponseContent(r);n._fileData.addData(e[0],o),t.onSuccess()},onError:t.onError})}},{key:"_roundRangeToChunkMultiple",value:function(e){var t=e[1]-e[0]+1,n=1024*Math.ceil(t/1024);return[e[0],e[0]+n-1]}},{key:"_makeXHRRequest",value:function(e,t,r){var o=this._createXHRObject();o.open(e,this._url);var a=function(){200===o.status||206===o.status?r.onSuccess(o):r.onError&&r.onError({type:"xhr",info:"Unexpected HTTP status "+o.status+".",xhr:o}),o=null};void 0!==o.onload?(o.onload=a,o.onerror=function(){r.onError&&r.onError({type:"xhr",info:"Generic XHR error, check xhr object.",xhr:o})}):o.onreadystatechange=function(){4===o.readyState&&a()},n._config.timeoutInSec&&(o.timeout=1e3*n._config.timeoutInSec,o.ontimeout=function(){r.onError&&r.onError({type:"xhr",info:"Timeout after "+o.timeout/1e3+"s. Use jsmediatags.Config.setXhrTimeout to override.",xhr:o})}),o.overrideMimeType("text/plain; charset=x-user-defined"),t&&this._setRequestHeader(o,"Range","bytes="+t[0]+"-"+t[1]),this._setRequestHeader(o,"If-Modified-Since","Sat, 01 Jan 1970 00:00:00 GMT"),o.send(null)}},{key:"_setRequestHeader",value:function(e,t,r){n._config.disallowedXhrHeaders.indexOf(t.toLowerCase())<0&&e.setRequestHeader(t,r)}},{key:"_hasResponseHeader",value:function(e,t){var n=e.getAllResponseHeaders();if(!n)return!1;for(var r=n.split("\r\n"),o=[],a=0;a<r.length;a++)o[a]=r[a].split(":")[0].toLowerCase();return o.indexOf(t.toLowerCase())>=0}},{key:"_getResponseHeader",value:function(e,t){return this._hasResponseHeader(e,t)?e.getResponseHeader(t):null}},{key:"getByteAt",value:function(e){return 255&this._fileData.getByteAt(e).charCodeAt(0)}},{key:"_isWebWorker",value:function(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope}},{key:"_createXHRObject",value:function(){if("undefined"==typeof window&&!this._isWebWorker())return new(e("xhr2").XMLHttpRequest);if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;throw new Error("XMLHttpRequest is not supported")}}],[{key:"canReadFile",value:function(e){return"string"==typeof e&&/^[a-z]+:\/\//i.test(e)}},{key:"setConfig",value:function(e){for(var t in e)e.hasOwnProperty(t)&&(this._config[t]=e[t]);for(var n=this._config.disallowedXhrHeaders,r=0;r<n.length;r++)n[r]=n[r].toLowerCase()}}]),n}(u);l._config={avoidHeadRequests:!1,disallowedXhrHeaders:[],timeoutInSec:30},t.exports=l},{"./ChunkedFileData":5,"./MediaFileReader":11,xhr2:2}],15:[function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){new y(e).read(t)}function i(e,t){var n=e.offset>=0&&e.offset+e.length>=t,r=e.offset<0&&(-e.offset>t||e.offset+e.length>0);return!(n||r)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=(e("./MediaFileReader"),e("./NodeFileReader")),l=e("./XhrFileReader"),c=e("./BlobFileReader"),d=e("./ArrayFileReader"),f=(e("./MediaTagReader"),e("./ID3v1TagReader")),p=e("./ID3v2TagReader"),h=e("./MP4TagReader"),m=e("./FLACTagReader"),v=[],g=[],y=function(){function e(t){o(this,e),this._file=t}return s(e,[{key:"setTagsToRead",value:function(e){return this._tagsToRead=e,this}},{key:"setFileReader",value:function(e){return this._fileReader=e,this}},{key:"setTagReader",value:function(e){return this._tagReader=e,this}},{key:"read",value:function(e){var t=this._getFileReader(),n=new t(this._file),r=this;n.init({onSuccess:function(){r._getTagReader(n,{onSuccess:function(t){new t(n).setTagsToRead(r._tagsToRead).read(e)},onError:e.onError})},onError:e.onError})}},{key:"_getFileReader",value:function(){return this._fileReader?this._fileReader:this._findFileReader()}},{key:"_findFileReader",value:function(){for(var e=0;e<v.length;e++)if(v[e].canReadFile(this._file))return v[e];throw new Error("No suitable file reader found for "+this._file)}},{key:"_getTagReader",value:function(e,t){if(this._tagReader){var n=this._tagReader;setTimeout(function(){t.onSuccess(n)},1)}else this._findTagReader(e,t)}},{key:"_findTagReader",value:function(e,t){for(var n=[],r=[],o=e.getSize(),a=0;a<g.length;a++){var s=g[a].getTagIdentifierByteRange();i(s,o)&&(s.offset>=0&&s.offset<o/2||s.offset<0&&s.offset<-o/2?n.push(g[a]):r.push(g[a]))}var u=!1,l={onSuccess:function(){if(!u)return void(u=!0);for(var n=0;n<g.length;n++){var r=g[n].getTagIdentifierByteRange();if(i(r,o)){try{var a=e.getBytesAt(r.offset>=0?r.offset:r.offset+o,r.length)}catch(e){return void(t.onError&&t.onError({type:"fileReader",info:e.message}))}if(g[n].canReadTagFormat(a))return void t.onSuccess(g[n])}}t.onError&&t.onError({type:"tagFormat",info:"No suitable tag reader found"})},onError:t.onError};this._loadTagIdentifierRanges(e,n,l),this._loadTagIdentifierRanges(e,r,l)}},{key:"_loadTagIdentifierRanges",value:function(e,t,n){if(0===t.length)return void setTimeout(n.onSuccess,1);for(var r=[Number.MAX_VALUE,0],o=e.getSize(),a=0;a<t.length;a++){var i=t[a].getTagIdentifierByteRange(),s=i.offset>=0?i.offset:i.offset+o,u=s+i.length-1;r[0]=Math.min(s,r[0]),r[1]=Math.max(u,r[1])}e.loadRange(r,n)}}]),e}(),b=function(){function e(){o(this,e)}return s(e,null,[{key:"addFileReader",value:function(t){return v.push(t),e}},{key:"addTagReader",value:function(t){return g.push(t),e}},{key:"removeTagReader",value:function(t){var n=g.indexOf(t);return n>=0&&g.splice(n,1),e}},{key:"EXPERIMENTAL_avoidHeadRequests",value:function(){l.setConfig({avoidHeadRequests:!0})}},{key:"setDisallowedXhrHeaders",value:function(e){l.setConfig({disallowedXhrHeaders:e})}},{key:"setXhrTimeoutInSec",value:function(e){l.setConfig({timeoutInSec:e})}}]),e}();b.addFileReader(l).addFileReader(c).addFileReader(d).addTagReader(p).addTagReader(f).addTagReader(h).addTagReader(m),void 0===n||n.browser||b.addFileReader(u),t.exports={read:a,Reader:y,Config:b}},{"./ArrayFileReader":3,"./BlobFileReader":4,"./FLACTagReader":6,"./ID3v1TagReader":7,"./ID3v2TagReader":9,"./MP4TagReader":10,"./MediaFileReader":11,"./MediaTagReader":12,"./NodeFileReader":1,"./XhrFileReader":14}]},{},[15])(15)})}).call(t,n("../node_modules/buffer/index.js").Buffer,n("../node_modules/process/browser.js"))},"./dialogs/audio-capture-dialog-box-browser.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.AudioCaptureDialogBoxBrowser=t.default=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n("../../common/node_modules/lodash/lodash.js"),l=r(u),c=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),d=r(c),f=n("../../common/node_modules/react/index.js"),p=r(f),h=n("../../common/src/media/media-stream-utils.js"),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(h),v=n("../../common/src/widgets/overlay.jsx"),g=r(v),y=n("./widgets/push-button.jsx"),b=r(y),w=n("./widgets/device-placeholder.jsx"),C=r(w),_=n("./widgets/duration-indicator.jsx"),k=r(_);n("./dialogs/audio-capture-dialog-box-browser.scss");var E=n("../../common/src/transport/payloads.js"),j=(r(E),n("../../common/src/env/environment.js")),S=(r(j),function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.setLiveAudioNode=function(e){var t=n.state.liveAudioStream;n.audioNode=e,n.audioNode&&(n.audioNode.srcObject=t)},n.handleStartClick=function(e){var t=n.props.payloads;return n.beginRecording().then(function(e){return t.stream(e.outputStream),n.setState({mediaRecorder:e,startTime:new Date,duration:0}),null})},n.handlePauseClick=function(e){var t=n.state,r=t.startTime,o=t.duration;return n.pauseRecording().then(function(){var e=new Date;o+=e-r,n.setState({duration:o,startTime:null})})},n.handleResumeClick=function(e){return n.resumeRecording().then(function(){var e=new Date;n.setState({startTime:e})})},n.handleStopClick=function(e){var t=n.state,r=t.mediaRecorder,o=t.startTime,a=t.duration;return n.endRecording().then(function(){var e=r.outputStream.toBlob(),t=URL.createObjectURL(e),i=0;if(o){i=new Date-o}var s={format:l.default.last(l.default.split(r.mimeType,"/")),audioBitsPerSecond:r.audioBitsPerSecond,stream:r.outputStream,duration:a+i};n.setState({capturedAudio:s,previewURL:t,mediaRecorder:null})})},n.handleRerecordClick=function(e){n.clearCapturedAudio()},n.handleAcceptClick=function(e){var t=n.props.payloads,r=n.state.capturedAudio,o=t.add("audio");o.attachStream(r.stream);var a={type:"audio",payload_token:o.id,duration:r.duration,format:r.format,bitrates:{audio:r.audioBitsPerSecond}};n.triggerCloseEvent(),n.triggerCaptureEvent(a)},n.handleCancelClick=function(e){n.triggerCloseEvent()},n.state={liveAudioStream:null,liveAudioContext:null,liveAudioProcessor:null,liveAudioSource:null,liveAudioLevel:0,liveAudioError:null,liveAudioRecorder:null,mediaRecorder:null,capturedAudio:null,previewURL:null,startTime:null,duration:0},n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.props.show&&this.initializeMicrophone()}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.props.show;e.show!==n&&(e.show?(this.clearCapturedAudio(),this.initializeMicrophone()):setTimeout(function(){t.shutdownMicrophone(),t.clearCapturedAudio()},500))}},{key:"clearCapturedAudio",value:function(){var e=this.state,t=e.capturedAudio,n=e.previewURL;t&&(URL.revokeObjectURL(n),this.setState({capturedAudio:null,previewURL:null}))}},{key:"initializeMicrophone",value:function(){var e=this;this.createLiveAudioStream().then(function(t){e.setLiveAudioState(null,t)}).catch(function(t){e.setLiveAudioState(t,null)})}},{key:"shutdownMicrophone",value:function(){var e=this;this.destroyLiveAudioStream().then(function(){e.setLiveAudioState(null,null)})}},{key:"setLiveAudioState",value:function(e,t){var n=this,r=this.state,o=r.liveAudioSource,a=r.liveAudioProcessor,i=r.liveAudioContext,s=r.liveAudioLevel;a&&(o.disconnect(a),a.disconnect(i.destination));if(t){var u=new AudioContext,l=u.createScriptProcessor(4096,1,1),c=u.createMediaStreamSource(t);l.addEventListener("audioprocess",function(e){for(var t=e.inputBuffer.getChannelData(0),r=0,o=t.length,a=0;a<o;a++){var i=t[a];i>r&&(r=i)}var u=Math.round(100*r);u!==s&&n.setState({liveAudioLevel:u})}),c.connect(l),l.connect(u.destination)}this.setState({liveAudioStream:t,liveAudioContext:void 0,liveAudioProcessor:void 0,liveAudioSource:void 0,liveAudioError:e}),e&&console.error(e)}},{key:"render",value:function(){var e=this.props.show,t={show:e,onBackgroundClick:this.handleCancelClick};return p.default.createElement(g.default,t,p.default.createElement("div",{className:"audio-capture-dialog-box"},p.default.createElement("div",{className:"container"},this.renderView()),p.default.createElement("div",{className:"controls"},this.renderDuration(),this.renderButtons())))}},{key:"renderView",value:function(){var e=this.state,t=e.capturedAudio,n=e.liveAudioStream;return t?this.renderCapturedAudio():n?this.renderLiveAudio():this.renderPlaceholder()}},{key:"renderPlaceholder",value:function(){var e=this.state.liveAudioError,t={blocked:!!e,icon:"microphone"};return p.default.createElement(C.default,t)}},{key:"renderLiveAudio",value:function(){var e=this.state.liveAudioLevel,t={ref:this.setLiveAudioNode,autoPlay:!0,muted:!0},n=void 0;n=e<10?"volume-off":e<50?"volume-down":"volume-up";var r=e+"%";return p.default.createElement("div",null,p.default.createElement("div",{className:"volume-meter"},p.default.createElement("div",{className:"icon"},p.default.createElement("i",{className:"fa fa-"+n})),p.default.createElement("div",{className:"bar-container"},p.default.createElement("div",{className:"bar"},p.default.createElement("div",{className:"fill",style:{width:r}})))),p.default.createElement("audio",t))}},{key:"renderCapturedAudio",value:function(){var e=this.state.previewURL,t={src:e,controls:!0};return p.default.createElement("audio",t)}},{key:"renderDuration",value:function(){var e=this.state,t=e.mediaRecorder,n=e.duration,r=e.startTime;if(!t)return null;var o={duration:n,startTime:r};return p.default.createElement(k.default,o)}},{key:"renderButtons",value:function(){var e=this.props.env,t=this.state,n=t.mediaRecorder,r=t.capturedAudio,o=t.liveAudioStream,a=e.locale.t;if(n){var i="paused"===n.state,s={label:a("audio-capture-pause"),onClick:this.handlePauseClick,hidden:i},u={label:a("audio-capture-resume"),onClick:this.handleResumeClick,hidden:!i,emphasized:!0},l={label:a("audio-capture-stop"),onClick:this.handleStopClick,emphasized:!i};return p.default.createElement("div",{className:"buttons"},p.default.createElement(b.default,s),p.default.createElement(b.default,u),p.default.createElement(b.default,l))}if(r){var c={label:a("audio-capture-rerecord"),onClick:this.handleRerecordClick},d={label:a("audio-capture-accept"),onClick:this.handleAcceptClick,emphasized:!0};return p.default.createElement("div",{className:"buttons"},p.default.createElement(b.default,c),p.default.createElement(b.default,d))}var f={label:a("audio-capture-cancel"),onClick:this.handleCancelClick},h={label:a("audio-capture-start"),onClick:this.handleStartClick,disabled:!o,emphasized:!0};return p.default.createElement("div",{className:"buttons"},p.default.createElement(b.default,f),p.default.createElement(b.default,h))}},{key:"componentWillUnmount",value:function(){this.destroyLiveAudioStream()}},{key:"createLiveAudioStream",value:function(){return this.audioStreamPromise||(this.audioStreamPromise=m.getAudioStream()),this.audioStreamPromise}},{key:"destroyLiveAudioStream",value:function(){if(!this.audioStreamPromise)return d.default.resolve();var e=this.audioStreamPromise;return this.audioStreamPromise=null,e.then(function(e){m.stopAllTracks(e)})}},{key:"beginRecording",value:function(){var e=this.props.payloads,t=this.state.liveAudioStream;return d.default.try(function(){var n={audioBitsPerSecond:128e3,mimeType:"audio/webm"},r=new MediaRecorder(t,n),o=e.stream();return r.promise=new d.default(function(e,t){r.resolve=e,r.reject=t}),r.outputStream=o,r.addEventListener("dataavailable",function(e){o.push(e.data)}),r.addEventListener("stop",function(e){o.close(),r.resolve()}),r.start(3e3),o.start(),r})}},{key:"pauseRecording",value:function(){var e=this.state.mediaRecorder;return d.default.try(function(){e&&e.pause()})}},{key:"resumeRecording",value:function(){var e=this.state.mediaRecorder;return d.default.try(function(){e&&e.resume()})}},{key:"endRecording",value:function(){var e=this.state.mediaRecorder;return d.default.try(function(){if(e)return e.stop(),e.promise})}},{key:"triggerCaptureEvent",value:function(e){var t=this.props.onCapture;t&&t({type:"capture",target:this,resource:e})}},{key:"triggerCloseEvent",value:function(){var e=this.props.onClose;e&&e({type:"close",target:this})}}]),t}(f.PureComponent));S.displayName="AudioCaptureDialogBoxBrowser",t.default=S,t.AudioCaptureDialogBoxBrowser=S},"./dialogs/audio-capture-dialog-box-browser.scss":function(e,t){},"./dialogs/audio-capture-dialog-box-cordova.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(){var e=cordova.plugins.permissions;return e&&"android"===cordova.platformId?new p.default(function(t,n){var r=function(){t()},o=function(e){n(new Error("Unable to obtain permission"))};e.requestPermissions([e.RECORD_AUDIO,e.READ_EXTERNAL_STORAGE,e.WRITE_EXTERNAL_STORAGE],r,o)}):p.default.resolve()}Object.defineProperty(t,"__esModule",{value:!0}),t.AudioCaptureDialogBoxCordova=t.default=void 0;var u=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n("../../common/node_modules/lodash/lodash.js"),d=r(c),f=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),p=r(f),h=n("../../common/node_modules/react/index.js"),m=(r(h),n("../../common/src/media/media-loader.js")),v=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(m),g=n("../../common/src/transport/cordova-file.js"),y=r(g),b=n("../../common/src/transport/payloads.js"),w=(r(b),n("../../common/src/env/environment.js")),C=(r(w),function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;if(!this.props.show&&e.show){var n=navigator.device.capture;n&&s().then(function(){var e={duration:54e3,limit:1};n.captureAudio(t.handleCaptureSuccess,t.handleCaptureFailure,e)})}}},{key:"render",value:function(){return null}},{key:"triggerCloseEvent",value:function(){var e=this.props.onClose;e&&e({type:"close",target:this})}},{key:"triggerCaptureEvent",value:function(e){var t=this.props.onCapture;t&&t({type:"capture",target:this,resource:e})}},{key:"triggerCapturePendingEvent",value:function(){var e=this.props.onCapturePending;e&&e({type:"capturepending",target:this,resourceType:"audio"})}},{key:"triggerCaptureErrorEvent",value:function(e){var t=this.props.onCaptureError;t&&t({type:"capturefailure",target:this,error:e})}},{key:"handleCaptureSuccess",value:function(e){var t=this,n=this.props.payloads;this.triggerCloseEvent();var r=e[0];r&&(this.triggerCapturePendingEvent(),v.getFormatData(r).then(function(e){var o=new y.default(r.fullPath),a=d.default.split(r.type,"/"),i=u(a,2),s=(i[0],i[1]),l=n.add("audio");l.attachFile(o);var c={type:"audio",payload_token:l.id,format:s,width:e.width,height:e.height,filename:r.name,duration:1e3*e.duration};return t.triggerCaptureEvent(c),null}).catch(function(e){return t.triggerCaptureErrorEvent(e),null}))}},{key:"handleCaptureFailure",value:function(e){this.triggerCloseEvent(),this.triggerCaptureErrorEvent(e)}}]),t}(h.PureComponent));C.displayName="AudioCaptureDialogBoxCordova",t.default=C,t.AudioCaptureDialogBoxCordova=C},"./dialogs/confirmation-dialog-box.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmationDialogBox=t.default=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n("../../common/node_modules/react/index.js"),l=r(u),c=n("../../common/src/widgets/overlay.jsx"),d=r(c),f=n("./widgets/push-button.jsx"),p=r(f);n("./dialogs/confirmation-dialog-box.scss");var h=n("../../common/src/env/environment.js"),m=(r(h),function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.show,n=e.onClose,r={show:t,onBackgroundClick:n};return l.default.createElement(d.default,r,l.default.createElement("div",{className:"confirmation-dialog-box"},this.renderMessage(),this.renderButtons()))}},{key:"renderMessage",value:function(){var e=this.props.children;return l.default.createElement("div",{className:"message"},e)}},{key:"renderButtons",value:function(){var e=this.props,t=e.env,n=e.onClose,r=e.onConfirm,o=t.locale.t,a={label:o("confirmation-cancel"),onClick:n,hidden:!n},i={label:o("confirmation-confirm"),onClick:r,hidden:!r,emphasized:!0};return l.default.createElement("div",{className:"buttons"},l.default.createElement(p.default,a),l.default.createElement(p.default,i))}}]),t}(u.PureComponent));m.displayName="ConfirmationDialogBox",t.default=m,t.ConfirmationDialogBox=m},"./dialogs/confirmation-dialog-box.scss":function(e,t){},"./dialogs/mobile-setup-dialog-box.jsx":function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){if(!e)return e;var t=e.match(/.{1,4}/g);return _.toUpper(t.join(" "))}Object.defineProperty(t,"__esModule",{value:!0}),t.MobileSetupDialogBox=t.default=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n("../../common/node_modules/react/index.js"),d=o(c),f=n("../../common/node_modules/relaks/index.js"),p=n("../../common/src/routing/universal-link.js"),h=r(p),m=n("../../common/src/objects/finders/device-finder.js"),v=r(m),g=n("../../common/src/objects/finders/user-finder.js"),y=r(g),b=n("../../common/src/widgets/overlay.jsx"),w=o(b),C=n("./widgets/push-button.jsx"),k=o(C),E=n("./widgets/qr-code.jsx"),j=o(E);n("./dialogs/mobile-setup-dialog-box.scss");var S=n("../../common/src/data/database.js"),P=(o(S),n("../../common/src/env/environment.js")),R=(o(P),function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),l(t,[{key:"render",value:function(){var e=this.props,t=e.show,n=e.onClose,r={show:t,onBackgroundClick:n},o=_.omit(this.props,"show");return d.default.createElement(w.default,r,d.default.createElement(O,o))}}]),t}(c.PureComponent));R.displayName="MobileSetupDialogBox";var O=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),l(t,[{key:"renderAsync",value:function(e){var t=this.props,n=t.database,r=t.env,o=t.system,a=t.onClose,i=n.use({by:this}),s={activationCode:void 0,currentUser:void 0,devices:void 0,system:o,database:n,env:r,onClose:a};return e.show(d.default.createElement(T,s)),i.start().then(function(e){return y.findUser(i,e).then(function(e){s.currentUser=e})}).then(function(){return i.beginMobileSession("client").then(function(e){s.activationCode=e})}).then(function(){return v.findUserDevices(i,s.currentUser).then(function(e){s.devices=e})}).then(function(){return d.default.createElement(T,s)})}},{key:"componentWillUnmount",value:function(){this.props.database.use({by:this}).releaseMobileSession()}}]),t}(f.AsyncComponent);O.displayName="MobileSetupForm";var T=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),l(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.devices,r=t.onClose;if(e.devices!==n){var o=e.activationCode;o&&_.some(e.devices,{session_handle:o})&&r&&r({type:"close",target:this})}}},{key:"render",value:function(){var e=this.props,t=e.database,n=e.env,r=e.system,o=e.activationCode,a=e.onClose,i=n.locale.t,s=t.context,l=s.address,c=s.schema,f=_.get(r,"settings.address");f||(l=f);var p=void 0;o&&(p=h.createActivationURL(l,c,o),console.log(p));var m={label:i("mobile-setup-close"),emphasized:!0,onClick:a};return d.default.createElement("div",{className:"mobile-setup-dialog-box"},d.default.createElement("div",{className:"contents"},d.default.createElement(j.default,{text:p,scale:6}),d.default.createElement("div",{className:"info"},d.default.createElement("div",{className:"label"},i("mobile-setup-address")),d.default.createElement("div",{className:"value"},l),d.default.createElement("div",{className:"label"},i("mobile-setup-code")),d.default.createElement("div",{className:"value"},u(o)),d.default.createElement("div",{className:"label"},i("mobile-setup-project")),d.default.createElement("div",{className:"value"},c))),d.default.createElement("div",{className:"buttons"},d.default.createElement(k.default,m)))}}]),t}(c.PureComponent);T.displayName="MobileSetupFormSyncSync",t.default=R,t.MobileSetupDialogBox=R},"./dialogs/mobile-setup-dialog-box.scss":function(e,t){},"./dialogs/photo-capture-dialog-box-browser.jsx":function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoCaptureDialogBoxBrowser=t.default=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n("../../common/node_modules/lodash/lodash.js"),c=o(l),d=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),f=o(d),p=n("../../common/node_modules/react/index.js"),h=o(p),m=n("../../common/src/media/frame-grabber.js"),v=r(m),g=n("../../common/src/media/media-stream-utils.js"),y=r(g),b=n("../../common/src/transport/blob-manager.js"),w=r(b),C=n("../../common/src/widgets/overlay.jsx"),_=o(C),k=n("./widgets/push-button.jsx"),E=o(k),j=n("./widgets/device-selector.jsx"),S=o(j),P=n("./widgets/device-placeholder.jsx"),R=o(P);n("./dialogs/photo-capture-dialog-box-browser.scss");var O=n("../../common/src/transport/payloads.js"),T=(o(O),n("../../common/src/env/environment.js")),A=(o(T),function(e){function t(e){a(this,t);var n=e.env,r=e.cameraDirection,o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));o.setLiveVideoNode=function(e){var t=o.state,n=t.liveVideoStream,r=t.liveVideoWidth,a=t.liveVideoHeight;o.videoNode=e,o.videoNode&&(o.videoNode.srcObject=n,o.videoNode.play(),y.getActualVideoDimensions(e,function(e){r===e.width&&a===e.height||o.setState({liveVideoWidth:e.width,liveVideoHeight:e.height})}))},o.handleSnapClick=function(e){o.captureImage().then(function(e){o.setState({capturedImage:e})}).catch(function(e){console.error(e)})},o.handleRetakeClick=function(e){var t=o.state.capturedImage;w.release(t.blob),o.setState({capturedImage:null})},o.handleAcceptClick=function(e){var t=o.props.payloads,n=o.state.capturedImage,r=t.add("image");r.attachFile(n.blob);var a={type:"image",payload_token:r.id,width:n.width,height:n.height,format:"jpeg"};o.triggerCloseEvent(!0),o.triggerCaptureEvent(a)},o.handleCancelClick=function(e){o.triggerCloseEvent(!1)},o.handleDeviceSelect=function(e){var t=e.currentTarget.value;o.setState({selectedDeviceID:t},function(){o.reinitializeCamera()})};var s=S.default.choose(n.devices,"video",r);return o.state={liveVideoStream:null,liveVideoError:null,liveVideoWidth:640,liveVideoHeight:480,capturedImage:null,selectedDeviceID:s?s.deviceID:null},o}return s(t,e),u(t,[{key:"componentWillMount",value:function(){this.props.show&&this.initializeCamera()}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.props.show;e.show!==n&&(e.show?(this.setState({capturedImage:null}),this.initializeCamera()):setTimeout(function(){t.shutdownCamera(),t.setState({capturedImage:null})},500))}},{key:"initializeCamera",value:function(){var e=this;this.createLiveVideoStream().then(function(t){var n=y.getVideoDimensions(t);e.setState({liveVideoStream:t,liveVideoError:null,liveVideoWidth:n.width,liveVideoHeight:n.height})}).catch(function(t){console.error(t),e.setState({liveVideoStream:null,liveVideoError:t})})}},{key:"shutdownCamera",value:function(){var e=this;this.destroyLiveVideoStream().then(function(){e.setState({liveVideoStream:null,liveVideoError:null})})}},{key:"reinitializeCamera",value:function(){var e=this;this.destroyLiveVideoStream().then(function(){e.initializeCamera()})}},{key:"render",value:function(){var e=this.props.show,t={show:e,onBackgroundClick:this.handleCancelClick};return h.default.createElement(_.default,t,h.default.createElement("div",{className:"photo-capture-dialog-box"},h.default.createElement("div",{className:"container"},this.renderView()),h.default.createElement("div",{className:"controls"},this.renderDeviceSelector(),this.renderButtons())))}},{key:"renderView",value:function(){var e=this.state,t=e.capturedImage,n=e.liveVideoStream;return t?this.renderCapturedImage():n?this.renderLiveVideo():this.renderPlaceholder()}},{key:"renderPlaceholder",value:function(){var e=this.state.liveVideoError,t={blocked:!!e,icon:"camera"};return h.default.createElement(R.default,t)}},{key:"renderLiveVideo",value:function(){var e={ref:this.setLiveVideoNode,className:"live-video",muted:!0};return h.default.createElement("div",null,this.renderSpacer(),h.default.createElement("video",e))}},{key:"renderSpacer",value:function(){var e=this.state,t=e.liveVideoWidth,n=e.liveVideoHeight,r={className:"spacer",width:t,height:n};return h.default.createElement("canvas",r)}},{key:"renderCapturedImage",value:function(){var e=this.state.capturedImage,t={className:"preview",src:e.url};return h.default.createElement("div",null,this.renderSpacer(),h.default.createElement("img",t))}},{key:"renderDeviceSelector",value:function(){var e=this.props.env,t=this.state,n=t.capturedImage,r=t.selectedDeviceID;if(n)return null;var o={type:"video",selectedDeviceID:r,env:e,onSelect:this.handleDeviceSelect};return h.default.createElement(S.default,o)}},{key:"renderButtons",value:function(){var e=this.props.env,t=this.state,n=t.capturedImage,r=t.liveVideoStream,o=e.locale.t;if(n){var a={label:o("photo-capture-retake"),onClick:this.handleRetakeClick},i={label:o("photo-capture-accept"),onClick:this.handleAcceptClick,emphasized:!0};return h.default.createElement("div",{className:"buttons"},h.default.createElement(E.default,a),h.default.createElement(E.default,i))}var s={label:o("photo-capture-cancel"),onClick:this.handleCancelClick},u={label:o("photo-capture-snap"),onClick:this.handleSnapClick,disabled:!r,emphasized:!0};return h.default.createElement("div",{className:"buttons"},h.default.createElement(E.default,s),h.default.createElement(E.default,u))}},{key:"componentDidUpdate",value:function(e,t){var n=this,r=this.props.env,o=this.state,a=o.liveVideoStream,i=o.selectedDeviceID;this.videoNode&&t.liveVideoStream!==a&&this.setLiveVideoNode(this.videoNode),r.devices!==e.env.devices&&i&&(c.default.some(r.devices,{deviceID:i})||this.setState({selectedDeviceID:null},function(){n.reinitializeCamera()}))}},{key:"componentWillUnmount",value:function(){this.destroyLiveVideoStream()}},{key:"createLiveVideoStream",value:function(){var e=this.state.selectedDeviceID;return this.videoStreamPromise||(this.videoStreamPromise=y.getSilentVideoStream(e)),this.videoStreamPromise}},{key:"destroyLiveVideoStream",value:function(){if(!this.videoStreamPromise)return f.default.resolve();var e=this.videoStreamPromise;return this.videoStreamPromise=null,e.then(function(e){y.stopAllTracks(e)})}},{key:"captureImage",value:function(){var e=this.videoNode;return v.capture(e).then(function(t){return{url:w.manage(t),blob:t,width:e.videoWidth,height:e.videoHeight}})}},{key:"triggerCaptureEvent",value:function(e){var t=this.props.onCapture;t&&t({type:"capture",target:this,resource:e})}},{key:"triggerCloseEvent",value:function(){var e=this.props.onClose;e&&e({type:"close",target:this})}}]),t}(p.PureComponent));A.displayName="PhotoCaptureDialogBoxBrowser",t.default=A,t.PhotoCaptureDialogBoxBrowser=A},"./dialogs/photo-capture-dialog-box-browser.scss":function(e,t){},"./dialogs/photo-capture-dialog-box-cordova.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoCaptureDialogBoxCordova=t.default=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n("../../common/node_modules/lodash/lodash.js"),l=(r(u),n("../../common/node_modules/bluebird/js/browser/bluebird.js")),c=(r(l),n("../../common/node_modules/react/index.js")),d=(r(c),n("../../common/src/media/media-loader.js")),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(d),p=n("../../common/src/transport/cordova-file.js"),h=r(p),m=n("../../common/src/transport/payloads.js"),v=(r(m),n("../../common/src/env/environment.js")),g=(r(v),function(e){function t(){var e,n,r,i;o(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.handleCaptureSuccess=function(e){var t=r.props.payloads,n=new h.default(e);r.triggerCloseEvent(),r.triggerCapturePendingEvent(),n.obtainMetadata().then(function(){return f.getImageMetadata(n).then(function(e){var o=t.add("image").attachFile(n),a={type:"image",payload_token:o.id,format:e.format,width:e.width,height:e.height};return r.triggerCaptureEvent(a),null})}).catch(function(e){return r.triggerCaptureErrorEvent(e),null})},r.handleCaptureFailure=function(e){r.triggerCloseEvent()},i=n,a(r,i)}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props.show;if(e.show&&!t){var n=navigator.camera;if(n){var r=void 0;"front"===e.cameraDirection?r=Camera.Direction.FRONT:"back"===e.cameraDirection&&(r=Camera.Direction.BACK);var o={quality:50,destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.CAMERA,encodingType:Camera.EncodingType.JPEG,mediaType:Camera.MediaType.PICTURE,cameraDirection:r,allowEdit:!1};n.getPicture(this.handleCaptureSuccess,this.handleCaptureFailure,o)}}}},{key:"render",value:function(){return null}},{key:"triggerCloseEvent",value:function(){var e=this.props.onClose;e&&e({type:"close",target:this})}},{key:"triggerCaptureEvent",value:function(e){var t=this.props.onCapture;t&&t({type:"capture",target:this,resource:e})}},{key:"triggerCapturePendingEvent",value:function(){var e=this.props.onCapturePending;e&&e({type:"capturepending",target:this,resourceType:"image"})}},{key:"triggerCaptureErrorEvent",value:function(e){var t=this.props.onCaptureError;t&&t({type:"capturefailure",target:this,error:e})}}]),t}(c.PureComponent));g.displayName="PhotoCaptureDialogBoxCordova",t.default=g,t.PhotoCaptureDialogBoxCordova=g},"./dialogs/project-description-dialog-box.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectDescriptionDialogBox=t.default=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n("../../common/node_modules/lodash/lodash.js"),l=r(u),c=n("../../common/node_modules/react/index.js"),d=r(c),f=n("../../common/src/widgets/overlay.jsx"),p=r(f),h=n("./widgets/push-button.jsx"),m=r(h),v=n("../../common/src/widgets/resource-view.jsx"),g=r(v),y=n("./widgets/scrollable.jsx"),b=r(y);n("./dialogs/project-description-dialog-box.scss");var w=n("../../common/src/env/environment.js"),C=(r(w),function(e){function t(){var e,n,r,i;o(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.handleCloseClick=function(e){var t=r.props.onClose;t&&t({type:"cancel",target:r})},i=n,a(r,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.show,t={show:e,onBackgroundClick:this.handleCloseClick};return d.default.createElement(p.default,t,d.default.createElement("div",{className:"project-description-dialog-box"},this.renderText(),this.renderButtons()))}},{key:"renderText",value:function(){var e=this.props,t=e.env,n=e.project,r=n.name,o=n.details,a=o.resources,i=o.title,s=t.locale.p,u=l.default.find(a,{type:"image"});return d.default.createElement(b.default,null,d.default.createElement("div",{className:"title"},s(i)||r),d.default.createElement("div",{className:"description"},d.default.createElement("div",{className:"image"},d.default.createElement(g.default,{resource:u,width:160,env:t})),s(n.details.description)))}},{key:"renderButtons",value:function(){var e=this.props.env,t=e.locale.t,n={label:t("project-description-close"),emphasized:!0,onClick:this.handleCloseClick};return d.default.createElement("div",{className:"buttons"},d.default.createElement(m.default,n))}}]),t}(c.PureComponent));C.displayName="ProjectDescriptionDialogBox",t.default=C,t.ProjectDescriptionDialogBox=C},"./dialogs/project-description-dialog-box.scss":function(e,t){},"./dialogs/project-management-dialog-box.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectManagementDialogBox=t.default=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n("../../common/node_modules/lodash/lodash.js"),c=r(l),d=n("../../common/node_modules/react/index.js"),f=r(d),p=n("../../common/src/widgets/overlay.jsx"),h=r(p),m=n("./widgets/push-button.jsx"),v=r(m),g=n("./widgets/scrollable.jsx"),y=r(g),b=n("./widgets/option-button.jsx"),w=r(b);n("./dialogs/project-management-dialog-box.scss");var C=n("../../common/src/routing/route.js"),_=(r(C),n("../../common/src/env/environment.js")),k=(r(_),function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleProjectClick=function(e){var t=n.state.selection,r=e.currentTarget.id;c.default.includes(t,r)?(t=c.default.without(t,r),c.default.pull(t,r)):t=c.default.concat(t,r),n.setState({selection:t})},n.handleRemoveClick=function(e){var t=n.props.onDelete,r=n.state.selection;t&&t({type:"delete",target:n,selection:r})},n.handleCancelClick=function(e){var t=n.props.onCancel;t&&t({type:"cancel",target:n})},n.state={selection:[]},n}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props.show,t={show:e,onBackgroundClick:this.handleCancelClick};return f.default.createElement(h.default,t,f.default.createElement("div",{className:"project-management-dialog-box"},this.renderList(),this.renderButtons()))}},{key:"renderList",value:function(){var e=this,t=this.props.projectLinks;return f.default.createElement(y.default,null,c.default.map(t,function(t,n){return e.renderProjectButton(t,n)}))}},{key:"renderProjectButton",value:function(e,t){var n=this.props.env,r=this.state.selection,o=n.locale.p,a={id:e.key,label:o(e.name),iconOn:"times-circle",selected:c.default.includes(r,e.key),onClick:this.handleProjectClick};return f.default.createElement(w.default,s({key:t},a))}},{key:"renderButtons",value:function(){var e=this.props.env,t=this.state.selection,n=e.locale.t,r={label:n("project-management-cancel"),onClick:this.handleCancelClick},o={label:n("project-management-remove"),onClick:this.handleRemoveClick,emphasized:!0,disabled:c.default.isEmpty(t)};return f.default.createElement("div",{className:"buttons"},f.default.createElement(v.default,r),f.default.createElement(v.default,o))}}]),t}(d.PureComponent));k.displayName="ProjectManagementDialogBox",t.default=k,t.ProjectManagementDialogBox=k},"./dialogs/project-management-dialog-box.scss":function(e,t){},"./dialogs/system-description-dialog-box.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SystemDescriptionDialogBox=t.default=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n("../../common/node_modules/lodash/lodash.js"),l=r(u),c=n("../../common/node_modules/react/index.js"),d=r(c),f=n("../../common/src/widgets/overlay.jsx"),p=r(f),h=n("./widgets/push-button.jsx"),m=r(h),v=n("./widgets/scrollable.jsx"),g=r(v);n("./dialogs/system-description-dialog-box.scss");var y=n("../../common/src/env/environment.js"),b=(r(y),function(e){function t(){var e,n,r,i;o(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.handleCloseClick=function(e){var t=r.props.onClose;t&&t({type:"cancel",target:r})},i=n,a(r,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.show,t={show:e,onBackgroundClick:this.handleCloseClick};return d.default.createElement(p.default,t,d.default.createElement("div",{className:"system-description-dialog-box"},this.renderText(),this.renderButtons()))}},{key:"renderText",value:function(){var e=this.props,t=e.env,n=e.system,r=t.locale.p,o=r(l.default.get(n,"details.title")),a=r(l.default.get(n,"details.description"));return d.default.createElement(g.default,null,d.default.createElement("div",{className:"title"},o),d.default.createElement("div",{className:"description"},a))}},{key:"renderButtons",value:function(){var e=this.props.env,t=e.locale.t,n={label:t("project-description-close"),emphasized:!0,onClick:this.handleCloseClick};return d.default.createElement("div",{className:"buttons"},d.default.createElement(m.default,n))}}]),t}(c.PureComponent));b.displayName="SystemDescriptionDialogBox",t.default=b,t.SystemDescriptionDialogBox=b},"./dialogs/system-description-dialog-box.scss":function(e,t){},"./dialogs/video-capture-dialog-box-browser.jsx":function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.VideoCaptureDialogBoxBrowser=t.default=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n("../../common/node_modules/lodash/lodash.js"),c=o(l),d=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),f=o(d),p=n("../../common/node_modules/react/index.js"),h=o(p),m=n("../../common/src/media/frame-grabber.js"),v=r(m),g=n("../../common/src/media/media-stream-utils.js"),y=r(g),b=n("../../common/src/transport/blob-manager.js"),w=(r(b),n("../../common/src/widgets/overlay.jsx")),C=o(w),_=n("./widgets/push-button.jsx"),k=o(_),E=n("./widgets/device-selector.jsx"),j=o(E),S=n("./widgets/device-placeholder.jsx"),P=o(S),R=n("./widgets/duration-indicator.jsx"),O=o(R);n("./dialogs/video-capture-dialog-box-browser.scss");var T=n("../../common/src/transport/payloads.js"),A=(o(T),n("../../common/src/env/environment.js")),x=(o(A),function(e){function t(e){a(this,t);var n=e.env,r=e.cameraDirection,o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));o.setLiveVideoNode=function(e){var t=o.state,n=t.liveVideoStream,r=t.liveVideoWidth,a=t.liveVideoHeight;o.videoNode=e,o.videoNode&&(o.videoNode.srcObject=n,o.videoNode.play(),y.getActualVideoDimensions(e,function(e){r===e.width&&a===e.height||o.setState({liveVideoWidth:e.width,liveVideoHeight:e.height})}))},o.handleStartClick=function(e){return f.default.join(o.captureImage(),o.beginRecording(),function(e,t){return o.setState({capturedImage:e,mediaRecorder:t,startTime:new Date,duration:0}),null}).catch(function(e){console.error(e)})},o.handlePauseClick=function(e){var t=o.state,n=t.startTime,r=t.duration;return o.pauseRecording().then(function(){var e=new Date;r+=e-n,o.setState({duration:r,startTime:null})})},o.handleResumeClick=function(e){return o.resumeRecording().then(function(){var e=new Date;o.setState({startTime:e})})},o.handleStopClick=function(e){var t=o.state,n=t.mediaRecorder,r=t.startTime,a=t.duration;return o.endRecording().then(function(){var e=n.outputStream.toBlob(),t=URL.createObjectURL(e),i=0;if(r){i=new Date-r}var s={format:c.default.last(c.default.split(n.mimeType,"/")),audioBitsPerSecond:n.audioBitsPerSecond,videoBitsPerSecond:n.videoBitsPerSecond,stream:n.outputStream,duration:a+i};o.setState({capturedVideo:s,previewURL:t,mediaRecorder:null})})},o.handleRetakeClick=function(e){o.clearCapturedVideo()},o.handleAcceptClick=function(e){var t=o.props.payloads,n=o.state,r=n.capturedVideo,a=n.capturedImage,i=t.add("video");i.attachStream(r.stream),i.attachFile(a.blob,"poster");var s={type:"video",payload_token:i.id,width:a.width,height:a.height,duration:r.duration,format:r.format,bitrates:{audio:r.audioBitsPerSecond,video:r.videoBitsPerSecond}};o.triggerCloseEvent(),o.triggerCaptureEvent(s)},o.handleCancelClick=function(e){o.triggerCloseEvent()},o.handleDeviceSelect=function(e){var t=e.currentTarget.value;o.setState({selectedDeviceID:t},function(){o.reinitializeCamera()})};var s=j.default.choose(n.devices,"video",r);return o.state={liveVideoStream:null,liveVideoError:null,liveVideoWidth:640,liveVideoHeight:480,mediaRecorder:null,capturedVideo:null,capturedImage:null,previewURL:null,selectedDeviceID:s?s.deviceID:null,startTime:null,duration:0},o}return s(t,e),u(t,[{key:"componentWillMount",value:function(){this.props.show&&this.initializeCamera()}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.props.show;e.show!==n&&(e.show?(this.clearCapturedVideo(),this.initializeCamera()):setTimeout(function(){t.shutdownCamera(),t.clearCapturedVideo()},500))}},{key:"clearCapturedVideo",value:function(){var e=this.state,t=e.capturedVideo,n=e.previewURL;t&&(URL.revokeObjectURL(n),this.setState({capturedVideo:null,capturedImage:null,previewURL:null}))}},{key:"initializeCamera",value:function(){var e=this;return this.createLiveVideoStream().then(function(t){var n=y.getVideoDimensions(t);e.setState({liveVideoStream:t,liveVideoError:null,liveVideoWidth:n.width,liveVideoHeight:n.height})}).catch(function(t){e.setState({liveVideoStream:null,liveVideoError:t})})}},{key:"shutdownCamera",value:function(){var e=this;this.destroyLiveVideoStream().then(function(){e.setState({liveVideoStream:null,liveVideoError:null})})}},{key:"reinitializeCamera",value:function(){var e=this;this.destroyLiveVideoStream().then(function(){e.initializeCamera()})}},{key:"render",value:function(){var e=this.props.show,t={show:e,onBackgroundClick:this.handleCancelClick};return h.default.createElement(C.default,t,h.default.createElement("div",{className:"video-capture-dialog-box"},h.default.createElement("div",{className:"container"},this.renderView()),h.default.createElement("div",{className:"controls"},this.renderDeviceSelector(),this.renderButtons(),this.renderDuration())))}},{key:"renderView",value:function(){var e=this.state,t=e.capturedVideo,n=e.liveVideoStream;return t?this.renderCapturedVideo():n?this.renderLiveVideo():this.renderPlaceholder()}},{key:"renderPlaceholder",value:function(){var e=this.state.liveVideoError,t={blocked:!!e,icon:"video-camera"};return h.default.createElement(P.default,t)}},{key:"renderLiveVideo",value:function(){var e={ref:this.setLiveVideoNode,key:"live",className:"live-video",muted:!0};return h.default.createElement("div",null,this.renderSpacer(),h.default.createElement("video",e))}},{key:"renderSpacer",value:function(){var e=this.state,t=e.liveVideoWidth,n=e.liveVideoHeight,r={className:"spacer",width:t,height:n};return h.default.createElement("canvas",r)}},{key:"renderCapturedVideo",value:function(){var e=this.state.previewURL,t={key:"preview",className:"preview",src:e,controls:!0};return h.default.createElement("div",null,this.renderSpacer(),h.default.createElement("video",t))}},{key:"renderDeviceSelector",value:function(){var e=this.props.env,t=this.state,n=t.mediaRecorder,r=t.capturedVideo,o=t.selectedDeviceID;if(n)return null;if(r)return null;var a={type:"video",selectedDeviceID:o,env:e,onSelect:this.handleDeviceSelect};return h.default.createElement(j.default,a)}},{key:"renderDuration",value:function(){var e=this.state,t=e.mediaRecorder,n=e.startTime,r=e.duration;if(!t)return null;var o={duration:r,startTime:n};return h.default.createElement(O.default,o)}},{key:"renderButtons",value:function(){var e=this.props.env,t=this.state,n=t.mediaRecorder,r=t.capturedVideo,o=t.liveVideoStream,a=e.locale.t;if(n){var i="paused"===n.state,s={label:a("video-capture-pause"),onClick:this.handlePauseClick,hidden:i},u={label:a("video-capture-resume"),onClick:this.handleResumeClick,hidden:!i,emphasized:!0},l={label:a("video-capture-stop"),onClick:this.handleStopClick,emphasized:!i};return h.default.createElement("div",{className:"buttons"},h.default.createElement(k.default,s),h.default.createElement(k.default,u),h.default.createElement(k.default,l))}if(r){var c={label:a("video-capture-retake"),onClick:this.handleRetakeClick},d={label:a("video-capture-accept"),onClick:this.handleAcceptClick,emphasized:!0};return h.default.createElement("div",{className:"buttons"},h.default.createElement(k.default,c),h.default.createElement(k.default,d))}var f={label:a("video-capture-cancel"),onClick:this.handleCancelClick},p={label:a("video-capture-start"),onClick:this.handleStartClick,disabled:!o,emphasized:!0};return h.default.createElement("div",{className:"buttons"},h.default.createElement(k.default,f),h.default.createElement(k.default,p))}},{key:"componentDidUpdate",value:function(e,t){var n=this,r=this.props.env,o=this.state,a=o.liveVideoStream,i=o.selectedDeviceID;this.videoNode&&t.liveVideoStream!==a&&this.setLiveVideoNode(this.videoNode),r.devices!==e.env.devices&&i&&(c.default.some(r.devices,{deviceID:i})||this.setState({selectedDeviceID:null},function(){n.reinitializeCamera()}))}},{key:"componentWillUnmount",value:function(){this.destroyLiveVideoStream(),this.clearCapturedVideo()}},{key:"createLiveVideoStream",value:function(){var e=this.state.selectedDeviceID;return this.videoStreamPromise||(this.videoStreamPromise=y.getVideoStream(e)),this.videoStreamPromise}},{key:"destroyLiveVideoStream",value:function(){if(!this.videoStreamPromise)return f.default.resolve();var e=this.videoStreamPromise;return this.videoStreamPromise=null,e.then(function(e){y.stopAllTracks(e)})}},{key:"captureImage",value:function(){var e=this.videoNode;return v.capture(e).then(function(t){return{blob:t,width:e.videoWidth,height:e.videoHeight}})}},{key:"beginRecording",value:function(){var e=this.props.payloads,t=this.state.liveVideoStream;return f.default.try(function(){var n={audioBitsPerSecond:128e3,videoBitsPerSecond:25e5,mimeType:"video/webm"},r=new MediaRecorder(t,n),o=e.stream();return r.outputStream=o,r.promise=new f.default(function(e,t){r.resolve=e,r.reject=t}),r.addEventListener("dataavailable",function(e){o.push(e.data)}),r.addEventListener("stop",function(e){o.close(),r.resolve()}),r.start(3e3),o.start(),r})}},{key:"pauseRecording",value:function(){var e=this.state.mediaRecorder;return f.default.try(function(){e&&e.pause()})}},{key:"resumeRecording",value:function(){var e=this.state.mediaRecorder;return f.default.try(function(){e&&e.resume()})}},{key:"endRecording",value:function(){var e=this.state.mediaRecorder;return f.default.try(function(){if(e)return e.stop(),e.promise})}},{key:"triggerCaptureEvent",value:function(e){var t=this.props.onCapture;t&&t({type:"capture",target:this,resource:e})}},{key:"triggerCloseEvent",value:function(){var e=this.props.onClose;e&&e({type:"close",target:this})}}]),t}(p.PureComponent));x.displayName="VideoCaptureDialogBoxBrowser",t.default=x,t.VideoCaptureDialogBoxBrowser=x},"./dialogs/video-capture-dialog-box-browser.scss":function(e,t){},"./dialogs/video-capture-dialog-box-cordova.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return new p.default(function(t,n){var r=function(e){if("windows"===cordova.platformId){var n=d.default.lastIndexOf(e,"\\");if(-1!==n){var r=e.substr(n+1);e=cordova.file.dataDirectory+r}}t(e)},o=function(e){n(new Error(e))},a={fileUri:e.fullPath,outputFileName:e.name,quality:70};"windows"===cordova.platformId&&(a.outputFileName+=".jpg"),VideoEditor.createThumbnail(r,o,a)})}function u(){var e=cordova.plugins.permissions;return e&&"android"===cordova.platformId?new p.default(function(t,n){var r=function(){t()},o=function(e){n(new Error("Unable to obtain permission"))};e.requestPermissions([e.RECORD_AUDIO,e.RECORD_VIDEO,e.READ_EXTERNAL_STORAGE,e.WRITE_EXTERNAL_STORAGE],r,o)}):p.default.resolve()}Object.defineProperty(t,"__esModule",{value:!0}),t.VideoCaptureDialogBoxCordova=t.default=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n("../../common/node_modules/lodash/lodash.js"),d=r(c),f=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),p=r(f),h=n("../../common/node_modules/react/index.js"),m=(r(h),n("../../common/src/media/media-loader.js")),v=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(m),g=n("../../common/src/transport/cordova-file.js"),y=r(g),b=n("../../common/src/transport/payloads.js"),w=(r(b),n("../../common/src/env/environment.js")),C=(r(w),function(e){function t(){var e,n,r,i;o(this,t);for(var u=arguments.length,l=Array(u),c=0;c<u;c++)l[c]=arguments[c];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.handleCaptureSuccess=function(e){var t=r.props.payloads;r.triggerCloseEvent();var n=e[0];n&&(r.triggerCapturePendingEvent(),v.getFormatData(n).then(function(e){var o=void 0;o="windows"===cordova.platformId?n.localURL:n.fullPath;var a=new y.default(o,n.type,n.size),i=t.add("video");return i.attachFile(a),s(a).then(function(t){var r=new y.default(t);return v.getImageMetadata(r).then(function(t){return i.attachFile(r,"poster"),{type:"video",payload_token:i.id,format:v.extractFileFormat(n.type),width:t.width,height:t.height,filename:n.name,duration:1e3*e.duration}})}).catch(function(t){return i.attachStep("main","poster"),{type:"video",payload_token:i.id,format:v.extractFileFormat(n.type),filename:n.name,duration:1e3*e.duration}}).then(function(e){return r.triggerCaptureEvent(e),null})}).catch(function(e){return r.triggerCaptureErrorEvent(e),null}))},r.handleCaptureFailure=function(e){r.triggerCloseEvent(),r.triggerCaptureErrorEvent(e)},i=n,a(r,i)}return i(t,e),l(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.props.show;if(e.show&&!n){var r=navigator.device.capture;r&&u().then(function(){var e={duration:18e3,limit:1};r.captureVideo(t.handleCaptureSuccess,t.handleCaptureFailure,e)})}}},{key:"render",value:function(){return null}},{key:"triggerCloseEvent",value:function(){var e=this.props.onClose;e&&e({type:"close",target:this})}},{key:"triggerCaptureEvent",value:function(e){var t=this.props.onCapture;t&&t({type:"capture",target:this,resource:e})}},{key:"triggerCapturePendingEvent",value:function(){var e=this.props.onCapturePending;e&&e({type:"capturepending",target:this,resourceType:"video"})}},{key:"triggerCaptureErrorEvent",value:function(e){var t=this.props.onCaptureError;t&&t({type:"capturefailure",target:this,error:e})}}]),t}(h.PureComponent));C.displayName="VideoCaptureDialogBoxCordova",t.default=C,t.VideoCaptureDialogBoxCordova=C},"./editors/image-editor.jsx":function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ImageEditor=t.default=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n("../../common/node_modules/lodash/lodash.js"),c=o(l),d=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),f=(o(d),n("../../common/node_modules/react/index.js")),p=o(f),h=n("../../common/src/transport/blob-manager.js"),m=r(h),v=n("../../common/src/transport/payload.js"),g=(o(v),n("../../common/src/media/image-cropping.js")),y=(r(g),n("../../common/src/utils/focus-manager.js")),b=r(y),w=n("../../common/src/objects/utils/resource-utils.js"),C=r(w),_=n("../../common/src/utils/component-refs.js"),k=o(_),E=n("../../common/src/widgets/image-cropper.jsx"),j=o(E);n("./editors/image-editor.scss");var S=n("../../common/src/env/environment.js"),P=(o(S),function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClipRectChange=function(e){var t=n.props.resource;n.components.imageCropper;t=c.default.clone(t),t.clip=e.rect,n.triggerChangeEvent(t)},n.handleFullImageLoad=function(e){var t=(n.props.resource,n.components.imageCropper,e.target.props.url);n.setState({loadedImageURL:t})},n.components=(0,k.default)({imageCropper:j.default}),n.state={loadingFullImage:"",fullImageLoaded:""},n}return s(t,e),u(t,[{key:"render",value:function(){var e=this.props.children;return p.default.createElement("div",{className:"image-editor"},this.renderImage(),this.renderSpinner(),e)}},{key:"renderImage",value:function(){var e=this.getLocalImageURL(),t=this.getPreviewImageURL();return e?this.renderImageCropper():t?this.renderPreviewImage():this.renderPlaceholder()}},{key:"renderPreviewImage",value:function(){var e=this.props,t=e.previewWidth,n=e.previewHeight,r=e.disabled,o=this.getPreviewImageURL(),a="preview";r&&(a+=" disabled");var i={src:o,width:t,height:n};return p.default.createElement("div",{className:a},p.default.createElement("img",i))}},{key:"renderSpinner",value:function(){if(this.props.disabled)return null;var e=this.getLocalImageURL(),t=this.getPreviewImageURL();return e||!t?null:p.default.createElement("div",{className:"spinner"},p.default.createElement("i",{className:"fa fa-refresh fa-spin fa-fw"}))}},{key:"renderImageCropper",value:function(){var e=this.props,t=e.resource,n=e.disabled,r=this.components.setters,o=this.getLocalImageURL(),a=C.getClippingRect(t,{}),i={ref:r.imageCropper,url:o,clippingRect:a,vector:"svg"===t.format,disabled:n,onChange:this.handleClipRectChange,onLoad:this.handleFullImageLoad};return p.default.createElement(j.default,i)}},{key:"renderPlaceholder",value:function(){var e=this.props,t=e.env,n=e.resource,r=t.locale.t,o=void 0,a=void 0;return n.width&&n.height?(o=r("image-editor-upload-in-progress"),a="cloud-upload"):n.pending||("video"===n.type?(o=r("image-editor-poster-extraction-in-progress"),a="film"):"website"===n.type&&(o=r("image-editor-page-rendering-in-progress"),a="file-image-o")),p.default.createElement("div",{className:"placeholder"},p.default.createElement("div",{className:"icon"},p.default.createElement("i",{className:"fa fa-"+a})),p.default.createElement("div",{className:"message"},o))}},{key:"componentDidMount",value:function(){b.register(this,{type:"ImageEditor"}),this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(e,t){var n=this,r=this.state.loadingFullImage,o=this.getLocalImageURL(),a=this.getRemoteImageURL();!o&&a&&r!==a&&(this.setState({loadingFullImage:a}),m.fetch(a).then(function(){n.setState({fullImageLoaded:a})}))}},{key:"componentWillUnmount",value:function(){b.unregister(this)}},{key:"getRemoteImageURL",value:function(){var e=this.props,t=e.env,n=e.resource,r={remote:!0,original:!0};return C.getImageURL(n,r,t)}},{key:"getLocalImageURL",value:function(){var e=this.props,t=e.env,n=e.resource,r={local:!0,original:!0};return C.getImageURL(n,r,t)}},{key:"getPreviewImageURL",value:function(){var e=this.props,t=e.env,n=e.resource,r=e.previewWidth,o=e.previewHeight,a={remote:!0,width:r,height:o};return C.getImageURL(n,a,t)}},{key:"focus",value:function(){var e=this.components.imageCropper;e&&e.focus()}},{key:"triggerChangeEvent",value:function(e){var t=this.props.onChange;t&&t({type:"change",target:this,resource:e})}}]),t}(f.PureComponent));P.displayName="ImageEditor",P.defaultProps={previewWidth:512,previewHeight:512,disabled:!1},t.default=P,t.ImageEditor=P},"./editors/image-editor.scss":function(e,t){},"./editors/media-editor.scss":function(e,t){},"./editors/media-importer.jsx":function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){var t=p.default.filter(e,function(e){if("string"===e.kind)return/^text\/(html|uri-list)/.test(e.type)}),n={};return p.default.each(t,function(e){n[e.type]=new m.default(function(t,n){e.getAsString(t)})}),m.default.props(n)}function l(e){if(e){var t=document.createElement("DIV");t.innerHTML=e.replace(/<.*?>/g,""),website.title=t.innerText}}function c(e){return p.default.toUpper((0,g.default)().format("YYYY-MMM-DD-hhA"))+e}Object.defineProperty(t,"__esModule",{value:!0}),t.MediaImporter=t.default=void 0;var d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n("../../common/node_modules/lodash/lodash.js"),p=o(f),h=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),m=o(h),v=n("../../common/node_modules/moment/moment.js"),g=o(v),y=n("../../common/node_modules/react/index.js"),b=o(y),w=n("../../common/src/media/media-loader.js"),C=r(w),_=n("../../common/src/media/media-tag-reader.js"),k=r(_),E=n("../../common/src/utils/link-parser.js"),j=r(E),S=n("../../common/src/media/quick-start.js"),P=r(S),R=n("../../common/src/transport/blob-reader.js"),O=r(R),T=n("../../common/src/objects/types/resource-types.js"),A=o(T),x=n("./dialogs/photo-capture-dialog-box-browser.jsx"),D=o(x),M=n("./dialogs/photo-capture-dialog-box-cordova.jsx"),I=o(M),B=n("./dialogs/audio-capture-dialog-box-browser.jsx"),U=o(B),L=n("./dialogs/audio-capture-dialog-box-cordova.jsx"),N=o(L),F=n("./dialogs/video-capture-dialog-box-browser.jsx"),V=o(F),z=n("./dialogs/video-capture-dialog-box-cordova.jsx"),W=o(z);n("./editors/media-editor.scss");var H=n("../../common/src/env/environment.js"),Y=(o(H),n("../../common/src/transport/payloads.js")),X=(o(Y),function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClose=function(e){n.setState({capturing:null}),n.triggerCaptureEndEvent()},n.handleCapturePending=function(e){n.resourcePlaceholder={type:e.resourceType,pending:"capture-"+ ++q},n.addResources([n.resourcePlaceholder])},n.handleCaptureError=function(e){n.resourcePlaceholder&&n.removeResource(n.resourcePlaceholder)},n.handleCapture=function(e){var t=p.default.clone(e.resource),r="jpeg"===t.format?"jpg":t.format;t.filename=c("."+r),n.resourcePlaceholder?n.updateResource(n.resourcePlaceholder,t):n.addResources([t])},n.state={capturing:null},n}return s(t,e),d(t,[{key:"isAcceptable",value:function(e){var t=this.props.types;return p.default.includes(t,e)}},{key:"getResourceType",value:function(e){var t=C.extractFileCategory(e);if("application"===t)switch(C.extractFileFormat(e)){case"x-mswinurl":case"x-desktop":t="website"}if(this.isAcceptable(t))return t}},{key:"capture",value:function(e){this.setState({capturing:e}),this.triggerCaptureStartEvent()}},{key:"importFiles",value:function(e){var t=this;e=p.default.filter(e,function(e){return!!t.getResourceType(e.type)});var n=p.default.map(e,function(e){return t.getResourceType(e.type)}),r=this.addResourcePlaceholders(n);return m.default.each(e,function(e,n){return t.importFile(e).then(function(e){return t.updateResource(r[n],e),null}).catch(function(e){return t.removeResource(r[n]),null})})}},{key:"importFile",value:function(e){switch(this.getResourceType(e.type)){case"image":return this.importImageFile(e);case"video":return this.importVideoFile(e);case"audio":return this.importAudioFile(e);case"website":return this.importBookmarkFile(e)}}},{key:"importImageFile",value:function(e){var t=this.props.payloads,n=t.add("image").attachFile(e);return C.getImageMetadata(e).then(function(t){return{type:"image",payload_token:n.id,width:t.width,height:t.height,format:t.format,filename:e.name,imported:!0}}).catch(function(t){return{type:"image",payload_token:n.id,format:C.extractFileFormat(e.type),filename:e.name,imported:!0}})}},{key:"importVideoFile",value:function(e){var t=this.props.payloads;return P.process(e).then(function(n){n||(n=e);var r=t.add("video"),o=t.stream().pipe(n);return r.attachStream(o),C.getVideoMetadata(n).then(function(t){return r.attachFile(t.poster,"poster"),{type:"video",payload_token:r.id,width:t.width,height:t.height,format:t.format,duration:t.duration,filename:e.name,imported:!0}}).catch(function(t){return r.attachStep("main","poster"),{type:"video",payload_token:r.id,format:C.extractFileFormat(e.type),filename:e.name,imported:!0}})})}},{key:"importAudioFile",value:function(e){var t=this.props.payloads,n=t.add("audio"),r=t.stream().pipe(e);return n.attachStream(r),C.getAudioMetadata(e).then(function(t){var r={type:"audio",payload_token:n.id,format:t.format,duration:t.duration,filename:e.name,imported:!0};return k.extractAlbumArt(e).then(function(e){return e?(n.attachFile(e,"poster"),C.getImageMetadata(e).then(function(e){return r.width=e.width,r.height=e.height,r})):r})}).catch(function(t){return{type:"audio",payload_token:n.id,format:C.extractFileFormat(e.type),filename:e.name,imported:!0}})}},{key:"importBookmarkFile",value:function(e){var t=this.props.payloads;return O.loadText(e).then(function(n){var r=j.parse(n);if(r&&/https?:/.test(r.url)){return{type:"website",payload_token:t.add("website").attachURL(r.url,"poster").id,url:r.url,title:r.name||p.default.replace(e.name,/\.\w+$/,"")}}})}},{key:"importDataItems",value:function(e){var t=this,n=this.props.payloads;return u(e).then(function(e){var r=e["text/html"],o=e["text/uri-list"];if(o){var a=/<img\b/i.test(r)?"image":"website";if(t.isAcceptable(a)){if("image"===a){var i=o.replace(/.*\/([^\?#]*).*/,"$1")||void 0;return{type:"image",payload_token:n.add("image").attachURL(o).id,filename:i}}if("website"===a){return{type:"website",payload_token:n.add("website").attachURL(o,"poster").id,url:o,title:l(r)}}}}}).then(function(e){return e?(t.addResources([e]),null):0})}},{key:"render",value:function(){return b.default.createElement("div",null,this.renderPhotoDialog(),this.renderAudioDialog(),this.renderVideoDialog())}},{key:"renderPhotoDialog",value:function(){var e=this.props,t=e.payloads,n=e.env,r=e.cameraDirection,o=this.state.capturing,a={show:"image"===o,cameraDirection:r,payloads:t,env:n,onLoadStart:this.handleLoadStart,onClose:this.handleClose,onCapturePending:this.handleCapturePending,onCaptureError:this.handleCaptureError,onCapture:this.handleCapture};return"browser"===n.platform?b.default.createElement(D.default,a):"cordova"===n.platform?b.default.createElement(I.default,a):void 0}},{key:"renderVideoDialog",value:function(){var e=this.props,t=e.payloads,n=e.env,r=e.cameraDirection,o=this.state.capturing,a={show:"video"===o,cameraDirection:r,payloads:t,env:n,onLoadStart:this.handleLoadStart,onClose:this.handleClose,onCapturePending:this.handleCapturePending,onCaptureError:this.handleCaptureError,onCapture:this.handleCapture};return"browser"===n.platform?b.default.createElement(V.default,a):"cordova"===n.platform?b.default.createElement(W.default,a):void 0}},{key:"renderAudioDialog",value:function(){var e=this.props,t=e.payloads,n=e.env,r=(e.cameraDirection,this.state.capturing),o={show:"audio"===r,payloads:t,env:n,onClose:this.handleClose,onCapturePending:this.handleCapturePending,onCaptureError:this.handleCaptureError,onCapture:this.handleCapture};return"browser"===n.platform?b.default.createElement(U.default,o):"cordova"===n.platform?b.default.createElement(N.default,o):void 0}},{key:"componentWillUnmount",value:function(){this.state.capturing&&this.triggerCaptureEndEvent()}},{key:"addResourcePlaceholders",value:function(e){var t=p.default.map(e,function(e){return{type:e,pending:"import-"+ ++G,imported:!0}});return this.addResources(t),t}},{key:"addResources",value:function(e){var t=this.props,n=t.resources,r=t.limit;if(p.default.isEmpty(e))return m.default.resolve(0);var o=n.length;if(1===r){var a=p.default.first(e),i=p.default.findIndex(n,{type:a.type});n=p.default.concat(n,a),-1!==i&&(n.splice(i,1),o--)}else n=p.default.concat(n,e);this.triggerChangeEvent(n,o)}},{key:"updateResource",value:function(e,t){var n=this.props.resources,r=p.default.findIndex(n,e);return-1!==r&&(n=p.default.slice(n),n[r]=t,this.triggerChangeEvent(n)),null}},{key:"removeResource",value:function(e,t){var n=this.props.resources,r=p.default.findIndex(n,e);-1!==r&&(n=p.default.slice(n),n.splice(r,1),this.triggerChangeEvent(n))}},{key:"triggerChangeEvent",value:function(e,t){var n=this.props.onChange;n&&n({type:"change",target:this,resources:e,selection:t})}},{key:"triggerCaptureStartEvent",value:function(){var e=this.props.onCaptureStart,t=this.state.capturing;e&&e({type:"capturestart",target:this,mediaType:t})}},{key:"triggerCaptureEndEvent",value:function(e){var t=this.props.onCaptureEnd,n=this.state.capturing;t&&t({type:"captureend",target:this,mediaType:n,resource:e})}}]),t}(y.PureComponent));X.displayName="MediaImporter";var G=0,q=0;X.defaultProps={types:A.default,limit:1/0},t.default=X,t.MediaImporter=X},"./pages/settings-page.jsx":function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsPageSync=t.SettingsPage=t.default=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n("../../common/node_modules/lodash/lodash.js"),c=o(l),d=n("../../common/node_modules/react/index.js"),f=o(d),p=n("../../common/node_modules/relaks/index.js"),h=n("../../common/src/utils/konami-code.js"),m=r(h),v=n("../../common/src/objects/finders/device-finder.js"),g=r(v),y=n("../../common/src/objects/finders/project-finder.js"),b=r(y),w=n("../../common/src/objects/finders/project-link-finder.js"),C=r(w),_=n("../../common/src/objects/finders/repo-finder.js"),k=r(_),E=n("../../common/src/objects/finders/system-finder.js"),j=r(E),S=n("../../common/src/objects/finders/user-finder.js"),P=r(S),R=n("../../common/src/objects/utils/user-utils.js"),O=r(R),T=n("./widgets/page-container.jsx"),A=o(T),x=n("./panels/development-panel.jsx"),D=o(x),M=n("./panels/project-panel.jsx"),I=o(M),B=n("./panels/device-panel.jsx"),U=o(B),L=n("./panels/user-info-panel.jsx"),N=o(L),F=n("./panels/user-image-panel.jsx"),V=o(F),z=n("./panels/notification-panel.jsx"),W=o(z),H=n("./panels/web-alert-panel.jsx"),Y=o(H),X=n("./panels/mobile-alert-panel.jsx"),G=o(X),q=n("./panels/social-network-panel.jsx"),K=o(q),J=n("./panels/language-panel.jsx"),Z=o(J),Q=n("../../common/src/widgets/error-boundary.jsx"),$=o(Q);n("./pages/settings-page.scss");var ee=n("../../common/src/data/database.js"),te=(o(ee),n("../../common/src/transport/payloads.js")),ne=(o(te),n("../../common/src/routing/route.js")),re=(o(ne),n("../../common/src/env/environment.js")),oe=(o(re),function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),u(t,[{key:"renderAsync",value:function(e){var t=this.props,n=t.database,r=t.route,o=t.payloads,a=t.env,i=n.use({by:this}),s={currentUser:void 0,currentProject:void 0,projectLinks:void 0,repos:void 0,devices:void 0,system:void 0,database:n,payloads:o,route:r,env:a};return e.show(f.default.createElement(ae,s)),i.start().then(function(e){return P.findUser(i,e).then(function(e){s.currentUser=e})}).then(function(){return C.findActiveLinks(i).then(function(e){s.projectLinks=e})}).then(function(){return b.findCurrentProject(i).then(function(e){s.currentProject=e})}).then(function(){return e.show(f.default.createElement(ae,s)),g.findUserDevices(i,s.currentUser,1).then(function(e){s.devices=e})}).then(function(){return e.show(f.default.createElement(ae,s)),k.findProjectRepos(i,s.currentProject).then(function(e){s.repos=e})}).then(function(){return e.show(f.default.createElement(ae,s)),j.findSystem(i).then(function(e){s.system=e})}).then(function(){return f.default.createElement(ae,s)})}}]),t}(p.AsyncComponent));oe.displayName="SettingsPage";var ae=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=function(e){var t=e.user;n.setState({user:t},function(){n.saveUser(t,e.immediate||!1)})},n.handleKonamiCode=function(e){var t=c.default.decoupleSet(n.getUser(),"settings.development.show_panel",!0);n.setState({user:t},function(){n.saveUser(t,!0)})},n.state={user:null,original:null},n}return s(t,e),u(t,[{key:"getUser",value:function(){var e=this.props.currentUser;return this.state.user||e}},{key:"componentWillReceiveProps",value:function(e){var t=e.currentUser;if(e.currentUser!==t){var n={user:null};e.currentUser&&!e.currentUser.uncommitted&&(n.original=e.currentUser),this.setState(n)}}},{key:"render",value:function(){var e=this.props,t=e.env;return e.currentUser?f.default.createElement(A.default,{className:"settings-page"},f.default.createElement("div",{className:"panels"},f.default.createElement($.default,{env:t},this.renderDevelopmentPanel(),this.renderProjectPanel(),this.renderDevicePanel(),this.renderNotificationPanel(),this.renderWebAlertPanel(),this.renderMobileAlertPanel(),this.renderUserInfoPanel(),this.renderUserImagePanel(),this.renderSocialNetworkPanel(),this.renderLanguagePanel()))):null}},{key:"renderDevelopmentPanel",value:function(){var e=this.props,t=e.route,n=e.env,r=this.getUser();if(!c.default.get(r,"settings.development.show_panel"))return null;var o={currentUser:r,route:t,env:n,onChange:this.handleChange};return f.default.createElement(D.default,o)}},{key:"renderProjectPanel",value:function(){var e=this.props,t=e.system,n=e.currentProject,r=e.projectLinks,o=e.database,a=e.route,i=e.env,s={system:t,currentUser:this.getUser(),currentProject:n,projectLinks:r,database:o,route:a,env:i,onChange:this.handleChange};return f.default.createElement(I.default,s)}},{key:"renderDevicePanel",value:function(){var e=this.props,t=e.database,n=e.route,r=e.env,o=e.devices;if("cordova"===r.platform)return null;if(c.default.isEmpty(o))return null;var a={devices:o,database:t,route:n,env:r};return f.default.createElement(U.default,a)}},{key:"renderUserInfoPanel",value:function(){var e=this.props.env,t={currentUser:this.getUser(),env:e,onChange:this.handleChange};return f.default.createElement(N.default,t)}},{key:"renderUserImagePanel",value:function(){var e=this.props,t=e.env,n=e.payloads,r={currentUser:this.getUser(),payloads:n,env:t,onChange:this.handleChange};return f.default.createElement(V.default,r)}},{key:"renderSocialNetworkPanel",value:function(){var e=this.props.env,t={currentUser:this.getUser(),env:e,onChange:this.handleChange};return f.default.createElement(K.default,t)}},{key:"renderNotificationPanel",value:function(){var e=this.props,t=e.env,n=e.repos,r={currentUser:this.getUser(),repos:n,env:t,onChange:this.handleChange};return f.default.createElement(W.default,r)}},{key:"renderWebAlertPanel",value:function(){var e=this.props,t=e.env,n=e.repos;if("cordova"===t.platform)return null;var r={currentUser:this.getUser(),repos:n,env:t,onChange:this.handleChange};return f.default.createElement(Y.default,r)}},{key:"renderMobileAlertPanel",value:function(){var e=this.props,t=e.env,n=e.devices,r=e.repos;if(c.default.isEmpty(n))return null;var o={currentUser:this.getUser(),repos:r,env:t,onChange:this.handleChange};return f.default.createElement(G.default,o)}},{key:"renderLanguagePanel",value:function(){var e=this.props.env,t={env:e};return f.default.createElement(Z.default,t)}},{key:"componentDidMount",value:function(){m.addListener(this.handleKonamiCode)}},{key:"componentWillUnmount",value:function(){m.removeListener(this.handleKonamiCode)}},{key:"saveUser",value:function(e,t){var n=this.props,r=n.database,o=n.payloads,a=this.state.original,i={delay:t?void 0:2e3,onConflict:function(e){O.mergeRemoteChanges(e.local,e.remote,a)&&e.preventDefault()}};return r.use({schema:"global",by:this}).saveOne({table:"user"},e,i).then(function(e){return o.dispatch(e),e})}}]),t}(d.PureComponent);ae.displayName="SettingsPageSync",t.default=oe,t.SettingsPage=oe,t.SettingsPageSync=ae},"./pages/settings-page.scss":function(e,t){},"./panels/development-panel.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.DevelopmentPanel=t.default=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n("../../common/node_modules/lodash/lodash.js"),c=r(l),d=n("../../common/node_modules/react/index.js"),f=r(d),p=n("../../common/src/transport/code-push.js"),h=(r(p),n("./widgets/settings-panel.jsx")),m=r(h),v=n("./widgets/push-button.jsx"),g=r(v),y=n("./widgets/option-button.jsx"),b=r(y);n("./panels/development-panel.scss");var w=n("../../common/src/routing/route.js"),C=(r(w),n("../../common/src/env/environment.js")),_=(r(C),function(e){function t(){var e,n,r,i;o(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.handleDevelopmentOptionClick=function(e){var t=r.props.currentUser,n=e.currentTarget.id,o="development."+n,a=c.default.clone(c.default.get(t,"settings",{}));!c.default.get(a,o)?c.default.set(a,o,!0):c.default.unset(a,o),r.setUserProperty("settings",a)},r.handleDeploymentOptionClick=function(e){var t=r.props.env,n=e.currentTarget.id;t.codePush.saveDeploymentName(n)},r.handleShowClick=function(e){r.props.route.push("diagnostics-page")},i=n,a(r,i)}return i(t,e),u(t,[{key:"setUserProperty",value:function(e,t){var n=this.props,r=n.currentUser,o=n.onChange;if(r){var a=c.default.decoupleSet(r,e,t);o&&o({type:"change",target:this,user:a})}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return f.default.createElement(m.default,{className:"diagnostics"},f.default.createElement("header",null,f.default.createElement("div",{className:"icon"},f.default.createElement("i",{className:"fa fa-bug"}),f.default.createElement("i",{className:"fa fa-search icon-overlay"}))," ",t("settings-development")),f.default.createElement("body",null,this.renderDevelopmentOptions(),this.renderDeploymentOptions()),f.default.createElement("footer",null,this.renderButtons()))}},{key:"renderDeploymentOptions",value:function(){var e=this.props.env;if(!e.codePush)return null;var t=e.codePush.getDeploymentNames();return c.default.map(t,this.renderDeploymentOption.bind(this))}},{key:"renderDevelopmentOptions",value:function(){var e=["show-panel"];return c.default.map(e,this.renderDevelopmentOption.bind(this))}},{key:"renderDevelopmentOption",value:function(e,t){var n=this.props,r=n.env,o=n.currentUser,a=r.locale.t,i=c.default.snakeCase(e),u=c.default.get(o,"settings",{}),l=!!c.default.get(u,"development."+i),d={label:a("development-"+e),selected:l,onClick:this.handleDevelopmentOptionClick,id:i};return f.default.createElement(b.default,s({key:t},d))}},{key:"renderDeploymentOption",value:function(e,t){var n=this.props.env,r=n.locale.t,o={label:r("development-code-push-$deployment",e),selected:e===n.codePush.selectedDeployment,onClick:this.handleDeploymentOptionClick,id:e};return f.default.createElement(b.default,s({key:t},o))}},{key:"renderButtons",value:function(){var e=this.props.env,t=e.locale.t,n={label:t("development-show-diagnostics"),onClick:this.handleShowClick};return f.default.createElement("div",{className:"buttons"},f.default.createElement(g.default,n))}}]),t}(d.PureComponent));_.displayName="DevelopmentPanel",t.default=_,t.DevelopmentPanel=_},"./panels/development-panel.scss":function(e,t){},"./panels/device-panel.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=e.type,n=void 0;switch(t){case"ios":case"osx":n="apple";break;default:n=t}return p.default.createElement("div",{className:"device-icon"},p.default.createElement("i",{className:"fa fa-tablet background"}),p.default.createElement("i",{className:"fa fa-"+n+" icon-overlay"}))}function u(e){var t=e.details.manufacturer,n=e.details.display_name||e.details.name;return d.default.includes(d.default.toLower(n),d.default.toLower(t))||(n=t+" "+n),n}Object.defineProperty(t,"__esModule",{value:!0}),t.DevicePanel=t.default=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n("../../common/node_modules/lodash/lodash.js"),d=r(c),f=n("../../common/node_modules/react/index.js"),p=r(f),h=n("./widgets/settings-panel.jsx"),m=r(h),v=n("./widgets/push-button.jsx"),g=(r(v),n("./dialogs/confirmation-dialog-box.jsx")),y=r(g);n("./panels/device-panel.scss");var b=n("../../common/src/data/database.js"),w=(r(b),n("../../common/src/routing/route.js")),C=(r(w),n("../../common/src/env/environment.js")),_=(r(C),function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleRevokeClick=function(e){var t=parseInt(e.currentTarget.getAttribute("data-device-id"));n.setState({confirmingRevocation:!0,selectedDeviceID:t})},n.handleRevokeConfirm=function(e){var t=n.props,r=t.database,o=t.devices,a=n.state.selectedDeviceID,i=d.default.find(o,{id:a}),s=r.use({schema:"global",by:n});s.removeOne({table:"device"},i).then(function(){return s.endMobileSession(i.session_handle)}).finally(function(){n.handleDialogClose()})},n.handleDialogClose=function(e){n.setState({confirmingRevocation:!1})},n.state={confirmingRevocation:!1,selectedDeviceID:null},n}return i(t,e),l(t,[{key:"render",value:function(){var e=this.props,t=e.env,n=e.devices,r=t.locale.t,o=void 0;return o=r(1===d.default.size(n)?"settings-device":"settings-devices"),p.default.createElement(m.default,{className:"device"},p.default.createElement("header",null,p.default.createElement("i",{className:"fa fa-tablet"})," ",o),p.default.createElement("body",null,this.renderDevices(),this.renderDialogBox()))}},{key:"renderDevices",value:function(){var e=this,t=this.props.devices;return d.default.map(t,function(t){return e.renderDevice(t)})}},{key:"renderDevice",value:function(e){var t=this.props.env,n=t.locale.t,r=u(e);return p.default.createElement("div",{key:e.id,className:"device-option-button selected"},p.default.createElement("div",{className:"icon"},p.default.createElement(s,{type:e.type})),p.default.createElement("div",{className:"text"},p.default.createElement("span",{className:"name"},r),p.default.createElement("div",{"data-device-id":e.id,className:"revoke",onClick:this.handleRevokeClick},p.default.createElement("i",{className:"fa fa-ban"})," ",p.default.createElement("span",null,n("mobile-device-revoke")))))}},{key:"renderDialogBox",value:function(){var e=this.props.env,t=this.state.confirmingRevocation,n=e.locale.t,r={show:t,env:e,onClose:this.handleDialogClose,onConfirm:this.handleRevokeConfirm};return p.default.createElement(y.default,r,n("mobile-device-revoke-are-you-sure"))}}]),t}(f.PureComponent));_.displayName="DevicePanel",t.default=_,t.DevicePanel=_},"./panels/device-panel.scss":function(e,t){},"./panels/language-panel.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LanguagePanel=t.default=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n("../../common/node_modules/lodash/lodash.js"),c=r(l),d=n("../../common/node_modules/react/index.js"),f=r(d),p=n("./widgets/settings-panel.jsx"),h=r(p),m=n("./widgets/option-button.jsx"),v=r(m);n("./panels/language-panel.scss");var g=n("../../common/src/env/environment.js"),y=(r(g),function(e){function t(){var e,n,r,i;o(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.handleLanguageClick=function(e){var t=r.props.env,n=t.locale,o=n.languageCode,a=n.directory,i=e.currentTarget.id;if(i!==o){var s=c.default.find(a,{code:i}),u=s.code+"-"+s.defaultCountry;t.locale.change(u)}},r.handleCountryChange=function(e){var t=r.props.env,n=t.locale,o=n.languageCode,a=n.countryCode,i=e.currentTarget.value;if(i!==a){var s=o+"-"+i;t.locale.change(s)}},i=n,a(r,i)}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return f.default.createElement(h.default,{className:"language"},f.default.createElement("header",null,f.default.createElement("i",{className:"fa fa-language"})," ",t("settings-language")),f.default.createElement("body",null,this.renderList()))}},{key:"renderList",value:function(){var e=this,t=this.props.env,n=t.locale.directory,r=c.default.filter(n,function(e){return!!e.module});return c.default.map(r,function(t){return e.renderButton(t)})}},{key:"renderButton",value:function(e){var t=this.props.env,n=t.locale.languageCode,r=this.renderCountrySelect(e),o={label:f.default.createElement("span",null,e.name,r),selected:e.code===n,onClick:this.handleLanguageClick,id:e.code};return f.default.createElement(v.default,s({key:e.code},o))}},{key:"renderCountrySelect",value:function(e){var t=this.props.env,n=t.locale,r=n.languageCode,o=n.countryCode;o||(o=e.defaultCountry);var a=c.default.map(e.countries,function(e,t){return f.default.createElement("option",{key:t,value:t},e)}),i={value:o,onChange:this.handleCountryChange};return(e.code!==r||c.default.size(e.countries)<=1)&&(i.className="sole"),f.default.createElement("select",s({key:1},i),a)}}]),t}(d.PureComponent));y.displayName="LanguagePanel",t.default=y,t.LanguagePanel=y},"./panels/language-panel.scss":function(e,t){},"./panels/mobile-alert-panel.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MobileAlertPanel=t.default=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n("../../common/node_modules/lodash/lodash.js"),c=r(l),d=n("../../common/node_modules/react/index.js"),f=r(d),p=n("../../common/src/objects/types/notification-types.js"),h=r(p),m=n("../../common/src/objects/utils/user-utils.js"),v=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(m),g=n("./widgets/settings-panel.jsx"),y=r(g),b=n("./widgets/option-button.jsx"),w=r(b);n("./panels/mobile-alert-panel.scss");var C=n("../../common/src/env/environment.js"),_=(r(C),function(e){function t(){var e,n,r,i;o(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.handleOptionClick=function(e){var t=r.props.currentUser,n=e.currentTarget.id,o="mobile_alert."+n,a=c.default.clone(c.default.get(t,"settings",{}));!c.default.get(a,o)?c.default.set(a,o,!0):c.default.unset(a,o),r.setUserProperty("settings",a)},i=n,a(r,i)}return i(t,e),u(t,[{key:"setUserProperty",value:function(e,t){var n=this.props,r=n.currentUser,o=n.onChange;if(r){var a=c.default.decoupleSet(r,e,t);o&&o({type:"change",target:this,user:a})}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return f.default.createElement(y.default,{className:"mobile-alert"},f.default.createElement("header",null,f.default.createElement("div",{className:"icon"},f.default.createElement("i",{className:"fa fa-tablet"}),f.default.createElement("i",{className:"fa fa-exclamation-circle icon-overlay"}))," ",t("settings-mobile-alert")),f.default.createElement("body",null,this.renderOptions()))}},{key:"renderOptions",value:function(){var e=this,t=this.props.currentUser,n=h.default;return"admin"!==c.default.get(t,"type")&&(n=c.default.without(n,p.AdminNotificationTypes)),n=c.default.concat(n,"web-session"),c.default.map(n,function(t,n){return e.renderOption(t,n)})}},{key:"renderOption",value:function(e,t){var n=this.props,r=n.env,o=n.currentUser,a=n.repos,i=r.locale.t,u=c.default.snakeCase(e),l=c.default.get(o,"settings",{}),d=!!c.default.get(l,"notification."+u),p=!!c.default.get(l,"mobile_alert."+u),h=v.canReceiveNotification(o,a,e),m={label:i("notification-option-"+e),selected:p&&(d||"web-session"===e),hidden:!h,disabled:!(d||"web-session"===e),onClick:this.handleOptionClick,id:u};return f.default.createElement(w.default,s({key:t},m))}}]),t}(d.PureComponent));_.displayName="MobileAlertPanel",t.default=_,t.MobileAlertPanel=_},"./panels/mobile-alert-panel.scss":function(e,t){},"./panels/notification-panel.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationPanel=t.default=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n("../../common/node_modules/lodash/lodash.js"),c=r(l),d=n("../../common/node_modules/react/index.js"),f=r(d),p=n("../../common/src/objects/types/notification-types.js"),h=r(p),m=n("../../common/src/objects/utils/user-utils.js"),v=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(m),g=n("./widgets/settings-panel.jsx"),y=r(g),b=n("./widgets/option-button.jsx"),w=r(b);n("./panels/notification-panel.scss");var C=n("../../common/src/env/environment.js"),_=(r(C),function(e){function t(){var e,n,r,i;o(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.handleOptionClick=function(e){var t=r.props.currentUser,n=e.currentTarget.id,o=["notification."+n,"web_alert."+n,"mobile_alert."+n],a=c.default.clone(c.default.get(t,"settings",{})),i=!!c.default.get(a,o[0]);c.default.each(o,function(e,t){i?c.default.unset(a,e):0===t&&"merge"===n?c.default.set(a,e,"master"):c.default.set(a,e,!0)}),r.setUserProperty("settings",a)},i=n,a(r,i)}return i(t,e),u(t,[{key:"setUserProperty",value:function(e,t){var n=this.props,r=n.currentUser,o=n.onChange;if(r){var a=c.default.decoupleSet(r,e,t);o&&o({type:"change",target:this,user:a})}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return f.default.createElement(y.default,{className:"notification"},f.default.createElement("header",null,f.default.createElement("i",{className:"fa fa-exclamation-circle"})," ",t("settings-notification")),f.default.createElement("body",null,this.renderOptions()))}},{key:"renderOptions",value:function(){var e=this,t=this.props.currentUser,n=h.default;return"admin"!==c.default.get(t,"type")&&(n=c.default.without(n,p.AdminNotificationTypes)),c.default.map(n,function(t,n){return e.renderOption(t,n)})}},{key:"renderOption",value:function(e,t){var n=this.props,r=n.env,o=n.currentUser,a=n.repos,i=r.locale.t,u=c.default.snakeCase(e),l=c.default.get(o,"settings",{}),d=!!c.default.get(l,"notification."+u),p=v.canReceiveNotification(o,a,e),h={label:i("notification-option-"+e),selected:d,hidden:!p,onClick:this.handleOptionClick,id:u};return f.default.createElement(w.default,s({key:t},h))}}]),t}(d.PureComponent));_.displayName="NotificationPanel",t.default=_,t.NotificationPanel=_},"./panels/notification-panel.scss":function(e,t){},"./panels/project-panel.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return e.hidden?null:f.default.createElement("div",{className:"item"},f.default.createElement("span",{className:"button",onClick:e.onClick},f.default.createElement("i",{className:"fa fa-fw fa-"+e.icon}),f.default.createElement("span",{className:"label"},e.label)))}Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectPanel=t.default=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n("../../common/node_modules/lodash/lodash.js"),c=r(l),d=n("../../common/node_modules/react/index.js"),f=r(d),p=n("../../common/src/objects/utils/user-utils.js"),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(p),m=n("./widgets/settings-panel.jsx"),v=r(m),g=n("./widgets/push-button.jsx"),y=r(g),b=n("./dialogs/system-description-dialog-box.jsx"),w=r(b),C=n("./dialogs/project-description-dialog-box.jsx"),_=r(C),k=n("./dialogs/mobile-setup-dialog-box.jsx"),E=r(k),j=n("./dialogs/confirmation-dialog-box.jsx"),S=r(j),P=n("./dialogs/project-management-dialog-box.jsx"),R=r(P);n("./panels/project-panel.scss");var O=n("../../common/src/data/database.js"),T=(r(O),n("../../common/src/routing/route.js")),A=(r(T),n("../../common/src/env/environment.js")),x=(r(A),function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleProjectClick=function(e){var t=n.props,r=t.route,o=t.projectLinks,a=e.currentTarget.getAttribute("data-key"),i=c.default.find(o,{key:a});if(i){var s=window.location.origin,u={address:i.address,schema:i.schema,cors:s!==i.address};r.replace("settings-page",{},u)}},n.handleAddClick=function(e){n.props.route.push("start-page",{},{schema:null})},n.handleManageClick=function(e){n.setState({managingProjects:!0})},n.handleSystemDescriptionClick=function(e){n.setState({showingSystemDescription:!0})},n.handleProjectDescriptionClick=function(e){n.setState({showingProjectDescription:!0})},n.handleMobileSetupClick=function(e){n.setState({activatingMobileDevice:!0})},n.handleJoinClick=function(e){var t=n.props,r=t.currentUser,o=t.currentProject,a=t.onChange,i=c.default.cloneDeep(r);i.requested_project_ids=c.default.union(i.requested_project_ids,[o.id]),a&&a({type:"change",target:n,user:i})},n.handleCancelJoinClick=function(e){var t=n.props,r=t.currentUser,o=t.currentProject,a=t.onChange,i=c.default.cloneDeep(r);c.default.pull(i.requested_project_ids,o.id),a&&a({type:"change",target:n,user:i})},n.handleSignOutClick=function(e){n.setState({confirmingSignOut:!0})},n.handleSystemDescriptionDialogClose=function(e){n.setState({showingSystemDescription:!1})},n.handleProjectDescriptionDialogClose=function(e){n.setState({showingProjectDescription:!1})},n.handleMobileSetupDialogClose=function(e){n.setState({activatingMobileDevice:!1})},n.handleMembershipDialogClose=function(e){n.setState({notifyingNewMembership:!1})},n.handleConfirmationDialogClose=function(e){n.setState({confirmingSignOut:!1})},n.handleProjectManagementDialogClose=function(e){n.setState({managingProjects:!1})},n.handleProjectDelete=function(e){n.handleProjectManagementDialogClose();var t=n.props,r=t.database,o=t.route,a=o.context,i=c.default.includes(e.selection,a.address+"/"+a.schema),s=c.default.map(e.selection,function(e){return{key:e}});r.use({by:n}).remove({schema:"local",table:"project_link"},s).then(function(){if(i)return o.replace("start-page",{},{schema:null})})},n.handleSignOutConfirm=function(e){var t=n.props,r=t.database,o=t.route,a=t.projectLinks,i=o.context,s=r.use({by:n});s.endSession().then(function(){var e=c.default.filter(a,{address:i.address});return s.remove({schema:"local",table:"project_link"},e).then(function(){return o.replace("start-page",{},{schema:null})})})},n.state={showingSystemDescription:!1,showingProjectDescription:!1,activatingMobileDevice:!1,notifyingNewMembership:!1,confirmingSignOut:!1,managingProjects:!1},n}return i(t,e),u(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.currentProject,r=t.currentUser,o=this.state.notifyingNewMembership;if(e.currentProject!==n&&n&&e.currentProject&&e.currentProject.id===n.id){var a=h.isMember(r,n),i=h.isMember(r,e.currentProject);!a&&i&&(o||this.setState({notifyingNewMembership:!0}))}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return f.default.createElement(v.default,{className:"project"},f.default.createElement("header",null,f.default.createElement("i",{className:"fa fa-database"})," ",t("settings-projects")),f.default.createElement("body",null,this.renderProjects(),this.renderDialogBox()),f.default.createElement("footer",null,this.renderButtons()))}},{key:"renderProjects",value:function(){var e=this,t=this.props.projectLinks;return c.default.map(t,function(t,n){return e.renderProject(t,n)})}},{key:"renderProject",value:function(e,t){var n=this.props,r=n.route,o=n.env,a=n.currentProject,i=n.currentUser,u=o.locale,l=u.t,d=u.p,p=r.context;if(e.schema===p.schema&&e.address==p.address){var h=!0,m=!1;a&&i&&(c.default.includes(a.user_ids,i.id)||(h=!1,c.default.includes(i.requested_project_ids,a.id)&&(m=!0)));var v={icon:"home",label:e.address,onClick:this.handleSystemDescriptionClick},g={icon:"info-circle",label:l("project-management-description"),onClick:this.handleProjectDescriptionClick},y={icon:"qrcode",label:l("project-management-mobile-set-up"),hidden:"cordova"===o.platform,onClick:this.handleMobileSetupClick},b={icon:m?"clock-o":"user-circle-o",label:l("project-management-"+(m?"withdraw-request":"join-project")),hidden:h,onClick:m?this.handleCancelJoinClick:this.handleJoinClick},w={icon:"sign-out",label:l("project-management-sign-out"),onClick:this.handleSignOutClick};return f.default.createElement("div",{key:t,className:"project-option-button selected"},f.default.createElement("i",{className:"icon fa fa-check-circle"}),f.default.createElement("div",{className:"text"},f.default.createElement("span",{className:"name"},d(e.name)),f.default.createElement("div",{className:"supplemental"},f.default.createElement(s,v),f.default.createElement(s,g),f.default.createElement(s,y),f.default.createElement(s,b),f.default.createElement(s,w))))}return f.default.createElement("div",{key:t,"data-key":e.key,className:"project-option-button",onClick:this.handleProjectClick},f.default.createElement("i",{className:"icon fa fa-circle-o"}),f.default.createElement("div",{className:"text"},f.default.createElement("span",{className:"name"},d(e.name))))}},{key:"renderButtons",value:function(){var e=this.props.env,t=e.locale.t,n={label:t("project-management-add"),onClick:this.handleAddClick},r={label:t("project-management-manage"),onClick:this.handleManageClick};return f.default.createElement("div",{className:"buttons"},f.default.createElement(y.default,r),f.default.createElement(y.default,n))}},{key:"renderDialogBox",value:function(){return this.props.currentProject?f.default.createElement("div",null,this.renderSystemDescriptionDialogBox(),this.renderProjectDescriptionDialogBox(),this.renderMobileSetupDialogBox(),this.renderSignOutDialogBox(),this.renderProjectManagementDialogBox(),this.renderMembershipDialogBox()):null}},{key:"renderSystemDescriptionDialogBox",value:function(){var e=this.props,t=e.env,n=e.system,r=this.state.showingSystemDescription,o={show:r,system:n,env:t,onClose:this.handleSystemDescriptionDialogClose};return f.default.createElement(w.default,o)}},{key:"renderProjectDescriptionDialogBox",value:function(){var e=this.props,t=e.env,n=e.currentProject,r=this.state.showingProjectDescription,o={show:r,project:n,env:t,onClose:this.handleProjectDescriptionDialogClose};return f.default.createElement(_.default,o)}},{key:"renderMobileSetupDialogBox",value:function(){var e=this.props,t=e.database,n=e.env,r=e.system,o=this.state.activatingMobileDevice,a={show:o,system:r,database:t,env:n,onClose:this.handleMobileSetupDialogClose};return f.default.createElement(E.default,a)}},{key:"renderSignOutDialogBox",value:function(){var e=this.props.env,t=this.state.confirmingSignOut,n=e.locale.t,r={show:t,env:e,onClose:this.handleDialogClose,onConfirm:this.handleSignOutConfirm};return f.default.createElement(S.default,r,n("project-management-sign-out-are-you-sure"))}},{key:"renderMembershipDialogBox",value:function(){var e=this.props,t=e.env,n=e.currentUser,r=this.state.notifyingNewMembership,o=t.locale,a=o.t,i=o.g,s=h.getDisplayName(n,t);i(s,h.getGender(n));var u={show:r,env:t,onConfirm:this.handleMembershipDialogClose};return f.default.createElement(S.default,u,a("membership-request-$you-are-now-member",s))}},{key:"renderProjectManagementDialogBox",value:function(){var e=this.props,t=e.route,n=e.env,r=e.projectLinks,o=this.state.managingProjects,a={show:o,projectLinks:r,route:t,env:n,onDelete:this.handleProjectDelete,onCancel:this.handleProjectManagementDialogClose};return f.default.createElement(R.default,a)}}]),t}(d.PureComponent));x.displayName="ProjectPanel",t.default=x,t.ProjectPanel=x},"./panels/project-panel.scss":function(e,t){},"./panels/social-network-panel.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(/https?:/.test(e)){e=c.default.trim(e.replace(/\?.*/,""));var n=c.default.filter(e.split("/"));return n[n.length-1]}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.SocialNetworkPanel=t.default=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n("../../common/node_modules/lodash/lodash.js"),c=r(l),d=n("../../common/node_modules/react/index.js"),f=r(d),p=n("./widgets/settings-panel.jsx"),h=r(p),m=n("./widgets/push-button.jsx"),v=(r(m),n("./widgets/text-field.jsx")),g=r(v);n("./panels/social-network-panel.scss");var y=n("../../common/src/env/environment.js"),b=(r(y),function(e){function t(){var e,n,r,i;o(this,t);for(var u=arguments.length,l=Array(u),d=0;d<u;d++)l[d]=arguments[d];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.handleSkypeUsernameChange=function(e){var t=c.default.trim(e.target.value);r.setUserProperty("details.skype_username",t)},r.handleIchatUsernameChange=function(e){var t=c.default.trim(e.target.value);r.setUserProperty("details.ichat_username",t)},r.handleTwitterUsernameChange=function(e){var t=s(e.target.value);r.setUserProperty("details.twitter_username",t)},r.handleLinkedinURLChange=function(e){var t=c.default.trim(e.target.value);r.setUserProperty("details.linkedin_url",t)},r.handleGitHubURLChange=function(e){var t=c.default.trim(e.target.value);r.setUserProperty("details.github_url",t)},r.handleGitlabURLChange=function(e){var t=c.default.trim(e.target.value);r.setUserProperty("details.gitlab_url",t)},r.handleStackoverflowURLChange=function(e){var t=c.default.trim(e.target.value);r.setUserProperty("details.stackoverflow_url",t)},i=n,a(r,i)}return i(t,e),u(t,[{key:"getUserProperty",value:function(e){var t=this.props.currentUser;return c.default.get(t,e)}},{key:"setUserProperty",value:function(e,t){var n=this.props,r=n.currentUser,o=n.onChange;if(r){var a=c.default.decoupleSet(r,e,t);o&&o({type:"change",target:this,user:a})}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return f.default.createElement(h.default,{className:"user"},f.default.createElement("header",null,f.default.createElement("i",{className:"fa fa-handshake-o"})," ",t("settings-social-networks")),f.default.createElement("body",null,this.renderSkypeNameInput(),this.renderIChatInput(),this.renderTwitterInput(),this.renderGithubURLInput(),this.renderGitlabURLInput(),this.renderLinkedInURLInput(),this.renderStackoverflowURLInput()))}},{key:"renderSkypeNameInput",value:function(){var e=this.props.env,t=e.locale.t,n={id:"skype",value:this.getUserProperty("details.skype_username"),env:e,onChange:this.handleSkypeUsernameChange};return f.default.createElement(g.default,n,t("social-network-skype"))}},{key:"renderIChatInput",value:function(){var e=this.props.env,t=e.locale.t,n={id:"ichat",value:this.getUserProperty("details.ichat_username"),env:e,onChange:this.handleIchatUsernameChange};return f.default.createElement(g.default,n,t("social-network-ichat"))}},{key:"renderTwitterInput",value:function(){var e=this.props.env,t=e.locale.t,n={id:"twitter",value:this.getUserProperty("details.twitter_username"),env:e,onChange:this.handleTwitterUsernameChange};return f.default.createElement(g.default,n,t("social-network-twitter"))}},{key:"renderGithubURLInput",value:function(){var e=this.props.env,t=e.locale.t,n={id:"github",value:this.getUserProperty("details.github_url"),env:e,onChange:this.handleGitHubURLChange};return f.default.createElement(g.default,n,t("social-network-github"))}},{key:"renderGitlabURLInput",value:function(){var e=this.props.env,t=e.locale.t,n={id:"github",value:this.getUserProperty("details.gitlab_url"),env:e,onChange:this.handleGitlabURLChange};return f.default.createElement(g.default,n,t("social-network-gitlab"))}},{key:"renderLinkedInURLInput",value:function(){var e=this.props.env,t=e.locale.t,n={id:"linkedin",value:this.getUserProperty("details.linkedin_url"),env:e,onChange:this.handleLinkedinURLChange};return f.default.createElement(g.default,n,t("social-network-linkedin"))}},{key:"renderStackoverflowURLInput",value:function(){var e=this.props.env,t=e.locale.t,n={id:"stackoverflow",value:this.getUserProperty("details.stackoverflow_url"),env:e,onChange:this.handleStackoverflowURLChange};return f.default.createElement(g.default,n,t("social-network-stackoverflow"))}}]),t}(d.PureComponent));b.displayName="SocialNetworkPanel",t.default=b,t.SocialNetworkPanel=b},"./panels/social-network-panel.scss":function(e,t){},"./panels/user-image-panel.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.UserImagePanel=t.default=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n("../../common/node_modules/lodash/lodash.js"),l=r(u),c=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),d=r(c),f=n("../../common/node_modules/moment/moment.js"),p=(r(f),n("../../common/node_modules/react/index.js")),h=r(p),m=n("../../common/src/utils/component-refs.js"),v=r(m),g=n("../../common/src/utils/focus-manager.js"),y=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(g),n("./widgets/settings-panel.jsx")),b=r(y),w=n("./widgets/push-button.jsx"),C=r(w),_=n("./editors/image-editor.jsx"),k=r(_),E=n("./editors/media-importer.jsx"),j=r(E),S=n("../node_modules/octicons/build/svg/person.svg"),P=r(S);n("./panels/user-image-panel.scss");var R=n("../../common/src/transport/payloads.js"),O=(r(R),n("../../common/src/env/environment.js")),T=(r(O),function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleCancelClick=function(e){n.setState({action:null,image:null})},n.handleAdjustClick=function(e){n.setState({action:"adjust"})},n.handleReplaceClick=function(e){n.setState({action:"replace"})},n.handleTakeClick=function(e){n.components.importer.capture("image")},n.handleFileChange=function(e){var t=n.components.importer,r=e.target.files;t.importFiles(r)},n.handleSaveClick=function(e){var t=n.state.image;t&&(n.setUserProperty("details.resources",[t]),n.setState({action:null,image:null}))},n.handleImageChange=function(e){n.setState({image:e.resource})},n.handleChange=function(e){return n.setState({image:e.resources[0],action:"adjust"}),d.default.resolve()},n.handleCaptureEnd=function(e){},n.components=(0,v.default)({importer:j.default}),n.state={action:null,image:null},n}return i(t,e),s(t,[{key:"getUserProperty",value:function(e){var t=this.props.currentUser;return l.default.get(t,e)}},{key:"getImage",value:function(){var e=this.state.image;if(e)return e;var t=this.getUserProperty("details.resources");return l.default.find(t,{type:"image"})}},{key:"setUserProperty",value:function(e,t){var n=this.props,r=n.currentUser,o=n.onChange;if(r){var a=l.default.decoupleSet(r,e,t);o&&o({type:"change",target:this,user:a,immediate:!0})}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return h.default.createElement(b.default,{className:"user-image"},h.default.createElement("header",null,h.default.createElement("i",{className:"fa fa-image"})," ",t("settings-profile-image")),h.default.createElement("body",null,this.renderProfilePicture(),this.renderMediaImporter()),h.default.createElement("footer",null,this.renderButtons()))}},{key:"renderProfilePicture",value:function(){var e=this.props.env,t=this.state.action,n=void 0,r=this.getImage();if(r){var o={resource:r,previewWidth:256,previewHeight:256,disabled:"adjust"!==t,env:e,onChange:this.handleImageChange};n=h.default.createElement(k.default,o)}else n=h.default.createElement("div",{className:"no-image"},h.default.createElement(P.default,{className:""}));return h.default.createElement("div",{className:"image-container"},n)}},{key:"renderMediaImporter",value:function(){var e=this.props,t=e.env,n=e.payloads,r=e.currentUser,o=this.state.image,a=this.components.setters,i=void 0;i=o?[o]:l.default.get(r,"details.resources",[]);var s={ref:a.importer,types:["image"],limit:1,schema:"global",resources:i,env:t,payloads:n.override({schema:"global"}),cameraDirection:"front",onChange:this.handleChange,onCaptureEnd:this.handleCaptureEnd};return h.default.createElement(j.default,s)}},{key:"renderButtons",value:function(){var e=this.props.env,t=this.state,n=t.action,r=t.image,o=e.locale.t,a=!!this.getImage();if("adjust"===n&&a){var i={label:o("user-image-cancel"),onClick:this.handleCancelClick},s={label:o("user-image-save"),emphasized:!0,disabled:!r,onClick:this.handleSaveClick};return h.default.createElement("div",{key:"adjust",className:"buttons"},h.default.createElement(C.default,i),h.default.createElement(C.default,s))}if("replace"===n&&a){var u={label:o("user-image-cancel"),onClick:this.handleCancelClick},c={label:o("user-image-snap"),hidden:!l.default.includes(e.recorders,"image"),onClick:this.handleTakeClick},d={label:o("user-image-select"),accept:"image/*",onChange:this.handleFileChange};return h.default.createElement("div",{key:"replace",className:"buttons"},h.default.createElement(C.default,u),h.default.createElement(C.default,c),h.default.createElement(C.default.File,d))}if(a){var f={label:o("user-image-adjust"),onClick:this.handleAdjustClick},p={label:o("user-image-replace"),onClick:this.handleReplaceClick};return h.default.createElement("div",{key:"action",className:"buttons"},h.default.createElement(C.default,f),h.default.createElement(C.default,p))}var m={label:o("user-image-snap"),hidden:!canTakePicture,onClick:this.handleTakeClick},v={label:o("user-image-select"),accept:"image/*",onChange:this.handleFileChange};return h.default.createElement("div",{key:"add",className:"buttons"},h.default.createElement(C.default,m),h.default.createElement(C.default.File,v))}}]),t}(p.PureComponent));T.displayName="UserImagePanel",t.default=T,t.UserImagePanel=T},"./panels/user-image-panel.scss":function(e,t){},"./panels/user-info-panel.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.UserInfoPanel=t.default=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n("../../common/node_modules/lodash/lodash.js"),l=r(u),c=n("../../common/node_modules/react/index.js"),d=r(c),f=n("./widgets/settings-panel.jsx"),p=r(f),h=n("./widgets/push-button.jsx"),m=(r(h),n("./widgets/text-field.jsx")),v=r(m);n("./panels/user-info-panel.scss");var g=n("../../common/src/env/environment.js"),y=(r(g),function(e){function t(){var e,n,r,i;o(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.handleNameChange=function(e){var t=e.target.value;r.setUserProperty("details.name",t)},r.handleEmailChange=function(e){var t=e.target.value;r.setUserProperty("details.email",t)},r.handlePhoneChange=function(e){var t=e.target.value;r.setUserProperty("details.phone",t)},r.handleGenderChange=function(e){var t=e.target.value;r.setUserProperty("details.gender",t||void 0)},i=n,a(r,i)}return i(t,e),s(t,[{key:"getUserProperty",value:function(e){var t=this.props.currentUser;return l.default.get(t,e)}},{key:"setUserProperty",value:function(e,t){var n=this.props,r=n.currentUser,o=n.onChange;if(r){var a=l.default.decoupleSet(r,e,t);o&&o({type:"change",target:this,user:a})}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return d.default.createElement(p.default,{className:"user-info"},d.default.createElement("header",null,d.default.createElement("i",{className:"fa fa-user-circle"})," ",t("settings-user-information")),d.default.createElement("body",null,this.renderNameInput(),this.renderEmailInput(),this.renderPhoneInput(),this.renderGenderSelector()))}},{key:"renderNameInput",value:function(){var e=this.props.env,t=e.locale,n=t.t,r=t.p,o=this.getUserProperty("details.name"),a={id:"name",value:r(o),env:e,onChange:this.handleNameChange};return d.default.createElement(v.default,a,n("user-info-name"))}},{key:"renderEmailInput",value:function(){var e=this.props.env,t=e.locale,n=t.t,r=(t.p,{id:"email",value:this.getUserProperty("details.email"),env:e,onChange:this.handleEmailChange});return d.default.createElement(v.default,r,n("user-info-email"))}},{key:"renderPhoneInput",value:function(){var e=this.props.env,t=e.locale,n=t.t,r=(t.p,{id:"email",value:this.getUserProperty("details.phone"),env:e,onChange:this.handlePhoneChange});return d.default.createElement(v.default,r,n("user-info-phone"))}},{key:"renderGenderSelector",value:function(){var e=this.props.env,t=e.locale,n=t.t,r=(t.p,{id:"gender",value:this.getUserProperty("details.gender")||"",size:3,onChange:this.handleGenderChange});return d.default.createElement("div",{className:"gender-selector"},d.default.createElement("label",{htmlFor:"gender"},n("user-info-gender")),d.default.createElement("select",r,d.default.createElement("option",{value:"male"},n("user-info-gender-male")),d.default.createElement("option",{value:"female"},n("user-info-gender-female")),d.default.createElement("option",{value:""},n("user-info-gender-unspecified"))))}}]),t}(c.PureComponent));y.displayName="UserInfoPanel",t.default=y,t.UserInfoPanel=y},"./panels/user-info-panel.scss":function(e,t){},"./panels/web-alert-panel.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(){var e=navigator.userAgent;for(var t in E){if(E[t].test(e))return t}return"globe"}Object.defineProperty(t,"__esModule",{value:!0}),t.WebAlertPanel=t.default=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n("../../common/node_modules/lodash/lodash.js"),d=r(c),f=n("../../common/node_modules/react/index.js"),p=r(f),h=n("../../common/src/objects/types/notification-types.js"),m=r(h),v=n("../../common/src/objects/utils/user-utils.js"),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(v),y=n("./widgets/settings-panel.jsx"),b=r(y),w=n("./widgets/option-button.jsx"),C=r(w);n("./panels/web-alert-panel.scss");var _=n("../../common/src/env/environment.js"),k=(r(_),function(e){function t(){var e,n,r,i;o(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.handleOptionClick=function(e){var t=r.props.currentUser,n=e.currentTarget.id,o="web_alert."+n,a=d.default.clone(d.default.get(t,"settings",{}));!d.default.get(a,o)?d.default.set(a,o,!0):d.default.unset(a,o),r.setUserProperty("settings",a)},i=n,a(r,i)}return i(t,e),l(t,[{key:"setUserProperty",value:function(e,t){var n=this.props,r=n.currentUser,o=n.onChange;if(r){var a=d.default.decoupleSet(r,e,t);o&&o({type:"change",target:this,user:a})}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t,n=s();return p.default.createElement(b.default,{className:"web-alert"},p.default.createElement("header",null,p.default.createElement("div",{className:"icon"},p.default.createElement("i",{className:"fa fa-"+n}),p.default.createElement("i",{className:"fa fa-exclamation-circle icon-overlay"}))," ",t("settings-web-alert")),p.default.createElement("body",null,this.renderOptions()))}},{key:"renderOptions",value:function(){var e=this,t=this.props.currentUser,n=m.default;return"admin"!==d.default.get(t,"type")&&(n=d.default.without(n,h.AdminNotificationTypes)),d.default.map(n,function(t,n){return e.renderOption(t,n)})}},{key:"renderOption",value:function(e,t){var n=this.props,r=n.env,o=n.currentUser,a=n.repos,i=r.locale.t,s=d.default.snakeCase(e),l=d.default.get(o,"settings",{}),c=!!d.default.get(l,"notification."+s),f=!!d.default.get(l,"web_alert."+s),h=g.canReceiveNotification(o,a,e),m={label:i("notification-option-"+e),selected:f&&c,hidden:!h,disabled:!c,onClick:this.handleOptionClick,id:s};return p.default.createElement(C.default,u({key:t},m))}}]),t}(f.PureComponent));k.displayName="WebAlertPanel";var E={edge:/(Edge|Internet Explorer)/,chrome:/Chrome/,safari:/Safari/,firefox:/Firefox/};t.default=k,t.WebAlertPanel=k},"./panels/web-alert-panel.scss":function(e,t){}});